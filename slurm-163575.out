[I 2025-10-16 23:53:06,365] A new study created in RDB with name: Mamba_Exchange_1

======================================================================
Starting Optuna Hyperparameter Optimization
======================================================================
Model: Mamba
Dataset: custom
Number of trials: 50
Study name: Mamba_Exchange_1
Storage: sqlite:///optuna_study.db
======================================================================

  0%|          | 0/50 [00:00<?, ?it/s]
============================================================
Trial 0
============================================================
seq_len: 48, pred_len: 7
d_model: 32, n_heads: 8
e_layers: 2, d_layers: 1
batch_size: 16, lr: 0.000027
dropout: 0.27721417055855346
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 64, expand: 2
>>>>>> Start training: trial_0 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 7
============================================================
train 4619
val 253
test 255
Validation loss decreased (inf --> 0.037049).  Saving model ...
Updating learning rate to 2.6674972949994553e-05
Validation loss decreased (0.037049 --> 0.037019).  Saving model ...
Updating learning rate to 1.3337486474997277e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.668743237498638e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.334371618749319e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6671858093746596e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.335929046873298e-07
Validation loss decreased (0.037019 --> 0.037008).  Saving model ...
Updating learning rate to 4.167964523436649e-07
Validation loss decreased (0.037008 --> 0.036994).  Saving model ...
Updating learning rate to 2.0839822617183245e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0419911308591622e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.209955654295811e-08
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.6049778271479056e-08
Validation loss decreased (0.036994 --> 0.036994).  Saving model ...
Updating learning rate to 1.3024889135739528e-08
Validation loss decreased (0.036994 --> 0.036971).  Saving model ...
Updating learning rate to 6.512444567869764e-09
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.256222283934882e-09
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.628111141967441e-09
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.140555709837205e-10
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.0702778549186025e-10
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0351389274593013e-10
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.0175694637296506e-10
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.087847318648253e-11
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.5439236593241266e-11
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.2719618296620633e-11
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.3598091483103164e-12
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.1799045741551582e-12
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.5899522870775791e-12
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.949761435387896e-13
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.974880717693948e-13
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.987440358846974e-13
EarlyStopping counter: 16 out of 100
Updating learning rate to 9.93720179423487e-14
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.968600897117435e-14
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.4843004485587174e-14
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.2421502242793587e-14
EarlyStopping counter: 20 out of 100
Updating learning rate to 6.2107511213967934e-15
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.1053755606983967e-15
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.5526877803491983e-15
EarlyStopping counter: 23 out of 100
Updating learning rate to 7.763438901745992e-16
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.881719450872996e-16
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.940859725436498e-16
EarlyStopping counter: 26 out of 100
Updating learning rate to 9.70429862718249e-17
EarlyStopping counter: 27 out of 100
Updating learning rate to 4.852149313591245e-17
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.4260746567956224e-17
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.2130373283978112e-17
EarlyStopping counter: 30 out of 100
Updating learning rate to 6.065186641989056e-18
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.032593320994528e-18
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.516296660497264e-18
EarlyStopping counter: 33 out of 100
Updating learning rate to 7.58148330248632e-19
EarlyStopping counter: 34 out of 100
Updating learning rate to 3.79074165124316e-19
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.89537082562158e-19
EarlyStopping counter: 36 out of 100
Updating learning rate to 9.4768541281079e-20
EarlyStopping counter: 37 out of 100
Updating learning rate to 4.73842706405395e-20
EarlyStopping counter: 38 out of 100
Updating learning rate to 2.369213532026975e-20
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.1846067660134875e-20
EarlyStopping counter: 40 out of 100
Updating learning rate to 5.9230338300674376e-21
EarlyStopping counter: 41 out of 100
Updating learning rate to 2.9615169150337188e-21
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.4807584575168594e-21
EarlyStopping counter: 43 out of 100
Updating learning rate to 7.403792287584297e-22
EarlyStopping counter: 44 out of 100
Updating learning rate to 3.7018961437921485e-22
EarlyStopping counter: 45 out of 100
Updating learning rate to 1.8509480718960742e-22
EarlyStopping counter: 46 out of 100
Updating learning rate to 9.254740359480371e-23
EarlyStopping counter: 47 out of 100
Updating learning rate to 4.6273701797401856e-23
EarlyStopping counter: 48 out of 100
Updating learning rate to 2.3136850898700928e-23
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.1568425449350464e-23
EarlyStopping counter: 50 out of 100
Updating learning rate to 5.784212724675232e-24
EarlyStopping counter: 51 out of 100
Updating learning rate to 2.892106362337616e-24
Validation loss decreased (0.036971 --> 0.036939).  Saving model ...
Updating learning rate to 1.446053181168808e-24
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.23026590584404e-25
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.61513295292202e-25
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.80756647646101e-25
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.03783238230505e-26
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.518916191152525e-26
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.2594580955762625e-26
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1297290477881312e-26
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.648645238940656e-27
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.824322619470328e-27
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.412161309735164e-27
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.06080654867582e-28
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.53040327433791e-28
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.765201637168955e-28
EarlyStopping counter: 14 out of 100
Updating learning rate to 8.826008185844775e-29
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.4130040929223877e-29
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.2065020464611938e-29
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.1032510232305969e-29
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.5162551161529846e-30
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.7581275580764923e-30
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.3790637790382462e-30
EarlyStopping counter: 21 out of 100
Updating learning rate to 6.895318895191231e-31
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.4476594475956154e-31
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.7238297237978077e-31
Validation loss decreased (0.036939 --> 0.036933).  Saving model ...
Updating learning rate to 8.619148618989038e-32
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.309574309494519e-32
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.1547871547472596e-32
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0773935773736298e-32
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.386967886868149e-33
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.6934839434340745e-33
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3467419717170373e-33
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.733709858585186e-34
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.366854929292593e-34
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.6834274646462966e-34
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.417137323231483e-35
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.2085686616157414e-35
>>>>>> Testing on validation set: trial_0 >>>>>>
test 255
test shape: (255, 7, 5) (255, 7, 5)
test shape: (255, 7, 5) (255, 7, 5)


	mse:0.06438466906547546, mae:0.09809122234582901, dtw:Not calculated


                                      [I 2025-10-16 23:57:28,749] Trial 0 finished with value: 0.09809122234582901 and parameters: {'seq_len': 48, 'pred_len': 7, 'expand': 2, 'd_model': 32, 'n_heads': 8, 'e_layers': 2, 'd_layers': 1, 'batch_size': 16, 'learning_rate': 2.6674972949994553e-05, 'dropout': 0.27721417055855346}. Best is trial 0 with value: 0.09809122234582901.
  0%|          | 0/50 [04:22<?, ?it/s]Best trial: 0. Best value: 0.0980912:   0%|          | 0/50 [04:22<?, ?it/s]Best trial: 0. Best value: 0.0980912:   2%|▏         | 1/50 [04:22<3:34:17, 262.41s/it]
============================================================
Trial 1
============================================================
seq_len: 96, pred_len: 14
d_model: 64, n_heads: 4
e_layers: 2, d_layers: 1
batch_size: 16, lr: 0.000025
dropout: 0.08923359703380244
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_1 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 14
============================================================
train 4564
val 246
test 248
Validation loss decreased (inf --> 0.039132).  Saving model ...
Updating learning rate to 2.493283086512085e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2466415432560425e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.233207716280212e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.116603858140106e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.558301929070053e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.791509645350265e-07
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.895754822675133e-07
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.9478774113375664e-07
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.739387056687832e-08
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.869693528343916e-08
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.434846764171958e-08
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.217423382085979e-08
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.087116910429895e-09
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.0435584552149475e-09
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.5217792276074737e-09
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.608896138037369e-10
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.8044480690186843e-10
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.9022240345093422e-10
EarlyStopping counter: 18 out of 100
Updating learning rate to 9.511120172546711e-11
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.7555600862733554e-11
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.3777800431366777e-11
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.1888900215683389e-11
EarlyStopping counter: 22 out of 100
Updating learning rate to 5.944450107841694e-12
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.972225053920847e-12
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.4861125269604236e-12
EarlyStopping counter: 25 out of 100
Updating learning rate to 7.430562634802118e-13
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.715281317401059e-13
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.8576406587005295e-13
EarlyStopping counter: 28 out of 100
Updating learning rate to 9.288203293502647e-14
EarlyStopping counter: 29 out of 100
Updating learning rate to 4.6441016467513236e-14
EarlyStopping counter: 30 out of 100
Updating learning rate to 2.3220508233756618e-14
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.1610254116878309e-14
EarlyStopping counter: 32 out of 100
Updating learning rate to 5.8051270584391545e-15
EarlyStopping counter: 33 out of 100
Updating learning rate to 2.9025635292195773e-15
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.4512817646097886e-15
EarlyStopping counter: 35 out of 100
Updating learning rate to 7.256408823048943e-16
EarlyStopping counter: 36 out of 100
Updating learning rate to 3.6282044115244716e-16
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.8141022057622358e-16
EarlyStopping counter: 38 out of 100
Updating learning rate to 9.070511028811179e-17
EarlyStopping counter: 39 out of 100
Updating learning rate to 4.5352555144055895e-17
EarlyStopping counter: 40 out of 100
Updating learning rate to 2.2676277572027947e-17
EarlyStopping counter: 41 out of 100
Updating learning rate to 1.1338138786013974e-17
EarlyStopping counter: 42 out of 100
Updating learning rate to 5.669069393006987e-18
EarlyStopping counter: 43 out of 100
Updating learning rate to 2.8345346965034934e-18
EarlyStopping counter: 44 out of 100
Updating learning rate to 1.4172673482517467e-18
EarlyStopping counter: 45 out of 100
Updating learning rate to 7.086336741258734e-19
EarlyStopping counter: 46 out of 100
Updating learning rate to 3.543168370629367e-19
EarlyStopping counter: 47 out of 100
Updating learning rate to 1.7715841853146834e-19
EarlyStopping counter: 48 out of 100
Updating learning rate to 8.857920926573417e-20
EarlyStopping counter: 49 out of 100
Updating learning rate to 4.4289604632867085e-20
EarlyStopping counter: 50 out of 100
Updating learning rate to 2.2144802316433542e-20
EarlyStopping counter: 51 out of 100
Updating learning rate to 1.1072401158216771e-20
EarlyStopping counter: 52 out of 100
Updating learning rate to 5.5362005791083856e-21
EarlyStopping counter: 53 out of 100
Updating learning rate to 2.7681002895541928e-21
EarlyStopping counter: 54 out of 100
Updating learning rate to 1.3840501447770964e-21
EarlyStopping counter: 55 out of 100
Updating learning rate to 6.920250723885482e-22
EarlyStopping counter: 56 out of 100
Updating learning rate to 3.460125361942741e-22
EarlyStopping counter: 57 out of 100
Updating learning rate to 1.7300626809713705e-22
EarlyStopping counter: 58 out of 100
Updating learning rate to 8.650313404856853e-23
EarlyStopping counter: 59 out of 100
Updating learning rate to 4.325156702428426e-23
EarlyStopping counter: 60 out of 100
Updating learning rate to 2.162578351214213e-23
EarlyStopping counter: 61 out of 100
Updating learning rate to 1.0812891756071066e-23
EarlyStopping counter: 62 out of 100
Updating learning rate to 5.406445878035533e-24
EarlyStopping counter: 63 out of 100
Updating learning rate to 2.7032229390177664e-24
EarlyStopping counter: 64 out of 100
Updating learning rate to 1.3516114695088832e-24
EarlyStopping counter: 65 out of 100
Updating learning rate to 6.758057347544416e-25
EarlyStopping counter: 66 out of 100
Updating learning rate to 3.379028673772208e-25
EarlyStopping counter: 67 out of 100
Updating learning rate to 1.689514336886104e-25
EarlyStopping counter: 68 out of 100
Updating learning rate to 8.44757168443052e-26
EarlyStopping counter: 69 out of 100
Updating learning rate to 4.22378584221526e-26
EarlyStopping counter: 70 out of 100
Updating learning rate to 2.11189292110763e-26
EarlyStopping counter: 71 out of 100
Updating learning rate to 1.055946460553815e-26
EarlyStopping counter: 72 out of 100
Updating learning rate to 5.279732302769075e-27
EarlyStopping counter: 73 out of 100
Updating learning rate to 2.6398661513845375e-27
EarlyStopping counter: 74 out of 100
Updating learning rate to 1.3199330756922688e-27
EarlyStopping counter: 75 out of 100
Updating learning rate to 6.599665378461344e-28
EarlyStopping counter: 76 out of 100
Updating learning rate to 3.299832689230672e-28
EarlyStopping counter: 77 out of 100
Updating learning rate to 1.649916344615336e-28
EarlyStopping counter: 78 out of 100
Updating learning rate to 8.24958172307668e-29
EarlyStopping counter: 79 out of 100
Updating learning rate to 4.12479086153834e-29
EarlyStopping counter: 80 out of 100
Updating learning rate to 2.06239543076917e-29
EarlyStopping counter: 81 out of 100
Updating learning rate to 1.031197715384585e-29
EarlyStopping counter: 82 out of 100
Updating learning rate to 5.155988576922925e-30
EarlyStopping counter: 83 out of 100
Updating learning rate to 2.5779942884614624e-30
EarlyStopping counter: 84 out of 100
Updating learning rate to 1.2889971442307312e-30
EarlyStopping counter: 85 out of 100
Updating learning rate to 6.444985721153656e-31
EarlyStopping counter: 86 out of 100
Updating learning rate to 3.222492860576828e-31
EarlyStopping counter: 87 out of 100
Updating learning rate to 1.611246430288414e-31
EarlyStopping counter: 88 out of 100
Updating learning rate to 8.05623215144207e-32
EarlyStopping counter: 89 out of 100
Updating learning rate to 4.028116075721035e-32
EarlyStopping counter: 90 out of 100
Updating learning rate to 2.0140580378605175e-32
EarlyStopping counter: 91 out of 100
Updating learning rate to 1.0070290189302588e-32
EarlyStopping counter: 92 out of 100
Updating learning rate to 5.035145094651294e-33
EarlyStopping counter: 93 out of 100
Updating learning rate to 2.517572547325647e-33
EarlyStopping counter: 94 out of 100
Updating learning rate to 1.2587862736628234e-33
EarlyStopping counter: 95 out of 100
Updating learning rate to 6.293931368314117e-34
EarlyStopping counter: 96 out of 100
Updating learning rate to 3.1469656841570586e-34
EarlyStopping counter: 97 out of 100
Updating learning rate to 1.5734828420785293e-34
EarlyStopping counter: 98 out of 100
Updating learning rate to 7.867414210392647e-35
EarlyStopping counter: 99 out of 100
Updating learning rate to 3.933707105196323e-35
>>>>>> Testing on validation set: trial_1 >>>>>>
test 248
test shape: (248, 14, 5) (248, 14, 5)
test shape: (248, 14, 5) (248, 14, 5)


	mse:0.06727544963359833, mae:0.11559996008872986, dtw:Not calculated


                                                                                       [I 2025-10-17 00:01:47,368] Trial 1 finished with value: 0.11559996008872986 and parameters: {'seq_len': 96, 'pred_len': 14, 'expand': 1, 'd_model': 64, 'n_heads': 4, 'e_layers': 2, 'd_layers': 1, 'batch_size': 16, 'learning_rate': 2.493283086512085e-05, 'dropout': 0.08923359703380244}. Best is trial 0 with value: 0.09809122234582901.
Best trial: 0. Best value: 0.0980912:   2%|▏         | 1/50 [08:40<3:34:17, 262.41s/it]Best trial: 0. Best value: 0.0980912:   2%|▏         | 1/50 [08:41<3:34:17, 262.41s/it]Best trial: 0. Best value: 0.0980912:   4%|▍         | 2/50 [08:41<3:28:08, 260.18s/it]
============================================================
Trial 2
============================================================
seq_len: 96, pred_len: 1
d_model: 32, n_heads: 4
e_layers: 2, d_layers: 2
batch_size: 16, lr: 0.000051
dropout: 0.2953880958879255
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 64, expand: 2
>>>>>> Start training: trial_2 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 1
============================================================
train 4577
val 259
test 261
Validation loss decreased (inf --> 0.033724).  Saving model ...
Updating learning rate to 5.136050530232827e-05
Validation loss decreased (0.033724 --> 0.032179).  Saving model ...
Updating learning rate to 2.5680252651164135e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2840126325582067e-05
Validation loss decreased (0.032179 --> 0.031359).  Saving model ...
Updating learning rate to 6.420063162791034e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.210031581395517e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6050157906977584e-06
Validation loss decreased (0.031359 --> 0.031242).  Saving model ...
Updating learning rate to 8.025078953488792e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.012539476744396e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.006269738372198e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.003134869186099e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.015674345930495e-08
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.5078371729652475e-08
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.2539185864826238e-08
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.269592932413119e-09
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.1347964662065594e-09
Validation loss decreased (0.031242 --> 0.031155).  Saving model ...
Updating learning rate to 1.5673982331032797e-09
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.836991165516398e-10
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.918495582758199e-10
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.9592477913790996e-10
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.796238956895498e-11
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.898119478447749e-11
Validation loss decreased (0.031155 --> 0.030915).  Saving model ...
Updating learning rate to 2.4490597392238745e-11
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2245298696119373e-11
Validation loss decreased (0.030915 --> 0.030843).  Saving model ...
Updating learning rate to 6.122649348059686e-12
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.061324674029843e-12
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5306623370149216e-12
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.653311685074608e-13
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.826655842537304e-13
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.913327921268652e-13
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.56663960634326e-14
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.78331980317163e-14
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.391659901585815e-14
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.1958299507929075e-14
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.9791497539645374e-15
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.9895748769822687e-15
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.4947874384911344e-15
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.473937192455672e-16
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.736968596227836e-16
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.868484298113918e-16
EarlyStopping counter: 16 out of 100
Updating learning rate to 9.34242149056959e-17
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.671210745284795e-17
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.3356053726423974e-17
Validation loss decreased (0.030843 --> 0.030777).  Saving model ...
Updating learning rate to 1.1678026863211987e-17
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8390134316059936e-18
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.9195067158029968e-18
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4597533579014984e-18
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.298766789507492e-19
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.649383394753746e-19
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.824691697376873e-19
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.123458486884365e-20
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.5617292434421825e-20
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.2808646217210912e-20
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.1404323108605456e-20
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.702161554302728e-21
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.851080777151364e-21
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.425540388575682e-21
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.12770194287841e-22
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.563850971439205e-22
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.7819254857196025e-22
EarlyStopping counter: 17 out of 100
Updating learning rate to 8.909627428598013e-23
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.4548137142990063e-23
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.2274068571495032e-23
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.1137034285747516e-23
EarlyStopping counter: 21 out of 100
Updating learning rate to 5.568517142873758e-24
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.784258571436879e-24
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.3921292857184395e-24
EarlyStopping counter: 24 out of 100
Updating learning rate to 6.960646428592197e-25
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.4803232142960987e-25
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.7401616071480493e-25
EarlyStopping counter: 27 out of 100
Updating learning rate to 8.700808035740247e-26
EarlyStopping counter: 28 out of 100
Updating learning rate to 4.3504040178701234e-26
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.1752020089350617e-26
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.0876010044675308e-26
EarlyStopping counter: 31 out of 100
Updating learning rate to 5.438005022337654e-27
EarlyStopping counter: 32 out of 100
Updating learning rate to 2.719002511168827e-27
Validation loss decreased (0.030777 --> 0.030728).  Saving model ...
Updating learning rate to 1.3595012555844136e-27
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.797506277922068e-28
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.398753138961034e-28
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.699376569480517e-28
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.496882847402585e-29
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.2484414237012923e-29
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.1242207118506462e-29
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.0621103559253231e-29
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.3105517796266154e-30
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.6552758898133077e-30
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.3276379449066539e-30
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.638189724533269e-31
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.3190948622666346e-31
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.6595474311333173e-31
EarlyStopping counter: 14 out of 100
Updating learning rate to 8.297737155666587e-32
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.1488685778332933e-32
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.0744342889166467e-32
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.0372171444583233e-32
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.1860857222916166e-33
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.5930428611458083e-33
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.2965214305729042e-33
EarlyStopping counter: 21 out of 100
Updating learning rate to 6.482607152864521e-34
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.2413035764322604e-34
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.6206517882161302e-34
EarlyStopping counter: 24 out of 100
Updating learning rate to 8.103258941080651e-35
>>>>>> Testing on validation set: trial_2 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.06103142723441124, mae:0.10489612072706223, dtw:Not calculated


                                                                                       [I 2025-10-17 00:06:07,506] Trial 2 finished with value: 0.10489612072706223 and parameters: {'seq_len': 96, 'pred_len': 1, 'expand': 2, 'd_model': 32, 'n_heads': 4, 'e_layers': 2, 'd_layers': 2, 'batch_size': 16, 'learning_rate': 5.136050530232827e-05, 'dropout': 0.2953880958879255}. Best is trial 0 with value: 0.09809122234582901.
Best trial: 0. Best value: 0.0980912:   4%|▍         | 2/50 [13:01<3:28:08, 260.18s/it]Best trial: 0. Best value: 0.0980912:   4%|▍         | 2/50 [13:01<3:28:08, 260.18s/it]Best trial: 0. Best value: 0.0980912:   6%|▌         | 3/50 [13:01<3:23:47, 260.16s/it]
============================================================
Trial 3
============================================================
seq_len: 48, pred_len: 30
d_model: 64, n_heads: 4
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000546
dropout: 0.2453240774876695
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_3 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 30
============================================================
train 4596
val 230
test 232
Validation loss decreased (inf --> 0.036413).  Saving model ...
Updating learning rate to 0.000545734822529965
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0002728674112649825
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.00013643370563249125
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.821685281624563e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.410842640812281e-05
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.7054213204061407e-05
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.527106602030703e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.263553301015352e-06
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.131776650507676e-06
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.065888325253838e-06
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.32944162626919e-07
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.664720813134595e-07
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.3323604065672974e-07
EarlyStopping counter: 13 out of 100
Updating learning rate to 6.661802032836487e-08
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.3309010164182435e-08
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.6654505082091217e-08
EarlyStopping counter: 16 out of 100
Updating learning rate to 8.327252541045609e-09
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.163626270522804e-09
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.081813135261402e-09
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.040906567630701e-09
EarlyStopping counter: 20 out of 100
Updating learning rate to 5.204532838153505e-10
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.6022664190767527e-10
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.3011332095383764e-10
EarlyStopping counter: 23 out of 100
Updating learning rate to 6.505666047691882e-11
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.252833023845941e-11
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.6264165119229705e-11
EarlyStopping counter: 26 out of 100
Updating learning rate to 8.132082559614852e-12
EarlyStopping counter: 27 out of 100
Updating learning rate to 4.066041279807426e-12
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.033020639903713e-12
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.0165103199518565e-12
EarlyStopping counter: 30 out of 100
Updating learning rate to 5.082551599759283e-13
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.5412757998796413e-13
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.2706378999398207e-13
EarlyStopping counter: 33 out of 100
Updating learning rate to 6.353189499699103e-14
EarlyStopping counter: 34 out of 100
Updating learning rate to 3.1765947498495517e-14
Validation loss decreased (0.036413 --> 0.036043).  Saving model ...
Updating learning rate to 1.5882973749247758e-14
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.941486874623879e-15
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.9707434373119396e-15
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.9853717186559698e-15
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.926858593279849e-16
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.963429296639924e-16
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.481714648319962e-16
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.240857324159981e-16
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.204286620799906e-17
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.102143310399953e-17
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.5510716551999764e-17
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.755358275999882e-18
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.877679137999941e-18
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.9388395689999705e-18
EarlyStopping counter: 14 out of 100
Updating learning rate to 9.694197844999853e-19
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.847098922499926e-19
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.423549461249963e-19
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.2117747306249816e-19
EarlyStopping counter: 18 out of 100
Updating learning rate to 6.058873653124908e-20
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.029436826562454e-20
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.514718413281227e-20
EarlyStopping counter: 21 out of 100
Updating learning rate to 7.573592066406135e-21
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.7867960332030674e-21
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.8933980166015337e-21
EarlyStopping counter: 24 out of 100
Updating learning rate to 9.466990083007668e-22
EarlyStopping counter: 25 out of 100
Updating learning rate to 4.733495041503834e-22
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.366747520751917e-22
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.1833737603759586e-22
EarlyStopping counter: 28 out of 100
Updating learning rate to 5.916868801879793e-23
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.9584344009398964e-23
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.4792172004699482e-23
EarlyStopping counter: 31 out of 100
Updating learning rate to 7.396086002349741e-24
EarlyStopping counter: 32 out of 100
Updating learning rate to 3.6980430011748705e-24
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.8490215005874352e-24
EarlyStopping counter: 34 out of 100
Updating learning rate to 9.245107502937176e-25
EarlyStopping counter: 35 out of 100
Updating learning rate to 4.622553751468588e-25
EarlyStopping counter: 36 out of 100
Updating learning rate to 2.311276875734294e-25
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.155638437867147e-25
EarlyStopping counter: 38 out of 100
Updating learning rate to 5.778192189335735e-26
EarlyStopping counter: 39 out of 100
Updating learning rate to 2.8890960946678676e-26
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.4445480473339338e-26
EarlyStopping counter: 41 out of 100
Updating learning rate to 7.222740236669669e-27
EarlyStopping counter: 42 out of 100
Updating learning rate to 3.6113701183348345e-27
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.8056850591674172e-27
EarlyStopping counter: 44 out of 100
Updating learning rate to 9.028425295837086e-28
EarlyStopping counter: 45 out of 100
Updating learning rate to 4.514212647918543e-28
EarlyStopping counter: 46 out of 100
Updating learning rate to 2.2571063239592715e-28
EarlyStopping counter: 47 out of 100
Updating learning rate to 1.1285531619796358e-28
EarlyStopping counter: 48 out of 100
Updating learning rate to 5.642765809898179e-29
EarlyStopping counter: 49 out of 100
Updating learning rate to 2.8213829049490894e-29
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.4106914524745447e-29
EarlyStopping counter: 51 out of 100
Updating learning rate to 7.053457262372724e-30
EarlyStopping counter: 52 out of 100
Updating learning rate to 3.526728631186362e-30
EarlyStopping counter: 53 out of 100
Updating learning rate to 1.763364315593181e-30
EarlyStopping counter: 54 out of 100
Updating learning rate to 8.816821577965904e-31
EarlyStopping counter: 55 out of 100
Updating learning rate to 4.408410788982952e-31
EarlyStopping counter: 56 out of 100
Updating learning rate to 2.204205394491476e-31
EarlyStopping counter: 57 out of 100
Updating learning rate to 1.102102697245738e-31
EarlyStopping counter: 58 out of 100
Updating learning rate to 5.51051348622869e-32
EarlyStopping counter: 59 out of 100
Updating learning rate to 2.755256743114345e-32
EarlyStopping counter: 60 out of 100
Updating learning rate to 1.3776283715571726e-32
EarlyStopping counter: 61 out of 100
Updating learning rate to 6.888141857785863e-33
EarlyStopping counter: 62 out of 100
Updating learning rate to 3.4440709288929314e-33
EarlyStopping counter: 63 out of 100
Updating learning rate to 1.7220354644464657e-33
EarlyStopping counter: 64 out of 100
Updating learning rate to 8.610177322232329e-34
>>>>>> Testing on validation set: trial_3 >>>>>>
test 232
test shape: (232, 30, 5) (232, 30, 5)
test shape: (232, 30, 5) (232, 30, 5)


	mse:0.07138483971357346, mae:0.10876404494047165, dtw:Not calculated


                                                                                       [I 2025-10-17 00:08:20,989] Trial 3 finished with value: 0.10876404494047165 and parameters: {'seq_len': 48, 'pred_len': 30, 'expand': 2, 'd_model': 64, 'n_heads': 4, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.000545734822529965, 'dropout': 0.2453240774876695}. Best is trial 0 with value: 0.09809122234582901.
Best trial: 0. Best value: 0.0980912:   6%|▌         | 3/50 [15:14<3:23:47, 260.16s/it]Best trial: 0. Best value: 0.0980912:   6%|▌         | 3/50 [15:14<3:23:47, 260.16s/it]Best trial: 0. Best value: 0.0980912:   8%|▊         | 4/50 [15:14<2:41:06, 210.15s/it]
============================================================
Trial 4
============================================================
seq_len: 48, pred_len: 7
d_model: 64, n_heads: 4
e_layers: 1, d_layers: 1
batch_size: 32, lr: 0.000183
dropout: 0.011414604974174057
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_4 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 7
============================================================
train 4619
val 253
test 255
Validation loss decreased (inf --> 0.037433).  Saving model ...
Updating learning rate to 0.00018289992916958783
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.144996458479391e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.572498229239696e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.286249114619848e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.143124557309924e-05
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.71562278654962e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.85781139327481e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.428905696637405e-06
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.144528483187024e-07
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.572264241593512e-07
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.786132120796756e-07
EarlyStopping counter: 11 out of 100
Updating learning rate to 8.93066060398378e-08
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.46533030199189e-08
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.232665150995945e-08
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.1163325754979726e-08
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.581662877489863e-09
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.7908314387449314e-09
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.3954157193724657e-09
EarlyStopping counter: 18 out of 100
Updating learning rate to 6.977078596862329e-10
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.4885392984311643e-10
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.7442696492155822e-10
EarlyStopping counter: 21 out of 100
Updating learning rate to 8.721348246077911e-11
EarlyStopping counter: 22 out of 100
Updating learning rate to 4.3606741230389554e-11
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.1803370615194777e-11
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.0901685307597388e-11
EarlyStopping counter: 25 out of 100
Updating learning rate to 5.450842653798694e-12
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.725421326899347e-12
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.3627106634496736e-12
EarlyStopping counter: 28 out of 100
Updating learning rate to 6.813553317248368e-13
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.406776658624184e-13
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.703388329312092e-13
EarlyStopping counter: 31 out of 100
Updating learning rate to 8.51694164656046e-14
EarlyStopping counter: 32 out of 100
Updating learning rate to 4.25847082328023e-14
EarlyStopping counter: 33 out of 100
Updating learning rate to 2.129235411640115e-14
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.0646177058200575e-14
EarlyStopping counter: 35 out of 100
Updating learning rate to 5.323088529100287e-15
EarlyStopping counter: 36 out of 100
Updating learning rate to 2.6615442645501437e-15
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.3307721322750718e-15
EarlyStopping counter: 38 out of 100
Updating learning rate to 6.653860661375359e-16
EarlyStopping counter: 39 out of 100
Updating learning rate to 3.3269303306876796e-16
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.6634651653438398e-16
EarlyStopping counter: 41 out of 100
Updating learning rate to 8.317325826719199e-17
EarlyStopping counter: 42 out of 100
Updating learning rate to 4.1586629133595995e-17
EarlyStopping counter: 43 out of 100
Updating learning rate to 2.0793314566797997e-17
EarlyStopping counter: 44 out of 100
Updating learning rate to 1.0396657283398999e-17
EarlyStopping counter: 45 out of 100
Updating learning rate to 5.198328641699499e-18
EarlyStopping counter: 46 out of 100
Updating learning rate to 2.5991643208497497e-18
EarlyStopping counter: 47 out of 100
Updating learning rate to 1.2995821604248748e-18
EarlyStopping counter: 48 out of 100
Updating learning rate to 6.497910802124374e-19
EarlyStopping counter: 49 out of 100
Updating learning rate to 3.248955401062187e-19
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.6244777005310935e-19
EarlyStopping counter: 51 out of 100
Updating learning rate to 8.122388502655468e-20
EarlyStopping counter: 52 out of 100
Updating learning rate to 4.061194251327734e-20
EarlyStopping counter: 53 out of 100
Updating learning rate to 2.030597125663867e-20
EarlyStopping counter: 54 out of 100
Updating learning rate to 1.0152985628319335e-20
EarlyStopping counter: 55 out of 100
Updating learning rate to 5.076492814159667e-21
EarlyStopping counter: 56 out of 100
Updating learning rate to 2.5382464070798337e-21
EarlyStopping counter: 57 out of 100
Updating learning rate to 1.2691232035399168e-21
EarlyStopping counter: 58 out of 100
Updating learning rate to 6.345616017699584e-22
EarlyStopping counter: 59 out of 100
Updating learning rate to 3.172808008849792e-22
EarlyStopping counter: 60 out of 100
Updating learning rate to 1.586404004424896e-22
EarlyStopping counter: 61 out of 100
Updating learning rate to 7.93202002212448e-23
EarlyStopping counter: 62 out of 100
Updating learning rate to 3.96601001106224e-23
EarlyStopping counter: 63 out of 100
Updating learning rate to 1.98300500553112e-23
EarlyStopping counter: 64 out of 100
Updating learning rate to 9.9150250276556e-24
EarlyStopping counter: 65 out of 100
Updating learning rate to 4.9575125138278e-24
EarlyStopping counter: 66 out of 100
Updating learning rate to 2.4787562569139e-24
EarlyStopping counter: 67 out of 100
Updating learning rate to 1.23937812845695e-24
EarlyStopping counter: 68 out of 100
Updating learning rate to 6.19689064228475e-25
EarlyStopping counter: 69 out of 100
Updating learning rate to 3.098445321142375e-25
EarlyStopping counter: 70 out of 100
Updating learning rate to 1.5492226605711875e-25
EarlyStopping counter: 71 out of 100
Updating learning rate to 7.746113302855938e-26
EarlyStopping counter: 72 out of 100
Updating learning rate to 3.873056651427969e-26
EarlyStopping counter: 73 out of 100
Updating learning rate to 1.9365283257139844e-26
EarlyStopping counter: 74 out of 100
Updating learning rate to 9.682641628569922e-27
EarlyStopping counter: 75 out of 100
Updating learning rate to 4.841320814284961e-27
EarlyStopping counter: 76 out of 100
Updating learning rate to 2.4206604071424805e-27
EarlyStopping counter: 77 out of 100
Updating learning rate to 1.2103302035712403e-27
EarlyStopping counter: 78 out of 100
Updating learning rate to 6.051651017856201e-28
EarlyStopping counter: 79 out of 100
Updating learning rate to 3.0258255089281007e-28
EarlyStopping counter: 80 out of 100
Updating learning rate to 1.5129127544640503e-28
EarlyStopping counter: 81 out of 100
Updating learning rate to 7.564563772320252e-29
EarlyStopping counter: 82 out of 100
Updating learning rate to 3.782281886160126e-29
EarlyStopping counter: 83 out of 100
Updating learning rate to 1.891140943080063e-29
EarlyStopping counter: 84 out of 100
Updating learning rate to 9.455704715400315e-30
EarlyStopping counter: 85 out of 100
Updating learning rate to 4.727852357700157e-30
EarlyStopping counter: 86 out of 100
Updating learning rate to 2.3639261788500786e-30
EarlyStopping counter: 87 out of 100
Updating learning rate to 1.1819630894250393e-30
EarlyStopping counter: 88 out of 100
Updating learning rate to 5.909815447125197e-31
EarlyStopping counter: 89 out of 100
Updating learning rate to 2.9549077235625983e-31
EarlyStopping counter: 90 out of 100
Updating learning rate to 1.4774538617812992e-31
EarlyStopping counter: 91 out of 100
Updating learning rate to 7.387269308906496e-32
EarlyStopping counter: 92 out of 100
Updating learning rate to 3.693634654453248e-32
EarlyStopping counter: 93 out of 100
Updating learning rate to 1.846817327226624e-32
EarlyStopping counter: 94 out of 100
Updating learning rate to 9.23408663613312e-33
EarlyStopping counter: 95 out of 100
Updating learning rate to 4.61704331806656e-33
EarlyStopping counter: 96 out of 100
Updating learning rate to 2.30852165903328e-33
EarlyStopping counter: 97 out of 100
Updating learning rate to 1.15426082951664e-33
EarlyStopping counter: 98 out of 100
Updating learning rate to 5.7713041475832e-34
EarlyStopping counter: 99 out of 100
Updating learning rate to 2.8856520737916e-34
>>>>>> Testing on validation set: trial_4 >>>>>>
test 255
test shape: (255, 7, 5) (255, 7, 5)
test shape: (255, 7, 5) (255, 7, 5)


	mse:0.06696125864982605, mae:0.09735160320997238, dtw:Not calculated


                                                                                       [I 2025-10-17 00:10:33,624] Trial 4 finished with value: 0.09735160320997238 and parameters: {'seq_len': 48, 'pred_len': 7, 'expand': 1, 'd_model': 64, 'n_heads': 4, 'e_layers': 1, 'd_layers': 1, 'batch_size': 32, 'learning_rate': 0.00018289992916958783, 'dropout': 0.011414604974174057}. Best is trial 4 with value: 0.09735160320997238.
Best trial: 0. Best value: 0.0980912:   8%|▊         | 4/50 [17:27<2:41:06, 210.15s/it]Best trial: 4. Best value: 0.0973516:   8%|▊         | 4/50 [17:27<2:41:06, 210.15s/it]Best trial: 4. Best value: 0.0973516:  10%|█         | 5/50 [17:27<2:16:38, 182.20s/it]
============================================================
Trial 5
============================================================
seq_len: 48, pred_len: 7
d_model: 64, n_heads: 4
e_layers: 1, d_layers: 1
batch_size: 16, lr: 0.000799
dropout: 0.13231121997186554
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_5 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 7
============================================================
train 4619
val 253
test 255
Validation loss decreased (inf --> 0.036806).  Saving model ...
Updating learning rate to 0.0007987712561076752
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0003993856280538376
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.0001996928140269188
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.98464070134594e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.99232035067297e-05
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.496160175336485e-05
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.2480800876682425e-05
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.2404004383412125e-06
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.1202002191706063e-06
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.5601001095853031e-06
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.800500547926516e-07
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.900250273963258e-07
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.950125136981629e-07
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.750625684908145e-08
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.875312842454072e-08
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.437656421227036e-08
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.218828210613518e-08
EarlyStopping counter: 17 out of 100
Updating learning rate to 6.09414105306759e-09
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.047070526533795e-09
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.5235352632668976e-09
EarlyStopping counter: 20 out of 100
Updating learning rate to 7.617676316334488e-10
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.808838158167244e-10
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.904419079083622e-10
EarlyStopping counter: 23 out of 100
Updating learning rate to 9.52209539541811e-11
EarlyStopping counter: 24 out of 100
Updating learning rate to 4.761047697709055e-11
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.3805238488545275e-11
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.1902619244272637e-11
EarlyStopping counter: 27 out of 100
Updating learning rate to 5.951309622136319e-12
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.9756548110681593e-12
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.4878274055340797e-12
EarlyStopping counter: 30 out of 100
Updating learning rate to 7.439137027670398e-13
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.719568513835199e-13
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.8597842569175996e-13
EarlyStopping counter: 33 out of 100
Updating learning rate to 9.298921284587998e-14
EarlyStopping counter: 34 out of 100
Updating learning rate to 4.649460642293999e-14
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.3247303211469995e-14
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.1623651605734997e-14
EarlyStopping counter: 37 out of 100
Updating learning rate to 5.811825802867499e-15
EarlyStopping counter: 38 out of 100
Updating learning rate to 2.9059129014337494e-15
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.4529564507168747e-15
EarlyStopping counter: 40 out of 100
Updating learning rate to 7.264782253584373e-16
EarlyStopping counter: 41 out of 100
Updating learning rate to 3.6323911267921867e-16
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.8161955633960934e-16
EarlyStopping counter: 43 out of 100
Updating learning rate to 9.080977816980467e-17
EarlyStopping counter: 44 out of 100
Updating learning rate to 4.5404889084902334e-17
EarlyStopping counter: 45 out of 100
Updating learning rate to 2.2702444542451167e-17
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.1351222271225583e-17
EarlyStopping counter: 47 out of 100
Updating learning rate to 5.675611135612792e-18
EarlyStopping counter: 48 out of 100
Updating learning rate to 2.837805567806396e-18
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.418902783903198e-18
EarlyStopping counter: 50 out of 100
Updating learning rate to 7.09451391951599e-19
EarlyStopping counter: 51 out of 100
Updating learning rate to 3.547256959757995e-19
EarlyStopping counter: 52 out of 100
Updating learning rate to 1.7736284798789974e-19
EarlyStopping counter: 53 out of 100
Updating learning rate to 8.868142399394987e-20
EarlyStopping counter: 54 out of 100
Updating learning rate to 4.4340711996974935e-20
EarlyStopping counter: 55 out of 100
Updating learning rate to 2.2170355998487468e-20
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.1085177999243734e-20
EarlyStopping counter: 57 out of 100
Updating learning rate to 5.542588999621867e-21
EarlyStopping counter: 58 out of 100
Updating learning rate to 2.7712944998109335e-21
EarlyStopping counter: 59 out of 100
Updating learning rate to 1.3856472499054667e-21
EarlyStopping counter: 60 out of 100
Updating learning rate to 6.928236249527334e-22
EarlyStopping counter: 61 out of 100
Updating learning rate to 3.464118124763667e-22
EarlyStopping counter: 62 out of 100
Updating learning rate to 1.7320590623818334e-22
EarlyStopping counter: 63 out of 100
Updating learning rate to 8.660295311909167e-23
EarlyStopping counter: 64 out of 100
Updating learning rate to 4.3301476559545835e-23
EarlyStopping counter: 65 out of 100
Updating learning rate to 2.1650738279772918e-23
EarlyStopping counter: 66 out of 100
Updating learning rate to 1.0825369139886459e-23
EarlyStopping counter: 67 out of 100
Updating learning rate to 5.4126845699432294e-24
EarlyStopping counter: 68 out of 100
Updating learning rate to 2.7063422849716147e-24
EarlyStopping counter: 69 out of 100
Updating learning rate to 1.3531711424858074e-24
EarlyStopping counter: 70 out of 100
Updating learning rate to 6.765855712429037e-25
EarlyStopping counter: 71 out of 100
Updating learning rate to 3.3829278562145184e-25
EarlyStopping counter: 72 out of 100
Updating learning rate to 1.6914639281072592e-25
EarlyStopping counter: 73 out of 100
Updating learning rate to 8.457319640536296e-26
EarlyStopping counter: 74 out of 100
Updating learning rate to 4.228659820268148e-26
EarlyStopping counter: 75 out of 100
Updating learning rate to 2.114329910134074e-26
EarlyStopping counter: 76 out of 100
Updating learning rate to 1.057164955067037e-26
EarlyStopping counter: 77 out of 100
Updating learning rate to 5.285824775335185e-27
EarlyStopping counter: 78 out of 100
Updating learning rate to 2.6429123876675925e-27
EarlyStopping counter: 79 out of 100
Updating learning rate to 1.3214561938337962e-27
EarlyStopping counter: 80 out of 100
Updating learning rate to 6.607280969168981e-28
EarlyStopping counter: 81 out of 100
Updating learning rate to 3.3036404845844906e-28
EarlyStopping counter: 82 out of 100
Updating learning rate to 1.6518202422922453e-28
EarlyStopping counter: 83 out of 100
Updating learning rate to 8.259101211461227e-29
EarlyStopping counter: 84 out of 100
Updating learning rate to 4.129550605730613e-29
EarlyStopping counter: 85 out of 100
Updating learning rate to 2.0647753028653066e-29
EarlyStopping counter: 86 out of 100
Updating learning rate to 1.0323876514326533e-29
EarlyStopping counter: 87 out of 100
Updating learning rate to 5.1619382571632666e-30
EarlyStopping counter: 88 out of 100
Updating learning rate to 2.5809691285816333e-30
EarlyStopping counter: 89 out of 100
Updating learning rate to 1.2904845642908166e-30
EarlyStopping counter: 90 out of 100
Updating learning rate to 6.452422821454083e-31
EarlyStopping counter: 91 out of 100
Updating learning rate to 3.2262114107270416e-31
EarlyStopping counter: 92 out of 100
Updating learning rate to 1.6131057053635208e-31
EarlyStopping counter: 93 out of 100
Updating learning rate to 8.065528526817604e-32
EarlyStopping counter: 94 out of 100
Updating learning rate to 4.032764263408802e-32
EarlyStopping counter: 95 out of 100
Updating learning rate to 2.016382131704401e-32
EarlyStopping counter: 96 out of 100
Updating learning rate to 1.0081910658522005e-32
EarlyStopping counter: 97 out of 100
Updating learning rate to 5.0409553292610025e-33
EarlyStopping counter: 98 out of 100
Updating learning rate to 2.5204776646305013e-33
EarlyStopping counter: 99 out of 100
Updating learning rate to 1.2602388323152506e-33
>>>>>> Testing on validation set: trial_5 >>>>>>
test 255
test shape: (255, 7, 5) (255, 7, 5)
test shape: (255, 7, 5) (255, 7, 5)


	mse:0.0653345063328743, mae:0.09773793071508408, dtw:Not calculated


                                                                                       [I 2025-10-17 00:14:53,832] Trial 5 finished with value: 0.09773793071508408 and parameters: {'seq_len': 48, 'pred_len': 7, 'expand': 1, 'd_model': 64, 'n_heads': 4, 'e_layers': 1, 'd_layers': 1, 'batch_size': 16, 'learning_rate': 0.0007987712561076752, 'dropout': 0.13231121997186554}. Best is trial 4 with value: 0.09735160320997238.
Best trial: 4. Best value: 0.0973516:  10%|█         | 5/50 [21:47<2:16:38, 182.20s/it]Best trial: 4. Best value: 0.0973516:  10%|█         | 5/50 [21:47<2:16:38, 182.20s/it]Best trial: 4. Best value: 0.0973516:  12%|█▏        | 6/50 [21:47<2:33:03, 208.72s/it]
============================================================
Trial 6
============================================================
seq_len: 48, pred_len: 1
d_model: 32, n_heads: 4
e_layers: 1, d_layers: 1
batch_size: 16, lr: 0.000033
dropout: 0.1971737146047193
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 32, expand: 1
>>>>>> Start training: trial_6 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.033831).  Saving model ...
Updating learning rate to 3.2529848395306725e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6264924197653363e-05
Validation loss decreased (0.033831 --> 0.033593).  Saving model ...
Updating learning rate to 8.132462098826681e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.066231049413341e-06
Validation loss decreased (0.033593 --> 0.032735).  Saving model ...
Updating learning rate to 2.0331155247066703e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0165577623533352e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.082788811766676e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.541394405883338e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.270697202941669e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.353486014708345e-08
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.1767430073541724e-08
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.5883715036770862e-08
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.941857518385431e-09
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.9709287591927155e-09
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.9854643795963577e-09
EarlyStopping counter: 11 out of 100
Updating learning rate to 9.927321897981789e-10
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.963660948990894e-10
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.481830474495447e-10
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.2409152372477236e-10
EarlyStopping counter: 15 out of 100
Updating learning rate to 6.204576186238618e-11
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.102288093119309e-11
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.5511440465596545e-11
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.755720232798272e-12
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.877860116399136e-12
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.938930058199568e-12
EarlyStopping counter: 21 out of 100
Updating learning rate to 9.69465029099784e-13
EarlyStopping counter: 22 out of 100
Updating learning rate to 4.84732514549892e-13
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.42366257274946e-13
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.21183128637473e-13
EarlyStopping counter: 25 out of 100
Updating learning rate to 6.05915643187365e-14
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.029578215936825e-14
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.5147891079684126e-14
EarlyStopping counter: 28 out of 100
Updating learning rate to 7.573945539842063e-15
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.7869727699210315e-15
Validation loss decreased (0.032735 --> 0.032521).  Saving model ...
Updating learning rate to 1.8934863849605157e-15
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.467431924802579e-16
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.733715962401289e-16
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.3668579812006447e-16
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1834289906003223e-16
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.917144953001612e-17
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.958572476500806e-17
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.479286238250403e-17
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.396431191252015e-18
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.698215595626007e-18
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.8491077978130036e-18
EarlyStopping counter: 11 out of 100
Updating learning rate to 9.245538989065018e-19
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.622769494532509e-19
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.3113847472662545e-19
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.1556923736331273e-19
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.778461868165636e-20
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.889230934082818e-20
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.444615467041409e-20
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.223077335207045e-21
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.611538667603523e-21
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.8057693338017614e-21
EarlyStopping counter: 21 out of 100
Updating learning rate to 9.028846669008807e-22
EarlyStopping counter: 22 out of 100
Updating learning rate to 4.514423334504403e-22
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.2572116672522017e-22
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.1286058336261009e-22
EarlyStopping counter: 25 out of 100
Updating learning rate to 5.643029168130504e-23
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.821514584065252e-23
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.410757292032626e-23
EarlyStopping counter: 28 out of 100
Updating learning rate to 7.05378646016313e-24
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.526893230081565e-24
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.7634466150407826e-24
EarlyStopping counter: 31 out of 100
Updating learning rate to 8.817233075203913e-25
EarlyStopping counter: 32 out of 100
Updating learning rate to 4.408616537601956e-25
EarlyStopping counter: 33 out of 100
Updating learning rate to 2.204308268800978e-25
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.102154134400489e-25
EarlyStopping counter: 35 out of 100
Updating learning rate to 5.510770672002446e-26
EarlyStopping counter: 36 out of 100
Updating learning rate to 2.755385336001223e-26
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.3776926680006114e-26
EarlyStopping counter: 38 out of 100
Updating learning rate to 6.888463340003057e-27
EarlyStopping counter: 39 out of 100
Updating learning rate to 3.4442316700015285e-27
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.7221158350007642e-27
EarlyStopping counter: 41 out of 100
Updating learning rate to 8.610579175003821e-28
EarlyStopping counter: 42 out of 100
Updating learning rate to 4.305289587501911e-28
EarlyStopping counter: 43 out of 100
Updating learning rate to 2.1526447937509553e-28
EarlyStopping counter: 44 out of 100
Updating learning rate to 1.0763223968754777e-28
EarlyStopping counter: 45 out of 100
Updating learning rate to 5.381611984377388e-29
EarlyStopping counter: 46 out of 100
Updating learning rate to 2.690805992188694e-29
EarlyStopping counter: 47 out of 100
Updating learning rate to 1.345402996094347e-29
EarlyStopping counter: 48 out of 100
Updating learning rate to 6.727014980471735e-30
EarlyStopping counter: 49 out of 100
Updating learning rate to 3.363507490235868e-30
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.681753745117934e-30
EarlyStopping counter: 51 out of 100
Updating learning rate to 8.40876872558967e-31
EarlyStopping counter: 52 out of 100
Updating learning rate to 4.204384362794835e-31
EarlyStopping counter: 53 out of 100
Updating learning rate to 2.1021921813974173e-31
Validation loss decreased (0.032521 --> 0.032500).  Saving model ...
Updating learning rate to 1.0510960906987086e-31
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.255480453493543e-32
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.6277402267467716e-32
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3138701133733858e-32
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.569350566866929e-33
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.2846752834334645e-33
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423376417167323e-33
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.211688208583661e-34
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.105844104291831e-34
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.0529220521459153e-34
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.0264610260729577e-34
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.132305130364788e-35
>>>>>> Testing on validation set: trial_6 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.059801455587148666, mae:0.09390534460544586, dtw:Not calculated


                                                                                       [I 2025-10-17 00:19:14,685] Trial 6 finished with value: 0.09390534460544586 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 1, 'd_model': 32, 'n_heads': 4, 'e_layers': 1, 'd_layers': 1, 'batch_size': 16, 'learning_rate': 3.2529848395306725e-05, 'dropout': 0.1971737146047193}. Best is trial 6 with value: 0.09390534460544586.
Best trial: 4. Best value: 0.0973516:  12%|█▏        | 6/50 [26:08<2:33:03, 208.72s/it]Best trial: 6. Best value: 0.0939053:  12%|█▏        | 6/50 [26:08<2:33:03, 208.72s/it]Best trial: 6. Best value: 0.0939053:  14%|█▍        | 7/50 [26:08<2:41:47, 225.76s/it]
============================================================
Trial 7
============================================================
seq_len: 96, pred_len: 14
d_model: 64, n_heads: 4
e_layers: 2, d_layers: 1
batch_size: 32, lr: 0.000139
dropout: 0.2899245414673924
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_7 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 14
============================================================
train 4564
val 246
test 248
Validation loss decreased (inf --> 0.039183).  Saving model ...
Updating learning rate to 0.00013945800388625066
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.972900194312533e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4864500971562665e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.7432250485781333e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.716125242890666e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.358062621445333e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.1790313107226666e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.0895156553613333e-06
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.447578276806666e-07
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.723789138403333e-07
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.3618945692016666e-07
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.809472846008333e-08
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.4047364230041665e-08
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.7023682115020833e-08
EarlyStopping counter: 14 out of 100
Updating learning rate to 8.511841057510416e-09
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.255920528755208e-09
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.127960264377604e-09
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.063980132188802e-09
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.31990066094401e-10
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.659950330472005e-10
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.3299751652360026e-10
EarlyStopping counter: 21 out of 100
Updating learning rate to 6.649875826180013e-11
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.3249379130900064e-11
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.6624689565450032e-11
EarlyStopping counter: 24 out of 100
Updating learning rate to 8.312344782725016e-12
EarlyStopping counter: 25 out of 100
Updating learning rate to 4.156172391362508e-12
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.078086195681254e-12
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.039043097840627e-12
EarlyStopping counter: 28 out of 100
Updating learning rate to 5.195215489203135e-13
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.5976077446015675e-13
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.2988038723007837e-13
EarlyStopping counter: 31 out of 100
Updating learning rate to 6.494019361503919e-14
EarlyStopping counter: 32 out of 100
Updating learning rate to 3.2470096807519594e-14
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.6235048403759797e-14
EarlyStopping counter: 34 out of 100
Updating learning rate to 8.117524201879898e-15
EarlyStopping counter: 35 out of 100
Updating learning rate to 4.058762100939949e-15
EarlyStopping counter: 36 out of 100
Updating learning rate to 2.0293810504699746e-15
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.0146905252349873e-15
EarlyStopping counter: 38 out of 100
Updating learning rate to 5.073452626174936e-16
EarlyStopping counter: 39 out of 100
Updating learning rate to 2.536726313087468e-16
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.268363156543734e-16
EarlyStopping counter: 41 out of 100
Updating learning rate to 6.34181578271867e-17
EarlyStopping counter: 42 out of 100
Updating learning rate to 3.170907891359335e-17
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.5854539456796677e-17
EarlyStopping counter: 44 out of 100
Updating learning rate to 7.927269728398338e-18
EarlyStopping counter: 45 out of 100
Updating learning rate to 3.963634864199169e-18
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.9818174320995846e-18
EarlyStopping counter: 47 out of 100
Updating learning rate to 9.909087160497923e-19
EarlyStopping counter: 48 out of 100
Updating learning rate to 4.954543580248961e-19
EarlyStopping counter: 49 out of 100
Updating learning rate to 2.4772717901244807e-19
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.2386358950622404e-19
EarlyStopping counter: 51 out of 100
Updating learning rate to 6.193179475311202e-20
EarlyStopping counter: 52 out of 100
Updating learning rate to 3.096589737655601e-20
EarlyStopping counter: 53 out of 100
Updating learning rate to 1.5482948688278004e-20
EarlyStopping counter: 54 out of 100
Updating learning rate to 7.741474344139002e-21
EarlyStopping counter: 55 out of 100
Updating learning rate to 3.870737172069501e-21
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.9353685860347506e-21
EarlyStopping counter: 57 out of 100
Updating learning rate to 9.676842930173753e-22
EarlyStopping counter: 58 out of 100
Updating learning rate to 4.838421465086876e-22
EarlyStopping counter: 59 out of 100
Updating learning rate to 2.419210732543438e-22
EarlyStopping counter: 60 out of 100
Updating learning rate to 1.209605366271719e-22
EarlyStopping counter: 61 out of 100
Updating learning rate to 6.048026831358595e-23
EarlyStopping counter: 62 out of 100
Updating learning rate to 3.024013415679298e-23
EarlyStopping counter: 63 out of 100
Updating learning rate to 1.512006707839649e-23
EarlyStopping counter: 64 out of 100
Updating learning rate to 7.560033539198244e-24
EarlyStopping counter: 65 out of 100
Updating learning rate to 3.780016769599122e-24
EarlyStopping counter: 66 out of 100
Updating learning rate to 1.890008384799561e-24
EarlyStopping counter: 67 out of 100
Updating learning rate to 9.450041923997805e-25
EarlyStopping counter: 68 out of 100
Updating learning rate to 4.725020961998903e-25
EarlyStopping counter: 69 out of 100
Updating learning rate to 2.3625104809994514e-25
EarlyStopping counter: 70 out of 100
Updating learning rate to 1.1812552404997257e-25
EarlyStopping counter: 71 out of 100
Updating learning rate to 5.906276202498628e-26
EarlyStopping counter: 72 out of 100
Updating learning rate to 2.953138101249314e-26
EarlyStopping counter: 73 out of 100
Updating learning rate to 1.476569050624657e-26
EarlyStopping counter: 74 out of 100
Updating learning rate to 7.382845253123285e-27
EarlyStopping counter: 75 out of 100
Updating learning rate to 3.691422626561643e-27
EarlyStopping counter: 76 out of 100
Updating learning rate to 1.8457113132808214e-27
EarlyStopping counter: 77 out of 100
Updating learning rate to 9.228556566404107e-28
EarlyStopping counter: 78 out of 100
Updating learning rate to 4.614278283202053e-28
EarlyStopping counter: 79 out of 100
Updating learning rate to 2.3071391416010267e-28
EarlyStopping counter: 80 out of 100
Updating learning rate to 1.1535695708005134e-28
EarlyStopping counter: 81 out of 100
Updating learning rate to 5.767847854002567e-29
EarlyStopping counter: 82 out of 100
Updating learning rate to 2.8839239270012834e-29
EarlyStopping counter: 83 out of 100
Updating learning rate to 1.4419619635006417e-29
EarlyStopping counter: 84 out of 100
Updating learning rate to 7.209809817503208e-30
EarlyStopping counter: 85 out of 100
Updating learning rate to 3.604904908751604e-30
EarlyStopping counter: 86 out of 100
Updating learning rate to 1.802452454375802e-30
EarlyStopping counter: 87 out of 100
Updating learning rate to 9.01226227187901e-31
EarlyStopping counter: 88 out of 100
Updating learning rate to 4.506131135939505e-31
EarlyStopping counter: 89 out of 100
Updating learning rate to 2.2530655679697527e-31
EarlyStopping counter: 90 out of 100
Updating learning rate to 1.1265327839848763e-31
EarlyStopping counter: 91 out of 100
Updating learning rate to 5.632663919924382e-32
EarlyStopping counter: 92 out of 100
Updating learning rate to 2.816331959962191e-32
EarlyStopping counter: 93 out of 100
Updating learning rate to 1.4081659799810954e-32
EarlyStopping counter: 94 out of 100
Updating learning rate to 7.040829899905477e-33
EarlyStopping counter: 95 out of 100
Updating learning rate to 3.5204149499527385e-33
EarlyStopping counter: 96 out of 100
Updating learning rate to 1.7602074749763693e-33
EarlyStopping counter: 97 out of 100
Updating learning rate to 8.801037374881846e-34
EarlyStopping counter: 98 out of 100
Updating learning rate to 4.400518687440923e-34
EarlyStopping counter: 99 out of 100
Updating learning rate to 2.2002593437204616e-34
>>>>>> Testing on validation set: trial_7 >>>>>>
test 248
test shape: (248, 14, 5) (248, 14, 5)
test shape: (248, 14, 5) (248, 14, 5)


	mse:0.06905458122491837, mae:0.11443468183279037, dtw:Not calculated


                                                                                       [I 2025-10-17 00:21:26,370] Trial 7 finished with value: 0.11443468183279037 and parameters: {'seq_len': 96, 'pred_len': 14, 'expand': 1, 'd_model': 64, 'n_heads': 4, 'e_layers': 2, 'd_layers': 1, 'batch_size': 32, 'learning_rate': 0.00013945800388625066, 'dropout': 0.2899245414673924}. Best is trial 6 with value: 0.09390534460544586.
Best trial: 6. Best value: 0.0939053:  14%|█▍        | 7/50 [28:20<2:41:47, 225.76s/it]Best trial: 6. Best value: 0.0939053:  14%|█▍        | 7/50 [28:20<2:41:47, 225.76s/it]Best trial: 6. Best value: 0.0939053:  16%|█▌        | 8/50 [28:20<2:17:04, 195.81s/it]
============================================================
Trial 8
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 2, d_layers: 2
batch_size: 32, lr: 0.000020
dropout: 0.1207206673854884
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_8 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.032205).  Saving model ...
Updating learning rate to 1.963758220724517e-05
Validation loss decreased (0.032205 --> 0.031044).  Saving model ...
Updating learning rate to 9.818791103622586e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.909395551811293e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.4546977759056464e-06
Validation loss decreased (0.031044 --> 0.030417).  Saving model ...
Updating learning rate to 1.2273488879528232e-06
Validation loss decreased (0.030417 --> 0.030218).  Saving model ...
Updating learning rate to 6.136744439764116e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.068372219882058e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.534186109941029e-07
Validation loss decreased (0.030218 --> 0.029553).  Saving model ...
Updating learning rate to 7.670930549705145e-08
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.8354652748525725e-08
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.9177326374262863e-08
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.588663187131431e-09
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.794331593565716e-09
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.397165796782858e-09
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.198582898391429e-09
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.992914491957145e-10
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.9964572459785723e-10
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4982286229892861e-10
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.491143114946431e-11
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.7455715574732154e-11
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.8727857787366077e-11
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.363928893683038e-12
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.681964446841519e-12
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.3409822234207596e-12
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.1704911117103798e-12
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.852455558551899e-13
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.9262277792759495e-13
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.4631138896379747e-13
EarlyStopping counter: 20 out of 100
Updating learning rate to 7.315569448189874e-14
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.657784724094937e-14
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.8288923620474684e-14
EarlyStopping counter: 23 out of 100
Updating learning rate to 9.144461810237342e-15
EarlyStopping counter: 24 out of 100
Updating learning rate to 4.572230905118671e-15
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.2861154525593355e-15
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.1430577262796678e-15
EarlyStopping counter: 27 out of 100
Updating learning rate to 5.715288631398339e-16
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.8576443156991694e-16
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.4288221578495847e-16
EarlyStopping counter: 30 out of 100
Updating learning rate to 7.144110789247924e-17
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.572055394623962e-17
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.786027697311981e-17
EarlyStopping counter: 33 out of 100
Updating learning rate to 8.930138486559904e-18
EarlyStopping counter: 34 out of 100
Updating learning rate to 4.465069243279952e-18
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.232534621639976e-18
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.116267310819988e-18
EarlyStopping counter: 37 out of 100
Updating learning rate to 5.58133655409994e-19
EarlyStopping counter: 38 out of 100
Updating learning rate to 2.79066827704997e-19
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.395334138524985e-19
EarlyStopping counter: 40 out of 100
Updating learning rate to 6.976670692624925e-20
EarlyStopping counter: 41 out of 100
Updating learning rate to 3.4883353463124627e-20
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.7441676731562313e-20
EarlyStopping counter: 43 out of 100
Updating learning rate to 8.720838365781157e-21
EarlyStopping counter: 44 out of 100
Updating learning rate to 4.360419182890578e-21
EarlyStopping counter: 45 out of 100
Updating learning rate to 2.180209591445289e-21
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.0901047957226446e-21
EarlyStopping counter: 47 out of 100
Updating learning rate to 5.450523978613223e-22
EarlyStopping counter: 48 out of 100
Updating learning rate to 2.7252619893066115e-22
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.3626309946533057e-22
EarlyStopping counter: 50 out of 100
Updating learning rate to 6.813154973266529e-23
EarlyStopping counter: 51 out of 100
Updating learning rate to 3.4065774866332643e-23
EarlyStopping counter: 52 out of 100
Updating learning rate to 1.7032887433166322e-23
EarlyStopping counter: 53 out of 100
Updating learning rate to 8.516443716583161e-24
EarlyStopping counter: 54 out of 100
Updating learning rate to 4.2582218582915804e-24
EarlyStopping counter: 55 out of 100
Updating learning rate to 2.1291109291457902e-24
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.0645554645728951e-24
EarlyStopping counter: 57 out of 100
Updating learning rate to 5.3227773228644755e-25
EarlyStopping counter: 58 out of 100
Updating learning rate to 2.6613886614322378e-25
EarlyStopping counter: 59 out of 100
Updating learning rate to 1.3306943307161189e-25
EarlyStopping counter: 60 out of 100
Updating learning rate to 6.653471653580594e-26
EarlyStopping counter: 61 out of 100
Updating learning rate to 3.326735826790297e-26
EarlyStopping counter: 62 out of 100
Updating learning rate to 1.6633679133951486e-26
EarlyStopping counter: 63 out of 100
Updating learning rate to 8.316839566975743e-27
EarlyStopping counter: 64 out of 100
Updating learning rate to 4.1584197834878715e-27
EarlyStopping counter: 65 out of 100
Updating learning rate to 2.0792098917439358e-27
EarlyStopping counter: 66 out of 100
Updating learning rate to 1.0396049458719679e-27
EarlyStopping counter: 67 out of 100
Updating learning rate to 5.198024729359839e-28
EarlyStopping counter: 68 out of 100
Updating learning rate to 2.5990123646799197e-28
EarlyStopping counter: 69 out of 100
Updating learning rate to 1.2995061823399598e-28
EarlyStopping counter: 70 out of 100
Updating learning rate to 6.497530911699799e-29
EarlyStopping counter: 71 out of 100
Updating learning rate to 3.2487654558498996e-29
EarlyStopping counter: 72 out of 100
Updating learning rate to 1.6243827279249498e-29
EarlyStopping counter: 73 out of 100
Updating learning rate to 8.121913639624749e-30
EarlyStopping counter: 74 out of 100
Updating learning rate to 4.0609568198123745e-30
EarlyStopping counter: 75 out of 100
Updating learning rate to 2.0304784099061873e-30
EarlyStopping counter: 76 out of 100
Updating learning rate to 1.0152392049530936e-30
EarlyStopping counter: 77 out of 100
Updating learning rate to 5.076196024765468e-31
EarlyStopping counter: 78 out of 100
Updating learning rate to 2.538098012382734e-31
Validation loss decreased (0.029553 --> 0.029513).  Saving model ...
Updating learning rate to 1.269049006191367e-31
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.345245030956835e-32
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.1726225154784176e-32
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5863112577392088e-32
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.931556288696044e-33
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.965778144348022e-33
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.982889072174011e-33
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.914445360870055e-34
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.9572226804350275e-34
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.4786113402175137e-34
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.2393056701087569e-34
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.196528350543784e-35
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.098264175271892e-35
>>>>>> Testing on validation set: trial_8 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.05853936821222305, mae:0.0927814468741417, dtw:Not calculated


                                                                                       [I 2025-10-17 00:23:40,743] Trial 8 finished with value: 0.0927814468741417 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 2, 'd_model': 64, 'n_heads': 8, 'e_layers': 2, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 1.963758220724517e-05, 'dropout': 0.1207206673854884}. Best is trial 8 with value: 0.0927814468741417.
Best trial: 6. Best value: 0.0939053:  16%|█▌        | 8/50 [30:34<2:17:04, 195.81s/it]Best trial: 8. Best value: 0.0927814:  16%|█▌        | 8/50 [30:34<2:17:04, 195.81s/it]Best trial: 8. Best value: 0.0927814:  18%|█▊        | 9/50 [30:34<2:00:40, 176.61s/it]
============================================================
Trial 9
============================================================
seq_len: 48, pred_len: 30
d_model: 64, n_heads: 8
e_layers: 2, d_layers: 1
batch_size: 64, lr: 0.000011
dropout: 0.16875187104211403
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_9 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 30
============================================================
train 4596
val 230
test 232
Validation loss decreased (inf --> 0.037785).  Saving model ...
Updating learning rate to 1.1445499686124451e-05
Validation loss decreased (0.037785 --> 0.037395).  Saving model ...
Updating learning rate to 5.7227498430622255e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.8613749215311128e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4306874607655564e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.153437303827782e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.576718651913891e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.7883593259569455e-07
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.941796629784727e-08
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.470898314892364e-08
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.235449157446182e-08
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.117724578723091e-08
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.588622893615455e-09
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7943114468077273e-09
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.3971557234038636e-09
EarlyStopping counter: 13 out of 100
Updating learning rate to 6.985778617019318e-10
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.492889308509659e-10
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.7464446542548296e-10
EarlyStopping counter: 16 out of 100
Updating learning rate to 8.732223271274148e-11
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.366111635637074e-11
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.183055817818537e-11
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.0915279089092685e-11
EarlyStopping counter: 20 out of 100
Updating learning rate to 5.457639544546342e-12
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.728819772273171e-12
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.3644098861365856e-12
EarlyStopping counter: 23 out of 100
Updating learning rate to 6.822049430682928e-13
Validation loss decreased (0.037395 --> 0.037341).  Saving model ...
Updating learning rate to 3.411024715341464e-13
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.705512357670732e-13
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.52756178835366e-14
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.26378089417683e-14
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.131890447088415e-14
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0659452235442075e-14
Validation loss decreased (0.037341 --> 0.037333).  Saving model ...
Updating learning rate to 5.3297261177210375e-15
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.6648630588605187e-15
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3324315294302594e-15
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.662157647151297e-16
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.3310788235756484e-16
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6655394117878242e-16
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.327697058939121e-17
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.1638485294695605e-17
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0819242647347803e-17
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.0409621323673901e-17
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.204810661836951e-18
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.6024053309184753e-18
Validation loss decreased (0.037333 --> 0.037304).  Saving model ...
Updating learning rate to 1.3012026654592377e-18
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.506013327296188e-19
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.253006663648094e-19
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.626503331824047e-19
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.132516659120235e-20
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.066258329560118e-20
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.033129164780059e-20
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.0165645823900294e-20
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.082822911950147e-21
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.5414114559750736e-21
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.2707057279875368e-21
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.353528639937684e-22
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.176764319968842e-22
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.588382159984421e-22
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.941910799922105e-23
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.9709553999610524e-23
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.9854776999805262e-23
EarlyStopping counter: 17 out of 100
Updating learning rate to 9.927388499902631e-24
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.9636942499513156e-24
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.4818471249756578e-24
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.2409235624878289e-24
EarlyStopping counter: 21 out of 100
Updating learning rate to 6.204617812439144e-25
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.102308906219572e-25
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.551154453109786e-25
EarlyStopping counter: 24 out of 100
Updating learning rate to 7.75577226554893e-26
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.877886132774465e-26
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.9389430663872326e-26
EarlyStopping counter: 27 out of 100
Updating learning rate to 9.694715331936163e-27
EarlyStopping counter: 28 out of 100
Updating learning rate to 4.8473576659680816e-27
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.4236788329840408e-27
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.2118394164920204e-27
EarlyStopping counter: 31 out of 100
Updating learning rate to 6.059197082460102e-28
EarlyStopping counter: 32 out of 100
Updating learning rate to 3.029598541230051e-28
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.5147992706150255e-28
EarlyStopping counter: 34 out of 100
Updating learning rate to 7.573996353075128e-29
EarlyStopping counter: 35 out of 100
Updating learning rate to 3.786998176537564e-29
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.893499088268782e-29
EarlyStopping counter: 37 out of 100
Updating learning rate to 9.46749544134391e-30
EarlyStopping counter: 38 out of 100
Updating learning rate to 4.733747720671955e-30
EarlyStopping counter: 39 out of 100
Updating learning rate to 2.3668738603359773e-30
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.1834369301679887e-30
EarlyStopping counter: 41 out of 100
Updating learning rate to 5.917184650839943e-31
EarlyStopping counter: 42 out of 100
Updating learning rate to 2.9585923254199717e-31
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.4792961627099858e-31
EarlyStopping counter: 44 out of 100
Updating learning rate to 7.396480813549929e-32
EarlyStopping counter: 45 out of 100
Updating learning rate to 3.6982404067749646e-32
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.8491202033874823e-32
EarlyStopping counter: 47 out of 100
Updating learning rate to 9.245601016937412e-33
EarlyStopping counter: 48 out of 100
Updating learning rate to 4.622800508468706e-33
EarlyStopping counter: 49 out of 100
Updating learning rate to 2.311400254234353e-33
Validation loss decreased (0.037304 --> 0.037247).  Saving model ...
Updating learning rate to 1.1557001271171764e-33
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.778500635585882e-34
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.889250317792941e-34
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4446251588964705e-34
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.223125794482353e-35
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.6115628972411764e-35
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.8057814486205882e-35
>>>>>> Testing on validation set: trial_9 >>>>>>
test 232
test shape: (232, 30, 5) (232, 30, 5)
test shape: (232, 30, 5) (232, 30, 5)


	mse:0.06477562338113785, mae:0.10339419543743134, dtw:Not calculated


                                                                                       [I 2025-10-17 00:24:48,297] Trial 9 finished with value: 0.10339419543743134 and parameters: {'seq_len': 48, 'pred_len': 30, 'expand': 2, 'd_model': 64, 'n_heads': 8, 'e_layers': 2, 'd_layers': 1, 'batch_size': 64, 'learning_rate': 1.1445499686124451e-05, 'dropout': 0.16875187104211403}. Best is trial 8 with value: 0.0927814468741417.
Best trial: 8. Best value: 0.0927814:  18%|█▊        | 9/50 [31:41<2:00:40, 176.61s/it]Best trial: 8. Best value: 0.0927814:  18%|█▊        | 9/50 [31:41<2:00:40, 176.61s/it]Best trial: 8. Best value: 0.0927814:  20%|██        | 10/50 [31:41<1:35:17, 142.94s/it]
============================================================
Trial 10
============================================================
seq_len: 96, pred_len: 1
d_model: 32, n_heads: 8
e_layers: 2, d_layers: 2
batch_size: 64, lr: 0.000012
dropout: 0.05190081471587321
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 64, expand: 2
>>>>>> Start training: trial_10 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 1
============================================================
train 4577
val 259
test 261
Validation loss decreased (inf --> 0.030287).  Saving model ...
Updating learning rate to 1.2400787658042302e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.200393829021151e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.1001969145105754e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5500984572552877e-06
Validation loss decreased (0.030287 --> 0.030261).  Saving model ...
Updating learning rate to 7.750492286276438e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.875246143138219e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.9376230715691096e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.688115357845548e-08
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.844057678922774e-08
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.422028839461387e-08
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.2110144197306935e-08
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.0550720986534675e-09
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.0275360493267338e-09
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.5137680246633669e-09
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.568840123316834e-10
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.784420061658417e-10
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.8922100308292086e-10
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.461050154146043e-11
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.7305250770730215e-11
Validation loss decreased (0.030261 --> 0.030012).  Saving model ...
Updating learning rate to 2.3652625385365108e-11
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1826312692682554e-11
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.913156346341277e-12
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.9565781731706384e-12
Validation loss decreased (0.030012 --> 0.029943).  Saving model ...
Updating learning rate to 1.4782890865853192e-12
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.391445432926596e-13
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.695722716463298e-13
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.847861358231649e-13
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.239306791158245e-14
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.6196533955791226e-14
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.3098266977895613e-14
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1549133488947806e-14
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.774566744473903e-15
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.8872833722369516e-15
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.4436416861184758e-15
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.218208430592379e-16
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.6091042152961895e-16
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.8045521076480948e-16
EarlyStopping counter: 14 out of 100
Updating learning rate to 9.022760538240474e-17
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.511380269120237e-17
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.2556901345601184e-17
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.1278450672800592e-17
Validation loss decreased (0.029943 --> 0.029628).  Saving model ...
Updating learning rate to 5.639225336400296e-18
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.819612668200148e-18
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.409806334100074e-18
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.04903167050037e-19
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.524515835250185e-19
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.7622579176250925e-19
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.811289588125463e-20
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.4056447940627313e-20
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.2028223970313657e-20
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.1014111985156828e-20
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.507055992578414e-21
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.753527996289207e-21
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.3767639981446035e-21
EarlyStopping counter: 13 out of 100
Updating learning rate to 6.883819990723018e-22
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.441909995361509e-22
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.7209549976807544e-22
EarlyStopping counter: 16 out of 100
Updating learning rate to 8.604774988403772e-23
Validation loss decreased (0.029628 --> 0.029533).  Saving model ...
Updating learning rate to 4.302387494201886e-23
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.151193747100943e-23
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0755968735504715e-23
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.3779843677523576e-24
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.6889921838761788e-24
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3444960919380894e-24
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.722480459690447e-25
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.3612402298452235e-25
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6806201149226117e-25
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.403100574613059e-26
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.2015502873065294e-26
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.1007751436532647e-26
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.0503875718266323e-26
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.251937859133162e-27
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.625968929566581e-27
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.3129844647832904e-27
EarlyStopping counter: 16 out of 100
Updating learning rate to 6.564922323916452e-28
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.282461161958226e-28
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.641230580979113e-28
EarlyStopping counter: 19 out of 100
Updating learning rate to 8.206152904895565e-29
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.1030764524477826e-29
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.0515382262238913e-29
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.0257691131119456e-29
EarlyStopping counter: 23 out of 100
Updating learning rate to 5.128845565559728e-30
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.564422782779864e-30
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.282211391389932e-30
EarlyStopping counter: 26 out of 100
Updating learning rate to 6.41105695694966e-31
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.20552847847483e-31
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.602764239237415e-31
EarlyStopping counter: 29 out of 100
Updating learning rate to 8.013821196187075e-32
EarlyStopping counter: 30 out of 100
Updating learning rate to 4.0069105980935377e-32
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.0034552990467688e-32
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.0017276495233844e-32
EarlyStopping counter: 33 out of 100
Updating learning rate to 5.008638247616922e-33
EarlyStopping counter: 34 out of 100
Updating learning rate to 2.504319123808461e-33
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.2521595619042305e-33
EarlyStopping counter: 36 out of 100
Updating learning rate to 6.260797809521153e-34
EarlyStopping counter: 37 out of 100
Updating learning rate to 3.1303989047605763e-34
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.5651994523802882e-34
EarlyStopping counter: 39 out of 100
Updating learning rate to 7.825997261901441e-35
EarlyStopping counter: 40 out of 100
Updating learning rate to 3.9129986309507204e-35
EarlyStopping counter: 41 out of 100
Updating learning rate to 1.9564993154753602e-35
>>>>>> Testing on validation set: trial_10 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.06633876264095306, mae:0.11159087717533112, dtw:Not calculated


                                                                                        [I 2025-10-17 00:25:55,498] Trial 10 finished with value: 0.11159087717533112 and parameters: {'seq_len': 96, 'pred_len': 1, 'expand': 2, 'd_model': 32, 'n_heads': 8, 'e_layers': 2, 'd_layers': 2, 'batch_size': 64, 'learning_rate': 1.2400787658042302e-05, 'dropout': 0.05190081471587321}. Best is trial 8 with value: 0.0927814468741417.
Best trial: 8. Best value: 0.0927814:  20%|██        | 10/50 [32:49<1:35:17, 142.94s/it]Best trial: 8. Best value: 0.0927814:  20%|██        | 10/50 [32:49<1:35:17, 142.94s/it]Best trial: 8. Best value: 0.0927814:  22%|██▏       | 11/50 [32:49<1:17:50, 119.76s/it]
============================================================
Trial 11
============================================================
seq_len: 48, pred_len: 1
d_model: 32, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000057
dropout: 0.1847519535620736
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 32, expand: 1
>>>>>> Start training: trial_11 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.032653).  Saving model ...
Updating learning rate to 5.723663659916832e-05
Validation loss decreased (0.032653 --> 0.032486).  Saving model ...
Updating learning rate to 2.861831829958416e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.430915914979208e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.15457957489604e-06
Validation loss decreased (0.032486 --> 0.032109).  Saving model ...
Updating learning rate to 3.57728978744802e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.78864489372401e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.94322446862005e-07
Validation loss decreased (0.032109 --> 0.030125).  Saving model ...
Updating learning rate to 4.471612234310025e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2358061171550124e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1179030585775062e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.589515292887531e-08
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7947576464437655e-08
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3973788232218827e-08
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.986894116109414e-09
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.493447058054707e-09
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.7467235290273534e-09
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.733617645136767e-10
Validation loss decreased (0.030125 --> 0.029922).  Saving model ...
Updating learning rate to 4.3668088225683836e-10
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.1834044112841918e-10
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0917022056420959e-10
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.4585110282104794e-11
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7292555141052397e-11
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3646277570526199e-11
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.823138785263099e-12
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.4115693926315497e-12
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.7057846963157748e-12
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.528923481578874e-13
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.264461740789437e-13
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.1322308703947185e-13
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.0661154351973593e-13
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.3305771759867963e-14
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.6652885879933982e-14
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.3326442939966991e-14
EarlyStopping counter: 16 out of 100
Updating learning rate to 6.6632214699834954e-15
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.3316107349917477e-15
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.6658053674958739e-15
EarlyStopping counter: 19 out of 100
Updating learning rate to 8.329026837479369e-16
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.1645134187396846e-16
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.0822567093698423e-16
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.0411283546849212e-16
EarlyStopping counter: 23 out of 100
Updating learning rate to 5.205641773424606e-17
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.602820886712303e-17
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.3014104433561514e-17
EarlyStopping counter: 26 out of 100
Updating learning rate to 6.507052216780757e-18
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.2535261083903786e-18
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.6267630541951893e-18
EarlyStopping counter: 29 out of 100
Updating learning rate to 8.133815270975947e-19
EarlyStopping counter: 30 out of 100
Updating learning rate to 4.0669076354879733e-19
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.0334538177439866e-19
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.0167269088719933e-19
EarlyStopping counter: 33 out of 100
Updating learning rate to 5.0836345443599666e-20
EarlyStopping counter: 34 out of 100
Updating learning rate to 2.5418172721799833e-20
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.2709086360899916e-20
Validation loss decreased (0.029922 --> 0.029900).  Saving model ...
Updating learning rate to 6.354543180449958e-21
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.177271590224979e-21
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5886357951124896e-21
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.943178975562448e-22
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.971589487781224e-22
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.985794743890612e-22
Validation loss decreased (0.029900 --> 0.029791).  Saving model ...
Updating learning rate to 9.92897371945306e-23
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.96448685972653e-23
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.482243429863265e-23
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2411217149316325e-23
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.205608574658162e-24
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.102804287329081e-24
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.5514021436645406e-24
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.757010718322703e-25
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.8785053591613515e-25
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.9392526795806757e-25
EarlyStopping counter: 10 out of 100
Updating learning rate to 9.696263397903379e-26
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.8481316989516893e-26
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.4240658494758447e-26
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.2120329247379223e-26
EarlyStopping counter: 14 out of 100
Updating learning rate to 6.060164623689612e-27
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.030082311844806e-27
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.515041155922403e-27
EarlyStopping counter: 17 out of 100
Updating learning rate to 7.575205779612015e-28
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.7876028898060073e-28
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.8938014449030036e-28
EarlyStopping counter: 20 out of 100
Updating learning rate to 9.469007224515018e-29
EarlyStopping counter: 21 out of 100
Updating learning rate to 4.734503612257509e-29
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.3672518061287546e-29
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.1836259030643773e-29
EarlyStopping counter: 24 out of 100
Updating learning rate to 5.9181295153218864e-30
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.9590647576609432e-30
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.4795323788304716e-30
EarlyStopping counter: 27 out of 100
Updating learning rate to 7.397661894152358e-31
EarlyStopping counter: 28 out of 100
Updating learning rate to 3.698830947076179e-31
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.8494154735380895e-31
EarlyStopping counter: 30 out of 100
Updating learning rate to 9.247077367690447e-32
EarlyStopping counter: 31 out of 100
Updating learning rate to 4.623538683845224e-32
EarlyStopping counter: 32 out of 100
Updating learning rate to 2.311769341922612e-32
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.155884670961306e-32
EarlyStopping counter: 34 out of 100
Updating learning rate to 5.77942335480653e-33
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.889711677403265e-33
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.4448558387016324e-33
EarlyStopping counter: 37 out of 100
Updating learning rate to 7.224279193508162e-34
EarlyStopping counter: 38 out of 100
Updating learning rate to 3.612139596754081e-34
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.8060697983770405e-34
EarlyStopping counter: 40 out of 100
Updating learning rate to 9.030348991885203e-35
>>>>>> Testing on validation set: trial_11 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.059661056846380234, mae:0.0940236896276474, dtw:Not calculated


                                                                                        [I 2025-10-17 00:28:08,635] Trial 11 finished with value: 0.0940236896276474 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 1, 'd_model': 32, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 5.723663659916832e-05, 'dropout': 0.1847519535620736}. Best is trial 8 with value: 0.0927814468741417.
Best trial: 8. Best value: 0.0927814:  22%|██▏       | 11/50 [35:02<1:17:50, 119.76s/it]Best trial: 8. Best value: 0.0927814:  22%|██▏       | 11/50 [35:02<1:17:50, 119.76s/it]Best trial: 8. Best value: 0.0927814:  24%|██▍       | 12/50 [35:02<1:18:25, 123.83s/it]
============================================================
Trial 12
============================================================
seq_len: 48, pred_len: 1
d_model: 32, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 16, lr: 0.000027
dropout: 0.21640016432444342
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 64, expand: 2
>>>>>> Start training: trial_12 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.033801).  Saving model ...
Updating learning rate to 2.671666018414501e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3358330092072504e-05
Validation loss decreased (0.033801 --> 0.033718).  Saving model ...
Updating learning rate to 6.679165046036252e-06
Validation loss decreased (0.033718 --> 0.033101).  Saving model ...
Updating learning rate to 3.339582523018126e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.669791261509063e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.348956307545315e-07
Validation loss decreased (0.033101 --> 0.033033).  Saving model ...
Updating learning rate to 4.1744781537726576e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0872390768863288e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0436195384431644e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.218097692215822e-08
Validation loss decreased (0.033033 --> 0.032987).  Saving model ...
Updating learning rate to 2.609048846107911e-08
Validation loss decreased (0.032987 --> 0.032911).  Saving model ...
Updating learning rate to 1.3045244230539555e-08
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.5226221152697775e-09
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.2613110576348887e-09
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6306555288174444e-09
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.153277644087222e-10
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.076638822043611e-10
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0383194110218055e-10
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.0191597055109027e-10
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.0957985275545137e-11
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.5478992637772568e-11
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.2739496318886284e-11
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.369748159443142e-12
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.184874079721571e-12
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.5924370398607855e-12
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.962185199303928e-13
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.981092599651964e-13
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.990546299825982e-13
EarlyStopping counter: 17 out of 100
Updating learning rate to 9.95273149912991e-14
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.976365749564955e-14
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.4881828747824774e-14
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.2440914373912387e-14
EarlyStopping counter: 21 out of 100
Updating learning rate to 6.2204571869561934e-15
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.1102285934780967e-15
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.5551142967390484e-15
EarlyStopping counter: 24 out of 100
Updating learning rate to 7.775571483695242e-16
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.887785741847621e-16
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.9438928709238104e-16
EarlyStopping counter: 27 out of 100
Updating learning rate to 9.719464354619052e-17
EarlyStopping counter: 28 out of 100
Updating learning rate to 4.859732177309526e-17
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.429866088654763e-17
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.2149330443273815e-17
EarlyStopping counter: 31 out of 100
Updating learning rate to 6.074665221636908e-18
EarlyStopping counter: 32 out of 100
Updating learning rate to 3.037332610818454e-18
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.518666305409227e-18
EarlyStopping counter: 34 out of 100
Updating learning rate to 7.593331527046135e-19
EarlyStopping counter: 35 out of 100
Updating learning rate to 3.7966657635230673e-19
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.8983328817615336e-19
EarlyStopping counter: 37 out of 100
Updating learning rate to 9.491664408807668e-20
EarlyStopping counter: 38 out of 100
Updating learning rate to 4.745832204403834e-20
EarlyStopping counter: 39 out of 100
Updating learning rate to 2.372916102201917e-20
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.1864580511009585e-20
EarlyStopping counter: 41 out of 100
Updating learning rate to 5.932290255504793e-21
EarlyStopping counter: 42 out of 100
Updating learning rate to 2.9661451277523963e-21
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.4830725638761982e-21
EarlyStopping counter: 44 out of 100
Updating learning rate to 7.415362819380991e-22
EarlyStopping counter: 45 out of 100
Updating learning rate to 3.7076814096904954e-22
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.8538407048452477e-22
EarlyStopping counter: 47 out of 100
Updating learning rate to 9.269203524226238e-23
EarlyStopping counter: 48 out of 100
Updating learning rate to 4.634601762113119e-23
EarlyStopping counter: 49 out of 100
Updating learning rate to 2.3173008810565596e-23
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.1586504405282798e-23
EarlyStopping counter: 51 out of 100
Updating learning rate to 5.793252202641399e-24
EarlyStopping counter: 52 out of 100
Updating learning rate to 2.8966261013206995e-24
EarlyStopping counter: 53 out of 100
Updating learning rate to 1.4483130506603498e-24
EarlyStopping counter: 54 out of 100
Updating learning rate to 7.241565253301749e-25
EarlyStopping counter: 55 out of 100
Updating learning rate to 3.6207826266508744e-25
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.8103913133254372e-25
EarlyStopping counter: 57 out of 100
Updating learning rate to 9.051956566627186e-26
EarlyStopping counter: 58 out of 100
Updating learning rate to 4.525978283313593e-26
EarlyStopping counter: 59 out of 100
Updating learning rate to 2.2629891416567965e-26
EarlyStopping counter: 60 out of 100
Updating learning rate to 1.1314945708283983e-26
EarlyStopping counter: 61 out of 100
Updating learning rate to 5.657472854141991e-27
EarlyStopping counter: 62 out of 100
Updating learning rate to 2.8287364270709956e-27
EarlyStopping counter: 63 out of 100
Updating learning rate to 1.4143682135354978e-27
EarlyStopping counter: 64 out of 100
Updating learning rate to 7.071841067677489e-28
EarlyStopping counter: 65 out of 100
Updating learning rate to 3.5359205338387445e-28
EarlyStopping counter: 66 out of 100
Updating learning rate to 1.7679602669193723e-28
EarlyStopping counter: 67 out of 100
Updating learning rate to 8.839801334596861e-29
EarlyStopping counter: 68 out of 100
Updating learning rate to 4.4199006672984307e-29
EarlyStopping counter: 69 out of 100
Updating learning rate to 2.2099503336492153e-29
EarlyStopping counter: 70 out of 100
Updating learning rate to 1.1049751668246077e-29
EarlyStopping counter: 71 out of 100
Updating learning rate to 5.524875834123038e-30
EarlyStopping counter: 72 out of 100
Updating learning rate to 2.762437917061519e-30
EarlyStopping counter: 73 out of 100
Updating learning rate to 1.3812189585307596e-30
EarlyStopping counter: 74 out of 100
Updating learning rate to 6.906094792653798e-31
EarlyStopping counter: 75 out of 100
Updating learning rate to 3.453047396326899e-31
EarlyStopping counter: 76 out of 100
Updating learning rate to 1.7265236981634495e-31
EarlyStopping counter: 77 out of 100
Updating learning rate to 8.632618490817247e-32
EarlyStopping counter: 78 out of 100
Updating learning rate to 4.3163092454086237e-32
EarlyStopping counter: 79 out of 100
Updating learning rate to 2.1581546227043119e-32
EarlyStopping counter: 80 out of 100
Updating learning rate to 1.0790773113521559e-32
EarlyStopping counter: 81 out of 100
Updating learning rate to 5.3953865567607796e-33
EarlyStopping counter: 82 out of 100
Updating learning rate to 2.6976932783803898e-33
EarlyStopping counter: 83 out of 100
Updating learning rate to 1.3488466391901949e-33
EarlyStopping counter: 84 out of 100
Updating learning rate to 6.7442331959509745e-34
EarlyStopping counter: 85 out of 100
Updating learning rate to 3.3721165979754873e-34
EarlyStopping counter: 86 out of 100
Updating learning rate to 1.6860582989877436e-34
EarlyStopping counter: 87 out of 100
Updating learning rate to 8.430291494938718e-35
EarlyStopping counter: 88 out of 100
Updating learning rate to 4.215145747469359e-35
>>>>>> Testing on validation set: trial_12 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.06143459677696228, mae:0.0950542613863945, dtw:Not calculated


                                                                                        [I 2025-10-17 00:32:30,391] Trial 12 finished with value: 0.0950542613863945 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 2, 'd_model': 32, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 16, 'learning_rate': 2.671666018414501e-05, 'dropout': 0.21640016432444342}. Best is trial 8 with value: 0.0927814468741417.
Best trial: 8. Best value: 0.0927814:  24%|██▍       | 12/50 [39:24<1:18:25, 123.83s/it]Best trial: 8. Best value: 0.0927814:  24%|██▍       | 12/50 [39:24<1:18:25, 123.83s/it]Best trial: 8. Best value: 0.0927814:  26%|██▌       | 13/50 [39:24<1:42:07, 165.61s/it]
============================================================
Trial 13
============================================================
seq_len: 48, pred_len: 1
d_model: 32, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000061
dropout: 0.11855764719196625
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 32, expand: 1
>>>>>> Start training: trial_13 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.031946).  Saving model ...
Updating learning rate to 6.10292183043933e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.051460915219665e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5257304576098325e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.628652288049163e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.8143261440245813e-06
Validation loss decreased (0.031946 --> 0.031044).  Saving model ...
Updating learning rate to 1.9071630720122907e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.535815360061453e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.7679076800307267e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.3839538400153633e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1919769200076817e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.9598846000384084e-08
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.9799423000192042e-08
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4899711500096021e-08
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.4498557500480104e-09
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.7249278750240052e-09
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.8624639375120026e-09
EarlyStopping counter: 11 out of 100
Updating learning rate to 9.312319687560013e-10
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.6561598437800065e-10
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.3280799218900033e-10
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.1640399609450016e-10
Validation loss decreased (0.031044 --> 0.030909).  Saving model ...
Updating learning rate to 5.820199804725008e-11
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.910099902362504e-11
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.455049951181252e-11
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.27524975590626e-12
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.63762487795313e-12
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.818812438976565e-12
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.094062194882825e-13
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.5470310974414126e-13
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.2735155487207063e-13
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.1367577743603532e-13
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.683788871801766e-14
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.841894435900883e-14
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.4209472179504414e-14
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.104736089752207e-15
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.5523680448761036e-15
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.7761840224380518e-15
EarlyStopping counter: 16 out of 100
Updating learning rate to 8.880920112190259e-16
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.4404600560951295e-16
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.2202300280475648e-16
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.1101150140237824e-16
EarlyStopping counter: 20 out of 100
Updating learning rate to 5.550575070118912e-17
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.775287535059456e-17
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.387643767529728e-17
EarlyStopping counter: 23 out of 100
Updating learning rate to 6.93821883764864e-18
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.46910941882432e-18
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.73455470941216e-18
EarlyStopping counter: 26 out of 100
Updating learning rate to 8.6727735470608e-19
EarlyStopping counter: 27 out of 100
Updating learning rate to 4.3363867735304e-19
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.1681933867652e-19
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.0840966933826e-19
EarlyStopping counter: 30 out of 100
Updating learning rate to 5.420483466913e-20
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.7102417334565e-20
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.35512086672825e-20
EarlyStopping counter: 33 out of 100
Updating learning rate to 6.77560433364125e-21
EarlyStopping counter: 34 out of 100
Updating learning rate to 3.387802166820625e-21
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.6939010834103125e-21
EarlyStopping counter: 36 out of 100
Updating learning rate to 8.469505417051562e-22
EarlyStopping counter: 37 out of 100
Updating learning rate to 4.234752708525781e-22
EarlyStopping counter: 38 out of 100
Updating learning rate to 2.1173763542628906e-22
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.0586881771314453e-22
EarlyStopping counter: 40 out of 100
Updating learning rate to 5.2934408856572265e-23
EarlyStopping counter: 41 out of 100
Updating learning rate to 2.6467204428286132e-23
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.3233602214143066e-23
EarlyStopping counter: 43 out of 100
Updating learning rate to 6.616801107071533e-24
Validation loss decreased (0.030909 --> 0.030690).  Saving model ...
Updating learning rate to 3.3084005535357665e-24
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6542002767678833e-24
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.271001383839416e-25
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.135500691919708e-25
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.067750345959854e-25
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.033875172979927e-25
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.169375864899635e-26
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.5846879324498176e-26
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.2923439662249088e-26
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.461719831124544e-27
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.230859915562272e-27
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.615429957781136e-27
EarlyStopping counter: 12 out of 100
Updating learning rate to 8.07714978890568e-28
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.03857489445284e-28
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.01928744722642e-28
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.00964372361321e-28
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.04821861806605e-29
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.524109309033025e-29
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.2620546545165125e-29
EarlyStopping counter: 19 out of 100
Updating learning rate to 6.3102732725825625e-30
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.1551366362912813e-30
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.5775683181456406e-30
EarlyStopping counter: 22 out of 100
Updating learning rate to 7.887841590728203e-31
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.9439207953641016e-31
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.9719603976820508e-31
EarlyStopping counter: 25 out of 100
Updating learning rate to 9.859801988410254e-32
EarlyStopping counter: 26 out of 100
Updating learning rate to 4.929900994205127e-32
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.4649504971025635e-32
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.2324752485512817e-32
EarlyStopping counter: 29 out of 100
Updating learning rate to 6.162376242756409e-33
EarlyStopping counter: 30 out of 100
Updating learning rate to 3.0811881213782044e-33
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.5405940606891022e-33
EarlyStopping counter: 32 out of 100
Updating learning rate to 7.702970303445511e-34
EarlyStopping counter: 33 out of 100
Updating learning rate to 3.8514851517227554e-34
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.9257425758613777e-34
EarlyStopping counter: 35 out of 100
Updating learning rate to 9.628712879306889e-35
>>>>>> Testing on validation set: trial_13 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.06011824309825897, mae:0.09326346963644028, dtw:Not calculated


                                                                                        [I 2025-10-17 00:34:43,427] Trial 13 finished with value: 0.09326346963644028 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 1, 'd_model': 32, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 6.10292183043933e-05, 'dropout': 0.11855764719196625}. Best is trial 8 with value: 0.0927814468741417.
Best trial: 8. Best value: 0.0927814:  26%|██▌       | 13/50 [41:37<1:42:07, 165.61s/it]Best trial: 8. Best value: 0.0927814:  26%|██▌       | 13/50 [41:37<1:42:07, 165.61s/it]Best trial: 8. Best value: 0.0927814:  28%|██▊       | 14/50 [41:37<1:33:27, 155.77s/it]
============================================================
Trial 14
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000261
dropout: 0.11119938357486121
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_14 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.026547).  Saving model ...
Updating learning rate to 0.0002614776382530179
Validation loss decreased (0.026547 --> 0.026310).  Saving model ...
Updating learning rate to 0.00013073881912650895
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.536940956325448e-05
Validation loss decreased (0.026310 --> 0.025441).  Saving model ...
Updating learning rate to 3.268470478162724e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.634235239081362e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.17117619540681e-06
Validation loss decreased (0.025441 --> 0.025100).  Saving model ...
Updating learning rate to 4.085588097703405e-06
Validation loss decreased (0.025100 --> 0.024776).  Saving model ...
Updating learning rate to 2.0427940488517024e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0213970244258512e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.106985122129256e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.553492561064628e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.276746280532314e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.38373140266157e-08
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.191865701330785e-08
Validation loss decreased (0.024776 --> 0.024662).  Saving model ...
Updating learning rate to 1.5959328506653925e-08
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.979664253326962e-09
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.989832126663481e-09
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.9949160633317406e-09
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.974580316658703e-10
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.987290158329352e-10
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.493645079164676e-10
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.246822539582338e-10
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.23411269791169e-11
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.117056348955845e-11
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.5585281744779224e-11
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.792640872389612e-12
Validation loss decreased (0.024662 --> 0.024621).  Saving model ...
Updating learning rate to 3.896320436194806e-12
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.948160218097403e-12
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.740801090487015e-13
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.870400545243507e-13
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.4352002726217537e-13
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2176001363108768e-13
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.088000681554384e-14
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.044000340777192e-14
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.522000170388596e-14
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.61000085194298e-15
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.80500042597149e-15
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.902500212985745e-15
EarlyStopping counter: 12 out of 100
Updating learning rate to 9.512501064928725e-16
Validation loss decreased (0.024621 --> 0.024478).  Saving model ...
Updating learning rate to 4.756250532464363e-16
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.3781252662321813e-16
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1890626331160907e-16
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.945313165580453e-17
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.9726565827902267e-17
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4863282913951133e-17
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.431641456975567e-18
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.715820728487783e-18
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.8579103642438917e-18
Validation loss decreased (0.024478 --> 0.024407).  Saving model ...
Updating learning rate to 9.289551821219458e-19
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.644775910609729e-19
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.3223879553048646e-19
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1611939776524323e-19
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.805969888262161e-20
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.902984944131081e-20
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.4514924720655404e-20
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.257462360327702e-21
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.628731180163851e-21
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.8143655900819254e-21
EarlyStopping counter: 10 out of 100
Updating learning rate to 9.071827950409627e-22
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.535913975204814e-22
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.267956987602407e-22
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.1339784938012034e-22
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.669892469006017e-23
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.8349462345030085e-23
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.4174731172515043e-23
EarlyStopping counter: 17 out of 100
Updating learning rate to 7.087365586257521e-24
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.543682793128761e-24
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.7718413965643803e-24
EarlyStopping counter: 20 out of 100
Updating learning rate to 8.859206982821902e-25
EarlyStopping counter: 21 out of 100
Updating learning rate to 4.429603491410951e-25
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.2148017457054754e-25
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.1074008728527377e-25
EarlyStopping counter: 24 out of 100
Updating learning rate to 5.537004364263689e-26
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.768502182131844e-26
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.384251091065922e-26
EarlyStopping counter: 27 out of 100
Updating learning rate to 6.92125545532961e-27
EarlyStopping counter: 28 out of 100
Updating learning rate to 3.460627727664805e-27
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.7303138638324027e-27
EarlyStopping counter: 30 out of 100
Updating learning rate to 8.651569319162013e-28
EarlyStopping counter: 31 out of 100
Updating learning rate to 4.325784659581007e-28
EarlyStopping counter: 32 out of 100
Updating learning rate to 2.1628923297905033e-28
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.0814461648952517e-28
EarlyStopping counter: 34 out of 100
Updating learning rate to 5.407230824476258e-29
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.703615412238129e-29
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.3518077061190646e-29
EarlyStopping counter: 37 out of 100
Updating learning rate to 6.759038530595323e-30
EarlyStopping counter: 38 out of 100
Updating learning rate to 3.3795192652976614e-30
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.6897596326488307e-30
EarlyStopping counter: 40 out of 100
Updating learning rate to 8.448798163244154e-31
EarlyStopping counter: 41 out of 100
Updating learning rate to 4.224399081622077e-31
EarlyStopping counter: 42 out of 100
Updating learning rate to 2.1121995408110384e-31
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.0560997704055192e-31
EarlyStopping counter: 44 out of 100
Updating learning rate to 5.280498852027596e-32
EarlyStopping counter: 45 out of 100
Updating learning rate to 2.640249426013798e-32
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.320124713006899e-32
Validation loss decreased (0.024407 --> 0.024256).  Saving model ...
Updating learning rate to 6.600623565034495e-33
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.3003117825172475e-33
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6501558912586237e-33
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.250779456293119e-34
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.125389728146559e-34
>>>>>> Testing on validation set: trial_14 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.04972388595342636, mae:0.0760391429066658, dtw:Not calculated


                                                                                        [I 2025-10-17 00:36:56,972] Trial 14 finished with value: 0.0760391429066658 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0002614776382530179, 'dropout': 0.11119938357486121}. Best is trial 14 with value: 0.0760391429066658.
Best trial: 8. Best value: 0.0927814:  28%|██▊       | 14/50 [43:50<1:33:27, 155.77s/it]Best trial: 14. Best value: 0.0760391:  28%|██▊       | 14/50 [43:50<1:33:27, 155.77s/it]Best trial: 14. Best value: 0.0760391:  30%|███       | 15/50 [43:50<1:26:57, 149.07s/it]
============================================================
Trial 15
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 2, d_layers: 2
batch_size: 32, lr: 0.000335
dropout: 0.08443160267257659
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_15 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.025863).  Saving model ...
Updating learning rate to 0.0003349882529383815
Validation loss decreased (0.025863 --> 0.024668).  Saving model ...
Updating learning rate to 0.00016749412646919074
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.374706323459537e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.1873531617297686e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0936765808648843e-05
Validation loss decreased (0.024668 --> 0.023679).  Saving model ...
Updating learning rate to 1.0468382904324421e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.234191452162211e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.6170957260811054e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3085478630405527e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.542739315202763e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.2713696576013817e-07
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6356848288006909e-07
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.178424144003454e-08
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.089212072001727e-08
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.0446060360008636e-08
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.0223030180004318e-08
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.111515090002159e-09
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.5557575450010795e-09
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.2778787725005397e-09
EarlyStopping counter: 14 out of 100
Updating learning rate to 6.389393862502699e-10
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.1946969312513493e-10
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.5973484656256747e-10
EarlyStopping counter: 17 out of 100
Updating learning rate to 7.986742328128373e-11
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.9933711640641867e-11
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.9966855820320933e-11
EarlyStopping counter: 20 out of 100
Updating learning rate to 9.983427910160467e-12
EarlyStopping counter: 21 out of 100
Updating learning rate to 4.991713955080233e-12
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.4958569775401167e-12
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.2479284887700583e-12
EarlyStopping counter: 24 out of 100
Updating learning rate to 6.239642443850292e-13
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.119821221925146e-13
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.559910610962573e-13
Validation loss decreased (0.023679 --> 0.023666).  Saving model ...
Updating learning rate to 7.799553054812865e-14
Validation loss decreased (0.023666 --> 0.023581).  Saving model ...
Updating learning rate to 3.899776527406432e-14
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.949888263703216e-14
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.74944131851608e-15
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.87472065925804e-15
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.43736032962902e-15
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.21868016481451e-15
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.09340082407255e-16
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.046700412036275e-16
Validation loss decreased (0.023581 --> 0.023565).  Saving model ...
Updating learning rate to 1.5233502060181376e-16
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.616751030090688e-17
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.808375515045344e-17
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.904187757522672e-17
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.52093878761336e-18
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.76046939380668e-18
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.38023469690334e-18
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.19011734845167e-18
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.95058674225835e-19
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.975293371129175e-19
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.4876466855645875e-19
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.438233427822938e-20
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.719116713911469e-20
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.8595583569557344e-20
EarlyStopping counter: 14 out of 100
Updating learning rate to 9.297791784778672e-21
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.648895892389336e-21
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.324447946194668e-21
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.162223973097334e-21
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.81111986548667e-22
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.905559932743335e-22
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.4527799663716675e-22
EarlyStopping counter: 21 out of 100
Updating learning rate to 7.263899831858337e-23
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.631949915929169e-23
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.8159749579645844e-23
EarlyStopping counter: 24 out of 100
Updating learning rate to 9.079874789822922e-24
EarlyStopping counter: 25 out of 100
Updating learning rate to 4.539937394911461e-24
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.2699686974557305e-24
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.1349843487278652e-24
Validation loss decreased (0.023565 --> 0.023505).  Saving model ...
Updating learning rate to 5.674921743639326e-25
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.837460871819663e-25
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4187304359098315e-25
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.093652179549158e-26
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.546826089774579e-26
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.7734130448872894e-26
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.867065224436447e-27
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.4335326122182236e-27
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.2167663061091118e-27
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.1083831530545559e-27
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.541915765272779e-28
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7709578826363897e-28
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.3854789413181949e-28
EarlyStopping counter: 13 out of 100
Updating learning rate to 6.927394706590974e-29
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.463697353295487e-29
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.7318486766477436e-29
EarlyStopping counter: 16 out of 100
Updating learning rate to 8.659243383238718e-30
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.329621691619359e-30
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.1648108458096795e-30
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.0824054229048397e-30
EarlyStopping counter: 20 out of 100
Updating learning rate to 5.412027114524199e-31
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.7060135572620993e-31
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.3530067786310497e-31
EarlyStopping counter: 23 out of 100
Updating learning rate to 6.765033893155248e-32
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.382516946577624e-32
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.691258473288812e-32
EarlyStopping counter: 26 out of 100
Updating learning rate to 8.45629236644406e-33
EarlyStopping counter: 27 out of 100
Updating learning rate to 4.22814618322203e-33
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.114073091611015e-33
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.0570365458055076e-33
EarlyStopping counter: 30 out of 100
Updating learning rate to 5.285182729027538e-34
>>>>>> Testing on validation set: trial_15 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.04876338690519333, mae:0.07185053080320358, dtw:Not calculated


                                                                                         [I 2025-10-17 00:39:11,422] Trial 15 finished with value: 0.07185053080320358 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 2, 'd_model': 64, 'n_heads': 8, 'e_layers': 2, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0003349882529383815, 'dropout': 0.08443160267257659}. Best is trial 15 with value: 0.07185053080320358.
Best trial: 14. Best value: 0.0760391:  30%|███       | 15/50 [46:05<1:26:57, 149.07s/it]Best trial: 15. Best value: 0.0718505:  30%|███       | 15/50 [46:05<1:26:57, 149.07s/it]Best trial: 15. Best value: 0.0718505:  32%|███▏      | 16/50 [46:05<1:21:58, 144.67s/it]
============================================================
Trial 16
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000308
dropout: 0.07485972162313749
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_16 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.026228).  Saving model ...
Updating learning rate to 0.0003080855671872458
Validation loss decreased (0.026228 --> 0.026075).  Saving model ...
Updating learning rate to 0.0001540427835936229
Validation loss decreased (0.026075 --> 0.025133).  Saving model ...
Updating learning rate to 7.702139179681145e-05
Validation loss decreased (0.025133 --> 0.023245).  Saving model ...
Updating learning rate to 3.851069589840572e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.925534794920286e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.62767397460143e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.813836987300715e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.4069184936503577e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2034592468251788e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.017296234125894e-07
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.008648117062947e-07
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.5043240585314735e-07
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.521620292657368e-08
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.760810146328684e-08
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.880405073164342e-08
EarlyStopping counter: 12 out of 100
Updating learning rate to 9.40202536582171e-09
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.701012682910855e-09
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.3505063414554274e-09
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.1752531707277137e-09
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.876265853638569e-10
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.938132926819284e-10
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.469066463409642e-10
EarlyStopping counter: 19 out of 100
Updating learning rate to 7.34533231704821e-11
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.672666158524105e-11
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.8363330792620527e-11
EarlyStopping counter: 22 out of 100
Updating learning rate to 9.181665396310263e-12
EarlyStopping counter: 23 out of 100
Updating learning rate to 4.590832698155132e-12
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.295416349077566e-12
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.147708174538783e-12
EarlyStopping counter: 26 out of 100
Updating learning rate to 5.738540872693915e-13
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.8692704363469573e-13
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.4346352181734786e-13
EarlyStopping counter: 29 out of 100
Updating learning rate to 7.173176090867393e-14
EarlyStopping counter: 30 out of 100
Updating learning rate to 3.5865880454336966e-14
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.7932940227168483e-14
EarlyStopping counter: 32 out of 100
Updating learning rate to 8.966470113584242e-15
EarlyStopping counter: 33 out of 100
Updating learning rate to 4.483235056792121e-15
EarlyStopping counter: 34 out of 100
Updating learning rate to 2.2416175283960604e-15
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.1208087641980302e-15
EarlyStopping counter: 36 out of 100
Updating learning rate to 5.604043820990151e-16
EarlyStopping counter: 37 out of 100
Updating learning rate to 2.8020219104950755e-16
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.4010109552475377e-16
EarlyStopping counter: 39 out of 100
Updating learning rate to 7.005054776237689e-17
EarlyStopping counter: 40 out of 100
Updating learning rate to 3.5025273881188443e-17
EarlyStopping counter: 41 out of 100
Updating learning rate to 1.7512636940594222e-17
EarlyStopping counter: 42 out of 100
Updating learning rate to 8.756318470297111e-18
EarlyStopping counter: 43 out of 100
Updating learning rate to 4.3781592351485554e-18
EarlyStopping counter: 44 out of 100
Updating learning rate to 2.1890796175742777e-18
EarlyStopping counter: 45 out of 100
Updating learning rate to 1.0945398087871389e-18
EarlyStopping counter: 46 out of 100
Updating learning rate to 5.472699043935694e-19
EarlyStopping counter: 47 out of 100
Updating learning rate to 2.736349521967847e-19
EarlyStopping counter: 48 out of 100
Updating learning rate to 1.3681747609839236e-19
EarlyStopping counter: 49 out of 100
Updating learning rate to 6.840873804919618e-20
EarlyStopping counter: 50 out of 100
Updating learning rate to 3.420436902459809e-20
EarlyStopping counter: 51 out of 100
Updating learning rate to 1.7102184512299045e-20
EarlyStopping counter: 52 out of 100
Updating learning rate to 8.551092256149522e-21
EarlyStopping counter: 53 out of 100
Updating learning rate to 4.275546128074761e-21
EarlyStopping counter: 54 out of 100
Updating learning rate to 2.1377730640373806e-21
EarlyStopping counter: 55 out of 100
Updating learning rate to 1.0688865320186903e-21
EarlyStopping counter: 56 out of 100
Updating learning rate to 5.344432660093451e-22
EarlyStopping counter: 57 out of 100
Updating learning rate to 2.6722163300467257e-22
EarlyStopping counter: 58 out of 100
Updating learning rate to 1.3361081650233629e-22
EarlyStopping counter: 59 out of 100
Updating learning rate to 6.680540825116814e-23
EarlyStopping counter: 60 out of 100
Updating learning rate to 3.340270412558407e-23
EarlyStopping counter: 61 out of 100
Updating learning rate to 1.6701352062792036e-23
EarlyStopping counter: 62 out of 100
Updating learning rate to 8.350676031396018e-24
EarlyStopping counter: 63 out of 100
Updating learning rate to 4.175338015698009e-24
EarlyStopping counter: 64 out of 100
Updating learning rate to 2.0876690078490045e-24
EarlyStopping counter: 65 out of 100
Updating learning rate to 1.0438345039245022e-24
EarlyStopping counter: 66 out of 100
Updating learning rate to 5.219172519622511e-25
EarlyStopping counter: 67 out of 100
Updating learning rate to 2.6095862598112556e-25
EarlyStopping counter: 68 out of 100
Updating learning rate to 1.3047931299056278e-25
EarlyStopping counter: 69 out of 100
Updating learning rate to 6.523965649528139e-26
EarlyStopping counter: 70 out of 100
Updating learning rate to 3.2619828247640695e-26
EarlyStopping counter: 71 out of 100
Updating learning rate to 1.6309914123820347e-26
EarlyStopping counter: 72 out of 100
Updating learning rate to 8.154957061910174e-27
EarlyStopping counter: 73 out of 100
Updating learning rate to 4.077478530955087e-27
EarlyStopping counter: 74 out of 100
Updating learning rate to 2.0387392654775434e-27
EarlyStopping counter: 75 out of 100
Updating learning rate to 1.0193696327387717e-27
EarlyStopping counter: 76 out of 100
Updating learning rate to 5.096848163693859e-28
EarlyStopping counter: 77 out of 100
Updating learning rate to 2.5484240818469293e-28
EarlyStopping counter: 78 out of 100
Updating learning rate to 1.2742120409234646e-28
EarlyStopping counter: 79 out of 100
Updating learning rate to 6.371060204617323e-29
EarlyStopping counter: 80 out of 100
Updating learning rate to 3.1855301023086616e-29
EarlyStopping counter: 81 out of 100
Updating learning rate to 1.5927650511543308e-29
EarlyStopping counter: 82 out of 100
Updating learning rate to 7.963825255771654e-30
EarlyStopping counter: 83 out of 100
Updating learning rate to 3.981912627885827e-30
EarlyStopping counter: 84 out of 100
Updating learning rate to 1.9909563139429135e-30
EarlyStopping counter: 85 out of 100
Updating learning rate to 9.954781569714568e-31
EarlyStopping counter: 86 out of 100
Updating learning rate to 4.977390784857284e-31
EarlyStopping counter: 87 out of 100
Updating learning rate to 2.488695392428642e-31
EarlyStopping counter: 88 out of 100
Updating learning rate to 1.244347696214321e-31
EarlyStopping counter: 89 out of 100
Updating learning rate to 6.221738481071605e-32
EarlyStopping counter: 90 out of 100
Updating learning rate to 3.1108692405358023e-32
EarlyStopping counter: 91 out of 100
Updating learning rate to 1.5554346202679012e-32
EarlyStopping counter: 92 out of 100
Updating learning rate to 7.777173101339506e-33
EarlyStopping counter: 93 out of 100
Updating learning rate to 3.888586550669753e-33
EarlyStopping counter: 94 out of 100
Updating learning rate to 1.9442932753348765e-33
EarlyStopping counter: 95 out of 100
Updating learning rate to 9.721466376674382e-34
EarlyStopping counter: 96 out of 100
Updating learning rate to 4.860733188337191e-34
>>>>>> Testing on validation set: trial_16 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.04937228932976723, mae:0.0739981085062027, dtw:Not calculated


                                                                                         [I 2025-10-17 00:41:25,148] Trial 16 finished with value: 0.0739981085062027 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0003080855671872458, 'dropout': 0.07485972162313749}. Best is trial 15 with value: 0.07185053080320358.
Best trial: 15. Best value: 0.0718505:  32%|███▏      | 16/50 [48:18<1:21:58, 144.67s/it]Best trial: 15. Best value: 0.0718505:  32%|███▏      | 16/50 [48:18<1:21:58, 144.67s/it]Best trial: 15. Best value: 0.0718505:  34%|███▍      | 17/50 [48:18<1:17:45, 141.38s/it]
============================================================
Trial 17
============================================================
seq_len: 48, pred_len: 14
d_model: 64, n_heads: 8
e_layers: 2, d_layers: 2
batch_size: 32, lr: 0.000296
dropout: 0.06350866827593309
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_17 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 14
============================================================
train 4612
val 246
test 248
Validation loss decreased (inf --> 0.040054).  Saving model ...
Updating learning rate to 0.0002959362902846767
Validation loss decreased (0.040054 --> 0.038038).  Saving model ...
Updating learning rate to 0.00014796814514233834
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.398407257116917e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.6992036285584584e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8496018142792292e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.248009071396146e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.624004535698073e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.3120022678490365e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1560011339245183e-06
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.780005669622591e-07
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.8900028348112956e-07
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.4450014174056478e-07
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.225007087028239e-08
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.6125035435141196e-08
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.8062517717570598e-08
EarlyStopping counter: 14 out of 100
Updating learning rate to 9.031258858785299e-09
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.5156294293926495e-09
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.2578147146963247e-09
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.1289073573481624e-09
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.644536786740812e-10
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.822268393370406e-10
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.411134196685203e-10
EarlyStopping counter: 21 out of 100
Updating learning rate to 7.055670983426015e-11
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.5278354917130074e-11
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.7639177458565037e-11
EarlyStopping counter: 24 out of 100
Updating learning rate to 8.819588729282518e-12
EarlyStopping counter: 25 out of 100
Updating learning rate to 4.409794364641259e-12
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.2048971823206296e-12
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.1024485911603148e-12
EarlyStopping counter: 28 out of 100
Updating learning rate to 5.512242955801574e-13
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.756121477900787e-13
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.3780607389503935e-13
EarlyStopping counter: 31 out of 100
Updating learning rate to 6.890303694751968e-14
EarlyStopping counter: 32 out of 100
Updating learning rate to 3.445151847375984e-14
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.722575923687992e-14
EarlyStopping counter: 34 out of 100
Updating learning rate to 8.61287961843996e-15
EarlyStopping counter: 35 out of 100
Updating learning rate to 4.30643980921998e-15
EarlyStopping counter: 36 out of 100
Updating learning rate to 2.15321990460999e-15
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.076609952304995e-15
EarlyStopping counter: 38 out of 100
Updating learning rate to 5.383049761524975e-16
EarlyStopping counter: 39 out of 100
Updating learning rate to 2.6915248807624873e-16
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.3457624403812437e-16
EarlyStopping counter: 41 out of 100
Updating learning rate to 6.728812201906218e-17
EarlyStopping counter: 42 out of 100
Updating learning rate to 3.364406100953109e-17
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.6822030504765546e-17
EarlyStopping counter: 44 out of 100
Updating learning rate to 8.411015252382773e-18
EarlyStopping counter: 45 out of 100
Updating learning rate to 4.2055076261913864e-18
EarlyStopping counter: 46 out of 100
Updating learning rate to 2.1027538130956932e-18
EarlyStopping counter: 47 out of 100
Updating learning rate to 1.0513769065478466e-18
EarlyStopping counter: 48 out of 100
Updating learning rate to 5.256884532739233e-19
EarlyStopping counter: 49 out of 100
Updating learning rate to 2.6284422663696165e-19
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.3142211331848083e-19
EarlyStopping counter: 51 out of 100
Updating learning rate to 6.571105665924041e-20
EarlyStopping counter: 52 out of 100
Updating learning rate to 3.2855528329620207e-20
EarlyStopping counter: 53 out of 100
Updating learning rate to 1.6427764164810103e-20
EarlyStopping counter: 54 out of 100
Updating learning rate to 8.213882082405052e-21
EarlyStopping counter: 55 out of 100
Updating learning rate to 4.106941041202526e-21
EarlyStopping counter: 56 out of 100
Updating learning rate to 2.053470520601263e-21
EarlyStopping counter: 57 out of 100
Updating learning rate to 1.0267352603006315e-21
EarlyStopping counter: 58 out of 100
Updating learning rate to 5.133676301503157e-22
EarlyStopping counter: 59 out of 100
Updating learning rate to 2.5668381507515786e-22
EarlyStopping counter: 60 out of 100
Updating learning rate to 1.2834190753757893e-22
EarlyStopping counter: 61 out of 100
Updating learning rate to 6.417095376878947e-23
EarlyStopping counter: 62 out of 100
Updating learning rate to 3.2085476884394733e-23
EarlyStopping counter: 63 out of 100
Updating learning rate to 1.6042738442197366e-23
EarlyStopping counter: 64 out of 100
Updating learning rate to 8.021369221098683e-24
EarlyStopping counter: 65 out of 100
Updating learning rate to 4.0106846105493416e-24
EarlyStopping counter: 66 out of 100
Updating learning rate to 2.0053423052746708e-24
EarlyStopping counter: 67 out of 100
Updating learning rate to 1.0026711526373354e-24
EarlyStopping counter: 68 out of 100
Updating learning rate to 5.013355763186677e-25
EarlyStopping counter: 69 out of 100
Updating learning rate to 2.5066778815933385e-25
EarlyStopping counter: 70 out of 100
Updating learning rate to 1.2533389407966693e-25
EarlyStopping counter: 71 out of 100
Updating learning rate to 6.266694703983346e-26
EarlyStopping counter: 72 out of 100
Updating learning rate to 3.133347351991673e-26
EarlyStopping counter: 73 out of 100
Updating learning rate to 1.5666736759958366e-26
EarlyStopping counter: 74 out of 100
Updating learning rate to 7.833368379979183e-27
EarlyStopping counter: 75 out of 100
Updating learning rate to 3.9166841899895914e-27
EarlyStopping counter: 76 out of 100
Updating learning rate to 1.9583420949947957e-27
EarlyStopping counter: 77 out of 100
Updating learning rate to 9.791710474973979e-28
EarlyStopping counter: 78 out of 100
Updating learning rate to 4.895855237486989e-28
EarlyStopping counter: 79 out of 100
Updating learning rate to 2.4479276187434946e-28
EarlyStopping counter: 80 out of 100
Updating learning rate to 1.2239638093717473e-28
EarlyStopping counter: 81 out of 100
Updating learning rate to 6.119819046858737e-29
EarlyStopping counter: 82 out of 100
Updating learning rate to 3.0599095234293683e-29
EarlyStopping counter: 83 out of 100
Updating learning rate to 1.5299547617146842e-29
EarlyStopping counter: 84 out of 100
Updating learning rate to 7.649773808573421e-30
EarlyStopping counter: 85 out of 100
Updating learning rate to 3.8248869042867104e-30
EarlyStopping counter: 86 out of 100
Updating learning rate to 1.9124434521433552e-30
EarlyStopping counter: 87 out of 100
Updating learning rate to 9.562217260716776e-31
EarlyStopping counter: 88 out of 100
Updating learning rate to 4.781108630358388e-31
EarlyStopping counter: 89 out of 100
Updating learning rate to 2.390554315179194e-31
EarlyStopping counter: 90 out of 100
Updating learning rate to 1.195277157589597e-31
EarlyStopping counter: 91 out of 100
Updating learning rate to 5.976385787947985e-32
EarlyStopping counter: 92 out of 100
Updating learning rate to 2.9881928939739925e-32
EarlyStopping counter: 93 out of 100
Updating learning rate to 1.4940964469869962e-32
EarlyStopping counter: 94 out of 100
Updating learning rate to 7.470482234934981e-33
EarlyStopping counter: 95 out of 100
Updating learning rate to 3.7352411174674906e-33
EarlyStopping counter: 96 out of 100
Updating learning rate to 1.8676205587337453e-33
EarlyStopping counter: 97 out of 100
Updating learning rate to 9.338102793668727e-34
EarlyStopping counter: 98 out of 100
Updating learning rate to 4.669051396834363e-34
>>>>>> Testing on validation set: trial_17 >>>>>>
test 248
test shape: (248, 14, 5) (248, 14, 5)
test shape: (248, 14, 5) (248, 14, 5)


	mse:0.06761689484119415, mae:0.10187836736440659, dtw:Not calculated


                                                                                         [I 2025-10-17 00:43:38,929] Trial 17 finished with value: 0.10187836736440659 and parameters: {'seq_len': 48, 'pred_len': 14, 'expand': 2, 'd_model': 64, 'n_heads': 8, 'e_layers': 2, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0002959362902846767, 'dropout': 0.06350866827593309}. Best is trial 15 with value: 0.07185053080320358.
Best trial: 15. Best value: 0.0718505:  34%|███▍      | 17/50 [50:32<1:17:45, 141.38s/it]Best trial: 15. Best value: 0.0718505:  34%|███▍      | 17/50 [50:32<1:17:45, 141.38s/it]Best trial: 15. Best value: 0.0718505:  36%|███▌      | 18/50 [50:32<1:14:11, 139.10s/it]
============================================================
Trial 18
============================================================
seq_len: 96, pred_len: 30
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 64, lr: 0.000471
dropout: 0.005306650068196306
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_18 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 30
============================================================
train 4548
val 230
test 232
Validation loss decreased (inf --> 0.034962).  Saving model ...
Updating learning rate to 0.0004710848955623725
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00023554244778118625
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.00011777122389059313
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.888561194529656e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.944280597264828e-05
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.472140298632414e-05
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.36070149316207e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.680350746581035e-06
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.8401753732905176e-06
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.200876866452588e-07
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.600438433226294e-07
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.300219216613147e-07
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.1501096083065735e-07
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.7505480415328675e-08
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.8752740207664337e-08
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.4376370103832169e-08
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.188185051916084e-09
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.594092525958042e-09
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.797046262979021e-09
EarlyStopping counter: 19 out of 100
Updating learning rate to 8.985231314895105e-10
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.4926156574475527e-10
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.2463078287237763e-10
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.1231539143618882e-10
EarlyStopping counter: 23 out of 100
Updating learning rate to 5.615769571809441e-11
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.8078847859047204e-11
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.4039423929523602e-11
EarlyStopping counter: 26 out of 100
Updating learning rate to 7.019711964761801e-12
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.5098559823809005e-12
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.7549279911904503e-12
EarlyStopping counter: 29 out of 100
Updating learning rate to 8.774639955952251e-13
EarlyStopping counter: 30 out of 100
Updating learning rate to 4.3873199779761257e-13
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.1936599889880628e-13
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.0968299944940314e-13
EarlyStopping counter: 33 out of 100
Updating learning rate to 5.484149972470157e-14
EarlyStopping counter: 34 out of 100
Updating learning rate to 2.7420749862350786e-14
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.3710374931175393e-14
EarlyStopping counter: 36 out of 100
Updating learning rate to 6.855187465587696e-15
EarlyStopping counter: 37 out of 100
Updating learning rate to 3.427593732793848e-15
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.713796866396924e-15
EarlyStopping counter: 39 out of 100
Updating learning rate to 8.56898433198462e-16
EarlyStopping counter: 40 out of 100
Updating learning rate to 4.28449216599231e-16
EarlyStopping counter: 41 out of 100
Updating learning rate to 2.142246082996155e-16
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.0711230414980776e-16
EarlyStopping counter: 43 out of 100
Updating learning rate to 5.355615207490388e-17
EarlyStopping counter: 44 out of 100
Updating learning rate to 2.677807603745194e-17
EarlyStopping counter: 45 out of 100
Updating learning rate to 1.338903801872597e-17
EarlyStopping counter: 46 out of 100
Updating learning rate to 6.694519009362985e-18
EarlyStopping counter: 47 out of 100
Updating learning rate to 3.3472595046814924e-18
EarlyStopping counter: 48 out of 100
Updating learning rate to 1.6736297523407462e-18
EarlyStopping counter: 49 out of 100
Updating learning rate to 8.368148761703731e-19
EarlyStopping counter: 50 out of 100
Updating learning rate to 4.1840743808518655e-19
EarlyStopping counter: 51 out of 100
Updating learning rate to 2.0920371904259327e-19
EarlyStopping counter: 52 out of 100
Updating learning rate to 1.0460185952129664e-19
EarlyStopping counter: 53 out of 100
Updating learning rate to 5.230092976064832e-20
EarlyStopping counter: 54 out of 100
Updating learning rate to 2.615046488032416e-20
EarlyStopping counter: 55 out of 100
Updating learning rate to 1.307523244016208e-20
EarlyStopping counter: 56 out of 100
Updating learning rate to 6.53761622008104e-21
EarlyStopping counter: 57 out of 100
Updating learning rate to 3.26880811004052e-21
EarlyStopping counter: 58 out of 100
Updating learning rate to 1.63440405502026e-21
EarlyStopping counter: 59 out of 100
Updating learning rate to 8.1720202751013e-22
EarlyStopping counter: 60 out of 100
Updating learning rate to 4.08601013755065e-22
EarlyStopping counter: 61 out of 100
Updating learning rate to 2.043005068775325e-22
EarlyStopping counter: 62 out of 100
Updating learning rate to 1.0215025343876625e-22
EarlyStopping counter: 63 out of 100
Updating learning rate to 5.1075126719383123e-23
EarlyStopping counter: 64 out of 100
Updating learning rate to 2.5537563359691562e-23
EarlyStopping counter: 65 out of 100
Updating learning rate to 1.2768781679845781e-23
EarlyStopping counter: 66 out of 100
Updating learning rate to 6.3843908399228904e-24
EarlyStopping counter: 67 out of 100
Updating learning rate to 3.1921954199614452e-24
EarlyStopping counter: 68 out of 100
Updating learning rate to 1.5960977099807226e-24
EarlyStopping counter: 69 out of 100
Updating learning rate to 7.980488549903613e-25
EarlyStopping counter: 70 out of 100
Updating learning rate to 3.9902442749518065e-25
EarlyStopping counter: 71 out of 100
Updating learning rate to 1.9951221374759033e-25
EarlyStopping counter: 72 out of 100
Updating learning rate to 9.975610687379516e-26
EarlyStopping counter: 73 out of 100
Updating learning rate to 4.987805343689758e-26
EarlyStopping counter: 74 out of 100
Updating learning rate to 2.493902671844879e-26
EarlyStopping counter: 75 out of 100
Updating learning rate to 1.2469513359224395e-26
EarlyStopping counter: 76 out of 100
Updating learning rate to 6.234756679612198e-27
EarlyStopping counter: 77 out of 100
Updating learning rate to 3.117378339806099e-27
EarlyStopping counter: 78 out of 100
Updating learning rate to 1.5586891699030494e-27
EarlyStopping counter: 79 out of 100
Updating learning rate to 7.793445849515247e-28
EarlyStopping counter: 80 out of 100
Updating learning rate to 3.8967229247576235e-28
EarlyStopping counter: 81 out of 100
Updating learning rate to 1.9483614623788118e-28
EarlyStopping counter: 82 out of 100
Updating learning rate to 9.741807311894059e-29
EarlyStopping counter: 83 out of 100
Updating learning rate to 4.8709036559470294e-29
EarlyStopping counter: 84 out of 100
Updating learning rate to 2.4354518279735147e-29
EarlyStopping counter: 85 out of 100
Updating learning rate to 1.2177259139867574e-29
EarlyStopping counter: 86 out of 100
Updating learning rate to 6.088629569933787e-30
EarlyStopping counter: 87 out of 100
Updating learning rate to 3.0443147849668934e-30
EarlyStopping counter: 88 out of 100
Updating learning rate to 1.5221573924834467e-30
EarlyStopping counter: 89 out of 100
Updating learning rate to 7.6107869624172335e-31
EarlyStopping counter: 90 out of 100
Updating learning rate to 3.8053934812086167e-31
EarlyStopping counter: 91 out of 100
Updating learning rate to 1.9026967406043084e-31
EarlyStopping counter: 92 out of 100
Updating learning rate to 9.513483703021542e-32
EarlyStopping counter: 93 out of 100
Updating learning rate to 4.756741851510771e-32
EarlyStopping counter: 94 out of 100
Updating learning rate to 2.3783709257553855e-32
EarlyStopping counter: 95 out of 100
Updating learning rate to 1.1891854628776927e-32
EarlyStopping counter: 96 out of 100
Updating learning rate to 5.945927314388464e-33
EarlyStopping counter: 97 out of 100
Updating learning rate to 2.972963657194232e-33
EarlyStopping counter: 98 out of 100
Updating learning rate to 1.486481828597116e-33
EarlyStopping counter: 99 out of 100
Updating learning rate to 7.43240914298558e-34
>>>>>> Testing on validation set: trial_18 >>>>>>
test 232
test shape: (232, 30, 5) (232, 30, 5)
test shape: (232, 30, 5) (232, 30, 5)


	mse:0.06986496597528458, mae:0.1160116121172905, dtw:Not calculated


                                                                                         [I 2025-10-17 00:44:46,110] Trial 18 finished with value: 0.1160116121172905 and parameters: {'seq_len': 96, 'pred_len': 30, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 64, 'learning_rate': 0.0004710848955623725, 'dropout': 0.005306650068196306}. Best is trial 15 with value: 0.07185053080320358.
Best trial: 15. Best value: 0.0718505:  36%|███▌      | 18/50 [51:39<1:14:11, 139.10s/it]Best trial: 15. Best value: 0.0718505:  36%|███▌      | 18/50 [51:39<1:14:11, 139.10s/it]Best trial: 15. Best value: 0.0718505:  38%|███▊      | 19/50 [51:39<1:00:42, 117.50s/it]
============================================================
Trial 19
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 2, d_layers: 2
batch_size: 32, lr: 0.000340
dropout: 0.04781195871539144
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_19 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.028552).  Saving model ...
Updating learning rate to 0.0003401768093112803
Validation loss decreased (0.028552 --> 0.026181).  Saving model ...
Updating learning rate to 0.00017008840465564015
Validation loss decreased (0.026181 --> 0.024106).  Saving model ...
Updating learning rate to 8.504420232782007e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.252210116391004e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.126105058195502e-05
Validation loss decreased (0.024106 --> 0.023737).  Saving model ...
Updating learning rate to 1.063052529097751e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.315262645488755e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.6576313227443773e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3288156613721887e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.644078306860943e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.3220391534304716e-07
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6610195767152358e-07
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.305097883576179e-08
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.1525489417880895e-08
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.0762744708940448e-08
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.0381372354470224e-08
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.190686177235112e-09
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.595343088617556e-09
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.297671544308778e-09
EarlyStopping counter: 14 out of 100
Updating learning rate to 6.48835772154389e-10
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.244178860771945e-10
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.6220894303859725e-10
EarlyStopping counter: 17 out of 100
Updating learning rate to 8.110447151929862e-11
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.055223575964931e-11
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.0276117879824656e-11
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.0138058939912328e-11
EarlyStopping counter: 21 out of 100
Updating learning rate to 5.069029469956164e-12
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.534514734978082e-12
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.267257367489041e-12
EarlyStopping counter: 24 out of 100
Updating learning rate to 6.336286837445205e-13
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.1681434187226025e-13
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.5840717093613012e-13
EarlyStopping counter: 27 out of 100
Updating learning rate to 7.920358546806506e-14
EarlyStopping counter: 28 out of 100
Updating learning rate to 3.960179273403253e-14
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.9800896367016266e-14
EarlyStopping counter: 30 out of 100
Updating learning rate to 9.900448183508133e-15
EarlyStopping counter: 31 out of 100
Updating learning rate to 4.9502240917540664e-15
EarlyStopping counter: 32 out of 100
Updating learning rate to 2.4751120458770332e-15
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.2375560229385166e-15
EarlyStopping counter: 34 out of 100
Updating learning rate to 6.187780114692583e-16
EarlyStopping counter: 35 out of 100
Updating learning rate to 3.0938900573462915e-16
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.5469450286731457e-16
EarlyStopping counter: 37 out of 100
Updating learning rate to 7.734725143365729e-17
EarlyStopping counter: 38 out of 100
Updating learning rate to 3.8673625716828644e-17
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.9336812858414322e-17
EarlyStopping counter: 40 out of 100
Updating learning rate to 9.668406429207161e-18
EarlyStopping counter: 41 out of 100
Updating learning rate to 4.8342032146035805e-18
EarlyStopping counter: 42 out of 100
Updating learning rate to 2.4171016073017902e-18
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.2085508036508951e-18
EarlyStopping counter: 44 out of 100
Updating learning rate to 6.042754018254476e-19
EarlyStopping counter: 45 out of 100
Updating learning rate to 3.021377009127238e-19
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.510688504563619e-19
EarlyStopping counter: 47 out of 100
Updating learning rate to 7.553442522818094e-20
EarlyStopping counter: 48 out of 100
Updating learning rate to 3.776721261409047e-20
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.8883606307045236e-20
EarlyStopping counter: 50 out of 100
Updating learning rate to 9.441803153522618e-21
EarlyStopping counter: 51 out of 100
Updating learning rate to 4.720901576761309e-21
EarlyStopping counter: 52 out of 100
Updating learning rate to 2.3604507883806545e-21
EarlyStopping counter: 53 out of 100
Updating learning rate to 1.1802253941903273e-21
EarlyStopping counter: 54 out of 100
Updating learning rate to 5.901126970951636e-22
EarlyStopping counter: 55 out of 100
Updating learning rate to 2.950563485475818e-22
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.475281742737909e-22
EarlyStopping counter: 57 out of 100
Updating learning rate to 7.376408713689545e-23
EarlyStopping counter: 58 out of 100
Updating learning rate to 3.6882043568447727e-23
EarlyStopping counter: 59 out of 100
Updating learning rate to 1.8441021784223863e-23
EarlyStopping counter: 60 out of 100
Updating learning rate to 9.220510892111932e-24
EarlyStopping counter: 61 out of 100
Updating learning rate to 4.610255446055966e-24
EarlyStopping counter: 62 out of 100
Updating learning rate to 2.305127723027983e-24
EarlyStopping counter: 63 out of 100
Updating learning rate to 1.1525638615139915e-24
EarlyStopping counter: 64 out of 100
Updating learning rate to 5.762819307569957e-25
EarlyStopping counter: 65 out of 100
Updating learning rate to 2.8814096537849787e-25
EarlyStopping counter: 66 out of 100
Updating learning rate to 1.4407048268924893e-25
EarlyStopping counter: 67 out of 100
Updating learning rate to 7.203524134462447e-26
EarlyStopping counter: 68 out of 100
Updating learning rate to 3.6017620672312233e-26
EarlyStopping counter: 69 out of 100
Updating learning rate to 1.8008810336156117e-26
EarlyStopping counter: 70 out of 100
Updating learning rate to 9.004405168078058e-27
EarlyStopping counter: 71 out of 100
Updating learning rate to 4.502202584039029e-27
EarlyStopping counter: 72 out of 100
Updating learning rate to 2.2511012920195146e-27
EarlyStopping counter: 73 out of 100
Updating learning rate to 1.1255506460097573e-27
EarlyStopping counter: 74 out of 100
Updating learning rate to 5.6277532300487865e-28
EarlyStopping counter: 75 out of 100
Updating learning rate to 2.8138766150243932e-28
EarlyStopping counter: 76 out of 100
Updating learning rate to 1.4069383075121966e-28
EarlyStopping counter: 77 out of 100
Updating learning rate to 7.034691537560983e-29
EarlyStopping counter: 78 out of 100
Updating learning rate to 3.5173457687804915e-29
EarlyStopping counter: 79 out of 100
Updating learning rate to 1.7586728843902458e-29
EarlyStopping counter: 80 out of 100
Updating learning rate to 8.793364421951229e-30
EarlyStopping counter: 81 out of 100
Updating learning rate to 4.3966822109756144e-30
EarlyStopping counter: 82 out of 100
Updating learning rate to 2.1983411054878072e-30
EarlyStopping counter: 83 out of 100
Updating learning rate to 1.0991705527439036e-30
EarlyStopping counter: 84 out of 100
Updating learning rate to 5.495852763719518e-31
EarlyStopping counter: 85 out of 100
Updating learning rate to 2.747926381859759e-31
EarlyStopping counter: 86 out of 100
Updating learning rate to 1.3739631909298795e-31
EarlyStopping counter: 87 out of 100
Updating learning rate to 6.869815954649398e-32
EarlyStopping counter: 88 out of 100
Updating learning rate to 3.434907977324699e-32
EarlyStopping counter: 89 out of 100
Updating learning rate to 1.7174539886623494e-32
EarlyStopping counter: 90 out of 100
Updating learning rate to 8.587269943311747e-33
EarlyStopping counter: 91 out of 100
Updating learning rate to 4.2936349716558735e-33
EarlyStopping counter: 92 out of 100
Updating learning rate to 2.1468174858279367e-33
EarlyStopping counter: 93 out of 100
Updating learning rate to 1.0734087429139684e-33
EarlyStopping counter: 94 out of 100
Updating learning rate to 5.367043714569842e-34
>>>>>> Testing on validation set: trial_19 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.05045585706830025, mae:0.07492248713970184, dtw:Not calculated


                                                                                         [I 2025-10-17 00:47:00,696] Trial 19 finished with value: 0.07492248713970184 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 2, 'd_model': 64, 'n_heads': 8, 'e_layers': 2, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0003401768093112803, 'dropout': 0.04781195871539144}. Best is trial 15 with value: 0.07185053080320358.
Best trial: 15. Best value: 0.0718505:  38%|███▊      | 19/50 [53:54<1:00:42, 117.50s/it]Best trial: 15. Best value: 0.0718505:  38%|███▊      | 19/50 [53:54<1:00:42, 117.50s/it]Best trial: 15. Best value: 0.0718505:  40%|████      | 20/50 [53:54<1:01:18, 122.63s/it]
============================================================
Trial 20
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000882
dropout: 0.08539809447773936
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_20 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.027691).  Saving model ...
Updating learning rate to 0.0008822231566799609
Validation loss decreased (0.027691 --> 0.024320).  Saving model ...
Updating learning rate to 0.00044111157833998045
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00022055578916999023
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.00011027789458499511
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.5138947292497556e-05
Validation loss decreased (0.024320 --> 0.024139).  Saving model ...
Updating learning rate to 2.7569473646248778e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3784736823124389e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.8923684115621945e-06
Validation loss decreased (0.024139 --> 0.024109).  Saving model ...
Updating learning rate to 3.4461842057810973e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.7230921028905486e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.615460514452743e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.3077302572263716e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.1538651286131858e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0769325643065929e-07
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.3846628215329645e-08
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.6923314107664822e-08
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3461657053832411e-08
Validation loss decreased (0.024109 --> 0.024079).  Saving model ...
Updating learning rate to 6.730828526916206e-09
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.365414263458103e-09
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6827071317290514e-09
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.413535658645257e-10
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.2067678293226285e-10
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.1033839146613143e-10
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.0516919573306571e-10
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.2584597866532856e-11
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.6292298933266428e-11
Validation loss decreased (0.024079 --> 0.023929).  Saving model ...
Updating learning rate to 1.3146149466633214e-11
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.573074733316607e-12
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.2865373666583035e-12
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6432686833291518e-12
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.216343416645759e-13
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.1081717083228794e-13
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0540858541614397e-13
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.0270429270807199e-13
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.135214635403599e-14
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.5676073177017996e-14
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.2838036588508998e-14
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.419018294254499e-15
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.2095091471272495e-15
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.6047545735636248e-15
EarlyStopping counter: 14 out of 100
Updating learning rate to 8.023772867818124e-16
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.011886433909062e-16
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.005943216954531e-16
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.0029716084772655e-16
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.0148580423863274e-17
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.5074290211931637e-17
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.2537145105965818e-17
EarlyStopping counter: 21 out of 100
Updating learning rate to 6.268572552982909e-18
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.1342862764914546e-18
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.5671431382457273e-18
EarlyStopping counter: 24 out of 100
Updating learning rate to 7.835715691228637e-19
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.9178578456143183e-19
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.9589289228071591e-19
EarlyStopping counter: 27 out of 100
Updating learning rate to 9.794644614035796e-20
EarlyStopping counter: 28 out of 100
Updating learning rate to 4.897322307017898e-20
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.448661153508949e-20
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.2243305767544745e-20
EarlyStopping counter: 31 out of 100
Updating learning rate to 6.121652883772372e-21
EarlyStopping counter: 32 out of 100
Updating learning rate to 3.060826441886186e-21
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.530413220943093e-21
EarlyStopping counter: 34 out of 100
Updating learning rate to 7.652066104715465e-22
EarlyStopping counter: 35 out of 100
Updating learning rate to 3.8260330523577327e-22
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.9130165261788663e-22
EarlyStopping counter: 37 out of 100
Updating learning rate to 9.565082630894332e-23
EarlyStopping counter: 38 out of 100
Updating learning rate to 4.782541315447166e-23
EarlyStopping counter: 39 out of 100
Updating learning rate to 2.391270657723583e-23
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.1956353288617915e-23
EarlyStopping counter: 41 out of 100
Updating learning rate to 5.978176644308957e-24
EarlyStopping counter: 42 out of 100
Updating learning rate to 2.9890883221544787e-24
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.4945441610772393e-24
EarlyStopping counter: 44 out of 100
Updating learning rate to 7.472720805386197e-25
EarlyStopping counter: 45 out of 100
Updating learning rate to 3.7363604026930983e-25
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.8681802013465492e-25
EarlyStopping counter: 47 out of 100
Updating learning rate to 9.340901006732746e-26
EarlyStopping counter: 48 out of 100
Updating learning rate to 4.670450503366373e-26
EarlyStopping counter: 49 out of 100
Updating learning rate to 2.3352252516831865e-26
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.1676126258415932e-26
EarlyStopping counter: 51 out of 100
Updating learning rate to 5.838063129207966e-27
EarlyStopping counter: 52 out of 100
Updating learning rate to 2.919031564603983e-27
EarlyStopping counter: 53 out of 100
Updating learning rate to 1.4595157823019915e-27
EarlyStopping counter: 54 out of 100
Updating learning rate to 7.297578911509958e-28
EarlyStopping counter: 55 out of 100
Updating learning rate to 3.648789455754979e-28
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.8243947278774894e-28
EarlyStopping counter: 57 out of 100
Updating learning rate to 9.121973639387447e-29
EarlyStopping counter: 58 out of 100
Updating learning rate to 4.5609868196937236e-29
EarlyStopping counter: 59 out of 100
Updating learning rate to 2.2804934098468618e-29
EarlyStopping counter: 60 out of 100
Updating learning rate to 1.1402467049234309e-29
EarlyStopping counter: 61 out of 100
Updating learning rate to 5.7012335246171544e-30
EarlyStopping counter: 62 out of 100
Updating learning rate to 2.8506167623085772e-30
EarlyStopping counter: 63 out of 100
Updating learning rate to 1.4253083811542886e-30
EarlyStopping counter: 64 out of 100
Updating learning rate to 7.126541905771443e-31
EarlyStopping counter: 65 out of 100
Updating learning rate to 3.5632709528857215e-31
EarlyStopping counter: 66 out of 100
Updating learning rate to 1.7816354764428608e-31
EarlyStopping counter: 67 out of 100
Updating learning rate to 8.908177382214304e-32
EarlyStopping counter: 68 out of 100
Updating learning rate to 4.454088691107152e-32
EarlyStopping counter: 69 out of 100
Updating learning rate to 2.227044345553576e-32
EarlyStopping counter: 70 out of 100
Updating learning rate to 1.113522172776788e-32
EarlyStopping counter: 71 out of 100
Updating learning rate to 5.56761086388394e-33
EarlyStopping counter: 72 out of 100
Updating learning rate to 2.78380543194197e-33
EarlyStopping counter: 73 out of 100
Updating learning rate to 1.391902715970985e-33
>>>>>> Testing on validation set: trial_20 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.050394799560308456, mae:0.07131966948509216, dtw:Not calculated


                                                                                         [I 2025-10-17 00:49:14,558] Trial 20 finished with value: 0.07131966948509216 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0008822231566799609, 'dropout': 0.08539809447773936}. Best is trial 20 with value: 0.07131966948509216.
Best trial: 15. Best value: 0.0718505:  40%|████      | 20/50 [56:08<1:01:18, 122.63s/it]Best trial: 20. Best value: 0.0713197:  40%|████      | 20/50 [56:08<1:01:18, 122.63s/it]Best trial: 20. Best value: 0.0713197:  42%|████▏     | 21/50 [56:08<1:00:53, 126.00s/it]
============================================================
Trial 21
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000914
dropout: 0.08280942500036988
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_21 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.026913).  Saving model ...
Updating learning rate to 0.0009136893599852512
Validation loss decreased (0.026913 --> 0.026099).  Saving model ...
Updating learning rate to 0.0004568446799926256
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0002284223399963128
Validation loss decreased (0.026099 --> 0.025268).  Saving model ...
Updating learning rate to 0.0001142111699981564
Validation loss decreased (0.025268 --> 0.025125).  Saving model ...
Updating learning rate to 5.71055849990782e-05
Validation loss decreased (0.025125 --> 0.024746).  Saving model ...
Updating learning rate to 2.85527924995391e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.427639624976955e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.138198124884775e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.5690990624423876e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.7845495312211938e-06
Validation loss decreased (0.024746 --> 0.024294).  Saving model ...
Updating learning rate to 8.922747656105969e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.4613738280529845e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2306869140264922e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1153434570132461e-07
Validation loss decreased (0.024294 --> 0.024114).  Saving model ...
Updating learning rate to 5.5767172850662306e-08
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7883586425331153e-08
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3941793212665576e-08
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.970896606332788e-09
Validation loss decreased (0.024114 --> 0.023968).  Saving model ...
Updating learning rate to 3.485448303166394e-09
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.742724151583197e-09
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.713620757915985e-10
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.3568103789579926e-10
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.1784051894789963e-10
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0892025947394982e-10
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.446012973697491e-11
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7230064868487454e-11
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3615032434243727e-11
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.8075162171218635e-12
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.4037581085609317e-12
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.7018790542804659e-12
EarlyStopping counter: 12 out of 100
Updating learning rate to 8.509395271402329e-13
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.2546976357011647e-13
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.1273488178505823e-13
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.0636744089252912e-13
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.318372044626456e-14
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.659186022313228e-14
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.329593011156614e-14
EarlyStopping counter: 19 out of 100
Updating learning rate to 6.64796505578307e-15
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.323982527891535e-15
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.6619912639457675e-15
EarlyStopping counter: 22 out of 100
Updating learning rate to 8.309956319728837e-16
Validation loss decreased (0.023968 --> 0.023803).  Saving model ...
Updating learning rate to 4.1549781598644186e-16
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0774890799322093e-16
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0387445399661047e-16
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.193722699830523e-17
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.5968613499152616e-17
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2984306749576308e-17
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.492153374788154e-18
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.246076687394077e-18
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6230383436970385e-18
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.115191718485193e-19
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.0575958592425963e-19
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.0287979296212982e-19
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.0143989648106491e-19
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.0719948240532454e-20
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.5359974120266227e-20
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.2679987060133113e-20
EarlyStopping counter: 16 out of 100
Updating learning rate to 6.339993530066557e-21
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.1699967650332784e-21
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.5849983825166392e-21
EarlyStopping counter: 19 out of 100
Updating learning rate to 7.924991912583196e-22
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.962495956291598e-22
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.981247978145799e-22
EarlyStopping counter: 22 out of 100
Updating learning rate to 9.906239890728995e-23
EarlyStopping counter: 23 out of 100
Updating learning rate to 4.9531199453644975e-23
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.4765599726822487e-23
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.2382799863411244e-23
EarlyStopping counter: 26 out of 100
Updating learning rate to 6.191399931705622e-24
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.095699965852811e-24
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.5478499829264055e-24
EarlyStopping counter: 29 out of 100
Updating learning rate to 7.739249914632027e-25
EarlyStopping counter: 30 out of 100
Updating learning rate to 3.8696249573160136e-25
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.9348124786580068e-25
EarlyStopping counter: 32 out of 100
Updating learning rate to 9.674062393290034e-26
EarlyStopping counter: 33 out of 100
Updating learning rate to 4.837031196645017e-26
EarlyStopping counter: 34 out of 100
Updating learning rate to 2.4185155983225085e-26
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.2092577991612543e-26
EarlyStopping counter: 36 out of 100
Updating learning rate to 6.046288995806271e-27
EarlyStopping counter: 37 out of 100
Updating learning rate to 3.0231444979031357e-27
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.5115722489515678e-27
EarlyStopping counter: 39 out of 100
Updating learning rate to 7.557861244757839e-28
EarlyStopping counter: 40 out of 100
Updating learning rate to 3.7789306223789196e-28
EarlyStopping counter: 41 out of 100
Updating learning rate to 1.8894653111894598e-28
EarlyStopping counter: 42 out of 100
Updating learning rate to 9.447326555947299e-29
EarlyStopping counter: 43 out of 100
Updating learning rate to 4.7236632779736495e-29
EarlyStopping counter: 44 out of 100
Updating learning rate to 2.3618316389868247e-29
EarlyStopping counter: 45 out of 100
Updating learning rate to 1.1809158194934124e-29
EarlyStopping counter: 46 out of 100
Updating learning rate to 5.904579097467062e-30
EarlyStopping counter: 47 out of 100
Updating learning rate to 2.952289548733531e-30
EarlyStopping counter: 48 out of 100
Updating learning rate to 1.4761447743667655e-30
EarlyStopping counter: 49 out of 100
Updating learning rate to 7.380723871833827e-31
EarlyStopping counter: 50 out of 100
Updating learning rate to 3.6903619359169136e-31
EarlyStopping counter: 51 out of 100
Updating learning rate to 1.8451809679584568e-31
EarlyStopping counter: 52 out of 100
Updating learning rate to 9.225904839792284e-32
EarlyStopping counter: 53 out of 100
Updating learning rate to 4.612952419896142e-32
EarlyStopping counter: 54 out of 100
Updating learning rate to 2.306476209948071e-32
EarlyStopping counter: 55 out of 100
Updating learning rate to 1.1532381049740355e-32
EarlyStopping counter: 56 out of 100
Updating learning rate to 5.7661905248701776e-33
EarlyStopping counter: 57 out of 100
Updating learning rate to 2.8830952624350888e-33
EarlyStopping counter: 58 out of 100
Updating learning rate to 1.4415476312175444e-33
>>>>>> Testing on validation set: trial_21 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.050429366528987885, mae:0.07200949639081955, dtw:Not calculated


                                                                                         [I 2025-10-17 00:51:28,368] Trial 21 finished with value: 0.07200949639081955 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0009136893599852512, 'dropout': 0.08280942500036988}. Best is trial 20 with value: 0.07131966948509216.
Best trial: 20. Best value: 0.0713197:  42%|████▏     | 21/50 [58:21<1:00:53, 126.00s/it]Best trial: 20. Best value: 0.0713197:  42%|████▏     | 21/50 [58:22<1:00:53, 126.00s/it]Best trial: 20. Best value: 0.0713197:  44%|████▍     | 22/50 [58:22<59:53, 128.34s/it]  
============================================================
Trial 22
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000994
dropout: 0.15515214803442648
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_22 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.030382).  Saving model ...
Updating learning rate to 0.0009936857530697864
Validation loss decreased (0.030382 --> 0.027484).  Saving model ...
Updating learning rate to 0.0004968428765348932
Validation loss decreased (0.027484 --> 0.024104).  Saving model ...
Updating learning rate to 0.0002484214382674466
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0001242107191337233
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.210535956686165e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.1052679783430826e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5526339891715413e-05
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.763169945857707e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.881584972928853e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.9407924864644267e-06
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.703962432322133e-07
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.851981216161067e-07
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.4259906080805333e-07
Validation loss decreased (0.024104 --> 0.024027).  Saving model ...
Updating learning rate to 1.2129953040402667e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.064976520201333e-08
Validation loss decreased (0.024027 --> 0.023907).  Saving model ...
Updating learning rate to 3.0324882601006666e-08
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5162441300503333e-08
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.581220650251667e-09
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.790610325125833e-09
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8953051625629167e-09
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.476525812814583e-10
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.738262906407292e-10
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.369131453203646e-10
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.184565726601823e-10
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.922828633009115e-11
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.961414316504557e-11
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.4807071582522786e-11
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.403535791261393e-12
Validation loss decreased (0.023907 --> 0.023793).  Saving model ...
Updating learning rate to 3.7017678956306966e-12
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8508839478153483e-12
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.254419739076741e-13
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.627209869538371e-13
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.3136049347691854e-13
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1568024673845927e-13
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.784012336922963e-14
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.892006168461482e-14
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.446003084230741e-14
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.230015421153704e-15
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.615007710576852e-15
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.807503855288426e-15
EarlyStopping counter: 12 out of 100
Updating learning rate to 9.03751927644213e-16
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.518759638221065e-16
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.2593798191105326e-16
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.1296899095552663e-16
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.648449547776331e-17
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.824224773888166e-17
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.412112386944083e-17
EarlyStopping counter: 19 out of 100
Updating learning rate to 7.060561934720414e-18
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.530280967360207e-18
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.7651404836801036e-18
EarlyStopping counter: 22 out of 100
Updating learning rate to 8.825702418400518e-19
EarlyStopping counter: 23 out of 100
Updating learning rate to 4.412851209200259e-19
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.2064256046001295e-19
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.1032128023000647e-19
EarlyStopping counter: 26 out of 100
Updating learning rate to 5.516064011500324e-20
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.758032005750162e-20
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.379016002875081e-20
EarlyStopping counter: 29 out of 100
Updating learning rate to 6.895080014375405e-21
EarlyStopping counter: 30 out of 100
Updating learning rate to 3.447540007187702e-21
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.723770003593851e-21
EarlyStopping counter: 32 out of 100
Updating learning rate to 8.618850017969256e-22
EarlyStopping counter: 33 out of 100
Updating learning rate to 4.309425008984628e-22
EarlyStopping counter: 34 out of 100
Updating learning rate to 2.154712504492314e-22
Validation loss decreased (0.023793 --> 0.023778).  Saving model ...
Updating learning rate to 1.077356252246157e-22
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.386781261230785e-23
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.6933906306153924e-23
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3466953153076962e-23
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.733476576538481e-24
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.3667382882692405e-24
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6833691441346203e-24
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.416845720673101e-25
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.208422860336551e-25
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.1042114301682753e-25
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.0521057150841377e-25
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.260528575420688e-26
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.630264287710344e-26
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.315132143855172e-26
EarlyStopping counter: 14 out of 100
Updating learning rate to 6.57566071927586e-27
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.28783035963793e-27
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.643915179818965e-27
EarlyStopping counter: 17 out of 100
Updating learning rate to 8.219575899094826e-28
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.109787949547413e-28
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.0548939747737064e-28
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.0274469873868532e-28
EarlyStopping counter: 21 out of 100
Updating learning rate to 5.137234936934266e-29
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.568617468467133e-29
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.2843087342335665e-29
EarlyStopping counter: 24 out of 100
Updating learning rate to 6.421543671167832e-30
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.210771835583916e-30
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.605385917791958e-30
EarlyStopping counter: 27 out of 100
Updating learning rate to 8.02692958895979e-31
EarlyStopping counter: 28 out of 100
Updating learning rate to 4.013464794479895e-31
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.0067323972399476e-31
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.0033661986199738e-31
EarlyStopping counter: 31 out of 100
Updating learning rate to 5.016830993099869e-32
EarlyStopping counter: 32 out of 100
Updating learning rate to 2.5084154965499345e-32
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.2542077482749673e-32
EarlyStopping counter: 34 out of 100
Updating learning rate to 6.271038741374836e-33
EarlyStopping counter: 35 out of 100
Updating learning rate to 3.135519370687418e-33
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.567759685343709e-33
>>>>>> Testing on validation set: trial_22 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.05042780563235283, mae:0.07472838461399078, dtw:Not calculated


                                                                                       [I 2025-10-17 00:53:41,669] Trial 22 finished with value: 0.07472838461399078 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0009936857530697864, 'dropout': 0.15515214803442648}. Best is trial 20 with value: 0.07131966948509216.
Best trial: 20. Best value: 0.0713197:  44%|████▍     | 22/50 [1:00:35<59:53, 128.34s/it]Best trial: 20. Best value: 0.0713197:  44%|████▍     | 22/50 [1:00:35<59:53, 128.34s/it]Best trial: 20. Best value: 0.0713197:  46%|████▌     | 23/50 [1:00:35<58:25, 129.83s/it]
============================================================
Trial 23
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000637
dropout: 0.03238618128034859
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_23 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.029882).  Saving model ...
Updating learning rate to 0.0006373467143026023
Validation loss decreased (0.029882 --> 0.025157).  Saving model ...
Updating learning rate to 0.00031867335715130116
Validation loss decreased (0.025157 --> 0.024383).  Saving model ...
Updating learning rate to 0.00015933667857565058
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.966833928782529e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.9834169643912645e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.9917084821956322e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.958542410978161e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.979271205489081e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.4896356027445403e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.2448178013722701e-06
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.224089006861351e-07
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.1120445034306754e-07
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.5560222517153377e-07
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.780111258576688e-08
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.890055629288344e-08
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.945027814644172e-08
EarlyStopping counter: 14 out of 100
Updating learning rate to 9.72513907322086e-09
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.86256953661043e-09
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.431284768305215e-09
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.2156423841526076e-09
EarlyStopping counter: 18 out of 100
Updating learning rate to 6.078211920763038e-10
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.039105960381519e-10
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.5195529801907595e-10
EarlyStopping counter: 21 out of 100
Updating learning rate to 7.597764900953797e-11
Validation loss decreased (0.024383 --> 0.024147).  Saving model ...
Updating learning rate to 3.7988824504768986e-11
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8994412252384493e-11
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.497206126192247e-12
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.748603063096123e-12
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.3743015315480617e-12
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1871507657740308e-12
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.935753828870154e-13
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.967876914435077e-13
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.4839384572175385e-13
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.419692286087693e-14
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.7098461430438463e-14
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.8549230715219232e-14
EarlyStopping counter: 12 out of 100
Updating learning rate to 9.274615357609616e-15
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.637307678804808e-15
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.318653839402404e-15
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.159326919701202e-15
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.79663459850601e-16
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.898317299253005e-16
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.4491586496265025e-16
EarlyStopping counter: 19 out of 100
Updating learning rate to 7.245793248132512e-17
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.622896624066256e-17
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.811448312033128e-17
EarlyStopping counter: 22 out of 100
Updating learning rate to 9.05724156016564e-18
EarlyStopping counter: 23 out of 100
Updating learning rate to 4.52862078008282e-18
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.26431039004141e-18
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.132155195020705e-18
EarlyStopping counter: 26 out of 100
Updating learning rate to 5.660775975103525e-19
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.8303879875517626e-19
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.4151939937758813e-19
EarlyStopping counter: 29 out of 100
Updating learning rate to 7.075969968879407e-20
EarlyStopping counter: 30 out of 100
Updating learning rate to 3.5379849844397033e-20
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.7689924922198517e-20
EarlyStopping counter: 32 out of 100
Updating learning rate to 8.844962461099258e-21
Validation loss decreased (0.024147 --> 0.024142).  Saving model ...
Updating learning rate to 4.422481230549629e-21
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2112406152748146e-21
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1056203076374073e-21
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.528101538187036e-22
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.764050769093518e-22
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.382025384546759e-22
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.910126922733796e-23
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.455063461366898e-23
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.727531730683449e-23
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.637658653417244e-24
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.318829326708622e-24
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.159414663354311e-24
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.0797073316771556e-24
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.398536658385778e-25
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.699268329192889e-25
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.3496341645964444e-25
EarlyStopping counter: 16 out of 100
Updating learning rate to 6.748170822982222e-26
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.374085411491111e-26
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.6870427057455555e-26
EarlyStopping counter: 19 out of 100
Updating learning rate to 8.435213528727778e-27
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.217606764363889e-27
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.1088033821819444e-27
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.0544016910909722e-27
EarlyStopping counter: 23 out of 100
Updating learning rate to 5.272008455454861e-28
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.6360042277274305e-28
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.3180021138637153e-28
EarlyStopping counter: 26 out of 100
Updating learning rate to 6.590010569318576e-29
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.295005284659288e-29
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.647502642329644e-29
EarlyStopping counter: 29 out of 100
Updating learning rate to 8.23751321164822e-30
EarlyStopping counter: 30 out of 100
Updating learning rate to 4.11875660582411e-30
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.059378302912055e-30
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.0296891514560276e-30
EarlyStopping counter: 33 out of 100
Updating learning rate to 5.148445757280138e-31
EarlyStopping counter: 34 out of 100
Updating learning rate to 2.574222878640069e-31
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.2871114393200344e-31
EarlyStopping counter: 36 out of 100
Updating learning rate to 6.435557196600172e-32
EarlyStopping counter: 37 out of 100
Updating learning rate to 3.217778598300086e-32
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.608889299150043e-32
EarlyStopping counter: 39 out of 100
Updating learning rate to 8.044446495750215e-33
EarlyStopping counter: 40 out of 100
Updating learning rate to 4.0222232478751076e-33
EarlyStopping counter: 41 out of 100
Updating learning rate to 2.0111116239375538e-33
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.0055558119687769e-33
>>>>>> Testing on validation set: trial_23 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.049322709441185, mae:0.07065031677484512, dtw:Not calculated


                                                                                         [I 2025-10-17 00:55:54,848] Trial 23 finished with value: 0.07065031677484512 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0006373467143026023, 'dropout': 0.03238618128034859}. Best is trial 23 with value: 0.07065031677484512.
Best trial: 20. Best value: 0.0713197:  46%|████▌     | 23/50 [1:02:48<58:25, 129.83s/it]Best trial: 23. Best value: 0.0706503:  46%|████▌     | 23/50 [1:02:48<58:25, 129.83s/it]Best trial: 23. Best value: 0.0706503:  48%|████▊     | 24/50 [1:02:48<56:41, 130.84s/it]
============================================================
Trial 24
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000604
dropout: 0.03008964003055695
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_24 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.025549).  Saving model ...
Updating learning rate to 0.0006042788564885416
Validation loss decreased (0.025549 --> 0.023863).  Saving model ...
Updating learning rate to 0.0003021394282442708
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0001510697141221354
Validation loss decreased (0.023863 --> 0.023789).  Saving model ...
Updating learning rate to 7.55348570610677e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.776742853053385e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8883714265266926e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.441857132633463e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.7209285663167315e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.3604642831583658e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1802321415791829e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.901160707895914e-07
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.950580353947957e-07
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4752901769739786e-07
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.376450884869893e-08
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.6882254424349465e-08
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.8441127212174732e-08
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.220563606087366e-09
Validation loss decreased (0.023789 --> 0.023624).  Saving model ...
Updating learning rate to 4.610281803043683e-09
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.3051409015218416e-09
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1525704507609208e-09
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.762852253804604e-10
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.881426126902302e-10
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.440713063451151e-10
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.203565317255755e-11
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.6017826586278774e-11
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.8008913293139387e-11
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.004456646569694e-12
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.502228323284847e-12
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.2511141616424234e-12
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.1255570808212117e-12
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.627785404106058e-13
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.813892702053029e-13
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.4069463510265146e-13
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.034731755132573e-14
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.5173658775662866e-14
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.7586829387831433e-14
EarlyStopping counter: 19 out of 100
Updating learning rate to 8.793414693915716e-15
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.396707346957858e-15
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.198353673478929e-15
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.0991768367394645e-15
EarlyStopping counter: 23 out of 100
Updating learning rate to 5.495884183697323e-16
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.7479420918486614e-16
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.3739710459243307e-16
EarlyStopping counter: 26 out of 100
Updating learning rate to 6.869855229621653e-17
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.434927614810827e-17
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.7174638074054134e-17
EarlyStopping counter: 29 out of 100
Updating learning rate to 8.587319037027067e-18
EarlyStopping counter: 30 out of 100
Updating learning rate to 4.2936595185135334e-18
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.1468297592567667e-18
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.0734148796283833e-18
EarlyStopping counter: 33 out of 100
Updating learning rate to 5.367074398141917e-19
EarlyStopping counter: 34 out of 100
Updating learning rate to 2.6835371990709584e-19
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.3417685995354792e-19
EarlyStopping counter: 36 out of 100
Updating learning rate to 6.708842997677396e-20
EarlyStopping counter: 37 out of 100
Updating learning rate to 3.354421498838698e-20
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.677210749419349e-20
EarlyStopping counter: 39 out of 100
Updating learning rate to 8.386053747096745e-21
EarlyStopping counter: 40 out of 100
Updating learning rate to 4.1930268735483725e-21
EarlyStopping counter: 41 out of 100
Updating learning rate to 2.0965134367741862e-21
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.0482567183870931e-21
EarlyStopping counter: 43 out of 100
Updating learning rate to 5.241283591935466e-22
EarlyStopping counter: 44 out of 100
Updating learning rate to 2.620641795967733e-22
EarlyStopping counter: 45 out of 100
Updating learning rate to 1.3103208979838664e-22
EarlyStopping counter: 46 out of 100
Updating learning rate to 6.551604489919332e-23
EarlyStopping counter: 47 out of 100
Updating learning rate to 3.275802244959666e-23
EarlyStopping counter: 48 out of 100
Updating learning rate to 1.637901122479833e-23
EarlyStopping counter: 49 out of 100
Updating learning rate to 8.189505612399165e-24
EarlyStopping counter: 50 out of 100
Updating learning rate to 4.0947528061995825e-24
EarlyStopping counter: 51 out of 100
Updating learning rate to 2.0473764030997912e-24
EarlyStopping counter: 52 out of 100
Updating learning rate to 1.0236882015498956e-24
EarlyStopping counter: 53 out of 100
Updating learning rate to 5.118441007749478e-25
EarlyStopping counter: 54 out of 100
Updating learning rate to 2.559220503874739e-25
EarlyStopping counter: 55 out of 100
Updating learning rate to 1.2796102519373695e-25
EarlyStopping counter: 56 out of 100
Updating learning rate to 6.398051259686848e-26
EarlyStopping counter: 57 out of 100
Updating learning rate to 3.199025629843424e-26
EarlyStopping counter: 58 out of 100
Updating learning rate to 1.599512814921712e-26
EarlyStopping counter: 59 out of 100
Updating learning rate to 7.99756407460856e-27
EarlyStopping counter: 60 out of 100
Updating learning rate to 3.99878203730428e-27
EarlyStopping counter: 61 out of 100
Updating learning rate to 1.99939101865214e-27
EarlyStopping counter: 62 out of 100
Updating learning rate to 9.9969550932607e-28
EarlyStopping counter: 63 out of 100
Updating learning rate to 4.99847754663035e-28
EarlyStopping counter: 64 out of 100
Updating learning rate to 2.499238773315175e-28
EarlyStopping counter: 65 out of 100
Updating learning rate to 1.2496193866575874e-28
EarlyStopping counter: 66 out of 100
Updating learning rate to 6.248096933287937e-29
EarlyStopping counter: 67 out of 100
Updating learning rate to 3.1240484666439686e-29
EarlyStopping counter: 68 out of 100
Updating learning rate to 1.5620242333219843e-29
EarlyStopping counter: 69 out of 100
Updating learning rate to 7.810121166609921e-30
EarlyStopping counter: 70 out of 100
Updating learning rate to 3.905060583304961e-30
EarlyStopping counter: 71 out of 100
Updating learning rate to 1.9525302916524804e-30
EarlyStopping counter: 72 out of 100
Updating learning rate to 9.762651458262402e-31
EarlyStopping counter: 73 out of 100
Updating learning rate to 4.881325729131201e-31
EarlyStopping counter: 74 out of 100
Updating learning rate to 2.4406628645656004e-31
EarlyStopping counter: 75 out of 100
Updating learning rate to 1.2203314322828002e-31
EarlyStopping counter: 76 out of 100
Updating learning rate to 6.101657161414001e-32
EarlyStopping counter: 77 out of 100
Updating learning rate to 3.0508285807070005e-32
EarlyStopping counter: 78 out of 100
Updating learning rate to 1.5254142903535003e-32
EarlyStopping counter: 79 out of 100
Updating learning rate to 7.627071451767501e-33
EarlyStopping counter: 80 out of 100
Updating learning rate to 3.813535725883751e-33
EarlyStopping counter: 81 out of 100
Updating learning rate to 1.9067678629418753e-33
EarlyStopping counter: 82 out of 100
Updating learning rate to 9.533839314709377e-34
>>>>>> Testing on validation set: trial_24 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.049646392464637756, mae:0.07197979837656021, dtw:Not calculated


                                                                                         [I 2025-10-17 00:58:08,198] Trial 24 finished with value: 0.07197979837656021 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0006042788564885416, 'dropout': 0.03008964003055695}. Best is trial 23 with value: 0.07065031677484512.
Best trial: 23. Best value: 0.0706503:  48%|████▊     | 24/50 [1:05:01<56:41, 130.84s/it]Best trial: 23. Best value: 0.0706503:  48%|████▊     | 24/50 [1:05:01<56:41, 130.84s/it]Best trial: 23. Best value: 0.0706503:  50%|█████     | 25/50 [1:05:01<54:49, 131.59s/it]
============================================================
Trial 25
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 64, lr: 0.000422
dropout: 0.032417419516982106
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_25 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.024152).  Saving model ...
Updating learning rate to 0.0004220791581354528
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0002110395790677264
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.0001055197895338632
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.27598947669316e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.63799473834658e-05
Validation loss decreased (0.024152 --> 0.022070).  Saving model ...
Updating learning rate to 1.31899736917329e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.59498684586645e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.297493422933225e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6487467114666126e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.243733557333063e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.1218667786665315e-07
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0609333893332657e-07
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.0304666946666329e-07
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.152333473333164e-08
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.576166736666582e-08
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.288083368333291e-08
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.440416841666455e-09
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.2202084208332277e-09
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.6101042104166138e-09
Validation loss decreased (0.022070 --> 0.021698).  Saving model ...
Updating learning rate to 8.050521052083069e-10
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.0252605260415346e-10
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0126302630207673e-10
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0063151315103837e-10
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.031575657551918e-11
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.515787828775959e-11
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.2578939143879796e-11
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.289469571939898e-12
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.144734785969949e-12
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.5723673929849745e-12
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.861836964924872e-13
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.930918482462436e-13
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.965459241231218e-13
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.82729620615609e-14
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.913648103078045e-14
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.4568240515390226e-14
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.2284120257695113e-14
EarlyStopping counter: 17 out of 100
Updating learning rate to 6.1420601288475565e-15
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.0710300644237782e-15
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.5355150322118891e-15
EarlyStopping counter: 20 out of 100
Updating learning rate to 7.677575161059446e-16
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.838787580529723e-16
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.9193937902648614e-16
EarlyStopping counter: 23 out of 100
Updating learning rate to 9.596968951324307e-17
EarlyStopping counter: 24 out of 100
Updating learning rate to 4.7984844756621535e-17
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.3992422378310768e-17
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.1996211189155384e-17
EarlyStopping counter: 27 out of 100
Updating learning rate to 5.998105594577692e-18
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.999052797288846e-18
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.499526398644423e-18
EarlyStopping counter: 30 out of 100
Updating learning rate to 7.497631993222115e-19
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.7488159966110574e-19
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.8744079983055287e-19
EarlyStopping counter: 33 out of 100
Updating learning rate to 9.372039991527644e-20
EarlyStopping counter: 34 out of 100
Updating learning rate to 4.686019995763822e-20
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.343009997881911e-20
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.1715049989409554e-20
EarlyStopping counter: 37 out of 100
Updating learning rate to 5.857524994704777e-21
EarlyStopping counter: 38 out of 100
Updating learning rate to 2.9287624973523886e-21
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.4643812486761943e-21
EarlyStopping counter: 40 out of 100
Updating learning rate to 7.321906243380972e-22
EarlyStopping counter: 41 out of 100
Updating learning rate to 3.660953121690486e-22
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.830476560845243e-22
EarlyStopping counter: 43 out of 100
Updating learning rate to 9.152382804226214e-23
EarlyStopping counter: 44 out of 100
Updating learning rate to 4.576191402113107e-23
EarlyStopping counter: 45 out of 100
Updating learning rate to 2.2880957010565536e-23
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.1440478505282768e-23
EarlyStopping counter: 47 out of 100
Updating learning rate to 5.720239252641384e-24
EarlyStopping counter: 48 out of 100
Updating learning rate to 2.860119626320692e-24
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.430059813160346e-24
EarlyStopping counter: 50 out of 100
Updating learning rate to 7.15029906580173e-25
EarlyStopping counter: 51 out of 100
Updating learning rate to 3.575149532900865e-25
EarlyStopping counter: 52 out of 100
Updating learning rate to 1.7875747664504325e-25
EarlyStopping counter: 53 out of 100
Updating learning rate to 8.937873832252163e-26
EarlyStopping counter: 54 out of 100
Updating learning rate to 4.468936916126081e-26
EarlyStopping counter: 55 out of 100
Updating learning rate to 2.2344684580630406e-26
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.1172342290315203e-26
EarlyStopping counter: 57 out of 100
Updating learning rate to 5.5861711451576016e-27
EarlyStopping counter: 58 out of 100
Updating learning rate to 2.7930855725788008e-27
EarlyStopping counter: 59 out of 100
Updating learning rate to 1.3965427862894004e-27
EarlyStopping counter: 60 out of 100
Updating learning rate to 6.982713931447002e-28
EarlyStopping counter: 61 out of 100
Updating learning rate to 3.491356965723501e-28
EarlyStopping counter: 62 out of 100
Updating learning rate to 1.7456784828617505e-28
EarlyStopping counter: 63 out of 100
Updating learning rate to 8.728392414308752e-29
EarlyStopping counter: 64 out of 100
Updating learning rate to 4.364196207154376e-29
EarlyStopping counter: 65 out of 100
Updating learning rate to 2.182098103577188e-29
EarlyStopping counter: 66 out of 100
Updating learning rate to 1.091049051788594e-29
EarlyStopping counter: 67 out of 100
Updating learning rate to 5.45524525894297e-30
EarlyStopping counter: 68 out of 100
Updating learning rate to 2.727622629471485e-30
EarlyStopping counter: 69 out of 100
Updating learning rate to 1.3638113147357426e-30
EarlyStopping counter: 70 out of 100
Updating learning rate to 6.819056573678713e-31
EarlyStopping counter: 71 out of 100
Updating learning rate to 3.4095282868393564e-31
EarlyStopping counter: 72 out of 100
Updating learning rate to 1.7047641434196782e-31
EarlyStopping counter: 73 out of 100
Updating learning rate to 8.523820717098391e-32
EarlyStopping counter: 74 out of 100
Updating learning rate to 4.2619103585491955e-32
EarlyStopping counter: 75 out of 100
Updating learning rate to 2.1309551792745978e-32
EarlyStopping counter: 76 out of 100
Updating learning rate to 1.0654775896372989e-32
EarlyStopping counter: 77 out of 100
Updating learning rate to 5.3273879481864944e-33
EarlyStopping counter: 78 out of 100
Updating learning rate to 2.6636939740932472e-33
EarlyStopping counter: 79 out of 100
Updating learning rate to 1.3318469870466236e-33
EarlyStopping counter: 80 out of 100
Updating learning rate to 6.659234935233118e-34
>>>>>> Testing on validation set: trial_25 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.04966514930129051, mae:0.07470148056745529, dtw:Not calculated


                                                                                         [I 2025-10-17 00:59:17,193] Trial 25 finished with value: 0.07470148056745529 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 64, 'learning_rate': 0.0004220791581354528, 'dropout': 0.032417419516982106}. Best is trial 23 with value: 0.07065031677484512.
Best trial: 23. Best value: 0.0706503:  50%|█████     | 25/50 [1:06:10<54:49, 131.59s/it]Best trial: 23. Best value: 0.0706503:  50%|█████     | 25/50 [1:06:10<54:49, 131.59s/it]Best trial: 23. Best value: 0.0706503:  52%|█████▏    | 26/50 [1:06:10<45:07, 112.81s/it]
============================================================
Trial 26
============================================================
seq_len: 48, pred_len: 14
d_model: 64, n_heads: 8
e_layers: 2, d_layers: 2
batch_size: 32, lr: 0.000195
dropout: 0.10272119209193098
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_26 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 14
============================================================
train 4612
val 246
test 248
Validation loss decreased (inf --> 0.039518).  Saving model ...
Updating learning rate to 0.0001950405045490417
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.752025227452085e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.876012613726043e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.4380063068630214e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2190031534315107e-05
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.0950157671575534e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.0475078835787767e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.5237539417893884e-06
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.618769708946942e-07
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.809384854473471e-07
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.9046924272367354e-07
EarlyStopping counter: 11 out of 100
Updating learning rate to 9.523462136183677e-08
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.7617310680918386e-08
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.3808655340459193e-08
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.1904327670229597e-08
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.952163835114798e-09
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.976081917557399e-09
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.4880409587786996e-09
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.440204793893498e-10
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.720102396946749e-10
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.8600511984733745e-10
EarlyStopping counter: 21 out of 100
Updating learning rate to 9.300255992366872e-11
EarlyStopping counter: 22 out of 100
Updating learning rate to 4.650127996183436e-11
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.325063998091718e-11
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.162531999045859e-11
EarlyStopping counter: 25 out of 100
Updating learning rate to 5.812659995229295e-12
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.9063299976146476e-12
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.4531649988073238e-12
EarlyStopping counter: 28 out of 100
Updating learning rate to 7.265824994036619e-13
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.6329124970183095e-13
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.8164562485091547e-13
EarlyStopping counter: 31 out of 100
Updating learning rate to 9.082281242545774e-14
EarlyStopping counter: 32 out of 100
Updating learning rate to 4.541140621272887e-14
EarlyStopping counter: 33 out of 100
Updating learning rate to 2.2705703106364434e-14
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.1352851553182217e-14
EarlyStopping counter: 35 out of 100
Updating learning rate to 5.6764257765911086e-15
EarlyStopping counter: 36 out of 100
Updating learning rate to 2.8382128882955543e-15
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.4191064441477771e-15
EarlyStopping counter: 38 out of 100
Updating learning rate to 7.095532220738886e-16
EarlyStopping counter: 39 out of 100
Updating learning rate to 3.547766110369443e-16
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.7738830551847214e-16
EarlyStopping counter: 41 out of 100
Updating learning rate to 8.869415275923607e-17
EarlyStopping counter: 42 out of 100
Updating learning rate to 4.4347076379618036e-17
EarlyStopping counter: 43 out of 100
Updating learning rate to 2.2173538189809018e-17
EarlyStopping counter: 44 out of 100
Updating learning rate to 1.1086769094904509e-17
EarlyStopping counter: 45 out of 100
Updating learning rate to 5.5433845474522545e-18
EarlyStopping counter: 46 out of 100
Updating learning rate to 2.7716922737261272e-18
EarlyStopping counter: 47 out of 100
Updating learning rate to 1.3858461368630636e-18
EarlyStopping counter: 48 out of 100
Updating learning rate to 6.929230684315318e-19
EarlyStopping counter: 49 out of 100
Updating learning rate to 3.464615342157659e-19
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.7323076710788295e-19
EarlyStopping counter: 51 out of 100
Updating learning rate to 8.661538355394148e-20
EarlyStopping counter: 52 out of 100
Updating learning rate to 4.330769177697074e-20
EarlyStopping counter: 53 out of 100
Updating learning rate to 2.165384588848537e-20
EarlyStopping counter: 54 out of 100
Updating learning rate to 1.0826922944242685e-20
EarlyStopping counter: 55 out of 100
Updating learning rate to 5.413461472121342e-21
EarlyStopping counter: 56 out of 100
Updating learning rate to 2.706730736060671e-21
EarlyStopping counter: 57 out of 100
Updating learning rate to 1.3533653680303356e-21
EarlyStopping counter: 58 out of 100
Updating learning rate to 6.766826840151678e-22
EarlyStopping counter: 59 out of 100
Updating learning rate to 3.383413420075839e-22
EarlyStopping counter: 60 out of 100
Updating learning rate to 1.6917067100379195e-22
EarlyStopping counter: 61 out of 100
Updating learning rate to 8.458533550189597e-23
EarlyStopping counter: 62 out of 100
Updating learning rate to 4.2292667750947986e-23
EarlyStopping counter: 63 out of 100
Updating learning rate to 2.1146333875473993e-23
EarlyStopping counter: 64 out of 100
Updating learning rate to 1.0573166937736997e-23
EarlyStopping counter: 65 out of 100
Updating learning rate to 5.286583468868498e-24
EarlyStopping counter: 66 out of 100
Updating learning rate to 2.643291734434249e-24
EarlyStopping counter: 67 out of 100
Updating learning rate to 1.3216458672171246e-24
EarlyStopping counter: 68 out of 100
Updating learning rate to 6.608229336085623e-25
EarlyStopping counter: 69 out of 100
Updating learning rate to 3.3041146680428114e-25
EarlyStopping counter: 70 out of 100
Updating learning rate to 1.6520573340214057e-25
EarlyStopping counter: 71 out of 100
Updating learning rate to 8.260286670107029e-26
EarlyStopping counter: 72 out of 100
Updating learning rate to 4.1301433350535143e-26
EarlyStopping counter: 73 out of 100
Updating learning rate to 2.0650716675267571e-26
EarlyStopping counter: 74 out of 100
Updating learning rate to 1.0325358337633786e-26
EarlyStopping counter: 75 out of 100
Updating learning rate to 5.162679168816893e-27
EarlyStopping counter: 76 out of 100
Updating learning rate to 2.5813395844084464e-27
EarlyStopping counter: 77 out of 100
Updating learning rate to 1.2906697922042232e-27
EarlyStopping counter: 78 out of 100
Updating learning rate to 6.453348961021116e-28
EarlyStopping counter: 79 out of 100
Updating learning rate to 3.226674480510558e-28
EarlyStopping counter: 80 out of 100
Updating learning rate to 1.613337240255279e-28
EarlyStopping counter: 81 out of 100
Updating learning rate to 8.066686201276395e-29
EarlyStopping counter: 82 out of 100
Updating learning rate to 4.0333431006381976e-29
EarlyStopping counter: 83 out of 100
Updating learning rate to 2.0166715503190988e-29
EarlyStopping counter: 84 out of 100
Updating learning rate to 1.0083357751595494e-29
EarlyStopping counter: 85 out of 100
Updating learning rate to 5.041678875797747e-30
EarlyStopping counter: 86 out of 100
Updating learning rate to 2.5208394378988735e-30
EarlyStopping counter: 87 out of 100
Updating learning rate to 1.2604197189494367e-30
EarlyStopping counter: 88 out of 100
Updating learning rate to 6.302098594747184e-31
EarlyStopping counter: 89 out of 100
Updating learning rate to 3.151049297373592e-31
EarlyStopping counter: 90 out of 100
Updating learning rate to 1.575524648686796e-31
EarlyStopping counter: 91 out of 100
Updating learning rate to 7.87762324343398e-32
EarlyStopping counter: 92 out of 100
Updating learning rate to 3.93881162171699e-32
EarlyStopping counter: 93 out of 100
Updating learning rate to 1.969405810858495e-32
EarlyStopping counter: 94 out of 100
Updating learning rate to 9.847029054292474e-33
EarlyStopping counter: 95 out of 100
Updating learning rate to 4.923514527146237e-33
EarlyStopping counter: 96 out of 100
Updating learning rate to 2.4617572635731186e-33
EarlyStopping counter: 97 out of 100
Updating learning rate to 1.2308786317865593e-33
EarlyStopping counter: 98 out of 100
Updating learning rate to 6.1543931589327966e-34
EarlyStopping counter: 99 out of 100
Updating learning rate to 3.0771965794663983e-34
>>>>>> Testing on validation set: trial_26 >>>>>>
test 248
test shape: (248, 14, 5) (248, 14, 5)
test shape: (248, 14, 5) (248, 14, 5)


	mse:0.065738745033741, mae:0.09951169788837433, dtw:Not calculated


                                                                                         [I 2025-10-17 01:01:31,457] Trial 26 finished with value: 0.09951169788837433 and parameters: {'seq_len': 48, 'pred_len': 14, 'expand': 2, 'd_model': 64, 'n_heads': 8, 'e_layers': 2, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0001950405045490417, 'dropout': 0.10272119209193098}. Best is trial 23 with value: 0.07065031677484512.
Best trial: 23. Best value: 0.0706503:  52%|█████▏    | 26/50 [1:08:25<45:07, 112.81s/it]Best trial: 23. Best value: 0.0706503:  52%|█████▏    | 26/50 [1:08:25<45:07, 112.81s/it]Best trial: 23. Best value: 0.0706503:  54%|█████▍    | 27/50 [1:08:25<45:42, 119.25s/it]
============================================================
Trial 27
============================================================
seq_len: 96, pred_len: 7
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000710
dropout: 0.1376236007181679
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_27 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 7
============================================================
train 4571
val 253
test 255
Validation loss decreased (inf --> 0.037337).  Saving model ...
Updating learning rate to 0.0007099673275719134
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0003549836637859567
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.00017749183189297836
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.874591594648918e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.437295797324459e-05
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2186478986622295e-05
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1093239493311147e-05
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.546619746655574e-06
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.773309873327787e-06
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.3866549366638934e-06
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.933274683319467e-07
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.4666373416597335e-07
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.7333186708298668e-07
EarlyStopping counter: 13 out of 100
Updating learning rate to 8.666593354149334e-08
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.333296677074667e-08
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.1666483385373335e-08
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.0833241692686667e-08
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.416620846343334e-09
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.708310423171667e-09
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.3541552115858334e-09
EarlyStopping counter: 20 out of 100
Updating learning rate to 6.770776057929167e-10
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.3853880289645835e-10
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.6926940144822918e-10
EarlyStopping counter: 23 out of 100
Updating learning rate to 8.463470072411459e-11
EarlyStopping counter: 24 out of 100
Updating learning rate to 4.2317350362057294e-11
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.1158675181028647e-11
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.0579337590514324e-11
EarlyStopping counter: 27 out of 100
Updating learning rate to 5.289668795257162e-12
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.644834397628581e-12
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.3224171988142904e-12
EarlyStopping counter: 30 out of 100
Updating learning rate to 6.612085994071452e-13
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.306042997035726e-13
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.653021498517863e-13
EarlyStopping counter: 33 out of 100
Updating learning rate to 8.265107492589315e-14
EarlyStopping counter: 34 out of 100
Updating learning rate to 4.1325537462946576e-14
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.0662768731473288e-14
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.0331384365736644e-14
EarlyStopping counter: 37 out of 100
Updating learning rate to 5.165692182868322e-15
EarlyStopping counter: 38 out of 100
Updating learning rate to 2.582846091434161e-15
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.2914230457170805e-15
EarlyStopping counter: 40 out of 100
Updating learning rate to 6.457115228585403e-16
EarlyStopping counter: 41 out of 100
Updating learning rate to 3.2285576142927013e-16
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.6142788071463506e-16
EarlyStopping counter: 43 out of 100
Updating learning rate to 8.071394035731753e-17
EarlyStopping counter: 44 out of 100
Updating learning rate to 4.0356970178658766e-17
EarlyStopping counter: 45 out of 100
Updating learning rate to 2.0178485089329383e-17
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.0089242544664691e-17
EarlyStopping counter: 47 out of 100
Updating learning rate to 5.044621272332346e-18
EarlyStopping counter: 48 out of 100
Updating learning rate to 2.522310636166173e-18
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.2611553180830864e-18
EarlyStopping counter: 50 out of 100
Updating learning rate to 6.305776590415432e-19
EarlyStopping counter: 51 out of 100
Updating learning rate to 3.152888295207716e-19
EarlyStopping counter: 52 out of 100
Updating learning rate to 1.576444147603858e-19
EarlyStopping counter: 53 out of 100
Updating learning rate to 7.88222073801929e-20
EarlyStopping counter: 54 out of 100
Updating learning rate to 3.941110369009645e-20
EarlyStopping counter: 55 out of 100
Updating learning rate to 1.9705551845048226e-20
EarlyStopping counter: 56 out of 100
Updating learning rate to 9.852775922524113e-21
EarlyStopping counter: 57 out of 100
Updating learning rate to 4.9263879612620564e-21
EarlyStopping counter: 58 out of 100
Updating learning rate to 2.4631939806310282e-21
EarlyStopping counter: 59 out of 100
Updating learning rate to 1.2315969903155141e-21
EarlyStopping counter: 60 out of 100
Updating learning rate to 6.1579849515775705e-22
EarlyStopping counter: 61 out of 100
Updating learning rate to 3.0789924757887852e-22
EarlyStopping counter: 62 out of 100
Updating learning rate to 1.5394962378943926e-22
EarlyStopping counter: 63 out of 100
Updating learning rate to 7.697481189471963e-23
EarlyStopping counter: 64 out of 100
Updating learning rate to 3.8487405947359816e-23
EarlyStopping counter: 65 out of 100
Updating learning rate to 1.9243702973679908e-23
EarlyStopping counter: 66 out of 100
Updating learning rate to 9.621851486839954e-24
EarlyStopping counter: 67 out of 100
Updating learning rate to 4.810925743419977e-24
EarlyStopping counter: 68 out of 100
Updating learning rate to 2.4054628717099885e-24
EarlyStopping counter: 69 out of 100
Updating learning rate to 1.2027314358549942e-24
EarlyStopping counter: 70 out of 100
Updating learning rate to 6.013657179274971e-25
EarlyStopping counter: 71 out of 100
Updating learning rate to 3.0068285896374856e-25
EarlyStopping counter: 72 out of 100
Updating learning rate to 1.5034142948187428e-25
EarlyStopping counter: 73 out of 100
Updating learning rate to 7.517071474093714e-26
EarlyStopping counter: 74 out of 100
Updating learning rate to 3.758535737046857e-26
EarlyStopping counter: 75 out of 100
Updating learning rate to 1.8792678685234285e-26
EarlyStopping counter: 76 out of 100
Updating learning rate to 9.396339342617142e-27
EarlyStopping counter: 77 out of 100
Updating learning rate to 4.698169671308571e-27
EarlyStopping counter: 78 out of 100
Updating learning rate to 2.3490848356542856e-27
EarlyStopping counter: 79 out of 100
Updating learning rate to 1.1745424178271428e-27
EarlyStopping counter: 80 out of 100
Updating learning rate to 5.872712089135714e-28
EarlyStopping counter: 81 out of 100
Updating learning rate to 2.936356044567857e-28
EarlyStopping counter: 82 out of 100
Updating learning rate to 1.4681780222839285e-28
EarlyStopping counter: 83 out of 100
Updating learning rate to 7.340890111419643e-29
EarlyStopping counter: 84 out of 100
Updating learning rate to 3.6704450557098213e-29
EarlyStopping counter: 85 out of 100
Updating learning rate to 1.8352225278549106e-29
EarlyStopping counter: 86 out of 100
Updating learning rate to 9.176112639274553e-30
EarlyStopping counter: 87 out of 100
Updating learning rate to 4.5880563196372766e-30
EarlyStopping counter: 88 out of 100
Updating learning rate to 2.2940281598186383e-30
EarlyStopping counter: 89 out of 100
Updating learning rate to 1.1470140799093192e-30
EarlyStopping counter: 90 out of 100
Updating learning rate to 5.735070399546596e-31
EarlyStopping counter: 91 out of 100
Updating learning rate to 2.867535199773298e-31
EarlyStopping counter: 92 out of 100
Updating learning rate to 1.433767599886649e-31
EarlyStopping counter: 93 out of 100
Updating learning rate to 7.168837999433245e-32
EarlyStopping counter: 94 out of 100
Updating learning rate to 3.5844189997166223e-32
EarlyStopping counter: 95 out of 100
Updating learning rate to 1.7922094998583112e-32
EarlyStopping counter: 96 out of 100
Updating learning rate to 8.961047499291556e-33
EarlyStopping counter: 97 out of 100
Updating learning rate to 4.480523749645778e-33
EarlyStopping counter: 98 out of 100
Updating learning rate to 2.240261874822889e-33
EarlyStopping counter: 99 out of 100
Updating learning rate to 1.1201309374114445e-33
>>>>>> Testing on validation set: trial_27 >>>>>>
test 255
test shape: (255, 7, 5) (255, 7, 5)
test shape: (255, 7, 5) (255, 7, 5)


	mse:0.06670116633176804, mae:0.1022552102804184, dtw:Not calculated


                                                                                         [I 2025-10-17 01:03:43,225] Trial 27 finished with value: 0.1022552102804184 and parameters: {'seq_len': 96, 'pred_len': 7, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0007099673275719134, 'dropout': 0.1376236007181679}. Best is trial 23 with value: 0.07065031677484512.
Best trial: 23. Best value: 0.0706503:  54%|█████▍    | 27/50 [1:10:36<45:42, 119.25s/it]Best trial: 23. Best value: 0.0706503:  54%|█████▍    | 27/50 [1:10:36<45:42, 119.25s/it]Best trial: 23. Best value: 0.0706503:  56%|█████▌    | 28/50 [1:10:36<45:06, 123.00s/it]
============================================================
Trial 28
============================================================
seq_len: 48, pred_len: 30
d_model: 64, n_heads: 8
e_layers: 2, d_layers: 2
batch_size: 32, lr: 0.000442
dropout: 0.02865663495096578
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_28 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 30
============================================================
train 4596
val 230
test 232
Validation loss decreased (inf --> 0.038582).  Saving model ...
Updating learning rate to 0.0004424998339101134
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0002212499169550567
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.00011062495847752835
Validation loss decreased (0.038582 --> 0.038134).  Saving model ...
Updating learning rate to 5.531247923876417e-05
Validation loss decreased (0.038134 --> 0.038028).  Saving model ...
Updating learning rate to 2.7656239619382087e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3828119809691043e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.914059904845522e-06
Validation loss decreased (0.038028 --> 0.036992).  Saving model ...
Updating learning rate to 3.457029952422761e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.7285149762113804e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.642574881056902e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.321287440528451e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.1606437202642255e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0803218601321128e-07
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.401609300660564e-08
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.700804650330282e-08
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.350402325165141e-08
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.752011625825705e-09
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.3760058129128524e-09
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.6880029064564262e-09
EarlyStopping counter: 12 out of 100
Updating learning rate to 8.440014532282131e-10
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.2200072661410655e-10
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.1100036330705327e-10
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.0550018165352664e-10
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.275009082676332e-11
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.637504541338166e-11
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.318752270669083e-11
EarlyStopping counter: 19 out of 100
Updating learning rate to 6.593761353345415e-12
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.2968806766727074e-12
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.6484403383363537e-12
EarlyStopping counter: 22 out of 100
Updating learning rate to 8.242201691681768e-13
EarlyStopping counter: 23 out of 100
Updating learning rate to 4.121100845840884e-13
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.060550422920442e-13
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.030275211460221e-13
EarlyStopping counter: 26 out of 100
Updating learning rate to 5.151376057301105e-14
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.5756880286505527e-14
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.2878440143252763e-14
EarlyStopping counter: 29 out of 100
Updating learning rate to 6.439220071626382e-15
EarlyStopping counter: 30 out of 100
Updating learning rate to 3.219610035813191e-15
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.6098050179065954e-15
EarlyStopping counter: 32 out of 100
Updating learning rate to 8.049025089532977e-16
EarlyStopping counter: 33 out of 100
Updating learning rate to 4.0245125447664885e-16
EarlyStopping counter: 34 out of 100
Updating learning rate to 2.0122562723832443e-16
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.0061281361916221e-16
EarlyStopping counter: 36 out of 100
Updating learning rate to 5.0306406809581107e-17
EarlyStopping counter: 37 out of 100
Updating learning rate to 2.5153203404790553e-17
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.2576601702395277e-17
EarlyStopping counter: 39 out of 100
Updating learning rate to 6.288300851197638e-18
EarlyStopping counter: 40 out of 100
Updating learning rate to 3.144150425598819e-18
EarlyStopping counter: 41 out of 100
Updating learning rate to 1.5720752127994096e-18
EarlyStopping counter: 42 out of 100
Updating learning rate to 7.860376063997048e-19
EarlyStopping counter: 43 out of 100
Updating learning rate to 3.930188031998524e-19
EarlyStopping counter: 44 out of 100
Updating learning rate to 1.965094015999262e-19
EarlyStopping counter: 45 out of 100
Updating learning rate to 9.82547007999631e-20
Validation loss decreased (0.036992 --> 0.036792).  Saving model ...
Updating learning rate to 4.912735039998155e-20
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.4563675199990775e-20
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2281837599995387e-20
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.140918799997694e-21
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.070459399998847e-21
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.5352296999994234e-21
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.676148499997117e-22
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.8380742499985585e-22
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.9190371249992793e-22
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.595185624996396e-23
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.797592812498198e-23
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.398796406249099e-23
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.1993982031245495e-23
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.996991015622748e-24
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.998495507811374e-24
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.499247753905687e-24
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.496238769528435e-25
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.7481193847642173e-25
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.8740596923821087e-25
EarlyStopping counter: 19 out of 100
Updating learning rate to 9.370298461910543e-26
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.6851492309552717e-26
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.3425746154776358e-26
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.1712873077388179e-26
EarlyStopping counter: 23 out of 100
Updating learning rate to 5.8564365386940896e-27
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.9282182693470448e-27
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.4641091346735224e-27
EarlyStopping counter: 26 out of 100
Updating learning rate to 7.320545673367612e-28
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.660272836683806e-28
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.830136418341903e-28
EarlyStopping counter: 29 out of 100
Updating learning rate to 9.150682091709515e-29
EarlyStopping counter: 30 out of 100
Updating learning rate to 4.5753410458547575e-29
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.2876705229273787e-29
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.1438352614636894e-29
EarlyStopping counter: 33 out of 100
Updating learning rate to 5.719176307318447e-30
EarlyStopping counter: 34 out of 100
Updating learning rate to 2.8595881536592234e-30
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.4297940768296117e-30
EarlyStopping counter: 36 out of 100
Updating learning rate to 7.1489703841480586e-31
EarlyStopping counter: 37 out of 100
Updating learning rate to 3.5744851920740293e-31
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.7872425960370146e-31
EarlyStopping counter: 39 out of 100
Updating learning rate to 8.936212980185073e-32
EarlyStopping counter: 40 out of 100
Updating learning rate to 4.4681064900925366e-32
EarlyStopping counter: 41 out of 100
Updating learning rate to 2.2340532450462683e-32
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.1170266225231342e-32
EarlyStopping counter: 43 out of 100
Updating learning rate to 5.585133112615671e-33
EarlyStopping counter: 44 out of 100
Updating learning rate to 2.7925665563078354e-33
EarlyStopping counter: 45 out of 100
Updating learning rate to 1.3962832781539177e-33
EarlyStopping counter: 46 out of 100
Updating learning rate to 6.9814163907695884e-34
>>>>>> Testing on validation set: trial_28 >>>>>>
test 232
test shape: (232, 30, 5) (232, 30, 5)
test shape: (232, 30, 5) (232, 30, 5)


	mse:0.07536672800779343, mae:0.11148291826248169, dtw:Not calculated


                                                                                         [I 2025-10-17 01:05:56,497] Trial 28 finished with value: 0.11148291826248169 and parameters: {'seq_len': 48, 'pred_len': 30, 'expand': 2, 'd_model': 64, 'n_heads': 8, 'e_layers': 2, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0004424998339101134, 'dropout': 0.02865663495096578}. Best is trial 23 with value: 0.07065031677484512.
Best trial: 23. Best value: 0.0706503:  56%|█████▌    | 28/50 [1:12:50<45:06, 123.00s/it]Best trial: 23. Best value: 0.0706503:  56%|█████▌    | 28/50 [1:12:50<45:06, 123.00s/it]Best trial: 23. Best value: 0.0706503:  58%|█████▊    | 29/50 [1:12:50<44:07, 126.08s/it]
============================================================
Trial 29
============================================================
seq_len: 48, pred_len: 7
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 64, lr: 0.000101
dropout: 0.09328636230436166
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_29 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 7
============================================================
train 4619
val 253
test 255
Validation loss decreased (inf --> 0.038391).  Saving model ...
Updating learning rate to 0.00010142296893016189
Validation loss decreased (0.038391 --> 0.037643).  Saving model ...
Updating learning rate to 5.071148446508094e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.535574223254047e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2677871116270236e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.338935558135118e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.169467779067559e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.5847338895337795e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.923669447668897e-07
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.9618347238344487e-07
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.9809173619172243e-07
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.904586809586122e-08
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.952293404793061e-08
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.4761467023965304e-08
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.2380733511982652e-08
EarlyStopping counter: 13 out of 100
Updating learning rate to 6.190366755991326e-09
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.095183377995663e-09
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.5475916889978315e-09
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.737958444989158e-10
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.868979222494579e-10
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.9344896112472894e-10
EarlyStopping counter: 19 out of 100
Updating learning rate to 9.672448056236447e-11
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.8362240281182235e-11
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.4181120140591117e-11
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.2090560070295559e-11
EarlyStopping counter: 23 out of 100
Updating learning rate to 6.045280035147779e-12
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.0226400175738897e-12
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.5113200087869448e-12
EarlyStopping counter: 26 out of 100
Updating learning rate to 7.556600043934724e-13
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.778300021967362e-13
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.889150010983681e-13
EarlyStopping counter: 29 out of 100
Updating learning rate to 9.445750054918405e-14
EarlyStopping counter: 30 out of 100
Updating learning rate to 4.7228750274592026e-14
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.3614375137296013e-14
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.1807187568648007e-14
EarlyStopping counter: 33 out of 100
Updating learning rate to 5.903593784324003e-15
EarlyStopping counter: 34 out of 100
Updating learning rate to 2.9517968921620016e-15
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.4758984460810008e-15
EarlyStopping counter: 36 out of 100
Updating learning rate to 7.379492230405004e-16
EarlyStopping counter: 37 out of 100
Updating learning rate to 3.689746115202502e-16
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.844873057601251e-16
EarlyStopping counter: 39 out of 100
Updating learning rate to 9.224365288006255e-17
EarlyStopping counter: 40 out of 100
Updating learning rate to 4.6121826440031275e-17
EarlyStopping counter: 41 out of 100
Updating learning rate to 2.3060913220015638e-17
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.1530456610007819e-17
EarlyStopping counter: 43 out of 100
Updating learning rate to 5.7652283050039094e-18
EarlyStopping counter: 44 out of 100
Updating learning rate to 2.8826141525019547e-18
EarlyStopping counter: 45 out of 100
Updating learning rate to 1.4413070762509774e-18
EarlyStopping counter: 46 out of 100
Updating learning rate to 7.206535381254887e-19
EarlyStopping counter: 47 out of 100
Updating learning rate to 3.6032676906274434e-19
EarlyStopping counter: 48 out of 100
Updating learning rate to 1.8016338453137217e-19
EarlyStopping counter: 49 out of 100
Updating learning rate to 9.008169226568608e-20
EarlyStopping counter: 50 out of 100
Updating learning rate to 4.504084613284304e-20
EarlyStopping counter: 51 out of 100
Updating learning rate to 2.252042306642152e-20
EarlyStopping counter: 52 out of 100
Updating learning rate to 1.126021153321076e-20
EarlyStopping counter: 53 out of 100
Updating learning rate to 5.63010576660538e-21
EarlyStopping counter: 54 out of 100
Updating learning rate to 2.81505288330269e-21
EarlyStopping counter: 55 out of 100
Updating learning rate to 1.407526441651345e-21
EarlyStopping counter: 56 out of 100
Updating learning rate to 7.037632208256725e-22
EarlyStopping counter: 57 out of 100
Updating learning rate to 3.5188161041283627e-22
EarlyStopping counter: 58 out of 100
Updating learning rate to 1.7594080520641813e-22
EarlyStopping counter: 59 out of 100
Updating learning rate to 8.797040260320907e-23
EarlyStopping counter: 60 out of 100
Updating learning rate to 4.3985201301604534e-23
EarlyStopping counter: 61 out of 100
Updating learning rate to 2.1992600650802267e-23
EarlyStopping counter: 62 out of 100
Updating learning rate to 1.0996300325401133e-23
EarlyStopping counter: 63 out of 100
Updating learning rate to 5.498150162700567e-24
EarlyStopping counter: 64 out of 100
Updating learning rate to 2.7490750813502834e-24
EarlyStopping counter: 65 out of 100
Updating learning rate to 1.3745375406751417e-24
EarlyStopping counter: 66 out of 100
Updating learning rate to 6.872687703375708e-25
EarlyStopping counter: 67 out of 100
Updating learning rate to 3.436343851687854e-25
EarlyStopping counter: 68 out of 100
Updating learning rate to 1.718171925843927e-25
EarlyStopping counter: 69 out of 100
Updating learning rate to 8.590859629219635e-26
EarlyStopping counter: 70 out of 100
Updating learning rate to 4.295429814609818e-26
EarlyStopping counter: 71 out of 100
Updating learning rate to 2.147714907304909e-26
EarlyStopping counter: 72 out of 100
Updating learning rate to 1.0738574536524544e-26
EarlyStopping counter: 73 out of 100
Updating learning rate to 5.369287268262272e-27
EarlyStopping counter: 74 out of 100
Updating learning rate to 2.684643634131136e-27
EarlyStopping counter: 75 out of 100
Updating learning rate to 1.342321817065568e-27
EarlyStopping counter: 76 out of 100
Updating learning rate to 6.71160908532784e-28
EarlyStopping counter: 77 out of 100
Updating learning rate to 3.35580454266392e-28
EarlyStopping counter: 78 out of 100
Updating learning rate to 1.67790227133196e-28
EarlyStopping counter: 79 out of 100
Updating learning rate to 8.3895113566598e-29
EarlyStopping counter: 80 out of 100
Updating learning rate to 4.1947556783299e-29
EarlyStopping counter: 81 out of 100
Updating learning rate to 2.09737783916495e-29
EarlyStopping counter: 82 out of 100
Updating learning rate to 1.048688919582475e-29
EarlyStopping counter: 83 out of 100
Updating learning rate to 5.243444597912375e-30
EarlyStopping counter: 84 out of 100
Updating learning rate to 2.6217222989561876e-30
EarlyStopping counter: 85 out of 100
Updating learning rate to 1.3108611494780938e-30
EarlyStopping counter: 86 out of 100
Updating learning rate to 6.554305747390469e-31
EarlyStopping counter: 87 out of 100
Updating learning rate to 3.2771528736952345e-31
EarlyStopping counter: 88 out of 100
Updating learning rate to 1.6385764368476172e-31
EarlyStopping counter: 89 out of 100
Updating learning rate to 8.192882184238086e-32
EarlyStopping counter: 90 out of 100
Updating learning rate to 4.096441092119043e-32
EarlyStopping counter: 91 out of 100
Updating learning rate to 2.0482205460595215e-32
EarlyStopping counter: 92 out of 100
Updating learning rate to 1.0241102730297608e-32
EarlyStopping counter: 93 out of 100
Updating learning rate to 5.120551365148804e-33
EarlyStopping counter: 94 out of 100
Updating learning rate to 2.560275682574402e-33
EarlyStopping counter: 95 out of 100
Updating learning rate to 1.280137841287201e-33
EarlyStopping counter: 96 out of 100
Updating learning rate to 6.400689206436005e-34
EarlyStopping counter: 97 out of 100
Updating learning rate to 3.2003446032180024e-34
EarlyStopping counter: 98 out of 100
Updating learning rate to 1.6001723016090012e-34
>>>>>> Testing on validation set: trial_29 >>>>>>
test 255
test shape: (255, 7, 5) (255, 7, 5)
test shape: (255, 7, 5) (255, 7, 5)


	mse:0.06399615108966827, mae:0.0971631109714508, dtw:Not calculated


                                                                                         [I 2025-10-17 01:07:04,870] Trial 29 finished with value: 0.0971631109714508 and parameters: {'seq_len': 48, 'pred_len': 7, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 64, 'learning_rate': 0.00010142296893016189, 'dropout': 0.09328636230436166}. Best is trial 23 with value: 0.07065031677484512.
Best trial: 23. Best value: 0.0706503:  58%|█████▊    | 29/50 [1:13:58<44:07, 126.08s/it]Best trial: 23. Best value: 0.0706503:  58%|█████▊    | 29/50 [1:13:58<44:07, 126.08s/it]Best trial: 23. Best value: 0.0706503:  60%|██████    | 30/50 [1:13:58<36:15, 108.77s/it]
============================================================
Trial 30
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 2, d_layers: 2
batch_size: 32, lr: 0.000591
dropout: 0.06865004498826856
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_30 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.026511).  Saving model ...
Updating learning rate to 0.0005911316596863775
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00029556582984318876
Validation loss decreased (0.026511 --> 0.024814).  Saving model ...
Updating learning rate to 0.00014778291492159438
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.389145746079719e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.6945728730398595e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8472864365199298e-05
Validation loss decreased (0.024814 --> 0.024280).  Saving model ...
Updating learning rate to 9.236432182599649e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.618216091299824e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.309108045649912e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.154554022824956e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.77277011412478e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.88638505706239e-07
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.443192528531195e-07
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.215962642655976e-08
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.607981321327988e-08
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.803990660663994e-08
EarlyStopping counter: 10 out of 100
Updating learning rate to 9.01995330331997e-09
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.509976651659985e-09
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.2549883258299924e-09
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.1274941629149962e-09
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.637470814574981e-10
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.8187354072874905e-10
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.4093677036437452e-10
EarlyStopping counter: 17 out of 100
Updating learning rate to 7.046838518218726e-11
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.523419259109363e-11
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.7617096295546815e-11
EarlyStopping counter: 20 out of 100
Updating learning rate to 8.808548147773408e-12
EarlyStopping counter: 21 out of 100
Updating learning rate to 4.404274073886704e-12
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.202137036943352e-12
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.101068518471676e-12
EarlyStopping counter: 24 out of 100
Updating learning rate to 5.50534259235838e-13
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.75267129617919e-13
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.376335648089595e-13
EarlyStopping counter: 27 out of 100
Updating learning rate to 6.881678240447975e-14
EarlyStopping counter: 28 out of 100
Updating learning rate to 3.4408391202239874e-14
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.7204195601119937e-14
EarlyStopping counter: 30 out of 100
Updating learning rate to 8.602097800559968e-15
EarlyStopping counter: 31 out of 100
Updating learning rate to 4.301048900279984e-15
EarlyStopping counter: 32 out of 100
Updating learning rate to 2.150524450139992e-15
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.075262225069996e-15
EarlyStopping counter: 34 out of 100
Updating learning rate to 5.37631112534998e-16
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.68815556267499e-16
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.344077781337495e-16
EarlyStopping counter: 37 out of 100
Updating learning rate to 6.720388906687475e-17
EarlyStopping counter: 38 out of 100
Updating learning rate to 3.3601944533437377e-17
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.6800972266718688e-17
EarlyStopping counter: 40 out of 100
Updating learning rate to 8.400486133359344e-18
EarlyStopping counter: 41 out of 100
Updating learning rate to 4.200243066679672e-18
EarlyStopping counter: 42 out of 100
Updating learning rate to 2.100121533339836e-18
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.050060766669918e-18
EarlyStopping counter: 44 out of 100
Updating learning rate to 5.25030383334959e-19
EarlyStopping counter: 45 out of 100
Updating learning rate to 2.625151916674795e-19
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.3125759583373975e-19
EarlyStopping counter: 47 out of 100
Updating learning rate to 6.562879791686988e-20
EarlyStopping counter: 48 out of 100
Updating learning rate to 3.281439895843494e-20
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.640719947921747e-20
Validation loss decreased (0.024280 --> 0.024167).  Saving model ...
Updating learning rate to 8.203599739608735e-21
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.101799869804367e-21
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0508999349021836e-21
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0254499674510918e-21
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.127249837255459e-22
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.5636249186277296e-22
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.2818124593138648e-22
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.409062296569324e-23
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.204531148284662e-23
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.602265574142331e-23
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.011327870711655e-24
Validation loss decreased (0.024167 --> 0.024010).  Saving model ...
Updating learning rate to 4.0056639353558274e-24
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0028319676779137e-24
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0014159838389569e-24
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.007079919194784e-25
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503539959597392e-25
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.251769979798696e-25
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.25884989899348e-26
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.12942494949674e-26
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.56471247474837e-26
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.82356237374185e-27
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.911781186870925e-27
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.9558905934354626e-27
EarlyStopping counter: 12 out of 100
Updating learning rate to 9.779452967177313e-28
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.8897264835886565e-28
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.4448632417943283e-28
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.2224316208971641e-28
EarlyStopping counter: 16 out of 100
Updating learning rate to 6.112158104485821e-29
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.0560790522429103e-29
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.5280395261214552e-29
EarlyStopping counter: 19 out of 100
Updating learning rate to 7.640197630607276e-30
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.820098815303638e-30
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.910049407651819e-30
EarlyStopping counter: 22 out of 100
Updating learning rate to 9.550247038259095e-31
EarlyStopping counter: 23 out of 100
Updating learning rate to 4.775123519129547e-31
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.3875617595647737e-31
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.1937808797823868e-31
EarlyStopping counter: 26 out of 100
Updating learning rate to 5.968904398911934e-32
Validation loss decreased (0.024010 --> 0.023999).  Saving model ...
Updating learning rate to 2.984452199455967e-32
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4922260997279836e-32
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.461130498639918e-33
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.730565249319959e-33
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8652826246599795e-33
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.326413123299897e-34
>>>>>> Testing on validation set: trial_30 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.04925830662250519, mae:0.07257410138845444, dtw:Not calculated


                                                                                         [I 2025-10-17 01:09:19,100] Trial 30 finished with value: 0.07257410138845444 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 2, 'd_model': 64, 'n_heads': 8, 'e_layers': 2, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0005911316596863775, 'dropout': 0.06865004498826856}. Best is trial 23 with value: 0.07065031677484512.
Best trial: 23. Best value: 0.0706503:  60%|██████    | 30/50 [1:16:12<36:15, 108.77s/it]Best trial: 23. Best value: 0.0706503:  60%|██████    | 30/50 [1:16:12<36:15, 108.77s/it]Best trial: 23. Best value: 0.0706503:  62%|██████▏   | 31/50 [1:16:12<36:51, 116.41s/it]
============================================================
Trial 31
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000691
dropout: 0.031100373612740484
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_31 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.025573).  Saving model ...
Updating learning rate to 0.0006905193809404407
Validation loss decreased (0.025573 --> 0.024391).  Saving model ...
Updating learning rate to 0.00034525969047022033
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00017262984523511016
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.631492261755508e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.315746130877754e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.157873065438877e-05
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0789365327194385e-05
Validation loss decreased (0.024391 --> 0.024375).  Saving model ...
Updating learning rate to 5.394682663597193e-06
Validation loss decreased (0.024375 --> 0.024267).  Saving model ...
Updating learning rate to 2.6973413317985963e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3486706658992982e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.743353329496491e-07
Validation loss decreased (0.024267 --> 0.023944).  Saving model ...
Updating learning rate to 3.3716766647482454e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6858383323741227e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.429191661870613e-08
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.214595830935307e-08
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.1072979154676534e-08
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0536489577338267e-08
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.2682447886691334e-09
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.6341223943345667e-09
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3170611971672834e-09
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.585305985836417e-10
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.2926529929182084e-10
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.6463264964591042e-10
EarlyStopping counter: 12 out of 100
Updating learning rate to 8.231632482295521e-11
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.1158162411477605e-11
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.0579081205738802e-11
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.0289540602869401e-11
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.144770301434701e-12
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.5723851507173503e-12
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.2861925753586752e-12
EarlyStopping counter: 19 out of 100
Updating learning rate to 6.430962876793376e-13
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.215481438396688e-13
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.607740719198344e-13
EarlyStopping counter: 22 out of 100
Updating learning rate to 8.03870359599172e-14
EarlyStopping counter: 23 out of 100
Updating learning rate to 4.01935179799586e-14
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.00967589899793e-14
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.004837949498965e-14
EarlyStopping counter: 26 out of 100
Updating learning rate to 5.024189747494825e-15
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.5120948737474124e-15
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.2560474368737062e-15
EarlyStopping counter: 29 out of 100
Updating learning rate to 6.280237184368531e-16
EarlyStopping counter: 30 out of 100
Updating learning rate to 3.1401185921842655e-16
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.5700592960921328e-16
Validation loss decreased (0.023944 --> 0.023873).  Saving model ...
Updating learning rate to 7.850296480460664e-17
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.925148240230332e-17
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.962574120115166e-17
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.81287060057583e-18
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.906435300287915e-18
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.4532176501439574e-18
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.2266088250719787e-18
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.133044125359894e-19
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.066522062679947e-19
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.5332610313399734e-19
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.666305156699867e-20
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.8331525783499335e-20
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.9165762891749667e-20
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.582881445874834e-21
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.791440722937417e-21
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.3957203614687084e-21
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.1978601807343542e-21
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.989300903671771e-22
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.9946504518358855e-22
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.4973252259179428e-22
EarlyStopping counter: 20 out of 100
Updating learning rate to 7.486626129589714e-23
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.743313064794857e-23
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.8716565323974285e-23
EarlyStopping counter: 23 out of 100
Updating learning rate to 9.358282661987142e-24
EarlyStopping counter: 24 out of 100
Updating learning rate to 4.679141330993571e-24
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.3395706654967856e-24
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.1697853327483928e-24
EarlyStopping counter: 27 out of 100
Updating learning rate to 5.848926663741964e-25
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.924463331870982e-25
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.462231665935491e-25
EarlyStopping counter: 30 out of 100
Updating learning rate to 7.311158329677455e-26
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.6555791648387275e-26
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.8277895824193637e-26
EarlyStopping counter: 33 out of 100
Updating learning rate to 9.138947912096819e-27
EarlyStopping counter: 34 out of 100
Updating learning rate to 4.569473956048409e-27
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.2847369780242047e-27
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.1423684890121023e-27
EarlyStopping counter: 37 out of 100
Updating learning rate to 5.711842445060512e-28
EarlyStopping counter: 38 out of 100
Updating learning rate to 2.855921222530256e-28
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.427960611265128e-28
EarlyStopping counter: 40 out of 100
Updating learning rate to 7.13980305632564e-29
EarlyStopping counter: 41 out of 100
Updating learning rate to 3.56990152816282e-29
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.78495076408141e-29
EarlyStopping counter: 43 out of 100
Updating learning rate to 8.92475382040705e-30
EarlyStopping counter: 44 out of 100
Updating learning rate to 4.462376910203525e-30
Validation loss decreased (0.023873 --> 0.023751).  Saving model ...
Updating learning rate to 2.2311884551017624e-30
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1155942275508812e-30
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.577971137754406e-31
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.788985568877203e-31
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3944927844386015e-31
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.972463922193007e-32
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.4862319610965037e-32
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.7431159805482518e-32
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.715579902741259e-33
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.3577899513706296e-33
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.1788949756853148e-33
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.0894474878426574e-33
>>>>>> Testing on validation set: trial_31 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.05207566171884537, mae:0.07249698787927628, dtw:Not calculated


                                                                                         [I 2025-10-17 01:11:32,552] Trial 31 finished with value: 0.07249698787927628 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0006905193809404407, 'dropout': 0.031100373612740484}. Best is trial 23 with value: 0.07065031677484512.
Best trial: 23. Best value: 0.0706503:  62%|██████▏   | 31/50 [1:18:26<36:51, 116.41s/it]Best trial: 23. Best value: 0.0706503:  62%|██████▏   | 31/50 [1:18:26<36:51, 116.41s/it]Best trial: 23. Best value: 0.0706503:  64%|██████▍   | 32/50 [1:18:26<36:27, 121.52s/it]
============================================================
Trial 32
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000607
dropout: 0.0467841363555473
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_32 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.026581).  Saving model ...
Updating learning rate to 0.0006071938005160092
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0003035969002580046
Validation loss decreased (0.026581 --> 0.024970).  Saving model ...
Updating learning rate to 0.0001517984501290023
Validation loss decreased (0.024970 --> 0.023676).  Saving model ...
Updating learning rate to 7.589922506450115e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.7949612532250574e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8974806266125287e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.487403133062643e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.743701566531322e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.371850783265661e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1859253916328304e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.929626958164152e-07
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.964813479082076e-07
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.482406739541038e-07
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.41203369770519e-08
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.706016848852595e-08
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.8530084244262975e-08
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.265042122131488e-09
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.632521061065744e-09
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.316260530532872e-09
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.158130265266436e-09
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.79065132633218e-10
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.89532566316609e-10
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.447662831583045e-10
EarlyStopping counter: 20 out of 100
Updating learning rate to 7.238314157915225e-11
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.6191570789576124e-11
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.8095785394788062e-11
EarlyStopping counter: 23 out of 100
Updating learning rate to 9.047892697394031e-12
EarlyStopping counter: 24 out of 100
Updating learning rate to 4.5239463486970155e-12
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.2619731743485077e-12
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.1309865871742539e-12
EarlyStopping counter: 27 out of 100
Updating learning rate to 5.654932935871269e-13
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.8274664679356347e-13
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.4137332339678173e-13
EarlyStopping counter: 30 out of 100
Updating learning rate to 7.068666169839087e-14
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.5343330849195433e-14
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.7671665424597717e-14
EarlyStopping counter: 33 out of 100
Updating learning rate to 8.835832712298858e-15
EarlyStopping counter: 34 out of 100
Updating learning rate to 4.417916356149429e-15
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.2089581780747146e-15
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.1044790890373573e-15
EarlyStopping counter: 37 out of 100
Updating learning rate to 5.522395445186786e-16
EarlyStopping counter: 38 out of 100
Updating learning rate to 2.761197722593393e-16
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.3805988612966966e-16
EarlyStopping counter: 40 out of 100
Updating learning rate to 6.902994306483483e-17
EarlyStopping counter: 41 out of 100
Updating learning rate to 3.4514971532417415e-17
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.7257485766208708e-17
EarlyStopping counter: 43 out of 100
Updating learning rate to 8.628742883104354e-18
EarlyStopping counter: 44 out of 100
Updating learning rate to 4.314371441552177e-18
EarlyStopping counter: 45 out of 100
Updating learning rate to 2.1571857207760885e-18
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.0785928603880442e-18
EarlyStopping counter: 47 out of 100
Updating learning rate to 5.392964301940221e-19
EarlyStopping counter: 48 out of 100
Updating learning rate to 2.6964821509701106e-19
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.3482410754850553e-19
EarlyStopping counter: 50 out of 100
Updating learning rate to 6.741205377425276e-20
EarlyStopping counter: 51 out of 100
Updating learning rate to 3.370602688712638e-20
EarlyStopping counter: 52 out of 100
Updating learning rate to 1.685301344356319e-20
EarlyStopping counter: 53 out of 100
Updating learning rate to 8.426506721781596e-21
EarlyStopping counter: 54 out of 100
Updating learning rate to 4.213253360890798e-21
EarlyStopping counter: 55 out of 100
Updating learning rate to 2.106626680445399e-21
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.0533133402226994e-21
EarlyStopping counter: 57 out of 100
Updating learning rate to 5.266566701113497e-22
EarlyStopping counter: 58 out of 100
Updating learning rate to 2.6332833505567486e-22
EarlyStopping counter: 59 out of 100
Updating learning rate to 1.3166416752783743e-22
EarlyStopping counter: 60 out of 100
Updating learning rate to 6.583208376391872e-23
EarlyStopping counter: 61 out of 100
Updating learning rate to 3.291604188195936e-23
EarlyStopping counter: 62 out of 100
Updating learning rate to 1.645802094097968e-23
EarlyStopping counter: 63 out of 100
Updating learning rate to 8.22901047048984e-24
EarlyStopping counter: 64 out of 100
Updating learning rate to 4.11450523524492e-24
EarlyStopping counter: 65 out of 100
Updating learning rate to 2.05725261762246e-24
EarlyStopping counter: 66 out of 100
Updating learning rate to 1.02862630881123e-24
EarlyStopping counter: 67 out of 100
Updating learning rate to 5.14313154405615e-25
EarlyStopping counter: 68 out of 100
Updating learning rate to 2.571565772028075e-25
EarlyStopping counter: 69 out of 100
Updating learning rate to 1.2857828860140374e-25
EarlyStopping counter: 70 out of 100
Updating learning rate to 6.428914430070187e-26
EarlyStopping counter: 71 out of 100
Updating learning rate to 3.2144572150350935e-26
EarlyStopping counter: 72 out of 100
Updating learning rate to 1.6072286075175468e-26
Validation loss decreased (0.023676 --> 0.023619).  Saving model ...
Updating learning rate to 8.036143037587734e-27
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.018071518793867e-27
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0090357593969335e-27
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0045178796984667e-27
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.022589398492334e-28
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.511294699246167e-28
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.2556473496230834e-28
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.278236748115417e-29
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.1391183740577085e-29
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.5695591870288543e-29
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.847795935144271e-30
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.923897967572136e-30
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.961948983786068e-30
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.80974491893034e-31
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.90487245946517e-31
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.452436229732585e-31
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.2262181148662924e-31
EarlyStopping counter: 17 out of 100
Updating learning rate to 6.131090574331462e-32
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.065545287165731e-32
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.5327726435828655e-32
EarlyStopping counter: 20 out of 100
Updating learning rate to 7.663863217914327e-33
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.831931608957164e-33
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.915965804478582e-33
EarlyStopping counter: 23 out of 100
Updating learning rate to 9.57982902239291e-34
>>>>>> Testing on validation set: trial_32 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.05209246650338173, mae:0.07360118627548218, dtw:Not calculated


                                                                                         [I 2025-10-17 01:13:45,903] Trial 32 finished with value: 0.07360118627548218 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0006071938005160092, 'dropout': 0.0467841363555473}. Best is trial 23 with value: 0.07065031677484512.
Best trial: 23. Best value: 0.0706503:  64%|██████▍   | 32/50 [1:20:39<36:27, 121.52s/it]Best trial: 23. Best value: 0.0706503:  64%|██████▍   | 32/50 [1:20:39<36:27, 121.52s/it]Best trial: 23. Best value: 0.0706503:  66%|██████▌   | 33/50 [1:20:39<35:26, 125.07s/it]
============================================================
Trial 33
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000396
dropout: 0.0005477750470412324
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_33 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.025451).  Saving model ...
Updating learning rate to 0.00039555857675034324
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00019777928837517162
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.888964418758581e-05
Validation loss decreased (0.025451 --> 0.024928).  Saving model ...
Updating learning rate to 4.9444822093792905e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.4722411046896453e-05
Validation loss decreased (0.024928 --> 0.024872).  Saving model ...
Updating learning rate to 1.2361205523448226e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.180602761724113e-06
Validation loss decreased (0.024872 --> 0.024702).  Saving model ...
Updating learning rate to 3.0903013808620566e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5451506904310283e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.725753452155141e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.8628767260775707e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.9314383630387854e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.657191815193927e-08
Validation loss decreased (0.024702 --> 0.024583).  Saving model ...
Updating learning rate to 4.8285959075969634e-08
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.4142979537984817e-08
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2071489768992408e-08
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.035744884496204e-09
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.017872442248102e-09
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.508936221124051e-09
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.544681105620255e-10
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.7723405528101276e-10
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.8861702764050638e-10
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.430851382025319e-11
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.7154256910126596e-11
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.3577128455063298e-11
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.1788564227531649e-11
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.8942821137658244e-12
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.9471410568829122e-12
Validation loss decreased (0.024583 --> 0.024423).  Saving model ...
Updating learning rate to 1.4735705284414561e-12
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.367852642207281e-13
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.6839263211036403e-13
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8419631605518201e-13
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.209815802759101e-14
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.6049079013795503e-14
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.3024539506897752e-14
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1512269753448876e-14
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.756134876724438e-15
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.878067438362219e-15
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.4390337191811095e-15
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.195168595905547e-16
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.5975842979527737e-16
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.7987921489763869e-16
EarlyStopping counter: 14 out of 100
Updating learning rate to 8.993960744881934e-17
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.496980372440967e-17
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.2484901862204836e-17
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.1242450931102418e-17
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.621225465551209e-18
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.8106127327756045e-18
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.4053063663878022e-18
EarlyStopping counter: 21 out of 100
Updating learning rate to 7.026531831939011e-19
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.5132659159695056e-19
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.7566329579847528e-19
EarlyStopping counter: 24 out of 100
Updating learning rate to 8.783164789923764e-20
EarlyStopping counter: 25 out of 100
Updating learning rate to 4.391582394961882e-20
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.195791197480941e-20
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.0978955987404705e-20
EarlyStopping counter: 28 out of 100
Updating learning rate to 5.4894779937023525e-21
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.7447389968511762e-21
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.3723694984255881e-21
EarlyStopping counter: 31 out of 100
Updating learning rate to 6.861847492127941e-22
EarlyStopping counter: 32 out of 100
Updating learning rate to 3.4309237460639703e-22
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.7154618730319851e-22
EarlyStopping counter: 34 out of 100
Updating learning rate to 8.577309365159926e-23
EarlyStopping counter: 35 out of 100
Updating learning rate to 4.288654682579963e-23
EarlyStopping counter: 36 out of 100
Updating learning rate to 2.1443273412899814e-23
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.0721636706449907e-23
EarlyStopping counter: 38 out of 100
Updating learning rate to 5.3608183532249536e-24
EarlyStopping counter: 39 out of 100
Updating learning rate to 2.6804091766124768e-24
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.3402045883062384e-24
EarlyStopping counter: 41 out of 100
Updating learning rate to 6.701022941531192e-25
EarlyStopping counter: 42 out of 100
Updating learning rate to 3.350511470765596e-25
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.675255735382798e-25
EarlyStopping counter: 44 out of 100
Updating learning rate to 8.37627867691399e-26
EarlyStopping counter: 45 out of 100
Updating learning rate to 4.188139338456995e-26
EarlyStopping counter: 46 out of 100
Updating learning rate to 2.0940696692284975e-26
EarlyStopping counter: 47 out of 100
Updating learning rate to 1.0470348346142487e-26
EarlyStopping counter: 48 out of 100
Updating learning rate to 5.235174173071244e-27
EarlyStopping counter: 49 out of 100
Updating learning rate to 2.617587086535622e-27
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.308793543267811e-27
EarlyStopping counter: 51 out of 100
Updating learning rate to 6.543967716339055e-28
EarlyStopping counter: 52 out of 100
Updating learning rate to 3.2719838581695273e-28
EarlyStopping counter: 53 out of 100
Updating learning rate to 1.6359919290847637e-28
EarlyStopping counter: 54 out of 100
Updating learning rate to 8.179959645423818e-29
EarlyStopping counter: 55 out of 100
Updating learning rate to 4.089979822711909e-29
EarlyStopping counter: 56 out of 100
Updating learning rate to 2.0449899113559546e-29
EarlyStopping counter: 57 out of 100
Updating learning rate to 1.0224949556779773e-29
EarlyStopping counter: 58 out of 100
Updating learning rate to 5.1124747783898865e-30
EarlyStopping counter: 59 out of 100
Updating learning rate to 2.5562373891949432e-30
EarlyStopping counter: 60 out of 100
Updating learning rate to 1.2781186945974716e-30
EarlyStopping counter: 61 out of 100
Updating learning rate to 6.390593472987358e-31
EarlyStopping counter: 62 out of 100
Updating learning rate to 3.195296736493679e-31
EarlyStopping counter: 63 out of 100
Updating learning rate to 1.5976483682468395e-31
EarlyStopping counter: 64 out of 100
Updating learning rate to 7.988241841234198e-32
EarlyStopping counter: 65 out of 100
Updating learning rate to 3.994120920617099e-32
EarlyStopping counter: 66 out of 100
Updating learning rate to 1.9970604603085494e-32
EarlyStopping counter: 67 out of 100
Updating learning rate to 9.985302301542747e-33
EarlyStopping counter: 68 out of 100
Updating learning rate to 4.9926511507713735e-33
EarlyStopping counter: 69 out of 100
Updating learning rate to 2.4963255753856867e-33
EarlyStopping counter: 70 out of 100
Updating learning rate to 1.2481627876928434e-33
EarlyStopping counter: 71 out of 100
Updating learning rate to 6.240813938464217e-34
>>>>>> Testing on validation set: trial_33 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.048584915697574615, mae:0.07274188101291656, dtw:Not calculated


                                                                                         [I 2025-10-17 01:15:59,654] Trial 33 finished with value: 0.07274188101291656 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.00039555857675034324, 'dropout': 0.0005477750470412324}. Best is trial 23 with value: 0.07065031677484512.
Best trial: 23. Best value: 0.0706503:  66%|██████▌   | 33/50 [1:22:53<35:26, 125.07s/it]Best trial: 23. Best value: 0.0706503:  66%|██████▌   | 33/50 [1:22:53<35:26, 125.07s/it]Best trial: 23. Best value: 0.0706503:  68%|██████▊   | 34/50 [1:22:53<34:02, 127.67s/it]
============================================================
Trial 34
============================================================
seq_len: 96, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000252
dropout: 0.02841032537020184
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_34 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 1
============================================================
train 4577
val 259
test 261
Validation loss decreased (inf --> 0.028252).  Saving model ...
Updating learning rate to 0.0002524625288432983
Validation loss decreased (0.028252 --> 0.026903).  Saving model ...
Updating learning rate to 0.00012623126442164916
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.311563221082458e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.155781610541229e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5778908052706145e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.889454026353072e-06
Validation loss decreased (0.026903 --> 0.024949).  Saving model ...
Updating learning rate to 3.944727013176536e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.972363506588268e-06
Validation loss decreased (0.024949 --> 0.024638).  Saving model ...
Updating learning rate to 9.86181753294134e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.93090876647067e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.465454383235335e-07
Validation loss decreased (0.024638 --> 0.024582).  Saving model ...
Updating learning rate to 1.2327271916176676e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.163635958088338e-08
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.081817979044169e-08
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5409089895220845e-08
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.704544947610422e-09
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.852272473805211e-09
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.9261362369026056e-09
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.630681184513028e-10
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.815340592256514e-10
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.407670296128257e-10
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.2038351480641285e-10
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.019175740320642e-11
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.009587870160321e-11
Validation loss decreased (0.024582 --> 0.024425).  Saving model ...
Updating learning rate to 1.5047939350801606e-11
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.523969675400803e-12
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.7619848377004015e-12
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8809924188502008e-12
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.404962094251004e-13
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.702481047125502e-13
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.351240523562751e-13
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1756202617813755e-13
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.878101308906877e-14
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.939050654453439e-14
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.4695253272267193e-14
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.347626636133597e-15
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.673813318066798e-15
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.836906659033399e-15
EarlyStopping counter: 14 out of 100
Updating learning rate to 9.184533295166996e-16
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.592266647583498e-16
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.296133323791749e-16
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.1480666618958745e-16
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.740333309479372e-17
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.870166654739686e-17
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.435083327369843e-17
EarlyStopping counter: 21 out of 100
Updating learning rate to 7.175416636849216e-18
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.587708318424608e-18
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.793854159212304e-18
EarlyStopping counter: 24 out of 100
Updating learning rate to 8.96927079606152e-19
EarlyStopping counter: 25 out of 100
Updating learning rate to 4.48463539803076e-19
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.24231769901538e-19
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.12115884950769e-19
EarlyStopping counter: 28 out of 100
Updating learning rate to 5.60579424753845e-20
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.802897123769225e-20
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.4014485618846124e-20
EarlyStopping counter: 31 out of 100
Updating learning rate to 7.007242809423062e-21
EarlyStopping counter: 32 out of 100
Updating learning rate to 3.503621404711531e-21
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.7518107023557655e-21
EarlyStopping counter: 34 out of 100
Updating learning rate to 8.759053511778828e-22
EarlyStopping counter: 35 out of 100
Updating learning rate to 4.379526755889414e-22
EarlyStopping counter: 36 out of 100
Updating learning rate to 2.189763377944707e-22
Validation loss decreased (0.024425 --> 0.024392).  Saving model ...
Updating learning rate to 1.0948816889723534e-22
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.474408444861767e-23
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7372042224308836e-23
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3686021112154418e-23
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.843010556077209e-24
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4215052780386045e-24
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.7107526390193023e-24
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.553763195096511e-25
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.276881597548256e-25
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.138440798774128e-25
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.069220399387064e-25
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.34610199693532e-26
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.67305099846766e-26
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.33652549923383e-26
EarlyStopping counter: 14 out of 100
Updating learning rate to 6.68262749616915e-27
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.341313748084575e-27
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.6706568740422874e-27
EarlyStopping counter: 17 out of 100
Updating learning rate to 8.353284370211437e-28
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.176642185105718e-28
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.088321092552859e-28
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.0441605462764296e-28
EarlyStopping counter: 21 out of 100
Updating learning rate to 5.220802731382148e-29
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.610401365691074e-29
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.305200682845537e-29
EarlyStopping counter: 24 out of 100
Updating learning rate to 6.526003414227685e-30
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.2630017071138425e-30
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.6315008535569213e-30
EarlyStopping counter: 27 out of 100
Updating learning rate to 8.157504267784606e-31
EarlyStopping counter: 28 out of 100
Updating learning rate to 4.078752133892303e-31
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.0393760669461516e-31
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.0196880334730758e-31
EarlyStopping counter: 31 out of 100
Updating learning rate to 5.098440167365379e-32
EarlyStopping counter: 32 out of 100
Updating learning rate to 2.5492200836826895e-32
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.2746100418413447e-32
EarlyStopping counter: 34 out of 100
Updating learning rate to 6.373050209206724e-33
EarlyStopping counter: 35 out of 100
Updating learning rate to 3.186525104603362e-33
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.593262552301681e-33
EarlyStopping counter: 37 out of 100
Updating learning rate to 7.966312761508405e-34
EarlyStopping counter: 38 out of 100
Updating learning rate to 3.983156380754202e-34
>>>>>> Testing on validation set: trial_34 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.05093764886260033, mae:0.07771015167236328, dtw:Not calculated


                                                                                         [I 2025-10-17 01:18:11,988] Trial 34 finished with value: 0.07771015167236328 and parameters: {'seq_len': 96, 'pred_len': 1, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0002524625288432983, 'dropout': 0.02841032537020184}. Best is trial 23 with value: 0.07065031677484512.
Best trial: 23. Best value: 0.0706503:  68%|██████▊   | 34/50 [1:25:05<34:02, 127.67s/it]Best trial: 23. Best value: 0.0706503:  68%|██████▊   | 34/50 [1:25:05<34:02, 127.67s/it]Best trial: 23. Best value: 0.0706503:  70%|███████   | 35/50 [1:25:05<32:16, 129.07s/it]
============================================================
Trial 35
============================================================
seq_len: 48, pred_len: 14
d_model: 64, n_heads: 4
e_layers: 1, d_layers: 2
batch_size: 16, lr: 0.000573
dropout: 0.09116185562593482
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_35 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 14
============================================================
train 4612
val 246
test 248
Validation loss decreased (inf --> 0.038392).  Saving model ...
Updating learning rate to 0.0005730183837551532
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0002865091918775766
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.0001432545959387883
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.162729796939415e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.5813648984697075e-05
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.7906824492348538e-05
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.953412246174269e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.476706123087134e-06
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.238353061543567e-06
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.1191765307717836e-06
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.595882653858918e-07
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.797941326929459e-07
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.3989706634647295e-07
EarlyStopping counter: 13 out of 100
Updating learning rate to 6.994853317323648e-08
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.497426658661824e-08
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.748713329330912e-08
EarlyStopping counter: 16 out of 100
Updating learning rate to 8.74356664665456e-09
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.37178332332728e-09
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.18589166166364e-09
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.09294583083182e-09
EarlyStopping counter: 20 out of 100
Updating learning rate to 5.4647291541591e-10
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.73236457707955e-10
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.366182288539775e-10
EarlyStopping counter: 23 out of 100
Updating learning rate to 6.830911442698875e-11
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.415455721349437e-11
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.7077278606747186e-11
EarlyStopping counter: 26 out of 100
Updating learning rate to 8.538639303373593e-12
EarlyStopping counter: 27 out of 100
Updating learning rate to 4.2693196516867966e-12
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.1346598258433983e-12
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.0673299129216991e-12
EarlyStopping counter: 30 out of 100
Updating learning rate to 5.336649564608496e-13
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.668324782304248e-13
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.334162391152124e-13
EarlyStopping counter: 33 out of 100
Updating learning rate to 6.67081195576062e-14
EarlyStopping counter: 34 out of 100
Updating learning rate to 3.33540597788031e-14
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.667702988940155e-14
EarlyStopping counter: 36 out of 100
Updating learning rate to 8.338514944700775e-15
EarlyStopping counter: 37 out of 100
Updating learning rate to 4.169257472350387e-15
EarlyStopping counter: 38 out of 100
Updating learning rate to 2.0846287361751936e-15
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.0423143680875968e-15
EarlyStopping counter: 40 out of 100
Updating learning rate to 5.211571840437984e-16
EarlyStopping counter: 41 out of 100
Updating learning rate to 2.605785920218992e-16
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.302892960109496e-16
EarlyStopping counter: 43 out of 100
Updating learning rate to 6.51446480054748e-17
EarlyStopping counter: 44 out of 100
Updating learning rate to 3.25723240027374e-17
EarlyStopping counter: 45 out of 100
Updating learning rate to 1.62861620013687e-17
EarlyStopping counter: 46 out of 100
Updating learning rate to 8.14308100068435e-18
EarlyStopping counter: 47 out of 100
Updating learning rate to 4.071540500342175e-18
EarlyStopping counter: 48 out of 100
Updating learning rate to 2.0357702501710875e-18
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.0178851250855438e-18
EarlyStopping counter: 50 out of 100
Updating learning rate to 5.089425625427719e-19
EarlyStopping counter: 51 out of 100
Updating learning rate to 2.5447128127138594e-19
EarlyStopping counter: 52 out of 100
Updating learning rate to 1.2723564063569297e-19
EarlyStopping counter: 53 out of 100
Updating learning rate to 6.361782031784649e-20
EarlyStopping counter: 54 out of 100
Updating learning rate to 3.180891015892324e-20
EarlyStopping counter: 55 out of 100
Updating learning rate to 1.590445507946162e-20
EarlyStopping counter: 56 out of 100
Updating learning rate to 7.95222753973081e-21
EarlyStopping counter: 57 out of 100
Updating learning rate to 3.976113769865405e-21
EarlyStopping counter: 58 out of 100
Updating learning rate to 1.9880568849327027e-21
EarlyStopping counter: 59 out of 100
Updating learning rate to 9.940284424663513e-22
EarlyStopping counter: 60 out of 100
Updating learning rate to 4.970142212331757e-22
EarlyStopping counter: 61 out of 100
Updating learning rate to 2.4850711061658784e-22
EarlyStopping counter: 62 out of 100
Updating learning rate to 1.2425355530829392e-22
EarlyStopping counter: 63 out of 100
Updating learning rate to 6.212677765414696e-23
EarlyStopping counter: 64 out of 100
Updating learning rate to 3.106338882707348e-23
EarlyStopping counter: 65 out of 100
Updating learning rate to 1.553169441353674e-23
EarlyStopping counter: 66 out of 100
Updating learning rate to 7.76584720676837e-24
EarlyStopping counter: 67 out of 100
Updating learning rate to 3.882923603384185e-24
EarlyStopping counter: 68 out of 100
Updating learning rate to 1.9414618016920925e-24
EarlyStopping counter: 69 out of 100
Updating learning rate to 9.707309008460462e-25
EarlyStopping counter: 70 out of 100
Updating learning rate to 4.853654504230231e-25
EarlyStopping counter: 71 out of 100
Updating learning rate to 2.4268272521151156e-25
EarlyStopping counter: 72 out of 100
Updating learning rate to 1.2134136260575578e-25
EarlyStopping counter: 73 out of 100
Updating learning rate to 6.067068130287789e-26
EarlyStopping counter: 74 out of 100
Updating learning rate to 3.0335340651438945e-26
EarlyStopping counter: 75 out of 100
Updating learning rate to 1.5167670325719472e-26
EarlyStopping counter: 76 out of 100
Updating learning rate to 7.583835162859736e-27
EarlyStopping counter: 77 out of 100
Updating learning rate to 3.791917581429868e-27
EarlyStopping counter: 78 out of 100
Updating learning rate to 1.895958790714934e-27
EarlyStopping counter: 79 out of 100
Updating learning rate to 9.47979395357467e-28
EarlyStopping counter: 80 out of 100
Updating learning rate to 4.739896976787335e-28
EarlyStopping counter: 81 out of 100
Updating learning rate to 2.3699484883936676e-28
EarlyStopping counter: 82 out of 100
Updating learning rate to 1.1849742441968338e-28
EarlyStopping counter: 83 out of 100
Updating learning rate to 5.924871220984169e-29
EarlyStopping counter: 84 out of 100
Updating learning rate to 2.9624356104920844e-29
EarlyStopping counter: 85 out of 100
Updating learning rate to 1.4812178052460422e-29
EarlyStopping counter: 86 out of 100
Updating learning rate to 7.406089026230211e-30
EarlyStopping counter: 87 out of 100
Updating learning rate to 3.7030445131151056e-30
EarlyStopping counter: 88 out of 100
Updating learning rate to 1.8515222565575528e-30
EarlyStopping counter: 89 out of 100
Updating learning rate to 9.257611282787764e-31
EarlyStopping counter: 90 out of 100
Updating learning rate to 4.628805641393882e-31
EarlyStopping counter: 91 out of 100
Updating learning rate to 2.314402820696941e-31
EarlyStopping counter: 92 out of 100
Updating learning rate to 1.1572014103484705e-31
EarlyStopping counter: 93 out of 100
Updating learning rate to 5.786007051742352e-32
EarlyStopping counter: 94 out of 100
Updating learning rate to 2.893003525871176e-32
EarlyStopping counter: 95 out of 100
Updating learning rate to 1.446501762935588e-32
EarlyStopping counter: 96 out of 100
Updating learning rate to 7.23250881467794e-33
EarlyStopping counter: 97 out of 100
Updating learning rate to 3.61625440733897e-33
EarlyStopping counter: 98 out of 100
Updating learning rate to 1.808127203669485e-33
EarlyStopping counter: 99 out of 100
Updating learning rate to 9.040636018347426e-34
>>>>>> Testing on validation set: trial_35 >>>>>>
test 248
test shape: (248, 14, 5) (248, 14, 5)
test shape: (248, 14, 5) (248, 14, 5)


	mse:0.06514021754264832, mae:0.09998467564582825, dtw:Not calculated


                                                                                         [I 2025-10-17 01:22:32,987] Trial 35 finished with value: 0.09998467564582825 and parameters: {'seq_len': 48, 'pred_len': 14, 'expand': 1, 'd_model': 64, 'n_heads': 4, 'e_layers': 1, 'd_layers': 2, 'batch_size': 16, 'learning_rate': 0.0005730183837551532, 'dropout': 0.09116185562593482}. Best is trial 23 with value: 0.07065031677484512.
Best trial: 23. Best value: 0.0706503:  70%|███████   | 35/50 [1:29:26<32:16, 129.07s/it]Best trial: 23. Best value: 0.0706503:  70%|███████   | 35/50 [1:29:26<32:16, 129.07s/it]Best trial: 23. Best value: 0.0706503:  72%|███████▏  | 36/50 [1:29:26<39:21, 168.65s/it]
============================================================
Trial 36
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 1
batch_size: 32, lr: 0.000841
dropout: 0.023324304141522752
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_36 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.024301).  Saving model ...
Updating learning rate to 0.0008412359308300446
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0004206179654150223
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.00021030898270751116
EarlyStopping counter: 3 out of 100
Updating learning rate to 0.00010515449135375558
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.257724567687779e-05
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.6288622838438895e-05
Validation loss decreased (0.024301 --> 0.023731).  Saving model ...
Updating learning rate to 1.3144311419219447e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.572155709609724e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.286077854804862e-06
Validation loss decreased (0.023731 --> 0.023395).  Saving model ...
Updating learning rate to 1.643038927402431e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.215194637012155e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.1075973185060773e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0537986592530386e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0268993296265193e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.1344966481325966e-08
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.5672483240662983e-08
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.2836241620331491e-08
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.418120810165746e-09
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.209060405082873e-09
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.6045302025414364e-09
EarlyStopping counter: 11 out of 100
Updating learning rate to 8.022651012707182e-10
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.011325506353591e-10
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.0056627531767955e-10
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.0028313765883978e-10
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.014156882941989e-11
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.5070784414709944e-11
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.2535392207354972e-11
EarlyStopping counter: 18 out of 100
Updating learning rate to 6.267696103677486e-12
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.133848051838743e-12
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.5669240259193715e-12
EarlyStopping counter: 21 out of 100
Updating learning rate to 7.834620129596858e-13
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.917310064798429e-13
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.9586550323992144e-13
EarlyStopping counter: 24 out of 100
Updating learning rate to 9.793275161996072e-14
EarlyStopping counter: 25 out of 100
Updating learning rate to 4.896637580998036e-14
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.448318790499018e-14
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.224159395249509e-14
EarlyStopping counter: 28 out of 100
Updating learning rate to 6.120796976247545e-15
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.0603984881237725e-15
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.5301992440618863e-15
EarlyStopping counter: 31 out of 100
Updating learning rate to 7.650996220309431e-16
EarlyStopping counter: 32 out of 100
Updating learning rate to 3.8254981101547156e-16
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.9127490550773578e-16
EarlyStopping counter: 34 out of 100
Updating learning rate to 9.563745275386789e-17
EarlyStopping counter: 35 out of 100
Updating learning rate to 4.7818726376933945e-17
EarlyStopping counter: 36 out of 100
Updating learning rate to 2.3909363188466973e-17
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.1954681594233486e-17
EarlyStopping counter: 38 out of 100
Updating learning rate to 5.977340797116743e-18
EarlyStopping counter: 39 out of 100
Updating learning rate to 2.9886703985583716e-18
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.4943351992791858e-18
EarlyStopping counter: 41 out of 100
Updating learning rate to 7.471675996395929e-19
Validation loss decreased (0.023395 --> 0.023230).  Saving model ...
Updating learning rate to 3.7358379981979645e-19
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8679189990989822e-19
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.339594995494911e-20
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.6697974977474556e-20
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.3348987488737278e-20
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1674493744368639e-20
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.8372468721843195e-21
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.9186234360921597e-21
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.4593117180460799e-21
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.296558590230399e-22
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.6482792951151997e-22
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.8241396475575998e-22
EarlyStopping counter: 12 out of 100
Updating learning rate to 9.120698237787999e-23
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.5603491188939996e-23
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.2801745594469998e-23
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.1400872797234999e-23
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.7004363986174995e-24
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.8502181993087498e-24
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.4251090996543749e-24
EarlyStopping counter: 19 out of 100
Updating learning rate to 7.125545498271874e-25
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.562772749135937e-25
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.7813863745679686e-25
EarlyStopping counter: 22 out of 100
Updating learning rate to 8.906931872839843e-26
EarlyStopping counter: 23 out of 100
Updating learning rate to 4.4534659364199215e-26
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.2267329682099607e-26
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.1133664841049804e-26
EarlyStopping counter: 26 out of 100
Updating learning rate to 5.566832420524902e-27
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.783416210262451e-27
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.3917081051312255e-27
EarlyStopping counter: 29 out of 100
Updating learning rate to 6.958540525656127e-28
EarlyStopping counter: 30 out of 100
Updating learning rate to 3.4792702628280637e-28
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.7396351314140318e-28
EarlyStopping counter: 32 out of 100
Updating learning rate to 8.698175657070159e-29
EarlyStopping counter: 33 out of 100
Updating learning rate to 4.3490878285350796e-29
EarlyStopping counter: 34 out of 100
Updating learning rate to 2.1745439142675398e-29
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.0872719571337699e-29
EarlyStopping counter: 36 out of 100
Updating learning rate to 5.4363597856688495e-30
EarlyStopping counter: 37 out of 100
Updating learning rate to 2.7181798928344247e-30
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.3590899464172124e-30
EarlyStopping counter: 39 out of 100
Updating learning rate to 6.795449732086062e-31
EarlyStopping counter: 40 out of 100
Updating learning rate to 3.397724866043031e-31
EarlyStopping counter: 41 out of 100
Updating learning rate to 1.6988624330215155e-31
EarlyStopping counter: 42 out of 100
Updating learning rate to 8.494312165107577e-32
EarlyStopping counter: 43 out of 100
Updating learning rate to 4.2471560825537887e-32
EarlyStopping counter: 44 out of 100
Updating learning rate to 2.1235780412768943e-32
EarlyStopping counter: 45 out of 100
Updating learning rate to 1.0617890206384472e-32
EarlyStopping counter: 46 out of 100
Updating learning rate to 5.308945103192236e-33
EarlyStopping counter: 47 out of 100
Updating learning rate to 2.654472551596118e-33
EarlyStopping counter: 48 out of 100
Updating learning rate to 1.327236275798059e-33
>>>>>> Testing on validation set: trial_36 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.051196422427892685, mae:0.07107055187225342, dtw:Not calculated


                                                                                         [I 2025-10-17 01:24:46,195] Trial 36 finished with value: 0.07107055187225342 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 1, 'batch_size': 32, 'learning_rate': 0.0008412359308300446, 'dropout': 0.023324304141522752}. Best is trial 23 with value: 0.07065031677484512.
Best trial: 23. Best value: 0.0706503:  72%|███████▏  | 36/50 [1:31:39<39:21, 168.65s/it]Best trial: 23. Best value: 0.0706503:  72%|███████▏  | 36/50 [1:31:39<39:21, 168.65s/it]Best trial: 23. Best value: 0.0706503:  74%|███████▍  | 37/50 [1:31:39<34:14, 158.02s/it]
============================================================
Trial 37
============================================================
seq_len: 48, pred_len: 7
d_model: 32, n_heads: 4
e_layers: 1, d_layers: 1
batch_size: 16, lr: 0.000988
dropout: 0.059119542923381965
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 32, expand: 1
>>>>>> Start training: trial_37 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 7
============================================================
train 4619
val 253
test 255
Validation loss decreased (inf --> 0.038126).  Saving model ...
Updating learning rate to 0.0009880555246435723
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0004940277623217862
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.0002470138811608931
EarlyStopping counter: 3 out of 100
Updating learning rate to 0.00012350694058044654
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.175347029022327e-05
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.0876735145111636e-05
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.5438367572555818e-05
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.719183786277909e-06
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.8595918931389545e-06
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.9297959465694772e-06
EarlyStopping counter: 10 out of 100
Updating learning rate to 9.648979732847386e-07
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.824489866423693e-07
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.4122449332118465e-07
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.2061224666059233e-07
EarlyStopping counter: 14 out of 100
Updating learning rate to 6.030612333029616e-08
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.015306166514808e-08
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.507653083257404e-08
EarlyStopping counter: 17 out of 100
Updating learning rate to 7.53826541628702e-09
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.76913270814351e-09
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.884566354071755e-09
EarlyStopping counter: 20 out of 100
Updating learning rate to 9.422831770358776e-10
EarlyStopping counter: 21 out of 100
Updating learning rate to 4.711415885179388e-10
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.355707942589694e-10
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.177853971294847e-10
EarlyStopping counter: 24 out of 100
Updating learning rate to 5.889269856474235e-11
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.9446349282371174e-11
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.4723174641185587e-11
EarlyStopping counter: 27 out of 100
Updating learning rate to 7.361587320592793e-12
EarlyStopping counter: 28 out of 100
Updating learning rate to 3.680793660296397e-12
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.8403968301481984e-12
EarlyStopping counter: 30 out of 100
Updating learning rate to 9.201984150740992e-13
EarlyStopping counter: 31 out of 100
Updating learning rate to 4.600992075370496e-13
EarlyStopping counter: 32 out of 100
Updating learning rate to 2.300496037685248e-13
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.150248018842624e-13
EarlyStopping counter: 34 out of 100
Updating learning rate to 5.75124009421312e-14
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.87562004710656e-14
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.43781002355328e-14
EarlyStopping counter: 37 out of 100
Updating learning rate to 7.1890501177664e-15
EarlyStopping counter: 38 out of 100
Updating learning rate to 3.5945250588832e-15
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.7972625294416e-15
EarlyStopping counter: 40 out of 100
Updating learning rate to 8.986312647208e-16
EarlyStopping counter: 41 out of 100
Updating learning rate to 4.493156323604e-16
EarlyStopping counter: 42 out of 100
Updating learning rate to 2.246578161802e-16
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.123289080901e-16
EarlyStopping counter: 44 out of 100
Updating learning rate to 5.616445404505e-17
EarlyStopping counter: 45 out of 100
Updating learning rate to 2.8082227022525e-17
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.40411135112625e-17
EarlyStopping counter: 47 out of 100
Updating learning rate to 7.02055675563125e-18
EarlyStopping counter: 48 out of 100
Updating learning rate to 3.510278377815625e-18
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.7551391889078125e-18
EarlyStopping counter: 50 out of 100
Updating learning rate to 8.775695944539062e-19
EarlyStopping counter: 51 out of 100
Updating learning rate to 4.387847972269531e-19
EarlyStopping counter: 52 out of 100
Updating learning rate to 2.1939239861347656e-19
EarlyStopping counter: 53 out of 100
Updating learning rate to 1.0969619930673828e-19
EarlyStopping counter: 54 out of 100
Updating learning rate to 5.484809965336914e-20
EarlyStopping counter: 55 out of 100
Updating learning rate to 2.742404982668457e-20
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.3712024913342285e-20
EarlyStopping counter: 57 out of 100
Updating learning rate to 6.856012456671142e-21
EarlyStopping counter: 58 out of 100
Updating learning rate to 3.428006228335571e-21
EarlyStopping counter: 59 out of 100
Updating learning rate to 1.7140031141677856e-21
EarlyStopping counter: 60 out of 100
Updating learning rate to 8.570015570838928e-22
EarlyStopping counter: 61 out of 100
Updating learning rate to 4.285007785419464e-22
EarlyStopping counter: 62 out of 100
Updating learning rate to 2.142503892709732e-22
EarlyStopping counter: 63 out of 100
Updating learning rate to 1.071251946354866e-22
EarlyStopping counter: 64 out of 100
Updating learning rate to 5.35625973177433e-23
EarlyStopping counter: 65 out of 100
Updating learning rate to 2.678129865887165e-23
EarlyStopping counter: 66 out of 100
Updating learning rate to 1.3390649329435825e-23
EarlyStopping counter: 67 out of 100
Updating learning rate to 6.695324664717913e-24
EarlyStopping counter: 68 out of 100
Updating learning rate to 3.347662332358956e-24
EarlyStopping counter: 69 out of 100
Updating learning rate to 1.673831166179478e-24
EarlyStopping counter: 70 out of 100
Updating learning rate to 8.36915583089739e-25
EarlyStopping counter: 71 out of 100
Updating learning rate to 4.184577915448695e-25
EarlyStopping counter: 72 out of 100
Updating learning rate to 2.0922889577243477e-25
EarlyStopping counter: 73 out of 100
Updating learning rate to 1.0461444788621738e-25
EarlyStopping counter: 74 out of 100
Updating learning rate to 5.230722394310869e-26
EarlyStopping counter: 75 out of 100
Updating learning rate to 2.6153611971554346e-26
EarlyStopping counter: 76 out of 100
Updating learning rate to 1.3076805985777173e-26
EarlyStopping counter: 77 out of 100
Updating learning rate to 6.538402992888586e-27
EarlyStopping counter: 78 out of 100
Updating learning rate to 3.269201496444293e-27
EarlyStopping counter: 79 out of 100
Updating learning rate to 1.6346007482221466e-27
EarlyStopping counter: 80 out of 100
Updating learning rate to 8.173003741110733e-28
EarlyStopping counter: 81 out of 100
Updating learning rate to 4.0865018705553665e-28
EarlyStopping counter: 82 out of 100
Updating learning rate to 2.0432509352776833e-28
EarlyStopping counter: 83 out of 100
Updating learning rate to 1.0216254676388416e-28
EarlyStopping counter: 84 out of 100
Updating learning rate to 5.108127338194208e-29
EarlyStopping counter: 85 out of 100
Updating learning rate to 2.554063669097104e-29
EarlyStopping counter: 86 out of 100
Updating learning rate to 1.277031834548552e-29
EarlyStopping counter: 87 out of 100
Updating learning rate to 6.38515917274276e-30
EarlyStopping counter: 88 out of 100
Updating learning rate to 3.19257958637138e-30
EarlyStopping counter: 89 out of 100
Updating learning rate to 1.59628979318569e-30
EarlyStopping counter: 90 out of 100
Updating learning rate to 7.98144896592845e-31
EarlyStopping counter: 91 out of 100
Updating learning rate to 3.990724482964225e-31
EarlyStopping counter: 92 out of 100
Updating learning rate to 1.9953622414821126e-31
EarlyStopping counter: 93 out of 100
Updating learning rate to 9.976811207410563e-32
EarlyStopping counter: 94 out of 100
Updating learning rate to 4.988405603705281e-32
EarlyStopping counter: 95 out of 100
Updating learning rate to 2.4942028018526407e-32
EarlyStopping counter: 96 out of 100
Updating learning rate to 1.2471014009263203e-32
EarlyStopping counter: 97 out of 100
Updating learning rate to 6.235507004631602e-33
EarlyStopping counter: 98 out of 100
Updating learning rate to 3.117753502315801e-33
EarlyStopping counter: 99 out of 100
Updating learning rate to 1.5588767511579004e-33
>>>>>> Testing on validation set: trial_37 >>>>>>
test 255
test shape: (255, 7, 5) (255, 7, 5)
test shape: (255, 7, 5) (255, 7, 5)


	mse:0.06869998574256897, mae:0.0995197519659996, dtw:Not calculated


                                                                                         [I 2025-10-17 01:29:06,182] Trial 37 finished with value: 0.0995197519659996 and parameters: {'seq_len': 48, 'pred_len': 7, 'expand': 1, 'd_model': 32, 'n_heads': 4, 'e_layers': 1, 'd_layers': 1, 'batch_size': 16, 'learning_rate': 0.0009880555246435723, 'dropout': 0.059119542923381965}. Best is trial 23 with value: 0.07065031677484512.
Best trial: 23. Best value: 0.0706503:  74%|███████▍  | 37/50 [1:35:59<34:14, 158.02s/it]Best trial: 23. Best value: 0.0706503:  74%|███████▍  | 37/50 [1:35:59<34:14, 158.02s/it]Best trial: 23. Best value: 0.0706503:  76%|███████▌  | 38/50 [1:35:59<37:43, 188.61s/it]
============================================================
Trial 38
============================================================
seq_len: 96, pred_len: 30
d_model: 64, n_heads: 8
e_layers: 2, d_layers: 1
batch_size: 32, lr: 0.000193
dropout: 0.01436838581311402
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_38 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 30
============================================================
train 4548
val 230
test 232
Validation loss decreased (inf --> 0.037295).  Saving model ...
Updating learning rate to 0.0001928929836444459
Validation loss decreased (0.037295 --> 0.036614).  Saving model ...
Updating learning rate to 9.644649182222295e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.822324591111148e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.411162295555574e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.205581147777787e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.027905738888935e-06
Validation loss decreased (0.036614 --> 0.035691).  Saving model ...
Updating learning rate to 3.0139528694444673e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5069764347222336e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.534882173611168e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.767441086805584e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.883720543402792e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.41860271701396e-08
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.70930135850698e-08
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.35465067925349e-08
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.177325339626745e-08
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.886626698133725e-09
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.9433133490668626e-09
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.4716566745334313e-09
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.358283372667156e-10
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.679141686333578e-10
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.839570843166789e-10
EarlyStopping counter: 15 out of 100
Updating learning rate to 9.197854215833946e-11
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.598927107916973e-11
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.2994635539584864e-11
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.1497317769792432e-11
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.748658884896216e-12
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.874329442448108e-12
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.437164721224054e-12
EarlyStopping counter: 22 out of 100
Updating learning rate to 7.18582360612027e-13
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.592911803060135e-13
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.7964559015300675e-13
EarlyStopping counter: 25 out of 100
Updating learning rate to 8.982279507650338e-14
EarlyStopping counter: 26 out of 100
Updating learning rate to 4.491139753825169e-14
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.2455698769125844e-14
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.1227849384562922e-14
EarlyStopping counter: 29 out of 100
Updating learning rate to 5.613924692281461e-15
EarlyStopping counter: 30 out of 100
Updating learning rate to 2.8069623461407305e-15
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.4034811730703652e-15
EarlyStopping counter: 32 out of 100
Updating learning rate to 7.017405865351826e-16
EarlyStopping counter: 33 out of 100
Updating learning rate to 3.508702932675913e-16
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.7543514663379565e-16
EarlyStopping counter: 35 out of 100
Updating learning rate to 8.771757331689783e-17
EarlyStopping counter: 36 out of 100
Updating learning rate to 4.3858786658448914e-17
EarlyStopping counter: 37 out of 100
Updating learning rate to 2.1929393329224457e-17
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.0964696664612228e-17
EarlyStopping counter: 39 out of 100
Updating learning rate to 5.482348332306114e-18
EarlyStopping counter: 40 out of 100
Updating learning rate to 2.741174166153057e-18
EarlyStopping counter: 41 out of 100
Updating learning rate to 1.3705870830765285e-18
EarlyStopping counter: 42 out of 100
Updating learning rate to 6.852935415382643e-19
EarlyStopping counter: 43 out of 100
Updating learning rate to 3.4264677076913214e-19
EarlyStopping counter: 44 out of 100
Updating learning rate to 1.7132338538456607e-19
EarlyStopping counter: 45 out of 100
Updating learning rate to 8.566169269228303e-20
EarlyStopping counter: 46 out of 100
Updating learning rate to 4.283084634614152e-20
EarlyStopping counter: 47 out of 100
Updating learning rate to 2.141542317307076e-20
EarlyStopping counter: 48 out of 100
Updating learning rate to 1.070771158653538e-20
EarlyStopping counter: 49 out of 100
Updating learning rate to 5.35385579326769e-21
EarlyStopping counter: 50 out of 100
Updating learning rate to 2.676927896633845e-21
EarlyStopping counter: 51 out of 100
Updating learning rate to 1.3384639483169224e-21
EarlyStopping counter: 52 out of 100
Updating learning rate to 6.692319741584612e-22
EarlyStopping counter: 53 out of 100
Updating learning rate to 3.346159870792306e-22
EarlyStopping counter: 54 out of 100
Updating learning rate to 1.673079935396153e-22
EarlyStopping counter: 55 out of 100
Updating learning rate to 8.365399676980765e-23
EarlyStopping counter: 56 out of 100
Updating learning rate to 4.1826998384903825e-23
EarlyStopping counter: 57 out of 100
Updating learning rate to 2.0913499192451913e-23
EarlyStopping counter: 58 out of 100
Updating learning rate to 1.0456749596225956e-23
EarlyStopping counter: 59 out of 100
Updating learning rate to 5.228374798112978e-24
EarlyStopping counter: 60 out of 100
Updating learning rate to 2.614187399056489e-24
EarlyStopping counter: 61 out of 100
Updating learning rate to 1.3070936995282445e-24
EarlyStopping counter: 62 out of 100
Updating learning rate to 6.535468497641223e-25
EarlyStopping counter: 63 out of 100
Updating learning rate to 3.2677342488206114e-25
EarlyStopping counter: 64 out of 100
Updating learning rate to 1.6338671244103057e-25
EarlyStopping counter: 65 out of 100
Updating learning rate to 8.169335622051528e-26
EarlyStopping counter: 66 out of 100
Updating learning rate to 4.084667811025764e-26
EarlyStopping counter: 67 out of 100
Updating learning rate to 2.042333905512882e-26
EarlyStopping counter: 68 out of 100
Updating learning rate to 1.021166952756441e-26
EarlyStopping counter: 69 out of 100
Updating learning rate to 5.105834763782205e-27
EarlyStopping counter: 70 out of 100
Updating learning rate to 2.5529173818911026e-27
EarlyStopping counter: 71 out of 100
Updating learning rate to 1.2764586909455513e-27
EarlyStopping counter: 72 out of 100
Updating learning rate to 6.382293454727757e-28
EarlyStopping counter: 73 out of 100
Updating learning rate to 3.1911467273638783e-28
EarlyStopping counter: 74 out of 100
Updating learning rate to 1.5955733636819391e-28
EarlyStopping counter: 75 out of 100
Updating learning rate to 7.977866818409696e-29
EarlyStopping counter: 76 out of 100
Updating learning rate to 3.988933409204848e-29
EarlyStopping counter: 77 out of 100
Updating learning rate to 1.994466704602424e-29
EarlyStopping counter: 78 out of 100
Updating learning rate to 9.97233352301212e-30
EarlyStopping counter: 79 out of 100
Updating learning rate to 4.98616676150606e-30
EarlyStopping counter: 80 out of 100
Updating learning rate to 2.49308338075303e-30
EarlyStopping counter: 81 out of 100
Updating learning rate to 1.246541690376515e-30
EarlyStopping counter: 82 out of 100
Updating learning rate to 6.232708451882575e-31
EarlyStopping counter: 83 out of 100
Updating learning rate to 3.1163542259412874e-31
EarlyStopping counter: 84 out of 100
Updating learning rate to 1.5581771129706437e-31
EarlyStopping counter: 85 out of 100
Updating learning rate to 7.790885564853218e-32
EarlyStopping counter: 86 out of 100
Updating learning rate to 3.895442782426609e-32
EarlyStopping counter: 87 out of 100
Updating learning rate to 1.9477213912133046e-32
EarlyStopping counter: 88 out of 100
Updating learning rate to 9.738606956066523e-33
EarlyStopping counter: 89 out of 100
Updating learning rate to 4.8693034780332615e-33
EarlyStopping counter: 90 out of 100
Updating learning rate to 2.4346517390166308e-33
EarlyStopping counter: 91 out of 100
Updating learning rate to 1.2173258695083154e-33
Validation loss decreased (0.035691 --> 0.035624).  Saving model ...
Updating learning rate to 6.086629347541577e-34
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.0433146737707885e-34
>>>>>> Testing on validation set: trial_38 >>>>>>
test 232
test shape: (232, 30, 5) (232, 30, 5)
test shape: (232, 30, 5) (232, 30, 5)


	mse:0.07170645147562027, mae:0.11434338986873627, dtw:Not calculated


                                                                                         [I 2025-10-17 01:31:18,019] Trial 38 finished with value: 0.11434338986873627 and parameters: {'seq_len': 96, 'pred_len': 30, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 2, 'd_layers': 1, 'batch_size': 32, 'learning_rate': 0.0001928929836444459, 'dropout': 0.01436838581311402}. Best is trial 23 with value: 0.07065031677484512.
Best trial: 23. Best value: 0.0706503:  76%|███████▌  | 38/50 [1:38:11<37:43, 188.61s/it]Best trial: 23. Best value: 0.0706503:  76%|███████▌  | 38/50 [1:38:11<37:43, 188.61s/it]Best trial: 23. Best value: 0.0706503:  78%|███████▊  | 39/50 [1:38:11<31:27, 171.58s/it]
============================================================
Trial 39
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 4
e_layers: 1, d_layers: 1
batch_size: 32, lr: 0.000784
dropout: 0.240511642428416
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_39 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.024807).  Saving model ...
Updating learning rate to 0.0007838147433218849
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00039190737166094246
Validation loss decreased (0.024807 --> 0.024313).  Saving model ...
Updating learning rate to 0.00019595368583047123
Validation loss decreased (0.024313 --> 0.023958).  Saving model ...
Updating learning rate to 9.797684291523562e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.898842145761781e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.4494210728808904e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2247105364404452e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.123552682202226e-06
Validation loss decreased (0.023958 --> 0.023780).  Saving model ...
Updating learning rate to 3.061776341101113e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5308881705505565e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.654440852752782e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.827220426376391e-07
Validation loss decreased (0.023780 --> 0.023622).  Saving model ...
Updating learning rate to 1.9136102131881956e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.568051065940978e-08
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.784025532970489e-08
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.3920127664852445e-08
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1960063832426223e-08
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.980031916213111e-09
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.9900159581065556e-09
Validation loss decreased (0.023622 --> 0.023525).  Saving model ...
Updating learning rate to 1.4950079790532778e-09
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.475039895266389e-10
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.7375199476331945e-10
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8687599738165973e-10
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.343799869082986e-11
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.671899934541493e-11
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.3359499672707466e-11
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1679749836353733e-11
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.8398749181768665e-12
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.9199374590884332e-12
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.4599687295442166e-12
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.299843647721083e-13
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.6499218238605415e-13
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.8249609119302708e-13
EarlyStopping counter: 14 out of 100
Updating learning rate to 9.124804559651354e-14
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.562402279825677e-14
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.2812011399128385e-14
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.1406005699564192e-14
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.703002849782096e-15
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.851501424891048e-15
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.425750712445524e-15
EarlyStopping counter: 21 out of 100
Updating learning rate to 7.12875356222762e-16
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.56437678111381e-16
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.782188390556905e-16
EarlyStopping counter: 24 out of 100
Updating learning rate to 8.910941952784525e-17
EarlyStopping counter: 25 out of 100
Updating learning rate to 4.4554709763922626e-17
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.2277354881961313e-17
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.1138677440980657e-17
EarlyStopping counter: 28 out of 100
Updating learning rate to 5.569338720490328e-18
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.784669360245164e-18
Validation loss decreased (0.023525 --> 0.023413).  Saving model ...
Updating learning rate to 1.392334680122582e-18
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.96167340061291e-19
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.480836700306455e-19
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.7404183501532276e-19
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.702091750766138e-20
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.351045875383069e-20
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.1755229376915345e-20
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.0877614688457672e-20
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.438807344228836e-21
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.719403672114418e-21
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.359701836057209e-21
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.798509180286045e-22
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.3992545901430226e-22
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.6996272950715113e-22
EarlyStopping counter: 14 out of 100
Updating learning rate to 8.498136475357557e-23
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.2490682376787783e-23
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.1245341188393891e-23
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.0622670594196946e-23
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.311335297098473e-24
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.6556676485492364e-24
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.3278338242746182e-24
EarlyStopping counter: 21 out of 100
Updating learning rate to 6.639169121373091e-25
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.3195845606865455e-25
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.6597922803432728e-25
EarlyStopping counter: 24 out of 100
Updating learning rate to 8.298961401716364e-26
EarlyStopping counter: 25 out of 100
Updating learning rate to 4.149480700858182e-26
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.074740350429091e-26
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.0373701752145455e-26
EarlyStopping counter: 28 out of 100
Updating learning rate to 5.1868508760727274e-27
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.5934254380363637e-27
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.2967127190181819e-27
EarlyStopping counter: 31 out of 100
Updating learning rate to 6.483563595090909e-28
EarlyStopping counter: 32 out of 100
Updating learning rate to 3.2417817975454546e-28
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.6208908987727273e-28
EarlyStopping counter: 34 out of 100
Updating learning rate to 8.104454493863637e-29
EarlyStopping counter: 35 out of 100
Updating learning rate to 4.0522272469318183e-29
EarlyStopping counter: 36 out of 100
Updating learning rate to 2.0261136234659091e-29
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.0130568117329546e-29
EarlyStopping counter: 38 out of 100
Updating learning rate to 5.065284058664773e-30
EarlyStopping counter: 39 out of 100
Updating learning rate to 2.5326420293323864e-30
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.2663210146661932e-30
EarlyStopping counter: 41 out of 100
Updating learning rate to 6.331605073330966e-31
EarlyStopping counter: 42 out of 100
Updating learning rate to 3.165802536665483e-31
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.5829012683327415e-31
EarlyStopping counter: 44 out of 100
Updating learning rate to 7.914506341663708e-32
EarlyStopping counter: 45 out of 100
Updating learning rate to 3.957253170831854e-32
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.978626585415927e-32
EarlyStopping counter: 47 out of 100
Updating learning rate to 9.893132927079634e-33
EarlyStopping counter: 48 out of 100
Updating learning rate to 4.946566463539817e-33
EarlyStopping counter: 49 out of 100
Updating learning rate to 2.4732832317699086e-33
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.2366416158849543e-33
>>>>>> Testing on validation set: trial_39 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.05010296404361725, mae:0.07135666906833649, dtw:Not calculated


                                                                                         [I 2025-10-17 01:33:32,728] Trial 39 finished with value: 0.07135666906833649 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 2, 'd_model': 64, 'n_heads': 4, 'e_layers': 1, 'd_layers': 1, 'batch_size': 32, 'learning_rate': 0.0007838147433218849, 'dropout': 0.240511642428416}. Best is trial 23 with value: 0.07065031677484512.
Best trial: 23. Best value: 0.0706503:  78%|███████▊  | 39/50 [1:40:26<31:27, 171.58s/it]Best trial: 23. Best value: 0.0706503:  78%|███████▊  | 39/50 [1:40:26<31:27, 171.58s/it]Best trial: 23. Best value: 0.0706503:  80%|████████  | 40/50 [1:40:26<26:45, 160.52s/it]
============================================================
Trial 40
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 4
e_layers: 1, d_layers: 1
batch_size: 32, lr: 0.000770
dropout: 0.2560222530450992
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_40 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.031479).  Saving model ...
Updating learning rate to 0.0007699765207299673
Validation loss decreased (0.031479 --> 0.025644).  Saving model ...
Updating learning rate to 0.00038498826036498365
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00019249413018249182
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.624706509124591e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.8123532545622956e-05
Validation loss decreased (0.025644 --> 0.024332).  Saving model ...
Updating learning rate to 2.4061766272811478e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2030883136405739e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.0154415682028695e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.0077207841014348e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5038603920507174e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.519301960253587e-07
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.7596509801267935e-07
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8798254900633967e-07
Validation loss decreased (0.024332 --> 0.024261).  Saving model ...
Updating learning rate to 9.399127450316984e-08
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.699563725158492e-08
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.349781862579246e-08
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.174890931289623e-08
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.874454656448115e-09
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.9372273282240574e-09
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.4686136641120287e-09
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.343068320560143e-10
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.6715341602800717e-10
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.8357670801400359e-10
EarlyStopping counter: 10 out of 100
Updating learning rate to 9.178835400700179e-11
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.5894177003500897e-11
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.2947088501750448e-11
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.1473544250875224e-11
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.736772125437612e-12
Validation loss decreased (0.024261 --> 0.024115).  Saving model ...
Updating learning rate to 2.868386062718806e-12
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.434193031359403e-12
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.170965156797015e-13
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.5854825783985076e-13
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.7927412891992538e-13
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.963706445996269e-14
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.4818532229981344e-14
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2409266114990672e-14
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.1204633057495336e-14
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.602316528747668e-15
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.801158264373834e-15
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.400579132186917e-15
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.002895660934585e-16
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.5014478304672925e-16
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.7507239152336463e-16
EarlyStopping counter: 15 out of 100
Updating learning rate to 8.753619576168231e-17
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.3768097880841157e-17
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.1884048940420578e-17
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.0942024470210289e-17
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.4710122351051446e-18
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.7355061175525723e-18
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.3677530587762861e-18
EarlyStopping counter: 22 out of 100
Updating learning rate to 6.838765293881431e-19
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.4193826469407154e-19
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.7096913234703577e-19
EarlyStopping counter: 25 out of 100
Updating learning rate to 8.548456617351788e-20
EarlyStopping counter: 26 out of 100
Updating learning rate to 4.274228308675894e-20
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.137114154337947e-20
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.0685570771689736e-20
EarlyStopping counter: 29 out of 100
Updating learning rate to 5.342785385844868e-21
EarlyStopping counter: 30 out of 100
Updating learning rate to 2.671392692922434e-21
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.335696346461217e-21
EarlyStopping counter: 32 out of 100
Updating learning rate to 6.678481732306085e-22
EarlyStopping counter: 33 out of 100
Updating learning rate to 3.3392408661530423e-22
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.6696204330765212e-22
EarlyStopping counter: 35 out of 100
Updating learning rate to 8.348102165382606e-23
EarlyStopping counter: 36 out of 100
Updating learning rate to 4.174051082691303e-23
EarlyStopping counter: 37 out of 100
Updating learning rate to 2.0870255413456515e-23
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.0435127706728257e-23
EarlyStopping counter: 39 out of 100
Updating learning rate to 5.217563853364129e-24
EarlyStopping counter: 40 out of 100
Updating learning rate to 2.6087819266820643e-24
EarlyStopping counter: 41 out of 100
Updating learning rate to 1.3043909633410322e-24
EarlyStopping counter: 42 out of 100
Updating learning rate to 6.521954816705161e-25
EarlyStopping counter: 43 out of 100
Updating learning rate to 3.2609774083525804e-25
EarlyStopping counter: 44 out of 100
Updating learning rate to 1.6304887041762902e-25
EarlyStopping counter: 45 out of 100
Updating learning rate to 8.152443520881451e-26
EarlyStopping counter: 46 out of 100
Updating learning rate to 4.0762217604407255e-26
EarlyStopping counter: 47 out of 100
Updating learning rate to 2.0381108802203628e-26
EarlyStopping counter: 48 out of 100
Updating learning rate to 1.0190554401101814e-26
EarlyStopping counter: 49 out of 100
Updating learning rate to 5.095277200550907e-27
EarlyStopping counter: 50 out of 100
Updating learning rate to 2.5476386002754535e-27
EarlyStopping counter: 51 out of 100
Updating learning rate to 1.2738193001377267e-27
EarlyStopping counter: 52 out of 100
Updating learning rate to 6.369096500688634e-28
EarlyStopping counter: 53 out of 100
Updating learning rate to 3.184548250344317e-28
EarlyStopping counter: 54 out of 100
Updating learning rate to 1.5922741251721584e-28
EarlyStopping counter: 55 out of 100
Updating learning rate to 7.961370625860792e-29
EarlyStopping counter: 56 out of 100
Updating learning rate to 3.980685312930396e-29
EarlyStopping counter: 57 out of 100
Updating learning rate to 1.990342656465198e-29
EarlyStopping counter: 58 out of 100
Updating learning rate to 9.95171328232599e-30
EarlyStopping counter: 59 out of 100
Updating learning rate to 4.975856641162995e-30
EarlyStopping counter: 60 out of 100
Updating learning rate to 2.4879283205814975e-30
EarlyStopping counter: 61 out of 100
Updating learning rate to 1.2439641602907488e-30
EarlyStopping counter: 62 out of 100
Updating learning rate to 6.219820801453744e-31
EarlyStopping counter: 63 out of 100
Updating learning rate to 3.109910400726872e-31
EarlyStopping counter: 64 out of 100
Updating learning rate to 1.554955200363436e-31
EarlyStopping counter: 65 out of 100
Updating learning rate to 7.77477600181718e-32
EarlyStopping counter: 66 out of 100
Updating learning rate to 3.88738800090859e-32
EarlyStopping counter: 67 out of 100
Updating learning rate to 1.943694000454295e-32
EarlyStopping counter: 68 out of 100
Updating learning rate to 9.718470002271475e-33
EarlyStopping counter: 69 out of 100
Updating learning rate to 4.859235001135737e-33
EarlyStopping counter: 70 out of 100
Updating learning rate to 2.4296175005678687e-33
EarlyStopping counter: 71 out of 100
Updating learning rate to 1.2148087502839343e-33
>>>>>> Testing on validation set: trial_40 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.050250593572854996, mae:0.07235243171453476, dtw:Not calculated


                                                                                         [I 2025-10-17 01:35:46,057] Trial 40 finished with value: 0.07235243171453476 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 1, 'd_model': 64, 'n_heads': 4, 'e_layers': 1, 'd_layers': 1, 'batch_size': 32, 'learning_rate': 0.0007699765207299673, 'dropout': 0.2560222530450992}. Best is trial 23 with value: 0.07065031677484512.
Best trial: 23. Best value: 0.0706503:  80%|████████  | 40/50 [1:42:39<26:45, 160.52s/it]Best trial: 23. Best value: 0.0706503:  80%|████████  | 40/50 [1:42:39<26:45, 160.52s/it]Best trial: 23. Best value: 0.0706503:  82%|████████▏ | 41/50 [1:42:39<22:51, 152.37s/it]
============================================================
Trial 41
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 4
e_layers: 1, d_layers: 1
batch_size: 32, lr: 0.000742
dropout: 0.22543506918275288
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_41 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.027714).  Saving model ...
Updating learning rate to 0.0007417542767555797
Validation loss decreased (0.027714 --> 0.024760).  Saving model ...
Updating learning rate to 0.00037087713837778984
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00018543856918889492
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.271928459444746e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.635964229722373e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.3179821148611865e-05
Validation loss decreased (0.024760 --> 0.024756).  Saving model ...
Updating learning rate to 1.1589910574305932e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.794955287152966e-06
Validation loss decreased (0.024756 --> 0.024692).  Saving model ...
Updating learning rate to 2.897477643576483e-06
Validation loss decreased (0.024692 --> 0.024276).  Saving model ...
Updating learning rate to 1.4487388217882416e-06
Validation loss decreased (0.024276 --> 0.024154).  Saving model ...
Updating learning rate to 7.243694108941208e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.621847054470604e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.810923527235302e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.05461763617651e-08
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.527308818088255e-08
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2636544090441274e-08
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1318272045220637e-08
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.6591360226103186e-09
Validation loss decreased (0.024154 --> 0.024051).  Saving model ...
Updating learning rate to 2.8295680113051593e-09
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4147840056525796e-09
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.073920028262898e-10
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.536960014131449e-10
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.7684800070657246e-10
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.842400035328623e-11
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.4212000176643114e-11
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2106000088321557e-11
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.1053000044160778e-11
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.526500022080389e-12
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7632500110401946e-12
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.3816250055200973e-12
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.908125027600487e-13
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.4540625138002433e-13
Validation loss decreased (0.024051 --> 0.023935).  Saving model ...
Updating learning rate to 1.7270312569001216e-13
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.635156284500608e-14
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.317578142250304e-14
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.158789071125152e-14
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.079394535562576e-14
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.39697267781288e-15
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.69848633890644e-15
Validation loss decreased (0.023935 --> 0.023838).  Saving model ...
Updating learning rate to 1.34924316945322e-15
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.7462158472661e-16
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.37310792363305e-16
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.686553961816525e-16
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.432769809082625e-17
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.2163849045413126e-17
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.1081924522706563e-17
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.0540962261353281e-17
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.270481130676641e-18
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.6352405653383204e-18
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.3176202826691602e-18
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.588101413345801e-19
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.2940507066729005e-19
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.6470253533364502e-19
EarlyStopping counter: 14 out of 100
Updating learning rate to 8.235126766682251e-20
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.1175633833411256e-20
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.0587816916705628e-20
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.0293908458352814e-20
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.146954229176407e-21
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.5734771145882035e-21
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.2867385572941017e-21
EarlyStopping counter: 21 out of 100
Updating learning rate to 6.433692786470509e-22
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.2168463932352544e-22
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.6084231966176272e-22
EarlyStopping counter: 24 out of 100
Updating learning rate to 8.042115983088136e-23
EarlyStopping counter: 25 out of 100
Updating learning rate to 4.021057991544068e-23
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.010528995772034e-23
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.005264497886017e-23
EarlyStopping counter: 28 out of 100
Updating learning rate to 5.026322489430085e-24
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.5131612447150425e-24
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.2565806223575212e-24
EarlyStopping counter: 31 out of 100
Updating learning rate to 6.282903111787606e-25
EarlyStopping counter: 32 out of 100
Updating learning rate to 3.141451555893803e-25
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.5707257779469015e-25
EarlyStopping counter: 34 out of 100
Updating learning rate to 7.853628889734508e-26
EarlyStopping counter: 35 out of 100
Updating learning rate to 3.926814444867254e-26
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.963407222433627e-26
EarlyStopping counter: 37 out of 100
Updating learning rate to 9.817036112168135e-27
EarlyStopping counter: 38 out of 100
Updating learning rate to 4.908518056084067e-27
EarlyStopping counter: 39 out of 100
Updating learning rate to 2.4542590280420337e-27
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.2271295140210168e-27
EarlyStopping counter: 41 out of 100
Updating learning rate to 6.135647570105084e-28
EarlyStopping counter: 42 out of 100
Updating learning rate to 3.067823785052542e-28
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.533911892526271e-28
EarlyStopping counter: 44 out of 100
Updating learning rate to 7.669559462631355e-29
EarlyStopping counter: 45 out of 100
Updating learning rate to 3.8347797313156776e-29
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.9173898656578388e-29
EarlyStopping counter: 47 out of 100
Updating learning rate to 9.586949328289194e-30
EarlyStopping counter: 48 out of 100
Updating learning rate to 4.793474664144597e-30
EarlyStopping counter: 49 out of 100
Updating learning rate to 2.3967373320722985e-30
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.1983686660361492e-30
EarlyStopping counter: 51 out of 100
Updating learning rate to 5.991843330180746e-31
EarlyStopping counter: 52 out of 100
Updating learning rate to 2.995921665090373e-31
EarlyStopping counter: 53 out of 100
Updating learning rate to 1.4979608325451866e-31
EarlyStopping counter: 54 out of 100
Updating learning rate to 7.489804162725933e-32
EarlyStopping counter: 55 out of 100
Updating learning rate to 3.7449020813629664e-32
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.8724510406814832e-32
EarlyStopping counter: 57 out of 100
Updating learning rate to 9.362255203407416e-33
EarlyStopping counter: 58 out of 100
Updating learning rate to 4.681127601703708e-33
EarlyStopping counter: 59 out of 100
Updating learning rate to 2.340563800851854e-33
EarlyStopping counter: 60 out of 100
Updating learning rate to 1.170281900425927e-33
>>>>>> Testing on validation set: trial_41 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.050415992736816406, mae:0.07174646109342575, dtw:Not calculated


                                                                                         [I 2025-10-17 01:38:00,805] Trial 41 finished with value: 0.07174646109342575 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 2, 'd_model': 64, 'n_heads': 4, 'e_layers': 1, 'd_layers': 1, 'batch_size': 32, 'learning_rate': 0.0007417542767555797, 'dropout': 0.22543506918275288}. Best is trial 23 with value: 0.07065031677484512.
Best trial: 23. Best value: 0.0706503:  82%|████████▏ | 41/50 [1:44:54<22:51, 152.37s/it]Best trial: 23. Best value: 0.0706503:  82%|████████▏ | 41/50 [1:44:54<22:51, 152.37s/it]Best trial: 23. Best value: 0.0706503:  84%|████████▍ | 42/50 [1:44:54<19:36, 147.08s/it]
============================================================
Trial 42
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 4
e_layers: 1, d_layers: 1
batch_size: 32, lr: 0.000710
dropout: 0.2513346337650674
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_42 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.038755).  Saving model ...
Updating learning rate to 0.000710478346507065
Validation loss decreased (0.038755 --> 0.026895).  Saving model ...
Updating learning rate to 0.0003552391732535325
Validation loss decreased (0.026895 --> 0.025865).  Saving model ...
Updating learning rate to 0.00017761958662676624
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.880979331338312e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.440489665669156e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.220244832834578e-05
Validation loss decreased (0.025865 --> 0.024727).  Saving model ...
Updating learning rate to 1.110122416417289e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.550612082086445e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7753060410432225e-06
Validation loss decreased (0.024727 --> 0.023481).  Saving model ...
Updating learning rate to 1.3876530205216113e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.938265102608056e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.469132551304028e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.734566275652014e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.67283137826007e-08
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.336415689130035e-08
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.1682078445650176e-08
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.0841039222825088e-08
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.420519611412544e-09
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.710259805706272e-09
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.355129902853136e-09
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.77564951426568e-10
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.38782475713284e-10
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.69391237856642e-10
EarlyStopping counter: 14 out of 100
Updating learning rate to 8.4695618928321e-11
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.23478094641605e-11
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.117390473208025e-11
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.0586952366040125e-11
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.2934761830200625e-12
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.6467380915100313e-12
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.3233690457550156e-12
EarlyStopping counter: 21 out of 100
Updating learning rate to 6.616845228775078e-13
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.308422614387539e-13
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.6542113071937695e-13
EarlyStopping counter: 24 out of 100
Updating learning rate to 8.271056535968848e-14
EarlyStopping counter: 25 out of 100
Updating learning rate to 4.135528267984424e-14
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.067764133992212e-14
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.033882066996106e-14
EarlyStopping counter: 28 out of 100
Updating learning rate to 5.16941033498053e-15
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.584705167490265e-15
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.2923525837451324e-15
EarlyStopping counter: 31 out of 100
Updating learning rate to 6.461762918725662e-16
EarlyStopping counter: 32 out of 100
Updating learning rate to 3.230881459362831e-16
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.6154407296814156e-16
EarlyStopping counter: 34 out of 100
Updating learning rate to 8.077203648407078e-17
EarlyStopping counter: 35 out of 100
Updating learning rate to 4.038601824203539e-17
EarlyStopping counter: 36 out of 100
Updating learning rate to 2.0193009121017694e-17
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.0096504560508847e-17
EarlyStopping counter: 38 out of 100
Updating learning rate to 5.048252280254424e-18
EarlyStopping counter: 39 out of 100
Updating learning rate to 2.524126140127212e-18
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.262063070063606e-18
EarlyStopping counter: 41 out of 100
Updating learning rate to 6.31031535031803e-19
EarlyStopping counter: 42 out of 100
Updating learning rate to 3.155157675159015e-19
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.5775788375795074e-19
EarlyStopping counter: 44 out of 100
Updating learning rate to 7.887894187897537e-20
EarlyStopping counter: 45 out of 100
Updating learning rate to 3.9439470939487685e-20
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.9719735469743842e-20
EarlyStopping counter: 47 out of 100
Updating learning rate to 9.859867734871921e-21
EarlyStopping counter: 48 out of 100
Updating learning rate to 4.9299338674359606e-21
EarlyStopping counter: 49 out of 100
Updating learning rate to 2.4649669337179803e-21
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.2324834668589901e-21
EarlyStopping counter: 51 out of 100
Updating learning rate to 6.162417334294951e-22
EarlyStopping counter: 52 out of 100
Updating learning rate to 3.0812086671474754e-22
EarlyStopping counter: 53 out of 100
Updating learning rate to 1.5406043335737377e-22
EarlyStopping counter: 54 out of 100
Updating learning rate to 7.703021667868688e-23
EarlyStopping counter: 55 out of 100
Updating learning rate to 3.851510833934344e-23
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.925755416967172e-23
EarlyStopping counter: 57 out of 100
Updating learning rate to 9.62877708483586e-24
EarlyStopping counter: 58 out of 100
Updating learning rate to 4.81438854241793e-24
EarlyStopping counter: 59 out of 100
Updating learning rate to 2.407194271208965e-24
EarlyStopping counter: 60 out of 100
Updating learning rate to 1.2035971356044826e-24
EarlyStopping counter: 61 out of 100
Updating learning rate to 6.017985678022413e-25
EarlyStopping counter: 62 out of 100
Updating learning rate to 3.0089928390112064e-25
EarlyStopping counter: 63 out of 100
Updating learning rate to 1.5044964195056032e-25
EarlyStopping counter: 64 out of 100
Updating learning rate to 7.522482097528016e-26
EarlyStopping counter: 65 out of 100
Updating learning rate to 3.761241048764008e-26
EarlyStopping counter: 66 out of 100
Updating learning rate to 1.880620524382004e-26
EarlyStopping counter: 67 out of 100
Updating learning rate to 9.40310262191002e-27
EarlyStopping counter: 68 out of 100
Updating learning rate to 4.70155131095501e-27
EarlyStopping counter: 69 out of 100
Updating learning rate to 2.350775655477505e-27
EarlyStopping counter: 70 out of 100
Updating learning rate to 1.1753878277387525e-27
EarlyStopping counter: 71 out of 100
Updating learning rate to 5.8769391386937625e-28
EarlyStopping counter: 72 out of 100
Updating learning rate to 2.9384695693468813e-28
EarlyStopping counter: 73 out of 100
Updating learning rate to 1.4692347846734406e-28
EarlyStopping counter: 74 out of 100
Updating learning rate to 7.346173923367203e-29
EarlyStopping counter: 75 out of 100
Updating learning rate to 3.6730869616836016e-29
EarlyStopping counter: 76 out of 100
Updating learning rate to 1.8365434808418008e-29
EarlyStopping counter: 77 out of 100
Updating learning rate to 9.182717404209004e-30
EarlyStopping counter: 78 out of 100
Updating learning rate to 4.591358702104502e-30
EarlyStopping counter: 79 out of 100
Updating learning rate to 2.295679351052251e-30
EarlyStopping counter: 80 out of 100
Updating learning rate to 1.1478396755261255e-30
EarlyStopping counter: 81 out of 100
Updating learning rate to 5.7391983776306274e-31
EarlyStopping counter: 82 out of 100
Updating learning rate to 2.8695991888153137e-31
EarlyStopping counter: 83 out of 100
Updating learning rate to 1.4347995944076569e-31
EarlyStopping counter: 84 out of 100
Updating learning rate to 7.173997972038284e-32
EarlyStopping counter: 85 out of 100
Updating learning rate to 3.586998986019142e-32
EarlyStopping counter: 86 out of 100
Updating learning rate to 1.793499493009571e-32
EarlyStopping counter: 87 out of 100
Updating learning rate to 8.967497465047855e-33
EarlyStopping counter: 88 out of 100
Updating learning rate to 4.483748732523928e-33
EarlyStopping counter: 89 out of 100
Updating learning rate to 2.241874366261964e-33
EarlyStopping counter: 90 out of 100
Updating learning rate to 1.120937183130982e-33
>>>>>> Testing on validation set: trial_42 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.05040651559829712, mae:0.07268835604190826, dtw:Not calculated


                                                                                         [I 2025-10-17 01:40:15,238] Trial 42 finished with value: 0.07268835604190826 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 2, 'd_model': 64, 'n_heads': 4, 'e_layers': 1, 'd_layers': 1, 'batch_size': 32, 'learning_rate': 0.000710478346507065, 'dropout': 0.2513346337650674}. Best is trial 23 with value: 0.07065031677484512.
Best trial: 23. Best value: 0.0706503:  84%|████████▍ | 42/50 [1:47:08<19:36, 147.08s/it]Best trial: 23. Best value: 0.0706503:  84%|████████▍ | 42/50 [1:47:08<19:36, 147.08s/it]Best trial: 23. Best value: 0.0706503:  86%|████████▌ | 43/50 [1:47:08<16:43, 143.29s/it]
============================================================
Trial 43
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 4
e_layers: 1, d_layers: 1
batch_size: 32, lr: 0.000837
dropout: 0.20951510724311248
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_43 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.032117).  Saving model ...
Updating learning rate to 0.0008368577959597823
Validation loss decreased (0.032117 --> 0.030858).  Saving model ...
Updating learning rate to 0.00041842889797989117
Validation loss decreased (0.030858 --> 0.024957).  Saving model ...
Updating learning rate to 0.00020921444898994558
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00010460722449497279
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.2303612247486396e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.6151806123743198e-05
Validation loss decreased (0.024957 --> 0.023760).  Saving model ...
Updating learning rate to 1.3075903061871599e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.5379515309357995e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.2689757654678998e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6344878827339499e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.172439413669749e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.0862197068348747e-07
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0431098534174373e-07
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.0215549267087187e-07
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.1077746335435934e-08
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.5538873167717967e-08
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.2769436583858983e-08
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.384718291929492e-09
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.192359145964746e-09
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.596179572982373e-09
Validation loss decreased (0.023760 --> 0.023746).  Saving model ...
Updating learning rate to 7.980897864911865e-10
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.9904489324559323e-10
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.9952244662279662e-10
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.976122331139831e-11
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.9880611655699154e-11
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.4940305827849577e-11
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.2470152913924789e-11
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.235076456962394e-12
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.117538228481197e-12
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.5587691142405986e-12
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.793845571202993e-13
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.8969227856014964e-13
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.9484613928007482e-13
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.742306964003741e-14
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.8711534820018705e-14
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.4355767410009353e-14
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.2177883705004676e-14
EarlyStopping counter: 17 out of 100
Updating learning rate to 6.088941852502338e-15
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.044470926251169e-15
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.5222354631255845e-15
EarlyStopping counter: 20 out of 100
Updating learning rate to 7.611177315627923e-16
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.8055886578139613e-16
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.9027943289069807e-16
EarlyStopping counter: 23 out of 100
Updating learning rate to 9.513971644534903e-17
EarlyStopping counter: 24 out of 100
Updating learning rate to 4.7569858222674517e-17
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.3784929111337258e-17
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.1892464555668629e-17
EarlyStopping counter: 27 out of 100
Updating learning rate to 5.9462322778343146e-18
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.9731161389171573e-18
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.4865580694585786e-18
EarlyStopping counter: 30 out of 100
Updating learning rate to 7.432790347292893e-19
Validation loss decreased (0.023746 --> 0.023576).  Saving model ...
Updating learning rate to 3.7163951736464466e-19
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8581975868232233e-19
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.290987934116117e-20
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.645493967058058e-20
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.322746983529029e-20
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1613734917645146e-20
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.806867458822573e-21
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.9034337294112864e-21
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.4517168647056432e-21
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.258584323528216e-22
Validation loss decreased (0.023576 --> 0.023520).  Saving model ...
Updating learning rate to 3.629292161764108e-22
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.814646080882054e-22
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.07323040441027e-23
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.536615202205135e-23
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2683076011025675e-23
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1341538005512838e-23
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.670769002756419e-24
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.8353845013782094e-24
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.4176922506891047e-24
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.0884612534455235e-25
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.5442306267227617e-25
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.7721153133613809e-25
EarlyStopping counter: 12 out of 100
Updating learning rate to 8.860576566806904e-26
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.430288283403452e-26
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.215144141701726e-26
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.107572070850863e-26
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.537860354254315e-27
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.7689301771271576e-27
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.3844650885635788e-27
EarlyStopping counter: 19 out of 100
Updating learning rate to 6.922325442817894e-28
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.461162721408947e-28
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.7305813607044735e-28
EarlyStopping counter: 22 out of 100
Updating learning rate to 8.652906803522368e-29
EarlyStopping counter: 23 out of 100
Updating learning rate to 4.326453401761184e-29
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.163226700880592e-29
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.081613350440296e-29
EarlyStopping counter: 26 out of 100
Updating learning rate to 5.40806675220148e-30
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.70403337610074e-30
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.35201668805037e-30
EarlyStopping counter: 29 out of 100
Updating learning rate to 6.76008344025185e-31
EarlyStopping counter: 30 out of 100
Updating learning rate to 3.380041720125925e-31
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.6900208600629624e-31
EarlyStopping counter: 32 out of 100
Updating learning rate to 8.450104300314812e-32
EarlyStopping counter: 33 out of 100
Updating learning rate to 4.225052150157406e-32
EarlyStopping counter: 34 out of 100
Updating learning rate to 2.112526075078703e-32
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.0562630375393515e-32
EarlyStopping counter: 36 out of 100
Updating learning rate to 5.2813151876967575e-33
EarlyStopping counter: 37 out of 100
Updating learning rate to 2.6406575938483788e-33
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.3203287969241894e-33
>>>>>> Testing on validation set: trial_43 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.05011352151632309, mae:0.07360974699258804, dtw:Not calculated


                                                                                         [I 2025-10-17 01:42:29,594] Trial 43 finished with value: 0.07360974699258804 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 2, 'd_model': 64, 'n_heads': 4, 'e_layers': 1, 'd_layers': 1, 'batch_size': 32, 'learning_rate': 0.0008368577959597823, 'dropout': 0.20951510724311248}. Best is trial 23 with value: 0.07065031677484512.
Best trial: 23. Best value: 0.0706503:  86%|████████▌ | 43/50 [1:49:23<16:43, 143.29s/it]Best trial: 23. Best value: 0.0706503:  86%|████████▌ | 43/50 [1:49:23<16:43, 143.29s/it]Best trial: 23. Best value: 0.0706503:  88%|████████▊ | 44/50 [1:49:23<14:03, 140.61s/it]
============================================================
Trial 44
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 4
e_layers: 1, d_layers: 1
batch_size: 32, lr: 0.000550
dropout: 0.27150665269253715
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_44 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.037314).  Saving model ...
Updating learning rate to 0.0005500025100006188
Validation loss decreased (0.037314 --> 0.025246).  Saving model ...
Updating learning rate to 0.0002750012550003094
Validation loss decreased (0.025246 --> 0.024223).  Saving model ...
Updating learning rate to 0.0001375006275001547
Validation loss decreased (0.024223 --> 0.023900).  Saving model ...
Updating learning rate to 6.875031375007736e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.437515687503868e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.718757843751934e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.59378921875967e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.296894609379835e-06
Validation loss decreased (0.023900 --> 0.023459).  Saving model ...
Updating learning rate to 2.1484473046899173e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0742236523449587e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.371118261724793e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.6855591308623967e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3427795654311983e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.713897827155992e-08
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.356948913577996e-08
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.678474456788998e-08
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.39237228394499e-09
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.196186141972495e-09
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.0980930709862474e-09
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.0490465354931237e-09
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.245232677465619e-10
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.6226163387328093e-10
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.3113081693664046e-10
EarlyStopping counter: 15 out of 100
Updating learning rate to 6.556540846832023e-11
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.2782704234160116e-11
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.6391352117080058e-11
EarlyStopping counter: 18 out of 100
Updating learning rate to 8.195676058540029e-12
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.0978380292700145e-12
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.0489190146350072e-12
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.0244595073175036e-12
EarlyStopping counter: 22 out of 100
Updating learning rate to 5.122297536587518e-13
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.561148768293759e-13
Validation loss decreased (0.023459 --> 0.023344).  Saving model ...
Updating learning rate to 1.2805743841468795e-13
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.402871920734398e-14
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.201435960367199e-14
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6007179801835994e-14
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.003589900917997e-15
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.0017949504589985e-15
Validation loss decreased (0.023344 --> 0.023288).  Saving model ...
Updating learning rate to 2.0008974752294993e-15
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0004487376147496e-15
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.002243688073748e-16
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.501121844036874e-16
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.250560922018437e-16
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.252804610092185e-17
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.1264023050460926e-17
Validation loss decreased (0.023288 --> 0.023283).  Saving model ...
Updating learning rate to 1.5632011525230463e-17
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.816005762615231e-18
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.908002881307616e-18
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.954001440653808e-18
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.77000720326904e-19
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.88500360163452e-19
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.44250180081726e-19
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.22125090040863e-19
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.10625450204315e-20
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.053127251021575e-20
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.5265636255107874e-20
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.632818127553937e-21
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.8164090637769685e-21
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.9082045318884842e-21
EarlyStopping counter: 14 out of 100
Updating learning rate to 9.541022659442421e-22
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.770511329721211e-22
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.3852556648606053e-22
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.1926278324303027e-22
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.963139162151513e-23
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.9815695810757566e-23
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.4907847905378783e-23
EarlyStopping counter: 21 out of 100
Updating learning rate to 7.453923952689392e-24
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.726961976344696e-24
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.863480988172348e-24
EarlyStopping counter: 24 out of 100
Updating learning rate to 9.31740494086174e-25
EarlyStopping counter: 25 out of 100
Updating learning rate to 4.65870247043087e-25
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.329351235215435e-25
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.1646756176077174e-25
EarlyStopping counter: 28 out of 100
Updating learning rate to 5.823378088038587e-26
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.9116890440192936e-26
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.4558445220096468e-26
EarlyStopping counter: 31 out of 100
Updating learning rate to 7.279222610048234e-27
Validation loss decreased (0.023283 --> 0.023220).  Saving model ...
Updating learning rate to 3.639611305024117e-27
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8198056525120585e-27
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.099028262560292e-28
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.549514131280146e-28
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.274757065640073e-28
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1373785328200366e-28
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.686892664100183e-29
Validation loss decreased (0.023220 --> 0.023207).  Saving model ...
Updating learning rate to 2.8434463320500914e-29
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4217231660250457e-29
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.108615830125228e-30
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.554307915062614e-30
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.777153957531307e-30
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.885769787656536e-31
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.442884893828268e-31
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.221442446914134e-31
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.110721223457067e-31
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.553606117285335e-32
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7768030586426674e-32
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.3884015293213337e-32
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.942007646606668e-33
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.471003823303334e-33
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.735501911651667e-33
EarlyStopping counter: 15 out of 100
Updating learning rate to 8.677509558258336e-34
>>>>>> Testing on validation set: trial_44 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.049576085060834885, mae:0.0720362514257431, dtw:Not calculated


                                                                                         [I 2025-10-17 01:44:44,093] Trial 44 finished with value: 0.0720362514257431 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 2, 'd_model': 64, 'n_heads': 4, 'e_layers': 1, 'd_layers': 1, 'batch_size': 32, 'learning_rate': 0.0005500025100006188, 'dropout': 0.27150665269253715}. Best is trial 23 with value: 0.07065031677484512.
Best trial: 23. Best value: 0.0706503:  88%|████████▊ | 44/50 [1:51:37<14:03, 140.61s/it]Best trial: 23. Best value: 0.0706503:  88%|████████▊ | 44/50 [1:51:37<14:03, 140.61s/it]Best trial: 23. Best value: 0.0706503:  90%|█████████ | 45/50 [1:51:37<11:33, 138.78s/it]
============================================================
Trial 45
============================================================
seq_len: 48, pred_len: 1
d_model: 32, n_heads: 4
e_layers: 1, d_layers: 1
batch_size: 16, lr: 0.000820
dropout: 0.22480911647460322
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 64, expand: 2
>>>>>> Start training: trial_45 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.028251).  Saving model ...
Updating learning rate to 0.0008204760484320483
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00041023802421602415
Validation loss decreased (0.028251 --> 0.025311).  Saving model ...
Updating learning rate to 0.00020511901210801207
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00010255950605400604
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.127975302700302e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.563987651350151e-05
Validation loss decreased (0.025311 --> 0.025262).  Saving model ...
Updating learning rate to 1.2819938256750755e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.409969128375377e-06
Validation loss decreased (0.025262 --> 0.024678).  Saving model ...
Updating learning rate to 3.2049845641876887e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6024922820938443e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.012461410469222e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.006230705234611e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0031153526173054e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0015576763086527e-07
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.0077883815432635e-08
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.5038941907716318e-08
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.2519470953858159e-08
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.2597354769290794e-09
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.1298677384645397e-09
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.5649338692322699e-09
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.824669346161349e-10
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.9123346730806746e-10
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.9561673365403373e-10
EarlyStopping counter: 15 out of 100
Updating learning rate to 9.780836682701687e-11
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.890418341350843e-11
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.4452091706754217e-11
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.2226045853377108e-11
EarlyStopping counter: 19 out of 100
Updating learning rate to 6.113022926688554e-12
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.056511463344277e-12
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.5282557316721385e-12
EarlyStopping counter: 22 out of 100
Updating learning rate to 7.641278658360693e-13
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.8206393291803463e-13
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.9103196645901732e-13
EarlyStopping counter: 25 out of 100
Updating learning rate to 9.551598322950866e-14
EarlyStopping counter: 26 out of 100
Updating learning rate to 4.775799161475433e-14
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.3878995807377165e-14
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.1939497903688582e-14
EarlyStopping counter: 29 out of 100
Updating learning rate to 5.969748951844291e-15
EarlyStopping counter: 30 out of 100
Updating learning rate to 2.9848744759221456e-15
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.4924372379610728e-15
EarlyStopping counter: 32 out of 100
Updating learning rate to 7.462186189805364e-16
EarlyStopping counter: 33 out of 100
Updating learning rate to 3.731093094902682e-16
Validation loss decreased (0.024678 --> 0.024629).  Saving model ...
Updating learning rate to 1.865546547451341e-16
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.327732737256705e-17
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.6638663686283525e-17
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.3319331843141762e-17
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1659665921570881e-17
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8298329607854406e-18
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.9149164803927203e-18
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4574582401963601e-18
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.287291200981801e-19
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.6436456004909004e-19
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.8218228002454502e-19
EarlyStopping counter: 11 out of 100
Updating learning rate to 9.109114001227251e-20
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.5545570006136254e-20
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.2772785003068127e-20
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.1386392501534064e-20
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.693196250767032e-21
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.846598125383516e-21
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.423299062691758e-21
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.11649531345879e-22
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.558247656729395e-22
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.7791238283646974e-22
EarlyStopping counter: 21 out of 100
Updating learning rate to 8.895619141823487e-23
EarlyStopping counter: 22 out of 100
Updating learning rate to 4.4478095709117436e-23
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.2239047854558718e-23
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.1119523927279359e-23
EarlyStopping counter: 25 out of 100
Updating learning rate to 5.5597619636396795e-24
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.7798809818198397e-24
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.3899404909099199e-24
EarlyStopping counter: 28 out of 100
Updating learning rate to 6.949702454549599e-25
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.4748512272747997e-25
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.7374256136373998e-25
EarlyStopping counter: 31 out of 100
Updating learning rate to 8.687128068186999e-26
EarlyStopping counter: 32 out of 100
Updating learning rate to 4.3435640340934996e-26
EarlyStopping counter: 33 out of 100
Updating learning rate to 2.1717820170467498e-26
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.0858910085233749e-26
EarlyStopping counter: 35 out of 100
Updating learning rate to 5.4294550426168745e-27
EarlyStopping counter: 36 out of 100
Updating learning rate to 2.7147275213084373e-27
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.3573637606542186e-27
EarlyStopping counter: 38 out of 100
Updating learning rate to 6.786818803271093e-28
EarlyStopping counter: 39 out of 100
Updating learning rate to 3.3934094016355466e-28
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.6967047008177733e-28
EarlyStopping counter: 41 out of 100
Updating learning rate to 8.483523504088866e-29
EarlyStopping counter: 42 out of 100
Updating learning rate to 4.241761752044433e-29
EarlyStopping counter: 43 out of 100
Updating learning rate to 2.1208808760222166e-29
EarlyStopping counter: 44 out of 100
Updating learning rate to 1.0604404380111083e-29
EarlyStopping counter: 45 out of 100
Updating learning rate to 5.3022021900555415e-30
EarlyStopping counter: 46 out of 100
Updating learning rate to 2.6511010950277708e-30
EarlyStopping counter: 47 out of 100
Updating learning rate to 1.3255505475138854e-30
EarlyStopping counter: 48 out of 100
Updating learning rate to 6.627752737569427e-31
EarlyStopping counter: 49 out of 100
Updating learning rate to 3.3138763687847134e-31
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.6569381843923567e-31
EarlyStopping counter: 51 out of 100
Updating learning rate to 8.284690921961784e-32
EarlyStopping counter: 52 out of 100
Updating learning rate to 4.142345460980892e-32
EarlyStopping counter: 53 out of 100
Updating learning rate to 2.071172730490446e-32
EarlyStopping counter: 54 out of 100
Updating learning rate to 1.035586365245223e-32
EarlyStopping counter: 55 out of 100
Updating learning rate to 5.177931826226115e-33
EarlyStopping counter: 56 out of 100
Updating learning rate to 2.5889659131130574e-33
EarlyStopping counter: 57 out of 100
Updating learning rate to 1.2944829565565287e-33
>>>>>> Testing on validation set: trial_45 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.050175365060567856, mae:0.07337459176778793, dtw:Not calculated


                                                                                         [I 2025-10-17 01:49:05,960] Trial 45 finished with value: 0.07337459176778793 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 2, 'd_model': 32, 'n_heads': 4, 'e_layers': 1, 'd_layers': 1, 'batch_size': 16, 'learning_rate': 0.0008204760484320483, 'dropout': 0.22480911647460322}. Best is trial 23 with value: 0.07065031677484512.
Best trial: 23. Best value: 0.0706503:  90%|█████████ | 45/50 [1:55:59<11:33, 138.78s/it]Best trial: 23. Best value: 0.0706503:  90%|█████████ | 45/50 [1:55:59<11:33, 138.78s/it]Best trial: 23. Best value: 0.0706503:  92%|█████████▏| 46/50 [1:55:59<11:42, 175.70s/it]
============================================================
Trial 46
============================================================
seq_len: 96, pred_len: 1
d_model: 64, n_heads: 4
e_layers: 1, d_layers: 1
batch_size: 32, lr: 0.000496
dropout: 0.26688253695653175
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_46 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 1
============================================================
train 4577
val 259
test 261
Validation loss decreased (inf --> 0.025405).  Saving model ...
Updating learning rate to 0.0004956399065096897
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00024781995325484483
Validation loss decreased (0.025405 --> 0.024425).  Saving model ...
Updating learning rate to 0.00012390997662742242
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.195498831371121e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.0977494156855604e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5488747078427802e-05
Validation loss decreased (0.024425 --> 0.024330).  Saving model ...
Updating learning rate to 7.744373539213901e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.8721867696069505e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.9360933848034752e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.680466924017376e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.840233462008688e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.420116731004344e-07
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.210058365502172e-07
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.05029182751086e-08
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.02514591375543e-08
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.512572956877715e-08
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.562864784388575e-09
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.781432392194288e-09
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.890716196097144e-09
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.45358098048572e-10
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.72679049024286e-10
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.36339524512143e-10
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.181697622560715e-10
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.908488112803574e-11
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.954244056401787e-11
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.4771220282008936e-11
EarlyStopping counter: 20 out of 100
Updating learning rate to 7.385610141004468e-12
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.692805070502234e-12
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.846402535251117e-12
EarlyStopping counter: 23 out of 100
Updating learning rate to 9.232012676255585e-13
EarlyStopping counter: 24 out of 100
Updating learning rate to 4.616006338127792e-13
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.308003169063896e-13
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.154001584531948e-13
EarlyStopping counter: 27 out of 100
Updating learning rate to 5.77000792265974e-14
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.88500396132987e-14
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.442501980664935e-14
EarlyStopping counter: 30 out of 100
Updating learning rate to 7.212509903324676e-15
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.606254951662338e-15
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.803127475831169e-15
EarlyStopping counter: 33 out of 100
Updating learning rate to 9.015637379155845e-16
EarlyStopping counter: 34 out of 100
Updating learning rate to 4.507818689577922e-16
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.253909344788961e-16
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.1269546723944806e-16
EarlyStopping counter: 37 out of 100
Updating learning rate to 5.634773361972403e-17
EarlyStopping counter: 38 out of 100
Updating learning rate to 2.8173866809862015e-17
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.4086933404931007e-17
EarlyStopping counter: 40 out of 100
Updating learning rate to 7.043466702465504e-18
EarlyStopping counter: 41 out of 100
Updating learning rate to 3.521733351232752e-18
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.760866675616376e-18
EarlyStopping counter: 43 out of 100
Updating learning rate to 8.80433337808188e-19
EarlyStopping counter: 44 out of 100
Updating learning rate to 4.40216668904094e-19
EarlyStopping counter: 45 out of 100
Updating learning rate to 2.20108334452047e-19
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.100541672260235e-19
EarlyStopping counter: 47 out of 100
Updating learning rate to 5.502708361301175e-20
EarlyStopping counter: 48 out of 100
Updating learning rate to 2.7513541806505874e-20
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.3756770903252937e-20
EarlyStopping counter: 50 out of 100
Updating learning rate to 6.878385451626468e-21
EarlyStopping counter: 51 out of 100
Updating learning rate to 3.439192725813234e-21
EarlyStopping counter: 52 out of 100
Updating learning rate to 1.719596362906617e-21
EarlyStopping counter: 53 out of 100
Updating learning rate to 8.597981814533085e-22
EarlyStopping counter: 54 out of 100
Updating learning rate to 4.298990907266543e-22
EarlyStopping counter: 55 out of 100
Updating learning rate to 2.1494954536332714e-22
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.0747477268166357e-22
EarlyStopping counter: 57 out of 100
Updating learning rate to 5.373738634083178e-23
EarlyStopping counter: 58 out of 100
Updating learning rate to 2.686869317041589e-23
EarlyStopping counter: 59 out of 100
Updating learning rate to 1.3434346585207946e-23
EarlyStopping counter: 60 out of 100
Updating learning rate to 6.717173292603973e-24
EarlyStopping counter: 61 out of 100
Updating learning rate to 3.3585866463019865e-24
EarlyStopping counter: 62 out of 100
Updating learning rate to 1.6792933231509933e-24
EarlyStopping counter: 63 out of 100
Updating learning rate to 8.396466615754966e-25
EarlyStopping counter: 64 out of 100
Updating learning rate to 4.198233307877483e-25
EarlyStopping counter: 65 out of 100
Updating learning rate to 2.0991166539387416e-25
EarlyStopping counter: 66 out of 100
Updating learning rate to 1.0495583269693708e-25
EarlyStopping counter: 67 out of 100
Updating learning rate to 5.247791634846854e-26
EarlyStopping counter: 68 out of 100
Updating learning rate to 2.623895817423427e-26
EarlyStopping counter: 69 out of 100
Updating learning rate to 1.3119479087117135e-26
EarlyStopping counter: 70 out of 100
Updating learning rate to 6.559739543558567e-27
EarlyStopping counter: 71 out of 100
Updating learning rate to 3.279869771779284e-27
EarlyStopping counter: 72 out of 100
Updating learning rate to 1.639934885889642e-27
EarlyStopping counter: 73 out of 100
Updating learning rate to 8.19967442944821e-28
EarlyStopping counter: 74 out of 100
Updating learning rate to 4.099837214724105e-28
EarlyStopping counter: 75 out of 100
Updating learning rate to 2.0499186073620523e-28
EarlyStopping counter: 76 out of 100
Updating learning rate to 1.0249593036810262e-28
EarlyStopping counter: 77 out of 100
Updating learning rate to 5.124796518405131e-29
EarlyStopping counter: 78 out of 100
Updating learning rate to 2.5623982592025654e-29
EarlyStopping counter: 79 out of 100
Updating learning rate to 1.2811991296012827e-29
EarlyStopping counter: 80 out of 100
Updating learning rate to 6.405995648006414e-30
EarlyStopping counter: 81 out of 100
Updating learning rate to 3.202997824003207e-30
EarlyStopping counter: 82 out of 100
Updating learning rate to 1.6014989120016034e-30
EarlyStopping counter: 83 out of 100
Updating learning rate to 8.007494560008017e-31
EarlyStopping counter: 84 out of 100
Updating learning rate to 4.0037472800040084e-31
EarlyStopping counter: 85 out of 100
Updating learning rate to 2.0018736400020042e-31
EarlyStopping counter: 86 out of 100
Updating learning rate to 1.0009368200010021e-31
EarlyStopping counter: 87 out of 100
Updating learning rate to 5.004684100005011e-32
EarlyStopping counter: 88 out of 100
Updating learning rate to 2.5023420500025053e-32
EarlyStopping counter: 89 out of 100
Updating learning rate to 1.2511710250012526e-32
EarlyStopping counter: 90 out of 100
Updating learning rate to 6.255855125006263e-33
EarlyStopping counter: 91 out of 100
Updating learning rate to 3.1279275625031316e-33
EarlyStopping counter: 92 out of 100
Updating learning rate to 1.5639637812515658e-33
EarlyStopping counter: 93 out of 100
Updating learning rate to 7.819818906257829e-34
>>>>>> Testing on validation set: trial_46 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.049826499074697495, mae:0.0748739242553711, dtw:Not calculated


                                                                                         [I 2025-10-17 01:51:20,346] Trial 46 finished with value: 0.0748739242553711 and parameters: {'seq_len': 96, 'pred_len': 1, 'expand': 2, 'd_model': 64, 'n_heads': 4, 'e_layers': 1, 'd_layers': 1, 'batch_size': 32, 'learning_rate': 0.0004956399065096897, 'dropout': 0.26688253695653175}. Best is trial 23 with value: 0.07065031677484512.
Best trial: 23. Best value: 0.0706503:  92%|█████████▏| 46/50 [1:58:13<11:42, 175.70s/it]Best trial: 23. Best value: 0.0706503:  92%|█████████▏| 46/50 [1:58:14<11:42, 175.70s/it]Best trial: 23. Best value: 0.0706503:  94%|█████████▍| 47/50 [1:58:14<08:09, 163.31s/it]
============================================================
Trial 47
============================================================
seq_len: 48, pred_len: 14
d_model: 32, n_heads: 4
e_layers: 1, d_layers: 1
batch_size: 64, lr: 0.000383
dropout: 0.23130987455110266
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 64, expand: 2
>>>>>> Start training: trial_47 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 14
============================================================
train 4612
val 246
test 248
Validation loss decreased (inf --> 0.038607).  Saving model ...
Updating learning rate to 0.00038273866946655975
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00019136933473327988
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.568466736663994e-05
Validation loss decreased (0.038607 --> 0.038421).  Saving model ...
Updating learning rate to 4.784233368331997e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.3921166841659984e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1960583420829992e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.980291710414996e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.990145855207498e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.495072927603749e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.475364638018745e-07
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.7376823190093726e-07
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.8688411595046863e-07
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.344205797523431e-08
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.672102898761716e-08
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.336051449380858e-08
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.168025724690429e-08
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.840128623452145e-09
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.9200643117260723e-09
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.4600321558630362e-09
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.300160779315181e-10
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.6500803896575904e-10
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.8250401948287952e-10
EarlyStopping counter: 19 out of 100
Updating learning rate to 9.125200974143976e-11
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.562600487071988e-11
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.281300243535994e-11
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.140650121767997e-11
EarlyStopping counter: 23 out of 100
Updating learning rate to 5.703250608839985e-12
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.8516253044199925e-12
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.4258126522099962e-12
EarlyStopping counter: 26 out of 100
Updating learning rate to 7.129063261049981e-13
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.5645316305249906e-13
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.7822658152624953e-13
EarlyStopping counter: 29 out of 100
Updating learning rate to 8.911329076312477e-14
EarlyStopping counter: 30 out of 100
Updating learning rate to 4.455664538156238e-14
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.227832269078119e-14
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.1139161345390596e-14
EarlyStopping counter: 33 out of 100
Updating learning rate to 5.569580672695298e-15
EarlyStopping counter: 34 out of 100
Updating learning rate to 2.784790336347649e-15
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.3923951681738245e-15
EarlyStopping counter: 36 out of 100
Updating learning rate to 6.961975840869122e-16
EarlyStopping counter: 37 out of 100
Updating learning rate to 3.480987920434561e-16
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.7404939602172806e-16
EarlyStopping counter: 39 out of 100
Updating learning rate to 8.702469801086403e-17
EarlyStopping counter: 40 out of 100
Updating learning rate to 4.3512349005432014e-17
EarlyStopping counter: 41 out of 100
Updating learning rate to 2.1756174502716007e-17
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.0878087251358004e-17
EarlyStopping counter: 43 out of 100
Updating learning rate to 5.439043625679002e-18
EarlyStopping counter: 44 out of 100
Updating learning rate to 2.719521812839501e-18
EarlyStopping counter: 45 out of 100
Updating learning rate to 1.3597609064197505e-18
EarlyStopping counter: 46 out of 100
Updating learning rate to 6.798804532098752e-19
EarlyStopping counter: 47 out of 100
Updating learning rate to 3.399402266049376e-19
EarlyStopping counter: 48 out of 100
Updating learning rate to 1.699701133024688e-19
EarlyStopping counter: 49 out of 100
Updating learning rate to 8.49850566512344e-20
EarlyStopping counter: 50 out of 100
Updating learning rate to 4.24925283256172e-20
EarlyStopping counter: 51 out of 100
Updating learning rate to 2.12462641628086e-20
EarlyStopping counter: 52 out of 100
Updating learning rate to 1.06231320814043e-20
EarlyStopping counter: 53 out of 100
Updating learning rate to 5.31156604070215e-21
EarlyStopping counter: 54 out of 100
Updating learning rate to 2.655783020351075e-21
EarlyStopping counter: 55 out of 100
Updating learning rate to 1.3278915101755376e-21
EarlyStopping counter: 56 out of 100
Updating learning rate to 6.639457550877688e-22
EarlyStopping counter: 57 out of 100
Updating learning rate to 3.319728775438844e-22
EarlyStopping counter: 58 out of 100
Updating learning rate to 1.659864387719422e-22
EarlyStopping counter: 59 out of 100
Updating learning rate to 8.29932193859711e-23
EarlyStopping counter: 60 out of 100
Updating learning rate to 4.149660969298555e-23
EarlyStopping counter: 61 out of 100
Updating learning rate to 2.0748304846492774e-23
EarlyStopping counter: 62 out of 100
Updating learning rate to 1.0374152423246387e-23
EarlyStopping counter: 63 out of 100
Updating learning rate to 5.1870762116231936e-24
EarlyStopping counter: 64 out of 100
Updating learning rate to 2.5935381058115968e-24
EarlyStopping counter: 65 out of 100
Updating learning rate to 1.2967690529057984e-24
EarlyStopping counter: 66 out of 100
Updating learning rate to 6.483845264528992e-25
EarlyStopping counter: 67 out of 100
Updating learning rate to 3.241922632264496e-25
EarlyStopping counter: 68 out of 100
Updating learning rate to 1.620961316132248e-25
EarlyStopping counter: 69 out of 100
Updating learning rate to 8.10480658066124e-26
EarlyStopping counter: 70 out of 100
Updating learning rate to 4.05240329033062e-26
EarlyStopping counter: 71 out of 100
Updating learning rate to 2.02620164516531e-26
Validation loss decreased (0.038421 --> 0.038410).  Saving model ...
Updating learning rate to 1.013100822582655e-26
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.065504112913275e-27
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.5327520564566375e-27
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2663760282283187e-27
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.331880141141594e-28
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.165940070570797e-28
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.5829700352853984e-28
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.914850176426992e-29
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.957425088213496e-29
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.978712544106748e-29
EarlyStopping counter: 10 out of 100
Updating learning rate to 9.89356272053374e-30
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.94678136026687e-30
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.473390680133435e-30
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.2366953400667175e-30
EarlyStopping counter: 14 out of 100
Updating learning rate to 6.183476700333588e-31
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.091738350166794e-31
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.545869175083397e-31
EarlyStopping counter: 17 out of 100
Updating learning rate to 7.729345875416984e-32
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.864672937708492e-32
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.932336468854246e-32
EarlyStopping counter: 20 out of 100
Updating learning rate to 9.66168234427123e-33
EarlyStopping counter: 21 out of 100
Updating learning rate to 4.830841172135615e-33
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.4154205860678077e-33
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.2077102930339038e-33
EarlyStopping counter: 24 out of 100
Updating learning rate to 6.038551465169519e-34
>>>>>> Testing on validation set: trial_47 >>>>>>
test 248
test shape: (248, 14, 5) (248, 14, 5)
test shape: (248, 14, 5) (248, 14, 5)


	mse:0.06423673033714294, mae:0.09835658967494965, dtw:Not calculated


                                                                                         [I 2025-10-17 01:52:28,437] Trial 47 finished with value: 0.09835658967494965 and parameters: {'seq_len': 48, 'pred_len': 14, 'expand': 2, 'd_model': 32, 'n_heads': 4, 'e_layers': 1, 'd_layers': 1, 'batch_size': 64, 'learning_rate': 0.00038273866946655975, 'dropout': 0.23130987455110266}. Best is trial 23 with value: 0.07065031677484512.
Best trial: 23. Best value: 0.0706503:  94%|█████████▍| 47/50 [1:59:22<08:09, 163.31s/it]Best trial: 23. Best value: 0.0706503:  94%|█████████▍| 47/50 [1:59:22<08:09, 163.31s/it]Best trial: 23. Best value: 0.0706503:  96%|█████████▌| 48/50 [1:59:22<04:29, 134.74s/it]
============================================================
Trial 48
============================================================
seq_len: 48, pred_len: 7
d_model: 64, n_heads: 4
e_layers: 1, d_layers: 1
batch_size: 32, lr: 0.000136
dropout: 0.29224308646228425
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_48 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 7
============================================================
train 4619
val 253
test 255
Validation loss decreased (inf --> 0.037261).  Saving model ...
Updating learning rate to 0.00013583251528040692
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.791625764020346e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.395812882010173e-05
Validation loss decreased (0.037261 --> 0.036870).  Saving model ...
Updating learning rate to 1.6979064410050865e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.489532205025433e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.244766102512716e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.122383051256358e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.061191525628179e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.305957628140895e-07
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.6529788140704477e-07
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3264894070352238e-07
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.632447035176119e-08
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.3162235175880596e-08
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.6581117587940298e-08
EarlyStopping counter: 11 out of 100
Updating learning rate to 8.290558793970149e-09
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.1452793969850745e-09
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.0726396984925373e-09
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.0363198492462686e-09
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.181599246231343e-10
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.5907996231156716e-10
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.2953998115578358e-10
EarlyStopping counter: 18 out of 100
Updating learning rate to 6.476999057789179e-11
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.2384995288945895e-11
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.6192497644472947e-11
EarlyStopping counter: 21 out of 100
Updating learning rate to 8.096248822236474e-12
EarlyStopping counter: 22 out of 100
Updating learning rate to 4.048124411118237e-12
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.0240622055591184e-12
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.0120311027795592e-12
EarlyStopping counter: 25 out of 100
Updating learning rate to 5.060155513897796e-13
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.530077756948898e-13
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.265038878474449e-13
EarlyStopping counter: 28 out of 100
Updating learning rate to 6.325194392372245e-14
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.1625971961861225e-14
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.5812985980930613e-14
EarlyStopping counter: 31 out of 100
Updating learning rate to 7.906492990465306e-15
EarlyStopping counter: 32 out of 100
Updating learning rate to 3.953246495232653e-15
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.9766232476163266e-15
EarlyStopping counter: 34 out of 100
Updating learning rate to 9.883116238081633e-16
EarlyStopping counter: 35 out of 100
Updating learning rate to 4.941558119040816e-16
EarlyStopping counter: 36 out of 100
Updating learning rate to 2.470779059520408e-16
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.235389529760204e-16
EarlyStopping counter: 38 out of 100
Updating learning rate to 6.17694764880102e-17
EarlyStopping counter: 39 out of 100
Updating learning rate to 3.08847382440051e-17
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.544236912200255e-17
EarlyStopping counter: 41 out of 100
Updating learning rate to 7.721184561001276e-18
EarlyStopping counter: 42 out of 100
Updating learning rate to 3.860592280500638e-18
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.930296140250319e-18
EarlyStopping counter: 44 out of 100
Updating learning rate to 9.651480701251595e-19
EarlyStopping counter: 45 out of 100
Updating learning rate to 4.825740350625797e-19
EarlyStopping counter: 46 out of 100
Updating learning rate to 2.4128701753128987e-19
EarlyStopping counter: 47 out of 100
Updating learning rate to 1.2064350876564493e-19
EarlyStopping counter: 48 out of 100
Updating learning rate to 6.032175438282247e-20
EarlyStopping counter: 49 out of 100
Updating learning rate to 3.0160877191411233e-20
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.5080438595705617e-20
EarlyStopping counter: 51 out of 100
Updating learning rate to 7.540219297852808e-21
EarlyStopping counter: 52 out of 100
Updating learning rate to 3.770109648926404e-21
EarlyStopping counter: 53 out of 100
Updating learning rate to 1.885054824463202e-21
EarlyStopping counter: 54 out of 100
Updating learning rate to 9.42527412231601e-22
EarlyStopping counter: 55 out of 100
Updating learning rate to 4.712637061158005e-22
EarlyStopping counter: 56 out of 100
Updating learning rate to 2.3563185305790026e-22
EarlyStopping counter: 57 out of 100
Updating learning rate to 1.1781592652895013e-22
EarlyStopping counter: 58 out of 100
Updating learning rate to 5.890796326447506e-23
EarlyStopping counter: 59 out of 100
Updating learning rate to 2.945398163223753e-23
EarlyStopping counter: 60 out of 100
Updating learning rate to 1.4726990816118766e-23
EarlyStopping counter: 61 out of 100
Updating learning rate to 7.363495408059383e-24
EarlyStopping counter: 62 out of 100
Updating learning rate to 3.6817477040296916e-24
EarlyStopping counter: 63 out of 100
Updating learning rate to 1.8408738520148458e-24
EarlyStopping counter: 64 out of 100
Updating learning rate to 9.204369260074229e-25
EarlyStopping counter: 65 out of 100
Updating learning rate to 4.602184630037114e-25
EarlyStopping counter: 66 out of 100
Updating learning rate to 2.301092315018557e-25
EarlyStopping counter: 67 out of 100
Updating learning rate to 1.1505461575092786e-25
EarlyStopping counter: 68 out of 100
Updating learning rate to 5.752730787546393e-26
EarlyStopping counter: 69 out of 100
Updating learning rate to 2.8763653937731965e-26
EarlyStopping counter: 70 out of 100
Updating learning rate to 1.4381826968865983e-26
EarlyStopping counter: 71 out of 100
Updating learning rate to 7.190913484432991e-27
EarlyStopping counter: 72 out of 100
Updating learning rate to 3.595456742216496e-27
EarlyStopping counter: 73 out of 100
Updating learning rate to 1.797728371108248e-27
EarlyStopping counter: 74 out of 100
Updating learning rate to 8.98864185554124e-28
EarlyStopping counter: 75 out of 100
Updating learning rate to 4.49432092777062e-28
EarlyStopping counter: 76 out of 100
Updating learning rate to 2.24716046388531e-28
EarlyStopping counter: 77 out of 100
Updating learning rate to 1.123580231942655e-28
EarlyStopping counter: 78 out of 100
Updating learning rate to 5.617901159713274e-29
EarlyStopping counter: 79 out of 100
Updating learning rate to 2.808950579856637e-29
EarlyStopping counter: 80 out of 100
Updating learning rate to 1.4044752899283186e-29
EarlyStopping counter: 81 out of 100
Updating learning rate to 7.022376449641593e-30
EarlyStopping counter: 82 out of 100
Updating learning rate to 3.5111882248207965e-30
EarlyStopping counter: 83 out of 100
Updating learning rate to 1.7555941124103983e-30
EarlyStopping counter: 84 out of 100
Updating learning rate to 8.777970562051991e-31
EarlyStopping counter: 85 out of 100
Updating learning rate to 4.388985281025996e-31
EarlyStopping counter: 86 out of 100
Updating learning rate to 2.194492640512998e-31
EarlyStopping counter: 87 out of 100
Updating learning rate to 1.097246320256499e-31
EarlyStopping counter: 88 out of 100
Updating learning rate to 5.486231601282495e-32
EarlyStopping counter: 89 out of 100
Updating learning rate to 2.7431158006412473e-32
EarlyStopping counter: 90 out of 100
Updating learning rate to 1.3715579003206236e-32
EarlyStopping counter: 91 out of 100
Updating learning rate to 6.857789501603118e-33
EarlyStopping counter: 92 out of 100
Updating learning rate to 3.428894750801559e-33
EarlyStopping counter: 93 out of 100
Updating learning rate to 1.7144473754007796e-33
EarlyStopping counter: 94 out of 100
Updating learning rate to 8.572236877003898e-34
EarlyStopping counter: 95 out of 100
Updating learning rate to 4.286118438501949e-34
EarlyStopping counter: 96 out of 100
Updating learning rate to 2.1430592192509745e-34
>>>>>> Testing on validation set: trial_48 >>>>>>
test 255
test shape: (255, 7, 5) (255, 7, 5)
test shape: (255, 7, 5) (255, 7, 5)


	mse:0.06618154048919678, mae:0.09689837694168091, dtw:Not calculated


                                                                                         [I 2025-10-17 01:54:41,555] Trial 48 finished with value: 0.09689837694168091 and parameters: {'seq_len': 48, 'pred_len': 7, 'expand': 1, 'd_model': 64, 'n_heads': 4, 'e_layers': 1, 'd_layers': 1, 'batch_size': 32, 'learning_rate': 0.00013583251528040692, 'dropout': 0.29224308646228425}. Best is trial 23 with value: 0.07065031677484512.
Best trial: 23. Best value: 0.0706503:  96%|█████████▌| 48/50 [2:01:35<04:29, 134.74s/it]Best trial: 23. Best value: 0.0706503:  96%|█████████▌| 48/50 [2:01:35<04:29, 134.74s/it]Best trial: 23. Best value: 0.0706503:  98%|█████████▊| 49/50 [2:01:35<02:14, 134.26s/it]
============================================================
Trial 49
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 4
e_layers: 1, d_layers: 1
batch_size: 32, lr: 0.000043
dropout: 0.1769992284711717
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_49 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.036013).  Saving model ...
Updating learning rate to 4.337111630968268e-05
Validation loss decreased (0.036013 --> 0.030941).  Saving model ...
Updating learning rate to 2.168555815484134e-05
Validation loss decreased (0.030941 --> 0.030119).  Saving model ...
Updating learning rate to 1.084277907742067e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.421389538710335e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7106947693551674e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3553473846775837e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.776736923387918e-07
Validation loss decreased (0.030119 --> 0.028006).  Saving model ...
Updating learning rate to 3.388368461693959e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6941842308469796e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.470921154234898e-08
Validation loss decreased (0.028006 --> 0.027873).  Saving model ...
Updating learning rate to 4.235460577117449e-08
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.1177302885587245e-08
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0588651442793623e-08
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.294325721396811e-09
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.6471628606984057e-09
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3235814303492028e-09
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.617907151746014e-10
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.308953575873007e-10
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6544767879365035e-10
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.272383939682518e-11
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.136191969841259e-11
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.0680959849206294e-11
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.0340479924603147e-11
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.1702399623015736e-12
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.5851199811507868e-12
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.2925599905753934e-12
EarlyStopping counter: 16 out of 100
Updating learning rate to 6.462799952876967e-13
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.2313999764384835e-13
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.6156999882192417e-13
EarlyStopping counter: 19 out of 100
Updating learning rate to 8.078499941096209e-14
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.0392499705481043e-14
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.0196249852740522e-14
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.0098124926370261e-14
EarlyStopping counter: 23 out of 100
Updating learning rate to 5.0490624631851304e-15
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.5245312315925652e-15
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.2622656157962826e-15
EarlyStopping counter: 26 out of 100
Updating learning rate to 6.311328078981413e-16
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.1556640394907065e-16
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.5778320197453533e-16
EarlyStopping counter: 29 out of 100
Updating learning rate to 7.889160098726766e-17
EarlyStopping counter: 30 out of 100
Updating learning rate to 3.944580049363383e-17
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.9722900246816916e-17
EarlyStopping counter: 32 out of 100
Updating learning rate to 9.861450123408458e-18
EarlyStopping counter: 33 out of 100
Updating learning rate to 4.930725061704229e-18
EarlyStopping counter: 34 out of 100
Updating learning rate to 2.4653625308521145e-18
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.2326812654260572e-18
EarlyStopping counter: 36 out of 100
Updating learning rate to 6.163406327130286e-19
EarlyStopping counter: 37 out of 100
Updating learning rate to 3.081703163565143e-19
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.5408515817825715e-19
EarlyStopping counter: 39 out of 100
Updating learning rate to 7.704257908912858e-20
EarlyStopping counter: 40 out of 100
Updating learning rate to 3.852128954456429e-20
EarlyStopping counter: 41 out of 100
Updating learning rate to 1.9260644772282144e-20
EarlyStopping counter: 42 out of 100
Updating learning rate to 9.630322386141072e-21
EarlyStopping counter: 43 out of 100
Updating learning rate to 4.815161193070536e-21
EarlyStopping counter: 44 out of 100
Updating learning rate to 2.407580596535268e-21
EarlyStopping counter: 45 out of 100
Updating learning rate to 1.203790298267634e-21
EarlyStopping counter: 46 out of 100
Updating learning rate to 6.01895149133817e-22
EarlyStopping counter: 47 out of 100
Updating learning rate to 3.009475745669085e-22
EarlyStopping counter: 48 out of 100
Updating learning rate to 1.5047378728345425e-22
EarlyStopping counter: 49 out of 100
Updating learning rate to 7.523689364172713e-23
EarlyStopping counter: 50 out of 100
Updating learning rate to 3.7618446820863563e-23
EarlyStopping counter: 51 out of 100
Updating learning rate to 1.8809223410431782e-23
EarlyStopping counter: 52 out of 100
Updating learning rate to 9.404611705215891e-24
EarlyStopping counter: 53 out of 100
Updating learning rate to 4.7023058526079454e-24
EarlyStopping counter: 54 out of 100
Updating learning rate to 2.3511529263039727e-24
EarlyStopping counter: 55 out of 100
Updating learning rate to 1.1755764631519863e-24
EarlyStopping counter: 56 out of 100
Updating learning rate to 5.877882315759932e-25
EarlyStopping counter: 57 out of 100
Updating learning rate to 2.938941157879966e-25
EarlyStopping counter: 58 out of 100
Updating learning rate to 1.469470578939983e-25
EarlyStopping counter: 59 out of 100
Updating learning rate to 7.347352894699915e-26
EarlyStopping counter: 60 out of 100
Updating learning rate to 3.6736764473499573e-26
EarlyStopping counter: 61 out of 100
Updating learning rate to 1.8368382236749787e-26
EarlyStopping counter: 62 out of 100
Updating learning rate to 9.184191118374893e-27
EarlyStopping counter: 63 out of 100
Updating learning rate to 4.592095559187447e-27
EarlyStopping counter: 64 out of 100
Updating learning rate to 2.2960477795937233e-27
EarlyStopping counter: 65 out of 100
Updating learning rate to 1.1480238897968617e-27
EarlyStopping counter: 66 out of 100
Updating learning rate to 5.740119448984308e-28
EarlyStopping counter: 67 out of 100
Updating learning rate to 2.870059724492154e-28
EarlyStopping counter: 68 out of 100
Updating learning rate to 1.435029862246077e-28
EarlyStopping counter: 69 out of 100
Updating learning rate to 7.175149311230385e-29
EarlyStopping counter: 70 out of 100
Updating learning rate to 3.5875746556151927e-29
EarlyStopping counter: 71 out of 100
Updating learning rate to 1.7937873278075964e-29
EarlyStopping counter: 72 out of 100
Updating learning rate to 8.968936639037982e-30
Validation loss decreased (0.027873 --> 0.027733).  Saving model ...
Updating learning rate to 4.484468319518991e-30
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2422341597594954e-30
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1211170798797477e-30
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.605585399398739e-31
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.8027926996993693e-31
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4013963498496846e-31
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.006981749248423e-32
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.5034908746242116e-32
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.7517454373121058e-32
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.758727186560529e-33
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.3793635932802645e-33
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.1896817966401323e-33
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.0948408983200661e-33
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.474204491600331e-34
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.7371022458001653e-34
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.3685511229000827e-34
EarlyStopping counter: 16 out of 100
Updating learning rate to 6.842755614500413e-35
>>>>>> Testing on validation set: trial_49 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.05718454346060753, mae:0.0904017761349678, dtw:Not calculated


                                                                                         [I 2025-10-17 01:56:56,256] Trial 49 finished with value: 0.0904017761349678 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 2, 'd_model': 64, 'n_heads': 4, 'e_layers': 1, 'd_layers': 1, 'batch_size': 32, 'learning_rate': 4.337111630968268e-05, 'dropout': 0.1769992284711717}. Best is trial 23 with value: 0.07065031677484512.
Best trial: 23. Best value: 0.0706503:  98%|█████████▊| 49/50 [2:03:49<02:14, 134.26s/it]Best trial: 23. Best value: 0.0706503:  98%|█████████▊| 49/50 [2:03:49<02:14, 134.26s/it]Best trial: 23. Best value: 0.0706503: 100%|██████████| 50/50 [2:03:49<00:00, 134.39s/it]Best trial: 23. Best value: 0.0706503: 100%|██████████| 50/50 [2:03:49<00:00, 148.60s/it]

======================================================================
Optimization Complete!
======================================================================
Number of finished trials: 50

Best trial:
  Value (MSE): 0.070650

Best hyperparameters:
  seq_len: 48
  pred_len: 1
  expand: 1
  d_model: 64
  n_heads: 8
  e_layers: 1
  d_layers: 2
  batch_size: 32
  learning_rate: 0.0006373467143026023
  dropout: 0.03238618128034859
======================================================================

✅ Best parameters saved to: ./optuna_results/Mamba_Exchange_1_best_params.json
✅ Visualizations saved to ./optuna_results/

======================================================================
✅ Hyperparameter tuning complete!
✅ Best parameters saved to: ./optuna_results/Mamba_Exchange_1_best_params.json
======================================================================

Next steps:
  1. Review visualizations in optuna_results/ folder
  2. Train final model:
     python train_best_model.py --model Mamba --train_epochs 100
======================================================================
[I 2025-10-17 01:57:09,211] A new study created in RDB with name: Mamba_Exchange_7

======================================================================
Starting Optuna Hyperparameter Optimization
======================================================================
Model: Mamba
Dataset: custom
Number of trials: 50
Study name: Mamba_Exchange_7
Storage: sqlite:///optuna_study.db
======================================================================

  0%|          | 0/50 [00:00<?, ?it/s]
============================================================
Trial 0
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 2, d_layers: 2
batch_size: 64, lr: 0.000035
dropout: 0.17472832736432067
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_0 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.031249).  Saving model ...
Updating learning rate to 3.497253062343992e-05
Validation loss decreased (0.031249 --> 0.028510).  Saving model ...
Updating learning rate to 1.748626531171996e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.74313265585998e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.37156632792999e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.185783163964995e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0928915819824974e-06
Validation loss decreased (0.028510 --> 0.027084).  Saving model ...
Updating learning rate to 5.464457909912487e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7322289549562436e-07
Validation loss decreased (0.027084 --> 0.026198).  Saving model ...
Updating learning rate to 1.3661144774781218e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.830572387390609e-08
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4152861936953045e-08
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.7076430968476523e-08
Validation loss decreased (0.026198 --> 0.025878).  Saving model ...
Updating learning rate to 8.538215484238261e-09
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.269107742119131e-09
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.1345538710595653e-09
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0672769355297827e-09
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.336384677648913e-10
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.6681923388244567e-10
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3340961694122283e-10
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.670480847061142e-11
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.335240423530571e-11
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.6676202117652854e-11
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.338101058826427e-12
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.1690505294132135e-12
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.0845252647066068e-12
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.0422626323533034e-12
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.211313161766517e-13
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.6056565808832585e-13
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.3028282904416292e-13
EarlyStopping counter: 17 out of 100
Updating learning rate to 6.514141452208146e-14
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.257070726104073e-14
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.6285353630520365e-14
EarlyStopping counter: 20 out of 100
Updating learning rate to 8.142676815260183e-15
EarlyStopping counter: 21 out of 100
Updating learning rate to 4.071338407630091e-15
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.0356692038150457e-15
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.0178346019075228e-15
EarlyStopping counter: 24 out of 100
Updating learning rate to 5.089173009537614e-16
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.544586504768807e-16
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.2722932523844035e-16
EarlyStopping counter: 27 out of 100
Updating learning rate to 6.361466261922018e-17
EarlyStopping counter: 28 out of 100
Updating learning rate to 3.180733130961009e-17
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.5903665654805044e-17
EarlyStopping counter: 30 out of 100
Updating learning rate to 7.951832827402522e-18
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.975916413701261e-18
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.9879582068506305e-18
EarlyStopping counter: 33 out of 100
Updating learning rate to 9.939791034253153e-19
EarlyStopping counter: 34 out of 100
Updating learning rate to 4.969895517126576e-19
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.484947758563288e-19
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.242473879281644e-19
EarlyStopping counter: 37 out of 100
Updating learning rate to 6.21236939640822e-20
EarlyStopping counter: 38 out of 100
Updating learning rate to 3.10618469820411e-20
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.553092349102055e-20
EarlyStopping counter: 40 out of 100
Updating learning rate to 7.765461745510276e-21
EarlyStopping counter: 41 out of 100
Updating learning rate to 3.882730872755138e-21
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.941365436377569e-21
EarlyStopping counter: 43 out of 100
Updating learning rate to 9.706827181887844e-22
EarlyStopping counter: 44 out of 100
Updating learning rate to 4.853413590943922e-22
EarlyStopping counter: 45 out of 100
Updating learning rate to 2.426706795471961e-22
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.2133533977359806e-22
EarlyStopping counter: 47 out of 100
Updating learning rate to 6.066766988679903e-23
EarlyStopping counter: 48 out of 100
Updating learning rate to 3.0333834943399514e-23
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.5166917471699757e-23
EarlyStopping counter: 50 out of 100
Updating learning rate to 7.583458735849878e-24
EarlyStopping counter: 51 out of 100
Updating learning rate to 3.791729367924939e-24
EarlyStopping counter: 52 out of 100
Updating learning rate to 1.8958646839624696e-24
EarlyStopping counter: 53 out of 100
Updating learning rate to 9.479323419812348e-25
EarlyStopping counter: 54 out of 100
Updating learning rate to 4.739661709906174e-25
EarlyStopping counter: 55 out of 100
Updating learning rate to 2.369830854953087e-25
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.1849154274765435e-25
EarlyStopping counter: 57 out of 100
Updating learning rate to 5.924577137382718e-26
EarlyStopping counter: 58 out of 100
Updating learning rate to 2.962288568691359e-26
EarlyStopping counter: 59 out of 100
Updating learning rate to 1.4811442843456794e-26
EarlyStopping counter: 60 out of 100
Updating learning rate to 7.405721421728397e-27
EarlyStopping counter: 61 out of 100
Updating learning rate to 3.7028607108641985e-27
EarlyStopping counter: 62 out of 100
Updating learning rate to 1.8514303554320992e-27
EarlyStopping counter: 63 out of 100
Updating learning rate to 9.257151777160496e-28
EarlyStopping counter: 64 out of 100
Updating learning rate to 4.628575888580248e-28
EarlyStopping counter: 65 out of 100
Updating learning rate to 2.314287944290124e-28
EarlyStopping counter: 66 out of 100
Updating learning rate to 1.157143972145062e-28
EarlyStopping counter: 67 out of 100
Updating learning rate to 5.78571986072531e-29
EarlyStopping counter: 68 out of 100
Updating learning rate to 2.892859930362655e-29
EarlyStopping counter: 69 out of 100
Updating learning rate to 1.4464299651813275e-29
EarlyStopping counter: 70 out of 100
Updating learning rate to 7.232149825906638e-30
EarlyStopping counter: 71 out of 100
Updating learning rate to 3.616074912953319e-30
EarlyStopping counter: 72 out of 100
Updating learning rate to 1.8080374564766594e-30
EarlyStopping counter: 73 out of 100
Updating learning rate to 9.040187282383297e-31
EarlyStopping counter: 74 out of 100
Updating learning rate to 4.5200936411916485e-31
EarlyStopping counter: 75 out of 100
Updating learning rate to 2.2600468205958243e-31
EarlyStopping counter: 76 out of 100
Updating learning rate to 1.1300234102979121e-31
EarlyStopping counter: 77 out of 100
Updating learning rate to 5.650117051489561e-32
EarlyStopping counter: 78 out of 100
Updating learning rate to 2.8250585257447803e-32
EarlyStopping counter: 79 out of 100
Updating learning rate to 1.4125292628723902e-32
EarlyStopping counter: 80 out of 100
Updating learning rate to 7.062646314361951e-33
EarlyStopping counter: 81 out of 100
Updating learning rate to 3.5313231571809754e-33
EarlyStopping counter: 82 out of 100
Updating learning rate to 1.7656615785904877e-33
EarlyStopping counter: 83 out of 100
Updating learning rate to 8.828307892952439e-34
EarlyStopping counter: 84 out of 100
Updating learning rate to 4.414153946476219e-34
EarlyStopping counter: 85 out of 100
Updating learning rate to 2.2070769732381096e-34
EarlyStopping counter: 86 out of 100
Updating learning rate to 1.1035384866190548e-34
EarlyStopping counter: 87 out of 100
Updating learning rate to 5.517692433095274e-35
>>>>>> Testing on validation set: trial_0 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.058541566133499146, mae:0.09189842641353607, dtw:Not calculated


                                      [I 2025-10-17 01:58:20,795] Trial 0 finished with value: 0.09189842641353607 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 2, 'd_model': 64, 'n_heads': 8, 'e_layers': 2, 'd_layers': 2, 'batch_size': 64, 'learning_rate': 3.497253062343992e-05, 'dropout': 0.17472832736432067}. Best is trial 0 with value: 0.09189842641353607.
  0%|          | 0/50 [01:11<?, ?it/s]Best trial: 0. Best value: 0.0918984:   0%|          | 0/50 [01:11<?, ?it/s]Best trial: 0. Best value: 0.0918984:   2%|▏         | 1/50 [01:11<58:28, 71.61s/it]
============================================================
Trial 1
============================================================
seq_len: 96, pred_len: 14
d_model: 32, n_heads: 4
e_layers: 2, d_layers: 1
batch_size: 32, lr: 0.000011
dropout: 0.24487789752731953
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 32, expand: 1
>>>>>> Start training: trial_1 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 14
============================================================
train 4564
val 246
test 248
Validation loss decreased (inf --> 0.036209).  Saving model ...
Updating learning rate to 1.1339846264628324e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.669923132314162e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.834961566157081e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4174807830785405e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.087403915392703e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.5437019576963514e-07
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.7718509788481757e-07
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.859254894240878e-08
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.429627447120439e-08
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.2148137235602196e-08
Validation loss decreased (0.036209 --> 0.036141).  Saving model ...
Updating learning rate to 1.1074068617801098e-08
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.537034308900549e-09
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7685171544502745e-09
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3842585772251372e-09
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.921292886125686e-10
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.460646443062843e-10
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.7303232215314216e-10
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.651616107657108e-11
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.325808053828554e-11
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.162904026914277e-11
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.0814520134571385e-11
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.407260067285692e-12
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.703630033642846e-12
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.351815016821423e-12
EarlyStopping counter: 14 out of 100
Updating learning rate to 6.759075084107115e-13
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.3795375420535577e-13
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.6897687710267789e-13
EarlyStopping counter: 17 out of 100
Updating learning rate to 8.448843855133894e-14
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.224421927566947e-14
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.1122109637834736e-14
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.0561054818917368e-14
EarlyStopping counter: 21 out of 100
Updating learning rate to 5.280527409458684e-15
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.640263704729342e-15
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.320131852364671e-15
EarlyStopping counter: 24 out of 100
Updating learning rate to 6.600659261823355e-16
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.3003296309116775e-16
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.6501648154558387e-16
EarlyStopping counter: 27 out of 100
Updating learning rate to 8.250824077279194e-17
EarlyStopping counter: 28 out of 100
Updating learning rate to 4.125412038639597e-17
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.0627060193197984e-17
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.0313530096598992e-17
EarlyStopping counter: 31 out of 100
Updating learning rate to 5.156765048299496e-18
EarlyStopping counter: 32 out of 100
Updating learning rate to 2.578382524149748e-18
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.289191262074874e-18
EarlyStopping counter: 34 out of 100
Updating learning rate to 6.44595631037437e-19
EarlyStopping counter: 35 out of 100
Updating learning rate to 3.222978155187185e-19
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.6114890775935925e-19
EarlyStopping counter: 37 out of 100
Updating learning rate to 8.057445387967963e-20
EarlyStopping counter: 38 out of 100
Updating learning rate to 4.028722693983981e-20
EarlyStopping counter: 39 out of 100
Updating learning rate to 2.0143613469919906e-20
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.0071806734959953e-20
EarlyStopping counter: 41 out of 100
Updating learning rate to 5.0359033674799766e-21
EarlyStopping counter: 42 out of 100
Updating learning rate to 2.5179516837399883e-21
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.2589758418699942e-21
EarlyStopping counter: 44 out of 100
Updating learning rate to 6.294879209349971e-22
EarlyStopping counter: 45 out of 100
Updating learning rate to 3.1474396046749854e-22
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.5737198023374927e-22
EarlyStopping counter: 47 out of 100
Updating learning rate to 7.868599011687463e-23
EarlyStopping counter: 48 out of 100
Updating learning rate to 3.934299505843732e-23
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.967149752921866e-23
EarlyStopping counter: 50 out of 100
Updating learning rate to 9.83574876460933e-24
EarlyStopping counter: 51 out of 100
Updating learning rate to 4.917874382304665e-24
EarlyStopping counter: 52 out of 100
Updating learning rate to 2.4589371911523323e-24
EarlyStopping counter: 53 out of 100
Updating learning rate to 1.2294685955761662e-24
EarlyStopping counter: 54 out of 100
Updating learning rate to 6.147342977880831e-25
EarlyStopping counter: 55 out of 100
Updating learning rate to 3.0736714889404154e-25
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.5368357444702077e-25
EarlyStopping counter: 57 out of 100
Updating learning rate to 7.684178722351039e-26
EarlyStopping counter: 58 out of 100
Updating learning rate to 3.842089361175519e-26
EarlyStopping counter: 59 out of 100
Updating learning rate to 1.9210446805877596e-26
EarlyStopping counter: 60 out of 100
Updating learning rate to 9.605223402938798e-27
EarlyStopping counter: 61 out of 100
Updating learning rate to 4.802611701469399e-27
Validation loss decreased (0.036141 --> 0.035996).  Saving model ...
Updating learning rate to 2.4013058507346995e-27
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2006529253673498e-27
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.003264626836749e-28
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.0016323134183744e-28
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5008161567091872e-28
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.504080783545936e-29
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.752040391772968e-29
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.876020195886484e-29
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.38010097943242e-30
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.69005048971621e-30
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.345025244858105e-30
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.1725126224290525e-30
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.8625631121452625e-31
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.9312815560726313e-31
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.4656407780363156e-31
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.328203890181578e-32
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.664101945090789e-32
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.8320509725453945e-32
EarlyStopping counter: 18 out of 100
Updating learning rate to 9.160254862726973e-33
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.5801274313634864e-33
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.2900637156817432e-33
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.1450318578408716e-33
EarlyStopping counter: 22 out of 100
Updating learning rate to 5.725159289204358e-34
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.862579644602179e-34
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.4312898223010895e-34
EarlyStopping counter: 25 out of 100
Updating learning rate to 7.156449111505447e-35
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.5782245557527237e-35
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.7891122778763619e-35
>>>>>> Testing on validation set: trial_1 >>>>>>
test 248
test shape: (248, 14, 5) (248, 14, 5)
test shape: (248, 14, 5) (248, 14, 5)


	mse:0.0681176483631134, mae:0.11635828763246536, dtw:Not calculated


                                                                                    [I 2025-10-17 02:00:32,084] Trial 1 finished with value: 0.11635828763246536 and parameters: {'seq_len': 96, 'pred_len': 14, 'expand': 1, 'd_model': 32, 'n_heads': 4, 'e_layers': 2, 'd_layers': 1, 'batch_size': 32, 'learning_rate': 1.1339846264628324e-05, 'dropout': 0.24487789752731953}. Best is trial 0 with value: 0.09189842641353607.
Best trial: 0. Best value: 0.0918984:   2%|▏         | 1/50 [03:22<58:28, 71.61s/it]Best trial: 0. Best value: 0.0918984:   2%|▏         | 1/50 [03:22<58:28, 71.61s/it]Best trial: 0. Best value: 0.0918984:   4%|▍         | 2/50 [03:22<1:25:22, 106.71s/it]
============================================================
Trial 2
============================================================
seq_len: 96, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 2, d_layers: 2
batch_size: 32, lr: 0.000942
dropout: 0.23073346653962515
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_2 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 1
============================================================
train 4577
val 259
test 261
Validation loss decreased (inf --> 0.028705).  Saving model ...
Updating learning rate to 0.0009422749978415277
Validation loss decreased (0.028705 --> 0.024398).  Saving model ...
Updating learning rate to 0.00047113749892076386
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00023556874946038193
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.00011778437473019096
Validation loss decreased (0.024398 --> 0.023993).  Saving model ...
Updating learning rate to 5.889218736509548e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.944609368254774e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.472304684127387e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.361523420636935e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.6807617103184677e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8403808551592338e-06
Validation loss decreased (0.023993 --> 0.023835).  Saving model ...
Updating learning rate to 9.201904275796169e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6009521378980846e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.3004760689490423e-07
Validation loss decreased (0.023835 --> 0.023613).  Saving model ...
Updating learning rate to 1.1502380344745211e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.751190172372606e-08
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.875595086186303e-08
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4377975430931514e-08
Validation loss decreased (0.023613 --> 0.023568).  Saving model ...
Updating learning rate to 7.188987715465757e-09
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.5944938577328786e-09
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.7972469288664393e-09
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.986234644332196e-10
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.493117322166098e-10
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.246558661083049e-10
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1232793305415246e-10
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.616396652707623e-11
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.8081983263538114e-11
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4040991631769057e-11
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.0204958158845285e-12
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.5102479079422642e-12
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.7551239539711321e-12
EarlyStopping counter: 13 out of 100
Updating learning rate to 8.775619769855661e-13
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.3878098849278303e-13
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.1939049424639151e-13
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.0969524712319576e-13
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.484762356159788e-14
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.742381178079894e-14
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.371190589039947e-14
EarlyStopping counter: 20 out of 100
Updating learning rate to 6.855952945199735e-15
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.4279764725998674e-15
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.7139882362999337e-15
EarlyStopping counter: 23 out of 100
Updating learning rate to 8.569941181499669e-16
EarlyStopping counter: 24 out of 100
Updating learning rate to 4.2849705907498343e-16
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.1424852953749171e-16
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.0712426476874586e-16
EarlyStopping counter: 27 out of 100
Updating learning rate to 5.356213238437293e-17
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.6781066192186464e-17
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.3390533096093232e-17
EarlyStopping counter: 30 out of 100
Updating learning rate to 6.695266548046616e-18
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.347633274023308e-18
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.673816637011654e-18
EarlyStopping counter: 33 out of 100
Updating learning rate to 8.36908318505827e-19
EarlyStopping counter: 34 out of 100
Updating learning rate to 4.184541592529135e-19
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.0922707962645675e-19
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.0461353981322838e-19
EarlyStopping counter: 37 out of 100
Updating learning rate to 5.230676990661419e-20
EarlyStopping counter: 38 out of 100
Updating learning rate to 2.6153384953307094e-20
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.3076692476653547e-20
EarlyStopping counter: 40 out of 100
Updating learning rate to 6.5383462383267735e-21
EarlyStopping counter: 41 out of 100
Updating learning rate to 3.2691731191633867e-21
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.6345865595816934e-21
EarlyStopping counter: 43 out of 100
Updating learning rate to 8.172932797908467e-22
EarlyStopping counter: 44 out of 100
Updating learning rate to 4.0864663989542334e-22
EarlyStopping counter: 45 out of 100
Updating learning rate to 2.0432331994771167e-22
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.0216165997385584e-22
EarlyStopping counter: 47 out of 100
Updating learning rate to 5.108082998692792e-23
EarlyStopping counter: 48 out of 100
Updating learning rate to 2.554041499346396e-23
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.277020749673198e-23
EarlyStopping counter: 50 out of 100
Updating learning rate to 6.38510374836599e-24
EarlyStopping counter: 51 out of 100
Updating learning rate to 3.192551874182995e-24
EarlyStopping counter: 52 out of 100
Updating learning rate to 1.5962759370914974e-24
EarlyStopping counter: 53 out of 100
Updating learning rate to 7.981379685457487e-25
EarlyStopping counter: 54 out of 100
Updating learning rate to 3.9906898427287436e-25
EarlyStopping counter: 55 out of 100
Updating learning rate to 1.9953449213643718e-25
EarlyStopping counter: 56 out of 100
Updating learning rate to 9.976724606821859e-26
EarlyStopping counter: 57 out of 100
Updating learning rate to 4.9883623034109295e-26
EarlyStopping counter: 58 out of 100
Updating learning rate to 2.4941811517054647e-26
EarlyStopping counter: 59 out of 100
Updating learning rate to 1.2470905758527324e-26
EarlyStopping counter: 60 out of 100
Updating learning rate to 6.235452879263662e-27
EarlyStopping counter: 61 out of 100
Updating learning rate to 3.117726439631831e-27
EarlyStopping counter: 62 out of 100
Updating learning rate to 1.5588632198159155e-27
EarlyStopping counter: 63 out of 100
Updating learning rate to 7.794316099079577e-28
EarlyStopping counter: 64 out of 100
Updating learning rate to 3.8971580495397886e-28
EarlyStopping counter: 65 out of 100
Updating learning rate to 1.9485790247698943e-28
EarlyStopping counter: 66 out of 100
Updating learning rate to 9.742895123849472e-29
EarlyStopping counter: 67 out of 100
Updating learning rate to 4.871447561924736e-29
EarlyStopping counter: 68 out of 100
Updating learning rate to 2.435723780962368e-29
EarlyStopping counter: 69 out of 100
Updating learning rate to 1.217861890481184e-29
EarlyStopping counter: 70 out of 100
Updating learning rate to 6.08930945240592e-30
EarlyStopping counter: 71 out of 100
Updating learning rate to 3.04465472620296e-30
EarlyStopping counter: 72 out of 100
Updating learning rate to 1.52232736310148e-30
EarlyStopping counter: 73 out of 100
Updating learning rate to 7.6116368155074e-31
EarlyStopping counter: 74 out of 100
Updating learning rate to 3.8058184077537e-31
EarlyStopping counter: 75 out of 100
Updating learning rate to 1.90290920387685e-31
EarlyStopping counter: 76 out of 100
Updating learning rate to 9.51454601938425e-32
EarlyStopping counter: 77 out of 100
Updating learning rate to 4.757273009692125e-32
EarlyStopping counter: 78 out of 100
Updating learning rate to 2.3786365048460624e-32
EarlyStopping counter: 79 out of 100
Updating learning rate to 1.1893182524230312e-32
EarlyStopping counter: 80 out of 100
Updating learning rate to 5.946591262115156e-33
EarlyStopping counter: 81 out of 100
Updating learning rate to 2.973295631057578e-33
EarlyStopping counter: 82 out of 100
Updating learning rate to 1.486647815528789e-33
>>>>>> Testing on validation set: trial_2 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.04943252354860306, mae:0.07378587871789932, dtw:Not calculated


                                                                                       [I 2025-10-17 02:02:45,104] Trial 2 finished with value: 0.07378587871789932 and parameters: {'seq_len': 96, 'pred_len': 1, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 2, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0009422749978415277, 'dropout': 0.23073346653962515}. Best is trial 2 with value: 0.07378587871789932.
Best trial: 0. Best value: 0.0918984:   4%|▍         | 2/50 [05:35<1:25:22, 106.71s/it]Best trial: 2. Best value: 0.0737859:   4%|▍         | 2/50 [05:35<1:25:22, 106.71s/it]Best trial: 2. Best value: 0.0737859:   6%|▌         | 3/50 [05:35<1:33:00, 118.73s/it]
============================================================
Trial 3
============================================================
seq_len: 96, pred_len: 14
d_model: 64, n_heads: 4
e_layers: 1, d_layers: 1
batch_size: 64, lr: 0.000017
dropout: 0.2569596125145272
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_3 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 14
============================================================
train 4564
val 246
test 248
Validation loss decreased (inf --> 0.036856).  Saving model ...
Updating learning rate to 1.6536643311845847e-05
Validation loss decreased (0.036856 --> 0.036708).  Saving model ...
Updating learning rate to 8.268321655922923e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.134160827961462e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.067080413980731e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0335402069903654e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.167701034951827e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.5838505174759135e-07
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.2919252587379568e-07
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.459626293689784e-08
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.229813146844892e-08
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.614906573422446e-08
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.07453286711223e-09
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.037266433556115e-09
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.0186332167780574e-09
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.0093166083890287e-09
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.046583041945144e-10
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.523291520972572e-10
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.261645760486286e-10
EarlyStopping counter: 17 out of 100
Updating learning rate to 6.30822880243143e-11
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.154114401215715e-11
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.5770572006078574e-11
EarlyStopping counter: 20 out of 100
Updating learning rate to 7.885286003039287e-12
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.9426430015196434e-12
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.9713215007598217e-12
EarlyStopping counter: 23 out of 100
Updating learning rate to 9.856607503799109e-13
EarlyStopping counter: 24 out of 100
Updating learning rate to 4.928303751899554e-13
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.464151875949777e-13
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.2320759379748886e-13
EarlyStopping counter: 27 out of 100
Updating learning rate to 6.160379689874443e-14
EarlyStopping counter: 28 out of 100
Updating learning rate to 3.0801898449372214e-14
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.5400949224686107e-14
EarlyStopping counter: 30 out of 100
Updating learning rate to 7.700474612343054e-15
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.850237306171527e-15
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.9251186530857634e-15
EarlyStopping counter: 33 out of 100
Updating learning rate to 9.625593265428817e-16
EarlyStopping counter: 34 out of 100
Updating learning rate to 4.8127966327144085e-16
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.4063983163572042e-16
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.2031991581786021e-16
EarlyStopping counter: 37 out of 100
Updating learning rate to 6.015995790893011e-17
EarlyStopping counter: 38 out of 100
Updating learning rate to 3.0079978954465053e-17
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.5039989477232527e-17
EarlyStopping counter: 40 out of 100
Updating learning rate to 7.519994738616263e-18
EarlyStopping counter: 41 out of 100
Updating learning rate to 3.759997369308132e-18
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.879998684654066e-18
EarlyStopping counter: 43 out of 100
Updating learning rate to 9.39999342327033e-19
EarlyStopping counter: 44 out of 100
Updating learning rate to 4.699996711635165e-19
EarlyStopping counter: 45 out of 100
Updating learning rate to 2.3499983558175823e-19
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.1749991779087911e-19
EarlyStopping counter: 47 out of 100
Updating learning rate to 5.874995889543956e-20
EarlyStopping counter: 48 out of 100
Updating learning rate to 2.937497944771978e-20
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.468748972385989e-20
EarlyStopping counter: 50 out of 100
Updating learning rate to 7.343744861929945e-21
EarlyStopping counter: 51 out of 100
Updating learning rate to 3.671872430964972e-21
EarlyStopping counter: 52 out of 100
Updating learning rate to 1.835936215482486e-21
EarlyStopping counter: 53 out of 100
Updating learning rate to 9.17968107741243e-22
EarlyStopping counter: 54 out of 100
Updating learning rate to 4.589840538706215e-22
EarlyStopping counter: 55 out of 100
Updating learning rate to 2.2949202693531077e-22
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.1474601346765538e-22
EarlyStopping counter: 57 out of 100
Updating learning rate to 5.737300673382769e-23
EarlyStopping counter: 58 out of 100
Updating learning rate to 2.8686503366913846e-23
EarlyStopping counter: 59 out of 100
Updating learning rate to 1.4343251683456923e-23
EarlyStopping counter: 60 out of 100
Updating learning rate to 7.171625841728462e-24
EarlyStopping counter: 61 out of 100
Updating learning rate to 3.585812920864231e-24
EarlyStopping counter: 62 out of 100
Updating learning rate to 1.7929064604321154e-24
EarlyStopping counter: 63 out of 100
Updating learning rate to 8.964532302160577e-25
EarlyStopping counter: 64 out of 100
Updating learning rate to 4.482266151080288e-25
EarlyStopping counter: 65 out of 100
Updating learning rate to 2.241133075540144e-25
EarlyStopping counter: 66 out of 100
Updating learning rate to 1.120566537770072e-25
EarlyStopping counter: 67 out of 100
Updating learning rate to 5.60283268885036e-26
EarlyStopping counter: 68 out of 100
Updating learning rate to 2.80141634442518e-26
EarlyStopping counter: 69 out of 100
Updating learning rate to 1.40070817221259e-26
EarlyStopping counter: 70 out of 100
Updating learning rate to 7.00354086106295e-27
EarlyStopping counter: 71 out of 100
Updating learning rate to 3.501770430531475e-27
EarlyStopping counter: 72 out of 100
Updating learning rate to 1.7508852152657377e-27
EarlyStopping counter: 73 out of 100
Updating learning rate to 8.754426076328688e-28
EarlyStopping counter: 74 out of 100
Updating learning rate to 4.377213038164344e-28
EarlyStopping counter: 75 out of 100
Updating learning rate to 2.188606519082172e-28
EarlyStopping counter: 76 out of 100
Updating learning rate to 1.094303259541086e-28
EarlyStopping counter: 77 out of 100
Updating learning rate to 5.47151629770543e-29
EarlyStopping counter: 78 out of 100
Updating learning rate to 2.735758148852715e-29
EarlyStopping counter: 79 out of 100
Updating learning rate to 1.3678790744263576e-29
EarlyStopping counter: 80 out of 100
Updating learning rate to 6.839395372131788e-30
EarlyStopping counter: 81 out of 100
Updating learning rate to 3.419697686065894e-30
EarlyStopping counter: 82 out of 100
Updating learning rate to 1.709848843032947e-30
EarlyStopping counter: 83 out of 100
Updating learning rate to 8.549244215164735e-31
EarlyStopping counter: 84 out of 100
Updating learning rate to 4.274622107582367e-31
EarlyStopping counter: 85 out of 100
Updating learning rate to 2.1373110537911837e-31
EarlyStopping counter: 86 out of 100
Updating learning rate to 1.0686555268955918e-31
EarlyStopping counter: 87 out of 100
Updating learning rate to 5.343277634477959e-32
EarlyStopping counter: 88 out of 100
Updating learning rate to 2.6716388172389796e-32
EarlyStopping counter: 89 out of 100
Updating learning rate to 1.3358194086194898e-32
EarlyStopping counter: 90 out of 100
Updating learning rate to 6.679097043097449e-33
EarlyStopping counter: 91 out of 100
Updating learning rate to 3.3395485215487245e-33
EarlyStopping counter: 92 out of 100
Updating learning rate to 1.6697742607743623e-33
EarlyStopping counter: 93 out of 100
Updating learning rate to 8.348871303871811e-34
EarlyStopping counter: 94 out of 100
Updating learning rate to 4.174435651935906e-34
EarlyStopping counter: 95 out of 100
Updating learning rate to 2.087217825967953e-34
EarlyStopping counter: 96 out of 100
Updating learning rate to 1.0436089129839764e-34
EarlyStopping counter: 97 out of 100
Updating learning rate to 5.218044564919882e-35
EarlyStopping counter: 98 out of 100
Updating learning rate to 2.609022282459941e-35
>>>>>> Testing on validation set: trial_3 >>>>>>
test 248
test shape: (248, 14, 5) (248, 14, 5)
test shape: (248, 14, 5) (248, 14, 5)


	mse:0.0671130120754242, mae:0.11560377478599548, dtw:Not calculated


                                                                                       [I 2025-10-17 02:03:52,511] Trial 3 finished with value: 0.11560377478599548 and parameters: {'seq_len': 96, 'pred_len': 14, 'expand': 1, 'd_model': 64, 'n_heads': 4, 'e_layers': 1, 'd_layers': 1, 'batch_size': 64, 'learning_rate': 1.6536643311845847e-05, 'dropout': 0.2569596125145272}. Best is trial 2 with value: 0.07378587871789932.
Best trial: 2. Best value: 0.0737859:   6%|▌         | 3/50 [06:43<1:33:00, 118.73s/it]Best trial: 2. Best value: 0.0737859:   6%|▌         | 3/50 [06:43<1:33:00, 118.73s/it]Best trial: 2. Best value: 0.0737859:   8%|▊         | 4/50 [06:43<1:15:29, 98.47s/it] 
============================================================
Trial 4
============================================================
seq_len: 96, pred_len: 30
d_model: 64, n_heads: 4
e_layers: 2, d_layers: 2
batch_size: 32, lr: 0.000384
dropout: 0.033328513375209486
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_4 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 30
============================================================
train 4548
val 230
test 232
Validation loss decreased (inf --> 0.035569).  Saving model ...
Updating learning rate to 0.00038357771671981394
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00019178885835990697
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.589442917995349e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.794721458997674e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.397360729498837e-05
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1986803647494186e-05
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.993401823747093e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.9967009118735464e-06
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.4983504559367732e-06
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.491752279683866e-07
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.745876139841933e-07
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.8729380699209665e-07
EarlyStopping counter: 12 out of 100
Updating learning rate to 9.364690349604833e-08
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.682345174802416e-08
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.341172587401208e-08
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.170586293700604e-08
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.85293146850302e-09
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.92646573425151e-09
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.463232867125755e-09
EarlyStopping counter: 19 out of 100
Updating learning rate to 7.316164335628775e-10
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.6580821678143877e-10
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.8290410839071939e-10
EarlyStopping counter: 22 out of 100
Updating learning rate to 9.145205419535969e-11
EarlyStopping counter: 23 out of 100
Updating learning rate to 4.5726027097679846e-11
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.2863013548839923e-11
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.1431506774419962e-11
EarlyStopping counter: 26 out of 100
Updating learning rate to 5.715753387209981e-12
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.8578766936049904e-12
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.4289383468024952e-12
EarlyStopping counter: 29 out of 100
Updating learning rate to 7.144691734012476e-13
EarlyStopping counter: 30 out of 100
Updating learning rate to 3.572345867006238e-13
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.786172933503119e-13
EarlyStopping counter: 32 out of 100
Updating learning rate to 8.930864667515595e-14
EarlyStopping counter: 33 out of 100
Updating learning rate to 4.4654323337577975e-14
EarlyStopping counter: 34 out of 100
Updating learning rate to 2.2327161668788987e-14
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.1163580834394494e-14
EarlyStopping counter: 36 out of 100
Updating learning rate to 5.581790417197247e-15
EarlyStopping counter: 37 out of 100
Updating learning rate to 2.7908952085986234e-15
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.3954476042993117e-15
EarlyStopping counter: 39 out of 100
Updating learning rate to 6.977238021496559e-16
EarlyStopping counter: 40 out of 100
Updating learning rate to 3.4886190107482793e-16
EarlyStopping counter: 41 out of 100
Updating learning rate to 1.7443095053741396e-16
EarlyStopping counter: 42 out of 100
Updating learning rate to 8.721547526870698e-17
EarlyStopping counter: 43 out of 100
Updating learning rate to 4.360773763435349e-17
EarlyStopping counter: 44 out of 100
Updating learning rate to 2.1803868817176746e-17
EarlyStopping counter: 45 out of 100
Updating learning rate to 1.0901934408588373e-17
EarlyStopping counter: 46 out of 100
Updating learning rate to 5.4509672042941864e-18
EarlyStopping counter: 47 out of 100
Updating learning rate to 2.7254836021470932e-18
EarlyStopping counter: 48 out of 100
Updating learning rate to 1.3627418010735466e-18
EarlyStopping counter: 49 out of 100
Updating learning rate to 6.813709005367733e-19
EarlyStopping counter: 50 out of 100
Updating learning rate to 3.4068545026838665e-19
EarlyStopping counter: 51 out of 100
Updating learning rate to 1.7034272513419332e-19
EarlyStopping counter: 52 out of 100
Updating learning rate to 8.517136256709666e-20
EarlyStopping counter: 53 out of 100
Updating learning rate to 4.258568128354833e-20
EarlyStopping counter: 54 out of 100
Updating learning rate to 2.1292840641774166e-20
EarlyStopping counter: 55 out of 100
Updating learning rate to 1.0646420320887083e-20
EarlyStopping counter: 56 out of 100
Updating learning rate to 5.3232101604435414e-21
EarlyStopping counter: 57 out of 100
Updating learning rate to 2.6616050802217707e-21
EarlyStopping counter: 58 out of 100
Updating learning rate to 1.3308025401108854e-21
EarlyStopping counter: 59 out of 100
Updating learning rate to 6.654012700554427e-22
EarlyStopping counter: 60 out of 100
Updating learning rate to 3.3270063502772134e-22
EarlyStopping counter: 61 out of 100
Updating learning rate to 1.6635031751386067e-22
EarlyStopping counter: 62 out of 100
Updating learning rate to 8.317515875693033e-23
EarlyStopping counter: 63 out of 100
Updating learning rate to 4.158757937846517e-23
EarlyStopping counter: 64 out of 100
Updating learning rate to 2.0793789689232584e-23
EarlyStopping counter: 65 out of 100
Updating learning rate to 1.0396894844616292e-23
EarlyStopping counter: 66 out of 100
Updating learning rate to 5.198447422308146e-24
EarlyStopping counter: 67 out of 100
Updating learning rate to 2.599223711154073e-24
EarlyStopping counter: 68 out of 100
Updating learning rate to 1.2996118555770365e-24
EarlyStopping counter: 69 out of 100
Updating learning rate to 6.498059277885182e-25
EarlyStopping counter: 70 out of 100
Updating learning rate to 3.249029638942591e-25
EarlyStopping counter: 71 out of 100
Updating learning rate to 1.6245148194712956e-25
EarlyStopping counter: 72 out of 100
Updating learning rate to 8.122574097356478e-26
EarlyStopping counter: 73 out of 100
Updating learning rate to 4.061287048678239e-26
EarlyStopping counter: 74 out of 100
Updating learning rate to 2.0306435243391195e-26
EarlyStopping counter: 75 out of 100
Updating learning rate to 1.0153217621695597e-26
EarlyStopping counter: 76 out of 100
Updating learning rate to 5.076608810847799e-27
EarlyStopping counter: 77 out of 100
Updating learning rate to 2.5383044054238994e-27
EarlyStopping counter: 78 out of 100
Updating learning rate to 1.2691522027119497e-27
EarlyStopping counter: 79 out of 100
Updating learning rate to 6.345761013559748e-28
EarlyStopping counter: 80 out of 100
Updating learning rate to 3.172880506779874e-28
EarlyStopping counter: 81 out of 100
Updating learning rate to 1.586440253389937e-28
EarlyStopping counter: 82 out of 100
Updating learning rate to 7.932201266949686e-29
EarlyStopping counter: 83 out of 100
Updating learning rate to 3.966100633474843e-29
EarlyStopping counter: 84 out of 100
Updating learning rate to 1.9830503167374214e-29
EarlyStopping counter: 85 out of 100
Updating learning rate to 9.915251583687107e-30
EarlyStopping counter: 86 out of 100
Updating learning rate to 4.9576257918435534e-30
EarlyStopping counter: 87 out of 100
Updating learning rate to 2.4788128959217767e-30
EarlyStopping counter: 88 out of 100
Updating learning rate to 1.2394064479608884e-30
EarlyStopping counter: 89 out of 100
Updating learning rate to 6.197032239804442e-31
EarlyStopping counter: 90 out of 100
Updating learning rate to 3.098516119902221e-31
EarlyStopping counter: 91 out of 100
Updating learning rate to 1.5492580599511105e-31
EarlyStopping counter: 92 out of 100
Updating learning rate to 7.746290299755552e-32
EarlyStopping counter: 93 out of 100
Updating learning rate to 3.873145149877776e-32
EarlyStopping counter: 94 out of 100
Updating learning rate to 1.936572574938888e-32
EarlyStopping counter: 95 out of 100
Updating learning rate to 9.68286287469444e-33
EarlyStopping counter: 96 out of 100
Updating learning rate to 4.84143143734722e-33
EarlyStopping counter: 97 out of 100
Updating learning rate to 2.42071571867361e-33
EarlyStopping counter: 98 out of 100
Updating learning rate to 1.210357859336805e-33
EarlyStopping counter: 99 out of 100
Updating learning rate to 6.051789296684025e-34
>>>>>> Testing on validation set: trial_4 >>>>>>
test 232
test shape: (232, 30, 5) (232, 30, 5)
test shape: (232, 30, 5) (232, 30, 5)


	mse:0.07319589704275131, mae:0.1128133162856102, dtw:Not calculated


                                                                                      [I 2025-10-17 02:06:06,039] Trial 4 finished with value: 0.1128133162856102 and parameters: {'seq_len': 96, 'pred_len': 30, 'expand': 2, 'd_model': 64, 'n_heads': 4, 'e_layers': 2, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.00038357771671981394, 'dropout': 0.033328513375209486}. Best is trial 2 with value: 0.07378587871789932.
Best trial: 2. Best value: 0.0737859:   8%|▊         | 4/50 [08:56<1:15:29, 98.47s/it]Best trial: 2. Best value: 0.0737859:   8%|▊         | 4/50 [08:56<1:15:29, 98.47s/it]Best trial: 2. Best value: 0.0737859:  10%|█         | 5/50 [08:56<1:23:20, 111.11s/it]
============================================================
Trial 5
============================================================
seq_len: 48, pred_len: 14
d_model: 32, n_heads: 8
e_layers: 2, d_layers: 2
batch_size: 16, lr: 0.000012
dropout: 0.10152374628548806
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 64, expand: 2
>>>>>> Start training: trial_5 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 14
============================================================
train 4612
val 246
test 248
Validation loss decreased (inf --> 0.038585).  Saving model ...
Updating learning rate to 1.2365787583518557e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.182893791759278e-06
Validation loss decreased (0.038585 --> 0.037707).  Saving model ...
Updating learning rate to 3.091446895879639e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5457234479398196e-06
Validation loss decreased (0.037707 --> 0.037603).  Saving model ...
Updating learning rate to 7.728617239699098e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.864308619849549e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.9321543099247745e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.660771549623872e-08
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.830385774811936e-08
Validation loss decreased (0.037603 --> 0.037455).  Saving model ...
Updating learning rate to 2.415192887405968e-08
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.207596443702984e-08
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.03798221851492e-09
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.01899110925746e-09
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.50949555462873e-09
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.54747777314365e-10
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.773738886571825e-10
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8868694432859126e-10
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.434347216429563e-11
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.7171736082147815e-11
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.3585868041073907e-11
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.1792934020536954e-11
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.896467010268477e-12
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.9482335051342384e-12
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.4741167525671192e-12
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.370583762835596e-13
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.685291881417798e-13
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.842645940708899e-13
EarlyStopping counter: 18 out of 100
Updating learning rate to 9.213229703544495e-14
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.6066148517722475e-14
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.3033074258861238e-14
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.1516537129430619e-14
EarlyStopping counter: 22 out of 100
Updating learning rate to 5.7582685647153094e-15
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.8791342823576547e-15
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.4395671411788274e-15
EarlyStopping counter: 25 out of 100
Updating learning rate to 7.197835705894137e-16
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.5989178529470684e-16
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.7994589264735342e-16
EarlyStopping counter: 28 out of 100
Updating learning rate to 8.997294632367671e-17
EarlyStopping counter: 29 out of 100
Updating learning rate to 4.4986473161838355e-17
EarlyStopping counter: 30 out of 100
Updating learning rate to 2.2493236580919177e-17
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.1246618290459589e-17
EarlyStopping counter: 32 out of 100
Updating learning rate to 5.623309145229794e-18
EarlyStopping counter: 33 out of 100
Updating learning rate to 2.811654572614897e-18
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.4058272863074486e-18
EarlyStopping counter: 35 out of 100
Updating learning rate to 7.029136431537243e-19
EarlyStopping counter: 36 out of 100
Updating learning rate to 3.5145682157686215e-19
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.7572841078843107e-19
EarlyStopping counter: 38 out of 100
Updating learning rate to 8.786420539421554e-20
EarlyStopping counter: 39 out of 100
Updating learning rate to 4.393210269710777e-20
EarlyStopping counter: 40 out of 100
Updating learning rate to 2.1966051348553884e-20
EarlyStopping counter: 41 out of 100
Updating learning rate to 1.0983025674276942e-20
EarlyStopping counter: 42 out of 100
Updating learning rate to 5.491512837138471e-21
EarlyStopping counter: 43 out of 100
Updating learning rate to 2.7457564185692355e-21
EarlyStopping counter: 44 out of 100
Updating learning rate to 1.3728782092846178e-21
EarlyStopping counter: 45 out of 100
Updating learning rate to 6.864391046423089e-22
EarlyStopping counter: 46 out of 100
Updating learning rate to 3.4321955232115444e-22
EarlyStopping counter: 47 out of 100
Updating learning rate to 1.7160977616057722e-22
EarlyStopping counter: 48 out of 100
Updating learning rate to 8.580488808028861e-23
EarlyStopping counter: 49 out of 100
Updating learning rate to 4.2902444040144305e-23
EarlyStopping counter: 50 out of 100
Updating learning rate to 2.1451222020072153e-23
EarlyStopping counter: 51 out of 100
Updating learning rate to 1.0725611010036076e-23
EarlyStopping counter: 52 out of 100
Updating learning rate to 5.362805505018038e-24
EarlyStopping counter: 53 out of 100
Updating learning rate to 2.681402752509019e-24
EarlyStopping counter: 54 out of 100
Updating learning rate to 1.3407013762545095e-24
EarlyStopping counter: 55 out of 100
Updating learning rate to 6.703506881272548e-25
EarlyStopping counter: 56 out of 100
Updating learning rate to 3.351753440636274e-25
EarlyStopping counter: 57 out of 100
Updating learning rate to 1.675876720318137e-25
EarlyStopping counter: 58 out of 100
Updating learning rate to 8.379383601590685e-26
EarlyStopping counter: 59 out of 100
Updating learning rate to 4.1896918007953423e-26
EarlyStopping counter: 60 out of 100
Updating learning rate to 2.0948459003976711e-26
EarlyStopping counter: 61 out of 100
Updating learning rate to 1.0474229501988356e-26
EarlyStopping counter: 62 out of 100
Updating learning rate to 5.237114750994178e-27
EarlyStopping counter: 63 out of 100
Updating learning rate to 2.618557375497089e-27
EarlyStopping counter: 64 out of 100
Updating learning rate to 1.3092786877485445e-27
EarlyStopping counter: 65 out of 100
Updating learning rate to 6.546393438742722e-28
EarlyStopping counter: 66 out of 100
Updating learning rate to 3.273196719371361e-28
EarlyStopping counter: 67 out of 100
Updating learning rate to 1.6365983596856806e-28
EarlyStopping counter: 68 out of 100
Updating learning rate to 8.182991798428403e-29
EarlyStopping counter: 69 out of 100
Updating learning rate to 4.0914958992142015e-29
EarlyStopping counter: 70 out of 100
Updating learning rate to 2.0457479496071007e-29
EarlyStopping counter: 71 out of 100
Updating learning rate to 1.0228739748035504e-29
EarlyStopping counter: 72 out of 100
Updating learning rate to 5.114369874017752e-30
EarlyStopping counter: 73 out of 100
Updating learning rate to 2.557184937008876e-30
EarlyStopping counter: 74 out of 100
Updating learning rate to 1.278592468504438e-30
EarlyStopping counter: 75 out of 100
Updating learning rate to 6.39296234252219e-31
EarlyStopping counter: 76 out of 100
Updating learning rate to 3.196481171261095e-31
EarlyStopping counter: 77 out of 100
Updating learning rate to 1.5982405856305474e-31
Validation loss decreased (0.037455 --> 0.037455).  Saving model ...
Updating learning rate to 7.991202928152737e-32
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.9956014640763686e-32
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.9978007320381843e-32
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.989003660190922e-33
Validation loss decreased (0.037455 --> 0.037418).  Saving model ...
Updating learning rate to 4.994501830095461e-33
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.4972509150477304e-33
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2486254575238652e-33
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.243127287619326e-34
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.121563643809663e-34
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.5607818219048315e-34
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.803909109524157e-35
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.9019545547620787e-35
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.9509772773810394e-35
>>>>>> Testing on validation set: trial_5 >>>>>>
test 248
test shape: (248, 14, 5) (248, 14, 5)
test shape: (248, 14, 5) (248, 14, 5)


	mse:0.06629444658756256, mae:0.09923025220632553, dtw:Not calculated


                                                                                       [I 2025-10-17 02:10:27,235] Trial 5 finished with value: 0.09923025220632553 and parameters: {'seq_len': 48, 'pred_len': 14, 'expand': 2, 'd_model': 32, 'n_heads': 8, 'e_layers': 2, 'd_layers': 2, 'batch_size': 16, 'learning_rate': 1.2365787583518557e-05, 'dropout': 0.10152374628548806}. Best is trial 2 with value: 0.07378587871789932.
Best trial: 2. Best value: 0.0737859:  10%|█         | 5/50 [13:18<1:23:20, 111.11s/it]Best trial: 2. Best value: 0.0737859:  10%|█         | 5/50 [13:18<1:23:20, 111.11s/it]Best trial: 2. Best value: 0.0737859:  12%|█▏        | 6/50 [13:18<1:58:54, 162.14s/it]
============================================================
Trial 6
============================================================
seq_len: 96, pred_len: 7
d_model: 32, n_heads: 4
e_layers: 2, d_layers: 1
batch_size: 64, lr: 0.000144
dropout: 0.13897023272955292
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 64, expand: 2
>>>>>> Start training: trial_6 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 7
============================================================
train 4571
val 253
test 255
Validation loss decreased (inf --> 0.038160).  Saving model ...
Updating learning rate to 0.00014430109085053182
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.215054542526591e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.6075272712632956e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8037636356316478e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.018818178158239e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.5094090890791195e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.2547045445395597e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1273522722697799e-06
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.636761361348899e-07
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.8183806806744497e-07
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.4091903403372248e-07
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.045951701686124e-08
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.522975850843062e-08
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.761487925421531e-08
EarlyStopping counter: 14 out of 100
Updating learning rate to 8.807439627107655e-09
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.403719813553828e-09
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.201859906776914e-09
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.100929953388457e-09
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.504649766942284e-10
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.752324883471142e-10
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.376162441735571e-10
EarlyStopping counter: 21 out of 100
Updating learning rate to 6.880812208677856e-11
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.440406104338928e-11
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.720203052169464e-11
EarlyStopping counter: 24 out of 100
Updating learning rate to 8.60101526084732e-12
EarlyStopping counter: 25 out of 100
Updating learning rate to 4.30050763042366e-12
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.15025381521183e-12
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.075126907605915e-12
EarlyStopping counter: 28 out of 100
Updating learning rate to 5.375634538029575e-13
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.6878172690147874e-13
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.3439086345073937e-13
EarlyStopping counter: 31 out of 100
Updating learning rate to 6.719543172536968e-14
EarlyStopping counter: 32 out of 100
Updating learning rate to 3.359771586268484e-14
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.679885793134242e-14
EarlyStopping counter: 34 out of 100
Updating learning rate to 8.39942896567121e-15
EarlyStopping counter: 35 out of 100
Updating learning rate to 4.199714482835605e-15
EarlyStopping counter: 36 out of 100
Updating learning rate to 2.0998572414178026e-15
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.0499286207089013e-15
EarlyStopping counter: 38 out of 100
Updating learning rate to 5.249643103544507e-16
EarlyStopping counter: 39 out of 100
Updating learning rate to 2.6248215517722533e-16
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.3124107758861266e-16
EarlyStopping counter: 41 out of 100
Updating learning rate to 6.562053879430633e-17
EarlyStopping counter: 42 out of 100
Updating learning rate to 3.2810269397153166e-17
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.6405134698576583e-17
EarlyStopping counter: 44 out of 100
Updating learning rate to 8.202567349288291e-18
EarlyStopping counter: 45 out of 100
Updating learning rate to 4.101283674644146e-18
EarlyStopping counter: 46 out of 100
Updating learning rate to 2.050641837322073e-18
EarlyStopping counter: 47 out of 100
Updating learning rate to 1.0253209186610364e-18
EarlyStopping counter: 48 out of 100
Updating learning rate to 5.126604593305182e-19
EarlyStopping counter: 49 out of 100
Updating learning rate to 2.563302296652591e-19
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.2816511483262955e-19
EarlyStopping counter: 51 out of 100
Updating learning rate to 6.408255741631478e-20
EarlyStopping counter: 52 out of 100
Updating learning rate to 3.204127870815739e-20
EarlyStopping counter: 53 out of 100
Updating learning rate to 1.6020639354078694e-20
EarlyStopping counter: 54 out of 100
Updating learning rate to 8.010319677039347e-21
EarlyStopping counter: 55 out of 100
Updating learning rate to 4.0051598385196736e-21
EarlyStopping counter: 56 out of 100
Updating learning rate to 2.0025799192598368e-21
EarlyStopping counter: 57 out of 100
Updating learning rate to 1.0012899596299184e-21
EarlyStopping counter: 58 out of 100
Updating learning rate to 5.006449798149592e-22
EarlyStopping counter: 59 out of 100
Updating learning rate to 2.503224899074796e-22
EarlyStopping counter: 60 out of 100
Updating learning rate to 1.251612449537398e-22
EarlyStopping counter: 61 out of 100
Updating learning rate to 6.25806224768699e-23
EarlyStopping counter: 62 out of 100
Updating learning rate to 3.129031123843495e-23
EarlyStopping counter: 63 out of 100
Updating learning rate to 1.5645155619217475e-23
EarlyStopping counter: 64 out of 100
Updating learning rate to 7.822577809608737e-24
EarlyStopping counter: 65 out of 100
Updating learning rate to 3.911288904804369e-24
EarlyStopping counter: 66 out of 100
Updating learning rate to 1.9556444524021844e-24
EarlyStopping counter: 67 out of 100
Updating learning rate to 9.778222262010922e-25
EarlyStopping counter: 68 out of 100
Updating learning rate to 4.889111131005461e-25
EarlyStopping counter: 69 out of 100
Updating learning rate to 2.4445555655027305e-25
EarlyStopping counter: 70 out of 100
Updating learning rate to 1.2222777827513652e-25
EarlyStopping counter: 71 out of 100
Updating learning rate to 6.111388913756826e-26
EarlyStopping counter: 72 out of 100
Updating learning rate to 3.055694456878413e-26
EarlyStopping counter: 73 out of 100
Updating learning rate to 1.5278472284392065e-26
EarlyStopping counter: 74 out of 100
Updating learning rate to 7.639236142196033e-27
EarlyStopping counter: 75 out of 100
Updating learning rate to 3.819618071098016e-27
EarlyStopping counter: 76 out of 100
Updating learning rate to 1.909809035549008e-27
EarlyStopping counter: 77 out of 100
Updating learning rate to 9.54904517774504e-28
EarlyStopping counter: 78 out of 100
Updating learning rate to 4.77452258887252e-28
EarlyStopping counter: 79 out of 100
Updating learning rate to 2.38726129443626e-28
EarlyStopping counter: 80 out of 100
Updating learning rate to 1.19363064721813e-28
EarlyStopping counter: 81 out of 100
Updating learning rate to 5.96815323609065e-29
EarlyStopping counter: 82 out of 100
Updating learning rate to 2.984076618045325e-29
EarlyStopping counter: 83 out of 100
Updating learning rate to 1.4920383090226626e-29
EarlyStopping counter: 84 out of 100
Updating learning rate to 7.460191545113313e-30
EarlyStopping counter: 85 out of 100
Updating learning rate to 3.7300957725566566e-30
EarlyStopping counter: 86 out of 100
Updating learning rate to 1.8650478862783283e-30
EarlyStopping counter: 87 out of 100
Updating learning rate to 9.325239431391641e-31
EarlyStopping counter: 88 out of 100
Updating learning rate to 4.662619715695821e-31
EarlyStopping counter: 89 out of 100
Updating learning rate to 2.3313098578479104e-31
EarlyStopping counter: 90 out of 100
Updating learning rate to 1.1656549289239552e-31
EarlyStopping counter: 91 out of 100
Updating learning rate to 5.828274644619776e-32
EarlyStopping counter: 92 out of 100
Updating learning rate to 2.914137322309888e-32
EarlyStopping counter: 93 out of 100
Updating learning rate to 1.457068661154944e-32
EarlyStopping counter: 94 out of 100
Updating learning rate to 7.28534330577472e-33
EarlyStopping counter: 95 out of 100
Updating learning rate to 3.64267165288736e-33
EarlyStopping counter: 96 out of 100
Updating learning rate to 1.82133582644368e-33
EarlyStopping counter: 97 out of 100
Updating learning rate to 9.1066791322184e-34
EarlyStopping counter: 98 out of 100
Updating learning rate to 4.5533395661092e-34
EarlyStopping counter: 99 out of 100
Updating learning rate to 2.2766697830546e-34
>>>>>> Testing on validation set: trial_6 >>>>>>
test 255
test shape: (255, 7, 5) (255, 7, 5)
test shape: (255, 7, 5) (255, 7, 5)


	mse:0.06726265698671341, mae:0.11518033593893051, dtw:Not calculated


                                                                                       [I 2025-10-17 02:11:34,288] Trial 6 finished with value: 0.11518033593893051 and parameters: {'seq_len': 96, 'pred_len': 7, 'expand': 2, 'd_model': 32, 'n_heads': 4, 'e_layers': 2, 'd_layers': 1, 'batch_size': 64, 'learning_rate': 0.00014430109085053182, 'dropout': 0.13897023272955292}. Best is trial 2 with value: 0.07378587871789932.
Best trial: 2. Best value: 0.0737859:  12%|█▏        | 6/50 [14:25<1:58:54, 162.14s/it]Best trial: 2. Best value: 0.0737859:  12%|█▏        | 6/50 [14:25<1:58:54, 162.14s/it]Best trial: 2. Best value: 0.0737859:  14%|█▍        | 7/50 [14:25<1:33:55, 131.05s/it]
============================================================
Trial 7
============================================================
seq_len: 96, pred_len: 1
d_model: 32, n_heads: 8
e_layers: 2, d_layers: 2
batch_size: 64, lr: 0.000124
dropout: 0.03241752618857658
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 32, expand: 1
>>>>>> Start training: trial_7 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 1
============================================================
train 4577
val 259
test 261
Validation loss decreased (inf --> 0.031444).  Saving model ...
Updating learning rate to 0.00012369577988101057
Validation loss decreased (0.031444 --> 0.029539).  Saving model ...
Updating learning rate to 6.184788994050529e-05
Validation loss decreased (0.029539 --> 0.027627).  Saving model ...
Updating learning rate to 3.0923944970252644e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5461972485126322e-05
Validation loss decreased (0.027627 --> 0.026543).  Saving model ...
Updating learning rate to 7.730986242563161e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.8654931212815805e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.9327465606407902e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.663732803203951e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.831866401601976e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.415933200800988e-07
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.207966600400494e-07
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.03983300200247e-08
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.019916501001235e-08
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.5099582505006174e-08
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.549791252503087e-09
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.774895626251543e-09
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.8874478131257717e-09
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.437239065628859e-10
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.718619532814429e-10
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.3593097664072146e-10
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.1796548832036073e-10
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.898274416018037e-11
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.949137208009018e-11
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.474568604004509e-11
EarlyStopping counter: 20 out of 100
Updating learning rate to 7.372843020022546e-12
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.686421510011273e-12
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.8432107550056364e-12
EarlyStopping counter: 23 out of 100
Updating learning rate to 9.216053775028182e-13
EarlyStopping counter: 24 out of 100
Updating learning rate to 4.608026887514091e-13
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.3040134437570455e-13
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.1520067218785228e-13
EarlyStopping counter: 27 out of 100
Updating learning rate to 5.760033609392614e-14
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.880016804696307e-14
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.4400084023481535e-14
EarlyStopping counter: 30 out of 100
Updating learning rate to 7.200042011740767e-15
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.600021005870384e-15
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.800010502935192e-15
EarlyStopping counter: 33 out of 100
Updating learning rate to 9.00005251467596e-16
EarlyStopping counter: 34 out of 100
Updating learning rate to 4.50002625733798e-16
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.25001312866899e-16
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.125006564334495e-16
EarlyStopping counter: 37 out of 100
Updating learning rate to 5.625032821672474e-17
EarlyStopping counter: 38 out of 100
Updating learning rate to 2.812516410836237e-17
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.4062582054181186e-17
EarlyStopping counter: 40 out of 100
Updating learning rate to 7.031291027090593e-18
EarlyStopping counter: 41 out of 100
Updating learning rate to 3.5156455135452965e-18
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.7578227567726483e-18
EarlyStopping counter: 43 out of 100
Updating learning rate to 8.789113783863241e-19
EarlyStopping counter: 44 out of 100
Updating learning rate to 4.394556891931621e-19
EarlyStopping counter: 45 out of 100
Updating learning rate to 2.1972784459658103e-19
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.0986392229829052e-19
EarlyStopping counter: 47 out of 100
Updating learning rate to 5.493196114914526e-20
EarlyStopping counter: 48 out of 100
Updating learning rate to 2.746598057457263e-20
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.3732990287286315e-20
EarlyStopping counter: 50 out of 100
Updating learning rate to 6.866495143643157e-21
EarlyStopping counter: 51 out of 100
Updating learning rate to 3.433247571821579e-21
EarlyStopping counter: 52 out of 100
Updating learning rate to 1.7166237859107893e-21
EarlyStopping counter: 53 out of 100
Updating learning rate to 8.583118929553947e-22
EarlyStopping counter: 54 out of 100
Updating learning rate to 4.291559464776973e-22
EarlyStopping counter: 55 out of 100
Updating learning rate to 2.1457797323884867e-22
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.0728898661942433e-22
EarlyStopping counter: 57 out of 100
Updating learning rate to 5.364449330971217e-23
EarlyStopping counter: 58 out of 100
Updating learning rate to 2.6822246654856083e-23
EarlyStopping counter: 59 out of 100
Updating learning rate to 1.3411123327428042e-23
EarlyStopping counter: 60 out of 100
Updating learning rate to 6.705561663714021e-24
EarlyStopping counter: 61 out of 100
Updating learning rate to 3.3527808318570104e-24
EarlyStopping counter: 62 out of 100
Updating learning rate to 1.6763904159285052e-24
EarlyStopping counter: 63 out of 100
Updating learning rate to 8.381952079642526e-25
EarlyStopping counter: 64 out of 100
Updating learning rate to 4.190976039821263e-25
EarlyStopping counter: 65 out of 100
Updating learning rate to 2.0954880199106315e-25
EarlyStopping counter: 66 out of 100
Updating learning rate to 1.0477440099553157e-25
EarlyStopping counter: 67 out of 100
Updating learning rate to 5.238720049776579e-26
EarlyStopping counter: 68 out of 100
Updating learning rate to 2.6193600248882894e-26
EarlyStopping counter: 69 out of 100
Updating learning rate to 1.3096800124441447e-26
EarlyStopping counter: 70 out of 100
Updating learning rate to 6.548400062220723e-27
EarlyStopping counter: 71 out of 100
Updating learning rate to 3.274200031110362e-27
EarlyStopping counter: 72 out of 100
Updating learning rate to 1.637100015555181e-27
EarlyStopping counter: 73 out of 100
Updating learning rate to 8.185500077775904e-28
EarlyStopping counter: 74 out of 100
Updating learning rate to 4.092750038887952e-28
EarlyStopping counter: 75 out of 100
Updating learning rate to 2.046375019443976e-28
EarlyStopping counter: 76 out of 100
Updating learning rate to 1.023187509721988e-28
EarlyStopping counter: 77 out of 100
Updating learning rate to 5.11593754860994e-29
EarlyStopping counter: 78 out of 100
Updating learning rate to 2.55796877430497e-29
EarlyStopping counter: 79 out of 100
Updating learning rate to 1.278984387152485e-29
EarlyStopping counter: 80 out of 100
Updating learning rate to 6.394921935762425e-30
EarlyStopping counter: 81 out of 100
Updating learning rate to 3.1974609678812126e-30
EarlyStopping counter: 82 out of 100
Updating learning rate to 1.5987304839406063e-30
EarlyStopping counter: 83 out of 100
Updating learning rate to 7.993652419703032e-31
EarlyStopping counter: 84 out of 100
Updating learning rate to 3.996826209851516e-31
EarlyStopping counter: 85 out of 100
Updating learning rate to 1.998413104925758e-31
EarlyStopping counter: 86 out of 100
Updating learning rate to 9.99206552462879e-32
EarlyStopping counter: 87 out of 100
Updating learning rate to 4.996032762314395e-32
EarlyStopping counter: 88 out of 100
Updating learning rate to 2.4980163811571974e-32
EarlyStopping counter: 89 out of 100
Updating learning rate to 1.2490081905785987e-32
EarlyStopping counter: 90 out of 100
Updating learning rate to 6.245040952892993e-33
EarlyStopping counter: 91 out of 100
Updating learning rate to 3.122520476446497e-33
EarlyStopping counter: 92 out of 100
Updating learning rate to 1.5612602382232483e-33
EarlyStopping counter: 93 out of 100
Updating learning rate to 7.806301191116242e-34
EarlyStopping counter: 94 out of 100
Updating learning rate to 3.903150595558121e-34
EarlyStopping counter: 95 out of 100
Updating learning rate to 1.9515752977790604e-34
>>>>>> Testing on validation set: trial_7 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.06022464483976364, mae:0.10583800077438354, dtw:Not calculated


                                                                                       [I 2025-10-17 02:12:41,505] Trial 7 finished with value: 0.10583800077438354 and parameters: {'seq_len': 96, 'pred_len': 1, 'expand': 1, 'd_model': 32, 'n_heads': 8, 'e_layers': 2, 'd_layers': 2, 'batch_size': 64, 'learning_rate': 0.00012369577988101057, 'dropout': 0.03241752618857658}. Best is trial 2 with value: 0.07378587871789932.
Best trial: 2. Best value: 0.0737859:  14%|█▍        | 7/50 [15:32<1:33:55, 131.05s/it]Best trial: 2. Best value: 0.0737859:  14%|█▍        | 7/50 [15:32<1:33:55, 131.05s/it]Best trial: 2. Best value: 0.0737859:  16%|█▌        | 8/50 [15:32<1:17:30, 110.73s/it]
============================================================
Trial 8
============================================================
seq_len: 48, pred_len: 7
d_model: 32, n_heads: 4
e_layers: 2, d_layers: 2
batch_size: 16, lr: 0.000027
dropout: 0.13791249498313826
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 32, expand: 1
>>>>>> Start training: trial_8 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 7
============================================================
train 4619
val 253
test 255
Validation loss decreased (inf --> 0.037107).  Saving model ...
Updating learning rate to 2.7017680962350868e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508840481175434e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.754420240587717e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.3772101202938585e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6886050601469293e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.443025300734646e-07
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.221512650367323e-07
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.1107563251836616e-07
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.0553781625918308e-07
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.276890812959154e-08
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.638445406479577e-08
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.3192227032397885e-08
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.596113516198942e-09
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.298056758099471e-09
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.6490283790497356e-09
EarlyStopping counter: 15 out of 100
Updating learning rate to 8.245141895248678e-10
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.122570947624339e-10
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.0612854738121695e-10
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.0306427369060847e-10
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.153213684530424e-11
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.576606842265212e-11
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.288303421132606e-11
EarlyStopping counter: 22 out of 100
Updating learning rate to 6.44151710566303e-12
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.220758552831515e-12
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.6103792764157574e-12
EarlyStopping counter: 25 out of 100
Updating learning rate to 8.051896382078787e-13
EarlyStopping counter: 26 out of 100
Updating learning rate to 4.0259481910393935e-13
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.0129740955196968e-13
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.0064870477598484e-13
EarlyStopping counter: 29 out of 100
Updating learning rate to 5.032435238799242e-14
EarlyStopping counter: 30 out of 100
Updating learning rate to 2.516217619399621e-14
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.2581088096998105e-14
EarlyStopping counter: 32 out of 100
Updating learning rate to 6.2905440484990524e-15
EarlyStopping counter: 33 out of 100
Updating learning rate to 3.1452720242495262e-15
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.5726360121247631e-15
EarlyStopping counter: 35 out of 100
Updating learning rate to 7.863180060623816e-16
EarlyStopping counter: 36 out of 100
Updating learning rate to 3.931590030311908e-16
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.965795015155954e-16
EarlyStopping counter: 38 out of 100
Updating learning rate to 9.82897507577977e-17
EarlyStopping counter: 39 out of 100
Updating learning rate to 4.914487537889885e-17
EarlyStopping counter: 40 out of 100
Updating learning rate to 2.4572437689449424e-17
EarlyStopping counter: 41 out of 100
Updating learning rate to 1.2286218844724712e-17
EarlyStopping counter: 42 out of 100
Updating learning rate to 6.143109422362356e-18
EarlyStopping counter: 43 out of 100
Updating learning rate to 3.071554711181178e-18
EarlyStopping counter: 44 out of 100
Updating learning rate to 1.535777355590589e-18
EarlyStopping counter: 45 out of 100
Updating learning rate to 7.678886777952945e-19
EarlyStopping counter: 46 out of 100
Updating learning rate to 3.8394433889764724e-19
EarlyStopping counter: 47 out of 100
Updating learning rate to 1.9197216944882362e-19
EarlyStopping counter: 48 out of 100
Updating learning rate to 9.598608472441181e-20
EarlyStopping counter: 49 out of 100
Updating learning rate to 4.7993042362205905e-20
EarlyStopping counter: 50 out of 100
Updating learning rate to 2.3996521181102953e-20
EarlyStopping counter: 51 out of 100
Updating learning rate to 1.1998260590551476e-20
EarlyStopping counter: 52 out of 100
Updating learning rate to 5.999130295275738e-21
EarlyStopping counter: 53 out of 100
Updating learning rate to 2.999565147637869e-21
EarlyStopping counter: 54 out of 100
Updating learning rate to 1.4997825738189345e-21
EarlyStopping counter: 55 out of 100
Updating learning rate to 7.498912869094673e-22
EarlyStopping counter: 56 out of 100
Updating learning rate to 3.7494564345473364e-22
EarlyStopping counter: 57 out of 100
Updating learning rate to 1.8747282172736682e-22
EarlyStopping counter: 58 out of 100
Updating learning rate to 9.373641086368341e-23
EarlyStopping counter: 59 out of 100
Updating learning rate to 4.6868205431841704e-23
EarlyStopping counter: 60 out of 100
Updating learning rate to 2.3434102715920852e-23
EarlyStopping counter: 61 out of 100
Updating learning rate to 1.1717051357960426e-23
EarlyStopping counter: 62 out of 100
Updating learning rate to 5.858525678980213e-24
EarlyStopping counter: 63 out of 100
Updating learning rate to 2.9292628394901065e-24
EarlyStopping counter: 64 out of 100
Updating learning rate to 1.4646314197450533e-24
EarlyStopping counter: 65 out of 100
Updating learning rate to 7.323157098725266e-25
EarlyStopping counter: 66 out of 100
Updating learning rate to 3.661578549362633e-25
EarlyStopping counter: 67 out of 100
Updating learning rate to 1.8307892746813166e-25
EarlyStopping counter: 68 out of 100
Updating learning rate to 9.153946373406583e-26
EarlyStopping counter: 69 out of 100
Updating learning rate to 4.5769731867032914e-26
EarlyStopping counter: 70 out of 100
Updating learning rate to 2.2884865933516457e-26
EarlyStopping counter: 71 out of 100
Updating learning rate to 1.1442432966758229e-26
EarlyStopping counter: 72 out of 100
Updating learning rate to 5.721216483379114e-27
EarlyStopping counter: 73 out of 100
Updating learning rate to 2.860608241689557e-27
EarlyStopping counter: 74 out of 100
Updating learning rate to 1.4303041208447786e-27
EarlyStopping counter: 75 out of 100
Updating learning rate to 7.151520604223893e-28
EarlyStopping counter: 76 out of 100
Updating learning rate to 3.5757603021119464e-28
EarlyStopping counter: 77 out of 100
Updating learning rate to 1.7878801510559732e-28
EarlyStopping counter: 78 out of 100
Updating learning rate to 8.939400755279866e-29
EarlyStopping counter: 79 out of 100
Updating learning rate to 4.469700377639933e-29
EarlyStopping counter: 80 out of 100
Updating learning rate to 2.2348501888199665e-29
EarlyStopping counter: 81 out of 100
Updating learning rate to 1.1174250944099833e-29
EarlyStopping counter: 82 out of 100
Updating learning rate to 5.587125472049916e-30
EarlyStopping counter: 83 out of 100
Updating learning rate to 2.793562736024958e-30
EarlyStopping counter: 84 out of 100
Updating learning rate to 1.396781368012479e-30
EarlyStopping counter: 85 out of 100
Updating learning rate to 6.983906840062395e-31
EarlyStopping counter: 86 out of 100
Updating learning rate to 3.4919534200311977e-31
EarlyStopping counter: 87 out of 100
Updating learning rate to 1.7459767100155988e-31
EarlyStopping counter: 88 out of 100
Updating learning rate to 8.729883550077994e-32
EarlyStopping counter: 89 out of 100
Updating learning rate to 4.364941775038997e-32
EarlyStopping counter: 90 out of 100
Updating learning rate to 2.1824708875194986e-32
EarlyStopping counter: 91 out of 100
Updating learning rate to 1.0912354437597493e-32
EarlyStopping counter: 92 out of 100
Updating learning rate to 5.4561772187987464e-33
EarlyStopping counter: 93 out of 100
Updating learning rate to 2.7280886093993732e-33
EarlyStopping counter: 94 out of 100
Updating learning rate to 1.3640443046996866e-33
EarlyStopping counter: 95 out of 100
Updating learning rate to 6.820221523498433e-34
EarlyStopping counter: 96 out of 100
Updating learning rate to 3.4101107617492165e-34
EarlyStopping counter: 97 out of 100
Updating learning rate to 1.7050553808746082e-34
EarlyStopping counter: 98 out of 100
Updating learning rate to 8.525276904373041e-35
EarlyStopping counter: 99 out of 100
Updating learning rate to 4.2626384521865206e-35
>>>>>> Testing on validation set: trial_8 >>>>>>
test 255
test shape: (255, 7, 5) (255, 7, 5)
test shape: (255, 7, 5) (255, 7, 5)


	mse:0.06371024996042252, mae:0.09755502641201019, dtw:Not calculated


                                                                                       [I 2025-10-17 02:17:01,853] Trial 8 finished with value: 0.09755502641201019 and parameters: {'seq_len': 48, 'pred_len': 7, 'expand': 1, 'd_model': 32, 'n_heads': 4, 'e_layers': 2, 'd_layers': 2, 'batch_size': 16, 'learning_rate': 2.7017680962350868e-05, 'dropout': 0.13791249498313826}. Best is trial 2 with value: 0.07378587871789932.
Best trial: 2. Best value: 0.0737859:  16%|█▌        | 8/50 [19:52<1:17:30, 110.73s/it]Best trial: 2. Best value: 0.0737859:  16%|█▌        | 8/50 [19:52<1:17:30, 110.73s/it]Best trial: 2. Best value: 0.0737859:  18%|█▊        | 9/50 [19:52<1:47:37, 157.50s/it]
============================================================
Trial 9
============================================================
seq_len: 48, pred_len: 1
d_model: 32, n_heads: 4
e_layers: 2, d_layers: 2
batch_size: 64, lr: 0.000352
dropout: 0.07577764649966706
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 64, expand: 2
>>>>>> Start training: trial_9 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.032944).  Saving model ...
Updating learning rate to 0.0003522868513118683
Validation loss decreased (0.032944 --> 0.028194).  Saving model ...
Updating learning rate to 0.00017614342565593416
Validation loss decreased (0.028194 --> 0.024160).  Saving model ...
Updating learning rate to 8.807171282796708e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.403585641398354e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.201792820699177e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1008964103495885e-05
Validation loss decreased (0.024160 --> 0.023944).  Saving model ...
Updating learning rate to 5.5044820517479426e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7522410258739713e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3761205129369856e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.880602564684928e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.440301282342464e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.720150641171232e-07
Validation loss decreased (0.023944 --> 0.023125).  Saving model ...
Updating learning rate to 8.60075320585616e-08
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.30037660292808e-08
Validation loss decreased (0.023125 --> 0.023113).  Saving model ...
Updating learning rate to 2.15018830146404e-08
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.07509415073202e-08
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.3754707536601e-09
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.68773537683005e-09
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.343867688415025e-09
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.719338442075125e-10
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.3596692210375626e-10
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.6798346105187813e-10
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.399173052593907e-11
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.199586526296953e-11
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.0997932631484766e-11
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.0498966315742383e-11
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.2494831578711916e-12
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.6247415789355958e-12
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.3123707894677979e-12
EarlyStopping counter: 15 out of 100
Updating learning rate to 6.561853947338989e-13
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.2809269736694947e-13
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.6404634868347474e-13
EarlyStopping counter: 18 out of 100
Updating learning rate to 8.202317434173737e-14
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.1011587170868684e-14
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.0505793585434342e-14
Validation loss decreased (0.023113 --> 0.022894).  Saving model ...
Updating learning rate to 1.0252896792717171e-14
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.1264483963585855e-15
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.5632241981792928e-15
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2816120990896464e-15
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.408060495448232e-16
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.204030247724116e-16
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.602015123862058e-16
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.01007561931029e-17
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.005037809655145e-17
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.0025189048275725e-17
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.0012594524137862e-17
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.006297262068931e-18
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.5031486310344656e-18
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.2515743155172328e-18
EarlyStopping counter: 14 out of 100
Updating learning rate to 6.257871577586164e-19
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.128935788793082e-19
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.564467894396541e-19
EarlyStopping counter: 17 out of 100
Updating learning rate to 7.822339471982705e-20
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.9111697359913525e-20
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.9555848679956762e-20
EarlyStopping counter: 20 out of 100
Updating learning rate to 9.777924339978381e-21
EarlyStopping counter: 21 out of 100
Updating learning rate to 4.8889621699891906e-21
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.4444810849945953e-21
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.2222405424972976e-21
EarlyStopping counter: 24 out of 100
Updating learning rate to 6.111202712486488e-22
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.055601356243244e-22
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.527800678121622e-22
EarlyStopping counter: 27 out of 100
Updating learning rate to 7.63900339060811e-23
EarlyStopping counter: 28 out of 100
Updating learning rate to 3.819501695304055e-23
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.9097508476520276e-23
EarlyStopping counter: 30 out of 100
Updating learning rate to 9.548754238260138e-24
EarlyStopping counter: 31 out of 100
Updating learning rate to 4.774377119130069e-24
EarlyStopping counter: 32 out of 100
Updating learning rate to 2.3871885595650345e-24
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.1935942797825172e-24
EarlyStopping counter: 34 out of 100
Updating learning rate to 5.967971398912586e-25
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.983985699456293e-25
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.4919928497281465e-25
EarlyStopping counter: 37 out of 100
Updating learning rate to 7.459964248640733e-26
EarlyStopping counter: 38 out of 100
Updating learning rate to 3.7299821243203664e-26
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.8649910621601832e-26
EarlyStopping counter: 40 out of 100
Updating learning rate to 9.324955310800916e-27
EarlyStopping counter: 41 out of 100
Updating learning rate to 4.662477655400458e-27
EarlyStopping counter: 42 out of 100
Updating learning rate to 2.331238827700229e-27
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.1656194138501145e-27
EarlyStopping counter: 44 out of 100
Updating learning rate to 5.828097069250572e-28
EarlyStopping counter: 45 out of 100
Updating learning rate to 2.914048534625286e-28
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.457024267312643e-28
EarlyStopping counter: 47 out of 100
Updating learning rate to 7.285121336563216e-29
EarlyStopping counter: 48 out of 100
Updating learning rate to 3.642560668281608e-29
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.821280334140804e-29
EarlyStopping counter: 50 out of 100
Updating learning rate to 9.10640167070402e-30
EarlyStopping counter: 51 out of 100
Updating learning rate to 4.55320083535201e-30
EarlyStopping counter: 52 out of 100
Updating learning rate to 2.276600417676005e-30
EarlyStopping counter: 53 out of 100
Updating learning rate to 1.1383002088380024e-30
EarlyStopping counter: 54 out of 100
Updating learning rate to 5.691501044190012e-31
EarlyStopping counter: 55 out of 100
Updating learning rate to 2.845750522095006e-31
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.422875261047503e-31
EarlyStopping counter: 57 out of 100
Updating learning rate to 7.114376305237515e-32
EarlyStopping counter: 58 out of 100
Updating learning rate to 3.5571881526187576e-32
EarlyStopping counter: 59 out of 100
Updating learning rate to 1.7785940763093788e-32
EarlyStopping counter: 60 out of 100
Updating learning rate to 8.892970381546894e-33
EarlyStopping counter: 61 out of 100
Updating learning rate to 4.446485190773447e-33
EarlyStopping counter: 62 out of 100
Updating learning rate to 2.2232425953867235e-33
EarlyStopping counter: 63 out of 100
Updating learning rate to 1.1116212976933617e-33
EarlyStopping counter: 64 out of 100
Updating learning rate to 5.558106488466809e-34
>>>>>> Testing on validation set: trial_9 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.05181080475449562, mae:0.08047527819871902, dtw:Not calculated


                                                                                       [I 2025-10-17 02:18:10,340] Trial 9 finished with value: 0.08047527819871902 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 2, 'd_model': 32, 'n_heads': 4, 'e_layers': 2, 'd_layers': 2, 'batch_size': 64, 'learning_rate': 0.0003522868513118683, 'dropout': 0.07577764649966706}. Best is trial 2 with value: 0.07378587871789932.
Best trial: 2. Best value: 0.0737859:  18%|█▊        | 9/50 [21:01<1:47:37, 157.50s/it]Best trial: 2. Best value: 0.0737859:  18%|█▊        | 9/50 [21:01<1:47:37, 157.50s/it]Best trial: 2. Best value: 0.0737859:  20%|██        | 10/50 [21:01<1:26:40, 130.02s/it]
============================================================
Trial 10
============================================================
seq_len: 96, pred_len: 30
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 1
batch_size: 32, lr: 0.000977
dropout: 0.20545601623108925
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_10 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 30
============================================================
train 4548
val 230
test 232
Validation loss decreased (inf --> 0.035936).  Saving model ...
Updating learning rate to 0.0009767509329864418
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0004883754664932209
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.00024418773324661044
EarlyStopping counter: 3 out of 100
Updating learning rate to 0.00012209386662330522
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.104693331165261e-05
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.0523466655826305e-05
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.5261733327913153e-05
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.630866663956576e-06
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.815433331978288e-06
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.907716665989144e-06
EarlyStopping counter: 10 out of 100
Updating learning rate to 9.53858332994572e-07
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.76929166497286e-07
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.38464583248643e-07
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.192322916243215e-07
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.961614581216075e-08
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.9808072906080376e-08
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.4904036453040188e-08
Validation loss decreased (0.035936 --> 0.035640).  Saving model ...
Updating learning rate to 7.452018226520094e-09
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.726009113260047e-09
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8630045566300235e-09
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.315022783150118e-10
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.657511391575059e-10
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.3287556957875294e-10
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1643778478937647e-10
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.821889239468823e-11
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.910944619734412e-11
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.455472309867206e-11
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.27736154933603e-12
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.638680774668015e-12
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.8193403873340073e-12
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.096701936670037e-13
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.548350968335018e-13
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.274175484167509e-13
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.1370877420837546e-13
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.685438710418773e-14
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.8427193552093865e-14
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.4213596776046932e-14
EarlyStopping counter: 20 out of 100
Updating learning rate to 7.106798388023466e-15
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.553399194011733e-15
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.7766995970058665e-15
EarlyStopping counter: 23 out of 100
Updating learning rate to 8.883497985029333e-16
EarlyStopping counter: 24 out of 100
Updating learning rate to 4.441748992514666e-16
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.220874496257333e-16
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.1104372481286666e-16
EarlyStopping counter: 27 out of 100
Updating learning rate to 5.552186240643333e-17
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.7760931203216665e-17
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.3880465601608332e-17
EarlyStopping counter: 30 out of 100
Updating learning rate to 6.940232800804166e-18
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.470116400402083e-18
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.7350582002010415e-18
EarlyStopping counter: 33 out of 100
Updating learning rate to 8.675291001005208e-19
EarlyStopping counter: 34 out of 100
Updating learning rate to 4.337645500502604e-19
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.168822750251302e-19
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.084411375125651e-19
EarlyStopping counter: 37 out of 100
Updating learning rate to 5.422056875628255e-20
EarlyStopping counter: 38 out of 100
Updating learning rate to 2.7110284378141274e-20
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.3555142189070637e-20
EarlyStopping counter: 40 out of 100
Updating learning rate to 6.777571094535319e-21
EarlyStopping counter: 41 out of 100
Updating learning rate to 3.388785547267659e-21
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.6943927736338296e-21
EarlyStopping counter: 43 out of 100
Updating learning rate to 8.471963868169148e-22
EarlyStopping counter: 44 out of 100
Updating learning rate to 4.235981934084574e-22
EarlyStopping counter: 45 out of 100
Updating learning rate to 2.117990967042287e-22
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.0589954835211435e-22
EarlyStopping counter: 47 out of 100
Updating learning rate to 5.294977417605718e-23
EarlyStopping counter: 48 out of 100
Updating learning rate to 2.647488708802859e-23
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.3237443544014294e-23
EarlyStopping counter: 50 out of 100
Updating learning rate to 6.618721772007147e-24
EarlyStopping counter: 51 out of 100
Updating learning rate to 3.3093608860035735e-24
EarlyStopping counter: 52 out of 100
Updating learning rate to 1.6546804430017867e-24
EarlyStopping counter: 53 out of 100
Updating learning rate to 8.273402215008934e-25
EarlyStopping counter: 54 out of 100
Updating learning rate to 4.136701107504467e-25
EarlyStopping counter: 55 out of 100
Updating learning rate to 2.0683505537522334e-25
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.0341752768761167e-25
EarlyStopping counter: 57 out of 100
Updating learning rate to 5.170876384380584e-26
EarlyStopping counter: 58 out of 100
Updating learning rate to 2.585438192190292e-26
EarlyStopping counter: 59 out of 100
Updating learning rate to 1.292719096095146e-26
EarlyStopping counter: 60 out of 100
Updating learning rate to 6.46359548047573e-27
EarlyStopping counter: 61 out of 100
Updating learning rate to 3.231797740237865e-27
EarlyStopping counter: 62 out of 100
Updating learning rate to 1.6158988701189324e-27
EarlyStopping counter: 63 out of 100
Updating learning rate to 8.079494350594662e-28
EarlyStopping counter: 64 out of 100
Updating learning rate to 4.039747175297331e-28
EarlyStopping counter: 65 out of 100
Updating learning rate to 2.0198735876486655e-28
EarlyStopping counter: 66 out of 100
Updating learning rate to 1.0099367938243327e-28
EarlyStopping counter: 67 out of 100
Updating learning rate to 5.049683969121664e-29
EarlyStopping counter: 68 out of 100
Updating learning rate to 2.524841984560832e-29
EarlyStopping counter: 69 out of 100
Updating learning rate to 1.262420992280416e-29
EarlyStopping counter: 70 out of 100
Updating learning rate to 6.31210496140208e-30
EarlyStopping counter: 71 out of 100
Updating learning rate to 3.15605248070104e-30
EarlyStopping counter: 72 out of 100
Updating learning rate to 1.57802624035052e-30
EarlyStopping counter: 73 out of 100
Updating learning rate to 7.8901312017526e-31
EarlyStopping counter: 74 out of 100
Updating learning rate to 3.9450656008763e-31
EarlyStopping counter: 75 out of 100
Updating learning rate to 1.97253280043815e-31
EarlyStopping counter: 76 out of 100
Updating learning rate to 9.86266400219075e-32
EarlyStopping counter: 77 out of 100
Updating learning rate to 4.931332001095375e-32
EarlyStopping counter: 78 out of 100
Updating learning rate to 2.4656660005476873e-32
EarlyStopping counter: 79 out of 100
Updating learning rate to 1.2328330002738437e-32
EarlyStopping counter: 80 out of 100
Updating learning rate to 6.164165001369218e-33
EarlyStopping counter: 81 out of 100
Updating learning rate to 3.082082500684609e-33
EarlyStopping counter: 82 out of 100
Updating learning rate to 1.5410412503423046e-33
>>>>>> Testing on validation set: trial_10 >>>>>>
test 232
test shape: (232, 30, 5) (232, 30, 5)
test shape: (232, 30, 5) (232, 30, 5)


	mse:0.07559221982955933, mae:0.11687327176332474, dtw:Not calculated


                                                                                        [I 2025-10-17 02:20:22,627] Trial 10 finished with value: 0.11687327176332474 and parameters: {'seq_len': 96, 'pred_len': 30, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 1, 'batch_size': 32, 'learning_rate': 0.0009767509329864418, 'dropout': 0.20545601623108925}. Best is trial 2 with value: 0.07378587871789932.
Best trial: 2. Best value: 0.0737859:  20%|██        | 10/50 [23:13<1:26:40, 130.02s/it]Best trial: 2. Best value: 0.0737859:  20%|██        | 10/50 [23:13<1:26:40, 130.02s/it]Best trial: 2. Best value: 0.0737859:  22%|██▏       | 11/50 [23:13<1:24:57, 130.72s/it]
============================================================
Trial 11
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000993
dropout: 0.09093978756196072
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_11 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.025057).  Saving model ...
Updating learning rate to 0.0009932903524180804
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0004966451762090402
Validation loss decreased (0.025057 --> 0.023748).  Saving model ...
Updating learning rate to 0.0002483225881045201
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00012416129405226005
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.208064702613002e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.104032351306501e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5520161756532506e-05
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.760080878266253e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.8800404391331264e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.9400202195665632e-06
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.700101097832816e-07
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.850050548916408e-07
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.425025274458204e-07
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.212512637229102e-07
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.06256318614551e-08
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.031281593072755e-08
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.5156407965363775e-08
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.578203982681888e-09
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.789101991340944e-09
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.894550995670472e-09
EarlyStopping counter: 18 out of 100
Updating learning rate to 9.47275497835236e-10
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.73637748917618e-10
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.36818874458809e-10
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.184094372294045e-10
EarlyStopping counter: 22 out of 100
Updating learning rate to 5.920471861470225e-11
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.9602359307351123e-11
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.4801179653675562e-11
EarlyStopping counter: 25 out of 100
Updating learning rate to 7.400589826837781e-12
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.7002949134188904e-12
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.8501474567094452e-12
EarlyStopping counter: 28 out of 100
Updating learning rate to 9.250737283547226e-13
EarlyStopping counter: 29 out of 100
Updating learning rate to 4.625368641773613e-13
EarlyStopping counter: 30 out of 100
Updating learning rate to 2.3126843208868065e-13
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.1563421604434033e-13
EarlyStopping counter: 32 out of 100
Updating learning rate to 5.781710802217016e-14
EarlyStopping counter: 33 out of 100
Updating learning rate to 2.890855401108508e-14
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.445427700554254e-14
EarlyStopping counter: 35 out of 100
Updating learning rate to 7.22713850277127e-15
EarlyStopping counter: 36 out of 100
Updating learning rate to 3.613569251385635e-15
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.8067846256928176e-15
EarlyStopping counter: 38 out of 100
Updating learning rate to 9.033923128464088e-16
EarlyStopping counter: 39 out of 100
Updating learning rate to 4.516961564232044e-16
EarlyStopping counter: 40 out of 100
Updating learning rate to 2.258480782116022e-16
EarlyStopping counter: 41 out of 100
Updating learning rate to 1.129240391058011e-16
EarlyStopping counter: 42 out of 100
Updating learning rate to 5.646201955290055e-17
EarlyStopping counter: 43 out of 100
Updating learning rate to 2.8231009776450275e-17
EarlyStopping counter: 44 out of 100
Updating learning rate to 1.4115504888225137e-17
EarlyStopping counter: 45 out of 100
Updating learning rate to 7.057752444112569e-18
EarlyStopping counter: 46 out of 100
Updating learning rate to 3.528876222056284e-18
EarlyStopping counter: 47 out of 100
Updating learning rate to 1.764438111028142e-18
EarlyStopping counter: 48 out of 100
Updating learning rate to 8.82219055514071e-19
EarlyStopping counter: 49 out of 100
Updating learning rate to 4.411095277570355e-19
EarlyStopping counter: 50 out of 100
Updating learning rate to 2.2055476387851777e-19
EarlyStopping counter: 51 out of 100
Updating learning rate to 1.1027738193925889e-19
EarlyStopping counter: 52 out of 100
Updating learning rate to 5.513869096962944e-20
Validation loss decreased (0.023748 --> 0.023670).  Saving model ...
Updating learning rate to 2.756934548481472e-20
Validation loss decreased (0.023670 --> 0.023620).  Saving model ...
Updating learning rate to 1.378467274240736e-20
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.89233637120368e-21
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.44616818560184e-21
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.72308409280092e-21
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.6154204640046e-22
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.3077102320023e-22
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.15385511600115e-22
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.076927558000575e-22
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.384637790002875e-23
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.6923188950014376e-23
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.3461594475007188e-23
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.730797237503594e-24
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.365398618751797e-24
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.6826993093758985e-24
EarlyStopping counter: 14 out of 100
Updating learning rate to 8.413496546879493e-25
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.206748273439746e-25
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.103374136719873e-25
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.0516870683599366e-25
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.258435341799683e-26
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.6292176708998414e-26
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.3146088354499207e-26
EarlyStopping counter: 21 out of 100
Updating learning rate to 6.573044177249604e-27
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.286522088624802e-27
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.643261044312401e-27
EarlyStopping counter: 24 out of 100
Updating learning rate to 8.216305221562005e-28
EarlyStopping counter: 25 out of 100
Updating learning rate to 4.108152610781002e-28
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.054076305390501e-28
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.0270381526952506e-28
EarlyStopping counter: 28 out of 100
Updating learning rate to 5.135190763476253e-29
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.5675953817381264e-29
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.2837976908690632e-29
EarlyStopping counter: 31 out of 100
Updating learning rate to 6.418988454345316e-30
EarlyStopping counter: 32 out of 100
Updating learning rate to 3.209494227172658e-30
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.604747113586329e-30
EarlyStopping counter: 34 out of 100
Updating learning rate to 8.023735567931645e-31
EarlyStopping counter: 35 out of 100
Updating learning rate to 4.0118677839658225e-31
EarlyStopping counter: 36 out of 100
Updating learning rate to 2.0059338919829113e-31
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.0029669459914556e-31
EarlyStopping counter: 38 out of 100
Updating learning rate to 5.014834729957278e-32
EarlyStopping counter: 39 out of 100
Updating learning rate to 2.507417364978639e-32
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.2537086824893195e-32
EarlyStopping counter: 41 out of 100
Updating learning rate to 6.268543412446598e-33
EarlyStopping counter: 42 out of 100
Updating learning rate to 3.134271706223299e-33
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.5671358531116494e-33
>>>>>> Testing on validation set: trial_11 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.050308164209127426, mae:0.07131914794445038, dtw:Not calculated


                                                                                        [I 2025-10-17 02:22:36,991] Trial 11 finished with value: 0.07131914794445038 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 2, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0009932903524180804, 'dropout': 0.09093978756196072}. Best is trial 11 with value: 0.07131914794445038.
Best trial: 2. Best value: 0.0737859:  22%|██▏       | 11/50 [25:27<1:24:57, 130.72s/it]Best trial: 11. Best value: 0.0713191:  22%|██▏       | 11/50 [25:27<1:24:57, 130.72s/it]Best trial: 11. Best value: 0.0713191:  24%|██▍       | 12/50 [25:27<1:23:29, 131.83s/it]
============================================================
Trial 12
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000940
dropout: 0.2962676020620817
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_12 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.030841).  Saving model ...
Updating learning rate to 0.0009398537537854831
Validation loss decreased (0.030841 --> 0.026901).  Saving model ...
Updating learning rate to 0.00046992687689274154
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00023496343844637077
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.00011748171922318538
Validation loss decreased (0.026901 --> 0.024985).  Saving model ...
Updating learning rate to 5.874085961159269e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.9370429805796346e-05
Validation loss decreased (0.024985 --> 0.024888).  Saving model ...
Updating learning rate to 1.4685214902898173e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.3426074514490865e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.6713037257245433e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8356518628622716e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.178259314311358e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.589129657155679e-07
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.2945648285778395e-07
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1472824142889198e-07
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.736412071444599e-08
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.8682060357222994e-08
Validation loss decreased (0.024888 --> 0.024805).  Saving model ...
Updating learning rate to 1.4341030178611497e-08
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.1705150893057486e-09
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.5852575446528743e-09
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.7926287723264371e-09
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.963143861632186e-10
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.481571930816093e-10
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.2407859654080464e-10
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1203929827040232e-10
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.601964913520116e-11
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.800982456760058e-11
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.400491228380029e-11
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.002456141900145e-12
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.5012280709500725e-12
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.7506140354750363e-12
EarlyStopping counter: 14 out of 100
Updating learning rate to 8.753070177375181e-13
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.3765350886875907e-13
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.1882675443437953e-13
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.0941337721718977e-13
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.4706688608594883e-14
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.7353344304297442e-14
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.3676672152148721e-14
EarlyStopping counter: 21 out of 100
Updating learning rate to 6.8383360760743604e-15
Validation loss decreased (0.024805 --> 0.024665).  Saving model ...
Updating learning rate to 3.4191680380371802e-15
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.7095840190185901e-15
Validation loss decreased (0.024665 --> 0.024522).  Saving model ...
Updating learning rate to 8.547920095092951e-16
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.2739600475464753e-16
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.1369800237732376e-16
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0684900118866188e-16
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.342450059433094e-17
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.671225029716547e-17
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3356125148582735e-17
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.6780625742913676e-18
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.3390312871456838e-18
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.6695156435728419e-18
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.3475782178642095e-19
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.1737891089321048e-19
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.0868945544660524e-19
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.0434472772330262e-19
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.217236386165131e-20
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.6086181930825655e-20
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.3043090965412827e-20
EarlyStopping counter: 17 out of 100
Updating learning rate to 6.521545482706414e-21
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.260772741353207e-21
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.6303863706766034e-21
EarlyStopping counter: 20 out of 100
Updating learning rate to 8.151931853383017e-22
EarlyStopping counter: 21 out of 100
Updating learning rate to 4.0759659266915086e-22
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.0379829633457543e-22
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.0189914816728771e-22
EarlyStopping counter: 24 out of 100
Updating learning rate to 5.0949574083643857e-23
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.5474787041821928e-23
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.2737393520910964e-23
EarlyStopping counter: 27 out of 100
Updating learning rate to 6.368696760455482e-24
EarlyStopping counter: 28 out of 100
Updating learning rate to 3.184348380227741e-24
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.5921741901138705e-24
EarlyStopping counter: 30 out of 100
Updating learning rate to 7.960870950569353e-25
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.9804354752846763e-25
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.9902177376423382e-25
EarlyStopping counter: 33 out of 100
Updating learning rate to 9.951088688211691e-26
EarlyStopping counter: 34 out of 100
Updating learning rate to 4.9755443441058454e-26
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.4877721720529227e-26
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.2438860860264614e-26
EarlyStopping counter: 37 out of 100
Updating learning rate to 6.219430430132307e-27
EarlyStopping counter: 38 out of 100
Updating learning rate to 3.1097152150661534e-27
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.5548576075330767e-27
EarlyStopping counter: 40 out of 100
Updating learning rate to 7.774288037665383e-28
EarlyStopping counter: 41 out of 100
Updating learning rate to 3.8871440188326917e-28
Validation loss decreased (0.024522 --> 0.024501).  Saving model ...
Updating learning rate to 1.9435720094163459e-28
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.717860047081729e-29
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.8589300235408646e-29
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.4294650117704323e-29
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2147325058852162e-29
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.073662529426081e-30
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.0368312647130404e-30
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.5184156323565202e-30
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.592078161782601e-31
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.7960390808913005e-31
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.8980195404456503e-31
EarlyStopping counter: 11 out of 100
Updating learning rate to 9.490097702228251e-32
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.7450488511141256e-32
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.3725244255570628e-32
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.1862622127785314e-32
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.931311063892657e-33
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.9656555319463285e-33
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.4828277659731643e-33
>>>>>> Testing on validation set: trial_12 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.05010097101330757, mae:0.07295390963554382, dtw:Not calculated


                                                                                         [I 2025-10-17 02:24:51,697] Trial 12 finished with value: 0.07295390963554382 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 2, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0009398537537854831, 'dropout': 0.2962676020620817}. Best is trial 11 with value: 0.07131914794445038.
Best trial: 11. Best value: 0.0713191:  24%|██▍       | 12/50 [27:42<1:23:29, 131.83s/it]Best trial: 11. Best value: 0.0713191:  24%|██▍       | 12/50 [27:42<1:23:29, 131.83s/it]Best trial: 11. Best value: 0.0713191:  26%|██▌       | 13/50 [27:42<1:21:49, 132.70s/it]
============================================================
Trial 13
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000410
dropout: 0.28531536020792286
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_13 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.027293).  Saving model ...
Updating learning rate to 0.00040990128322052695
Validation loss decreased (0.027293 --> 0.027178).  Saving model ...
Updating learning rate to 0.00020495064161026348
Validation loss decreased (0.027178 --> 0.026806).  Saving model ...
Updating learning rate to 0.00010247532080513174
Validation loss decreased (0.026806 --> 0.025461).  Saving model ...
Updating learning rate to 5.123766040256587e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.5618830201282934e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2809415100641467e-05
Validation loss decreased (0.025461 --> 0.025338).  Saving model ...
Updating learning rate to 6.404707550320734e-06
Validation loss decreased (0.025338 --> 0.024636).  Saving model ...
Updating learning rate to 3.202353775160367e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6011768875801834e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.005884437900917e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.0029422189504585e-07
Validation loss decreased (0.024636 --> 0.024466).  Saving model ...
Updating learning rate to 2.0014711094752293e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0007355547376146e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.003677773688073e-08
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.5018388868440366e-08
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2509194434220183e-08
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.254597217110091e-09
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.1272986085550457e-09
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.5636493042775229e-09
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.818246521387614e-10
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.909123260693807e-10
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.9545616303469036e-10
EarlyStopping counter: 11 out of 100
Updating learning rate to 9.772808151734518e-11
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.886404075867259e-11
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.4432020379336295e-11
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.2216010189668147e-11
EarlyStopping counter: 15 out of 100
Updating learning rate to 6.108005094834074e-12
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.054002547417037e-12
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.5270012737085184e-12
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.635006368542592e-13
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.817503184271296e-13
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.908751592135648e-13
EarlyStopping counter: 21 out of 100
Updating learning rate to 9.54375796067824e-14
EarlyStopping counter: 22 out of 100
Updating learning rate to 4.77187898033912e-14
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.38593949016956e-14
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.19296974508478e-14
EarlyStopping counter: 25 out of 100
Updating learning rate to 5.9648487254239e-15
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.98242436271195e-15
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.491212181355975e-15
EarlyStopping counter: 28 out of 100
Updating learning rate to 7.456060906779875e-16
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.7280304533899375e-16
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.8640152266949688e-16
EarlyStopping counter: 31 out of 100
Updating learning rate to 9.320076133474844e-17
EarlyStopping counter: 32 out of 100
Updating learning rate to 4.660038066737422e-17
EarlyStopping counter: 33 out of 100
Updating learning rate to 2.330019033368711e-17
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.1650095166843555e-17
EarlyStopping counter: 35 out of 100
Updating learning rate to 5.8250475834217774e-18
EarlyStopping counter: 36 out of 100
Updating learning rate to 2.9125237917108887e-18
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.4562618958554443e-18
EarlyStopping counter: 38 out of 100
Updating learning rate to 7.281309479277222e-19
EarlyStopping counter: 39 out of 100
Updating learning rate to 3.640654739638611e-19
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.8203273698193054e-19
EarlyStopping counter: 41 out of 100
Updating learning rate to 9.101636849096527e-20
EarlyStopping counter: 42 out of 100
Updating learning rate to 4.5508184245482636e-20
EarlyStopping counter: 43 out of 100
Updating learning rate to 2.2754092122741318e-20
EarlyStopping counter: 44 out of 100
Updating learning rate to 1.1377046061370659e-20
EarlyStopping counter: 45 out of 100
Updating learning rate to 5.6885230306853295e-21
EarlyStopping counter: 46 out of 100
Updating learning rate to 2.8442615153426647e-21
EarlyStopping counter: 47 out of 100
Updating learning rate to 1.4221307576713324e-21
EarlyStopping counter: 48 out of 100
Updating learning rate to 7.110653788356662e-22
EarlyStopping counter: 49 out of 100
Updating learning rate to 3.555326894178331e-22
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.7776634470891655e-22
EarlyStopping counter: 51 out of 100
Updating learning rate to 8.888317235445827e-23
EarlyStopping counter: 52 out of 100
Updating learning rate to 4.4441586177229137e-23
EarlyStopping counter: 53 out of 100
Updating learning rate to 2.2220793088614568e-23
EarlyStopping counter: 54 out of 100
Updating learning rate to 1.1110396544307284e-23
EarlyStopping counter: 55 out of 100
Updating learning rate to 5.555198272153642e-24
EarlyStopping counter: 56 out of 100
Updating learning rate to 2.777599136076821e-24
EarlyStopping counter: 57 out of 100
Updating learning rate to 1.3887995680384105e-24
EarlyStopping counter: 58 out of 100
Updating learning rate to 6.943997840192053e-25
EarlyStopping counter: 59 out of 100
Updating learning rate to 3.4719989200960263e-25
EarlyStopping counter: 60 out of 100
Updating learning rate to 1.7359994600480131e-25
EarlyStopping counter: 61 out of 100
Updating learning rate to 8.679997300240066e-26
EarlyStopping counter: 62 out of 100
Updating learning rate to 4.339998650120033e-26
EarlyStopping counter: 63 out of 100
Updating learning rate to 2.1699993250600164e-26
EarlyStopping counter: 64 out of 100
Updating learning rate to 1.0849996625300082e-26
EarlyStopping counter: 65 out of 100
Updating learning rate to 5.424998312650041e-27
EarlyStopping counter: 66 out of 100
Updating learning rate to 2.7124991563250205e-27
EarlyStopping counter: 67 out of 100
Updating learning rate to 1.3562495781625103e-27
EarlyStopping counter: 68 out of 100
Updating learning rate to 6.781247890812551e-28
EarlyStopping counter: 69 out of 100
Updating learning rate to 3.3906239454062757e-28
EarlyStopping counter: 70 out of 100
Updating learning rate to 1.6953119727031378e-28
EarlyStopping counter: 71 out of 100
Updating learning rate to 8.476559863515689e-29
EarlyStopping counter: 72 out of 100
Updating learning rate to 4.2382799317578446e-29
EarlyStopping counter: 73 out of 100
Updating learning rate to 2.1191399658789223e-29
EarlyStopping counter: 74 out of 100
Updating learning rate to 1.0595699829394611e-29
EarlyStopping counter: 75 out of 100
Updating learning rate to 5.297849914697306e-30
EarlyStopping counter: 76 out of 100
Updating learning rate to 2.648924957348653e-30
EarlyStopping counter: 77 out of 100
Updating learning rate to 1.3244624786743264e-30
EarlyStopping counter: 78 out of 100
Updating learning rate to 6.622312393371632e-31
EarlyStopping counter: 79 out of 100
Updating learning rate to 3.311156196685816e-31
EarlyStopping counter: 80 out of 100
Updating learning rate to 1.655578098342908e-31
EarlyStopping counter: 81 out of 100
Updating learning rate to 8.27789049171454e-32
EarlyStopping counter: 82 out of 100
Updating learning rate to 4.13894524585727e-32
EarlyStopping counter: 83 out of 100
Updating learning rate to 2.069472622928635e-32
EarlyStopping counter: 84 out of 100
Updating learning rate to 1.0347363114643175e-32
EarlyStopping counter: 85 out of 100
Updating learning rate to 5.1736815573215876e-33
EarlyStopping counter: 86 out of 100
Updating learning rate to 2.5868407786607938e-33
EarlyStopping counter: 87 out of 100
Updating learning rate to 1.2934203893303969e-33
EarlyStopping counter: 88 out of 100
Updating learning rate to 6.4671019466519846e-34
>>>>>> Testing on validation set: trial_13 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.05142146348953247, mae:0.07516805082559586, dtw:Not calculated


                                                                                         [I 2025-10-17 02:27:06,325] Trial 13 finished with value: 0.07516805082559586 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 2, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.00040990128322052695, 'dropout': 0.28531536020792286}. Best is trial 11 with value: 0.07131914794445038.
Best trial: 11. Best value: 0.0713191:  26%|██▌       | 13/50 [29:57<1:21:49, 132.70s/it]Best trial: 11. Best value: 0.0713191:  26%|██▌       | 13/50 [29:57<1:21:49, 132.70s/it]Best trial: 11. Best value: 0.0713191:  28%|██▊       | 14/50 [29:57<1:19:59, 133.32s/it]
============================================================
Trial 14
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000601
dropout: 0.08780439444335959
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_14 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.029874).  Saving model ...
Updating learning rate to 0.0006012190734034816
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0003006095367017408
Validation loss decreased (0.029874 --> 0.023555).  Saving model ...
Updating learning rate to 0.0001503047683508704
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.51523841754352e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.75761920877176e-05
Validation loss decreased (0.023555 --> 0.023195).  Saving model ...
Updating learning rate to 1.87880960438588e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.3940480219294e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.6970240109647e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.34851200548235e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.174256002741175e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.871280013705875e-07
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.9356400068529375e-07
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4678200034264687e-07
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.339100017132344e-08
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.669550008566172e-08
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.834775004283086e-08
EarlyStopping counter: 11 out of 100
Updating learning rate to 9.17387502141543e-09
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.586937510707715e-09
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.2934687553538574e-09
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.1467343776769287e-09
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.733671888384643e-10
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.866835944192322e-10
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.433417972096161e-10
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.167089860480804e-11
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.583544930240402e-11
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.791772465120201e-11
EarlyStopping counter: 21 out of 100
Updating learning rate to 8.958862325601005e-12
EarlyStopping counter: 22 out of 100
Updating learning rate to 4.479431162800503e-12
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.2397155814002514e-12
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.1198577907001257e-12
EarlyStopping counter: 25 out of 100
Updating learning rate to 5.599288953500628e-13
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.799644476750314e-13
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.399822238375157e-13
EarlyStopping counter: 28 out of 100
Updating learning rate to 6.999111191875786e-14
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.499555595937893e-14
Validation loss decreased (0.023195 --> 0.023099).  Saving model ...
Updating learning rate to 1.7497777979689464e-14
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.748888989844732e-15
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.374444494922366e-15
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.187222247461183e-15
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0936111237305915e-15
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.468055618652957e-16
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7340278093264787e-16
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3670139046632394e-16
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.835069523316197e-17
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.4175347616580984e-17
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.7087673808290492e-17
EarlyStopping counter: 11 out of 100
Updating learning rate to 8.543836904145246e-18
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.271918452072623e-18
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.1359592260363115e-18
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.0679796130181557e-18
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.339898065090779e-19
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.6699490325453894e-19
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.3349745162726947e-19
EarlyStopping counter: 18 out of 100
Updating learning rate to 6.674872581363473e-20
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.337436290681737e-20
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.6687181453408684e-20
EarlyStopping counter: 21 out of 100
Updating learning rate to 8.343590726704342e-21
EarlyStopping counter: 22 out of 100
Updating learning rate to 4.171795363352171e-21
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.0858976816760854e-21
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.0429488408380427e-21
EarlyStopping counter: 25 out of 100
Updating learning rate to 5.214744204190214e-22
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.607372102095107e-22
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.3036860510475534e-22
EarlyStopping counter: 28 out of 100
Updating learning rate to 6.518430255237767e-23
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.2592151276188835e-23
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.6296075638094418e-23
EarlyStopping counter: 31 out of 100
Updating learning rate to 8.148037819047209e-24
EarlyStopping counter: 32 out of 100
Updating learning rate to 4.0740189095236044e-24
EarlyStopping counter: 33 out of 100
Updating learning rate to 2.0370094547618022e-24
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.0185047273809011e-24
EarlyStopping counter: 35 out of 100
Updating learning rate to 5.0925236369045055e-25
EarlyStopping counter: 36 out of 100
Updating learning rate to 2.5462618184522527e-25
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.2731309092261264e-25
EarlyStopping counter: 38 out of 100
Updating learning rate to 6.365654546130632e-26
EarlyStopping counter: 39 out of 100
Updating learning rate to 3.182827273065316e-26
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.591413636532658e-26
EarlyStopping counter: 41 out of 100
Updating learning rate to 7.95706818266329e-27
EarlyStopping counter: 42 out of 100
Updating learning rate to 3.978534091331645e-27
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.9892670456658225e-27
EarlyStopping counter: 44 out of 100
Updating learning rate to 9.946335228329112e-28
EarlyStopping counter: 45 out of 100
Updating learning rate to 4.973167614164556e-28
EarlyStopping counter: 46 out of 100
Updating learning rate to 2.486583807082278e-28
EarlyStopping counter: 47 out of 100
Updating learning rate to 1.243291903541139e-28
EarlyStopping counter: 48 out of 100
Updating learning rate to 6.216459517705695e-29
EarlyStopping counter: 49 out of 100
Updating learning rate to 3.1082297588528476e-29
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.5541148794264238e-29
EarlyStopping counter: 51 out of 100
Updating learning rate to 7.770574397132119e-30
EarlyStopping counter: 52 out of 100
Updating learning rate to 3.8852871985660595e-30
EarlyStopping counter: 53 out of 100
Updating learning rate to 1.9426435992830297e-30
EarlyStopping counter: 54 out of 100
Updating learning rate to 9.713217996415149e-31
EarlyStopping counter: 55 out of 100
Updating learning rate to 4.856608998207574e-31
EarlyStopping counter: 56 out of 100
Updating learning rate to 2.428304499103787e-31
EarlyStopping counter: 57 out of 100
Updating learning rate to 1.2141522495518936e-31
EarlyStopping counter: 58 out of 100
Updating learning rate to 6.070761247759468e-32
EarlyStopping counter: 59 out of 100
Updating learning rate to 3.035380623879734e-32
EarlyStopping counter: 60 out of 100
Updating learning rate to 1.517690311939867e-32
EarlyStopping counter: 61 out of 100
Updating learning rate to 7.588451559699335e-33
EarlyStopping counter: 62 out of 100
Updating learning rate to 3.7942257798496675e-33
EarlyStopping counter: 63 out of 100
Updating learning rate to 1.8971128899248337e-33
EarlyStopping counter: 64 out of 100
Updating learning rate to 9.485564449624169e-34
>>>>>> Testing on validation set: trial_14 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.04953409358859062, mae:0.07120024412870407, dtw:Not calculated


                                                                                         [I 2025-10-17 02:29:21,371] Trial 14 finished with value: 0.07120024412870407 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 2, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0006012190734034816, 'dropout': 0.08780439444335959}. Best is trial 14 with value: 0.07120024412870407.
Best trial: 11. Best value: 0.0713191:  28%|██▊       | 14/50 [32:12<1:19:59, 133.32s/it]Best trial: 14. Best value: 0.0712002:  28%|██▊       | 14/50 [32:12<1:19:59, 133.32s/it]Best trial: 14. Best value: 0.0712002:  30%|███       | 15/50 [32:12<1:18:03, 133.80s/it]
============================================================
Trial 15
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000226
dropout: 0.09274828169051318
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_15 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.026578).  Saving model ...
Updating learning rate to 0.00022608952024361716
Validation loss decreased (0.026578 --> 0.024554).  Saving model ...
Updating learning rate to 0.00011304476012180858
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.652238006090429e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.8261190030452145e-05
Validation loss decreased (0.024554 --> 0.023417).  Saving model ...
Updating learning rate to 1.4130595015226072e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.065297507613036e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.532648753806518e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.766324376903259e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.831621884516295e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.4158109422581476e-07
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.2079054711290738e-07
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1039527355645369e-07
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.5197636778226845e-08
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7598818389113423e-08
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.3799409194556711e-08
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.899704597278356e-09
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.449852298639178e-09
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.724926149319589e-09
EarlyStopping counter: 14 out of 100
Updating learning rate to 8.624630746597945e-10
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.3123153732989723e-10
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.1561576866494861e-10
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.0780788433247431e-10
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.3903942166237153e-11
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.6951971083118577e-11
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.3475985541559288e-11
EarlyStopping counter: 21 out of 100
Updating learning rate to 6.737992770779644e-12
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.368996385389822e-12
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.684498192694911e-12
EarlyStopping counter: 24 out of 100
Updating learning rate to 8.422490963474555e-13
EarlyStopping counter: 25 out of 100
Updating learning rate to 4.2112454817372776e-13
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.1056227408686388e-13
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.0528113704343194e-13
EarlyStopping counter: 28 out of 100
Updating learning rate to 5.264056852171597e-14
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.6320284260857985e-14
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.3160142130428993e-14
EarlyStopping counter: 31 out of 100
Updating learning rate to 6.580071065214496e-15
EarlyStopping counter: 32 out of 100
Updating learning rate to 3.290035532607248e-15
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.645017766303624e-15
EarlyStopping counter: 34 out of 100
Updating learning rate to 8.22508883151812e-16
EarlyStopping counter: 35 out of 100
Updating learning rate to 4.11254441575906e-16
EarlyStopping counter: 36 out of 100
Updating learning rate to 2.05627220787953e-16
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.028136103939765e-16
EarlyStopping counter: 38 out of 100
Updating learning rate to 5.140680519698825e-17
EarlyStopping counter: 39 out of 100
Updating learning rate to 2.5703402598494126e-17
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.2851701299247063e-17
EarlyStopping counter: 41 out of 100
Updating learning rate to 6.4258506496235315e-18
EarlyStopping counter: 42 out of 100
Updating learning rate to 3.2129253248117658e-18
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.6064626624058829e-18
EarlyStopping counter: 44 out of 100
Updating learning rate to 8.032313312029414e-19
EarlyStopping counter: 45 out of 100
Updating learning rate to 4.016156656014707e-19
EarlyStopping counter: 46 out of 100
Updating learning rate to 2.0080783280073536e-19
EarlyStopping counter: 47 out of 100
Updating learning rate to 1.0040391640036768e-19
EarlyStopping counter: 48 out of 100
Updating learning rate to 5.020195820018384e-20
EarlyStopping counter: 49 out of 100
Updating learning rate to 2.510097910009192e-20
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.255048955004596e-20
EarlyStopping counter: 51 out of 100
Updating learning rate to 6.27524477502298e-21
EarlyStopping counter: 52 out of 100
Updating learning rate to 3.13762238751149e-21
EarlyStopping counter: 53 out of 100
Updating learning rate to 1.568811193755745e-21
EarlyStopping counter: 54 out of 100
Updating learning rate to 7.844055968778725e-22
EarlyStopping counter: 55 out of 100
Updating learning rate to 3.9220279843893625e-22
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.9610139921946812e-22
EarlyStopping counter: 57 out of 100
Updating learning rate to 9.805069960973406e-23
EarlyStopping counter: 58 out of 100
Updating learning rate to 4.902534980486703e-23
EarlyStopping counter: 59 out of 100
Updating learning rate to 2.4512674902433516e-23
EarlyStopping counter: 60 out of 100
Updating learning rate to 1.2256337451216758e-23
EarlyStopping counter: 61 out of 100
Updating learning rate to 6.128168725608379e-24
EarlyStopping counter: 62 out of 100
Updating learning rate to 3.0640843628041894e-24
EarlyStopping counter: 63 out of 100
Updating learning rate to 1.5320421814020947e-24
EarlyStopping counter: 64 out of 100
Updating learning rate to 7.660210907010474e-25
EarlyStopping counter: 65 out of 100
Updating learning rate to 3.830105453505237e-25
EarlyStopping counter: 66 out of 100
Updating learning rate to 1.9150527267526184e-25
EarlyStopping counter: 67 out of 100
Updating learning rate to 9.575263633763092e-26
EarlyStopping counter: 68 out of 100
Updating learning rate to 4.787631816881546e-26
EarlyStopping counter: 69 out of 100
Updating learning rate to 2.393815908440773e-26
EarlyStopping counter: 70 out of 100
Updating learning rate to 1.1969079542203865e-26
EarlyStopping counter: 71 out of 100
Updating learning rate to 5.9845397711019325e-27
EarlyStopping counter: 72 out of 100
Updating learning rate to 2.9922698855509663e-27
EarlyStopping counter: 73 out of 100
Updating learning rate to 1.4961349427754831e-27
EarlyStopping counter: 74 out of 100
Updating learning rate to 7.480674713877416e-28
EarlyStopping counter: 75 out of 100
Updating learning rate to 3.740337356938708e-28
EarlyStopping counter: 76 out of 100
Updating learning rate to 1.870168678469354e-28
EarlyStopping counter: 77 out of 100
Updating learning rate to 9.35084339234677e-29
EarlyStopping counter: 78 out of 100
Updating learning rate to 4.675421696173385e-29
EarlyStopping counter: 79 out of 100
Updating learning rate to 2.3377108480866924e-29
EarlyStopping counter: 80 out of 100
Updating learning rate to 1.1688554240433462e-29
EarlyStopping counter: 81 out of 100
Updating learning rate to 5.844277120216731e-30
EarlyStopping counter: 82 out of 100
Updating learning rate to 2.9221385601083655e-30
EarlyStopping counter: 83 out of 100
Updating learning rate to 1.4610692800541827e-30
EarlyStopping counter: 84 out of 100
Updating learning rate to 7.305346400270914e-31
EarlyStopping counter: 85 out of 100
Updating learning rate to 3.652673200135457e-31
EarlyStopping counter: 86 out of 100
Updating learning rate to 1.8263366000677284e-31
EarlyStopping counter: 87 out of 100
Updating learning rate to 9.131683000338642e-32
EarlyStopping counter: 88 out of 100
Updating learning rate to 4.565841500169321e-32
EarlyStopping counter: 89 out of 100
Updating learning rate to 2.2829207500846605e-32
EarlyStopping counter: 90 out of 100
Updating learning rate to 1.1414603750423303e-32
EarlyStopping counter: 91 out of 100
Updating learning rate to 5.707301875211651e-33
EarlyStopping counter: 92 out of 100
Updating learning rate to 2.8536509376058257e-33
EarlyStopping counter: 93 out of 100
Updating learning rate to 1.4268254688029128e-33
EarlyStopping counter: 94 out of 100
Updating learning rate to 7.134127344014564e-34
EarlyStopping counter: 95 out of 100
Updating learning rate to 3.567063672007282e-34
>>>>>> Testing on validation set: trial_15 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.050439007580280304, mae:0.0763971358537674, dtw:Not calculated


                                                                                         [I 2025-10-17 02:31:35,759] Trial 15 finished with value: 0.0763971358537674 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 2, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.00022608952024361716, 'dropout': 0.09274828169051318}. Best is trial 14 with value: 0.07120024412870407.
Best trial: 14. Best value: 0.0712002:  30%|███       | 15/50 [34:26<1:18:03, 133.80s/it]Best trial: 14. Best value: 0.0712002:  30%|███       | 15/50 [34:26<1:18:03, 133.80s/it]Best trial: 14. Best value: 0.0712002:  32%|███▏      | 16/50 [34:26<1:15:55, 133.98s/it]
============================================================
Trial 16
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 16, lr: 0.000063
dropout: 0.010617973684806853
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_16 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.028832).  Saving model ...
Updating learning rate to 6.279963031702269e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.1399815158511345e-05
Validation loss decreased (0.028832 --> 0.027818).  Saving model ...
Updating learning rate to 1.5699907579255673e-05
Validation loss decreased (0.027818 --> 0.026826).  Saving model ...
Updating learning rate to 7.849953789627836e-06
Validation loss decreased (0.026826 --> 0.026637).  Saving model ...
Updating learning rate to 3.924976894813918e-06
Validation loss decreased (0.026637 --> 0.026239).  Saving model ...
Updating learning rate to 1.962488447406959e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.812442237034795e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.906221118517398e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.453110559258699e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2265552796293494e-07
Validation loss decreased (0.026239 --> 0.026192).  Saving model ...
Updating learning rate to 6.132776398146747e-08
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.0663881990733735e-08
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5331940995366868e-08
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.665970497683434e-09
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.832985248841717e-09
Validation loss decreased (0.026192 --> 0.026040).  Saving model ...
Updating learning rate to 1.9164926244208585e-09
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.582463122104292e-10
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.791231561052146e-10
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.395615780526073e-10
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1978078902630365e-10
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.989039451315183e-11
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.9945197256575914e-11
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4972598628287957e-11
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.486299314143978e-12
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.743149657071989e-12
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.8715748285359946e-12
EarlyStopping counter: 11 out of 100
Updating learning rate to 9.357874142679973e-13
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.678937071339986e-13
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.339468535669993e-13
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.1697342678349966e-13
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.848671339174983e-14
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.9243356695874916e-14
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.4621678347937458e-14
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.310839173968729e-15
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.6554195869843644e-15
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.8277097934921822e-15
EarlyStopping counter: 21 out of 100
Updating learning rate to 9.138548967460911e-16
EarlyStopping counter: 22 out of 100
Updating learning rate to 4.569274483730456e-16
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.284637241865228e-16
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.142318620932614e-16
EarlyStopping counter: 25 out of 100
Updating learning rate to 5.71159310466307e-17
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.855796552331535e-17
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.4278982761657674e-17
EarlyStopping counter: 28 out of 100
Updating learning rate to 7.139491380828837e-18
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.5697456904144184e-18
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.7848728452072092e-18
EarlyStopping counter: 31 out of 100
Updating learning rate to 8.924364226036046e-19
EarlyStopping counter: 32 out of 100
Updating learning rate to 4.462182113018023e-19
EarlyStopping counter: 33 out of 100
Updating learning rate to 2.2310910565090115e-19
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.1155455282545058e-19
EarlyStopping counter: 35 out of 100
Updating learning rate to 5.577727641272529e-20
EarlyStopping counter: 36 out of 100
Updating learning rate to 2.7888638206362644e-20
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.3944319103181322e-20
EarlyStopping counter: 38 out of 100
Updating learning rate to 6.972159551590661e-21
EarlyStopping counter: 39 out of 100
Updating learning rate to 3.4860797757953305e-21
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.7430398878976652e-21
EarlyStopping counter: 41 out of 100
Updating learning rate to 8.715199439488326e-22
EarlyStopping counter: 42 out of 100
Updating learning rate to 4.357599719744163e-22
EarlyStopping counter: 43 out of 100
Updating learning rate to 2.1787998598720815e-22
EarlyStopping counter: 44 out of 100
Updating learning rate to 1.0893999299360408e-22
EarlyStopping counter: 45 out of 100
Updating learning rate to 5.446999649680204e-23
EarlyStopping counter: 46 out of 100
Updating learning rate to 2.723499824840102e-23
EarlyStopping counter: 47 out of 100
Updating learning rate to 1.361749912420051e-23
EarlyStopping counter: 48 out of 100
Updating learning rate to 6.808749562100255e-24
EarlyStopping counter: 49 out of 100
Updating learning rate to 3.4043747810501274e-24
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.7021873905250637e-24
EarlyStopping counter: 51 out of 100
Updating learning rate to 8.510936952625319e-25
EarlyStopping counter: 52 out of 100
Updating learning rate to 4.255468476312659e-25
EarlyStopping counter: 53 out of 100
Updating learning rate to 2.1277342381563296e-25
EarlyStopping counter: 54 out of 100
Updating learning rate to 1.0638671190781648e-25
EarlyStopping counter: 55 out of 100
Updating learning rate to 5.319335595390824e-26
EarlyStopping counter: 56 out of 100
Updating learning rate to 2.659667797695412e-26
EarlyStopping counter: 57 out of 100
Updating learning rate to 1.329833898847706e-26
EarlyStopping counter: 58 out of 100
Updating learning rate to 6.64916949423853e-27
EarlyStopping counter: 59 out of 100
Updating learning rate to 3.324584747119265e-27
EarlyStopping counter: 60 out of 100
Updating learning rate to 1.6622923735596325e-27
EarlyStopping counter: 61 out of 100
Updating learning rate to 8.311461867798163e-28
EarlyStopping counter: 62 out of 100
Updating learning rate to 4.155730933899081e-28
EarlyStopping counter: 63 out of 100
Updating learning rate to 2.0778654669495407e-28
EarlyStopping counter: 64 out of 100
Updating learning rate to 1.0389327334747703e-28
EarlyStopping counter: 65 out of 100
Updating learning rate to 5.194663667373852e-29
EarlyStopping counter: 66 out of 100
Updating learning rate to 2.597331833686926e-29
EarlyStopping counter: 67 out of 100
Updating learning rate to 1.298665916843463e-29
EarlyStopping counter: 68 out of 100
Updating learning rate to 6.493329584217315e-30
EarlyStopping counter: 69 out of 100
Updating learning rate to 3.246664792108657e-30
EarlyStopping counter: 70 out of 100
Updating learning rate to 1.6233323960543286e-30
EarlyStopping counter: 71 out of 100
Updating learning rate to 8.116661980271643e-31
EarlyStopping counter: 72 out of 100
Updating learning rate to 4.058330990135822e-31
EarlyStopping counter: 73 out of 100
Updating learning rate to 2.029165495067911e-31
EarlyStopping counter: 74 out of 100
Updating learning rate to 1.0145827475339554e-31
EarlyStopping counter: 75 out of 100
Updating learning rate to 5.072913737669777e-32
EarlyStopping counter: 76 out of 100
Updating learning rate to 2.5364568688348885e-32
EarlyStopping counter: 77 out of 100
Updating learning rate to 1.2682284344174442e-32
EarlyStopping counter: 78 out of 100
Updating learning rate to 6.341142172087221e-33
EarlyStopping counter: 79 out of 100
Updating learning rate to 3.1705710860436106e-33
EarlyStopping counter: 80 out of 100
Updating learning rate to 1.5852855430218053e-33
EarlyStopping counter: 81 out of 100
Updating learning rate to 7.926427715109027e-34
EarlyStopping counter: 82 out of 100
Updating learning rate to 3.963213857554513e-34
EarlyStopping counter: 83 out of 100
Updating learning rate to 1.9816069287772566e-34
EarlyStopping counter: 84 out of 100
Updating learning rate to 9.908034643886283e-35
>>>>>> Testing on validation set: trial_16 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.05087801069021225, mae:0.07658106833696365, dtw:Not calculated


                                                                                         [I 2025-10-17 02:35:59,716] Trial 16 finished with value: 0.07658106833696365 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 2, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 16, 'learning_rate': 6.279963031702269e-05, 'dropout': 0.010617973684806853}. Best is trial 14 with value: 0.07120024412870407.
Best trial: 14. Best value: 0.0712002:  32%|███▏      | 16/50 [38:50<1:15:55, 133.98s/it]Best trial: 14. Best value: 0.0712002:  32%|███▏      | 16/50 [38:50<1:15:55, 133.98s/it]Best trial: 14. Best value: 0.0712002:  34%|███▍      | 17/50 [38:50<1:35:11, 173.06s/it]
============================================================
Trial 17
============================================================
seq_len: 48, pred_len: 7
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 1
batch_size: 32, lr: 0.000544
dropout: 0.06677595561332049
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_17 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 7
============================================================
train 4619
val 253
test 255
Validation loss decreased (inf --> 0.041731).  Saving model ...
Updating learning rate to 0.0005443470661970972
Validation loss decreased (0.041731 --> 0.038763).  Saving model ...
Updating learning rate to 0.0002721735330985486
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0001360867665492743
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.804338327463715e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4021691637318576e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.7010845818659288e-05
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.505422909329644e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.252711454664822e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.126355727332411e-06
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.0631778636662055e-06
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.315889318331027e-07
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.6579446591655137e-07
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.3289723295827569e-07
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.644861647913784e-08
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.322430823956892e-08
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.661215411978446e-08
EarlyStopping counter: 15 out of 100
Updating learning rate to 8.30607705989223e-09
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.153038529946115e-09
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.0765192649730576e-09
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.0382596324865288e-09
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.191298162432644e-10
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.595649081216322e-10
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.297824540608161e-10
EarlyStopping counter: 22 out of 100
Updating learning rate to 6.489122703040805e-11
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.2445613515204025e-11
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.6222806757602013e-11
EarlyStopping counter: 25 out of 100
Updating learning rate to 8.111403378801006e-12
EarlyStopping counter: 26 out of 100
Updating learning rate to 4.055701689400503e-12
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.0278508447002516e-12
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.0139254223501258e-12
EarlyStopping counter: 29 out of 100
Updating learning rate to 5.069627111750629e-13
EarlyStopping counter: 30 out of 100
Updating learning rate to 2.5348135558753145e-13
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.2674067779376572e-13
EarlyStopping counter: 32 out of 100
Updating learning rate to 6.337033889688286e-14
EarlyStopping counter: 33 out of 100
Updating learning rate to 3.168516944844143e-14
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.5842584724220715e-14
EarlyStopping counter: 35 out of 100
Updating learning rate to 7.921292362110358e-15
EarlyStopping counter: 36 out of 100
Updating learning rate to 3.960646181055179e-15
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.9803230905275894e-15
EarlyStopping counter: 38 out of 100
Updating learning rate to 9.901615452637947e-16
EarlyStopping counter: 39 out of 100
Updating learning rate to 4.950807726318974e-16
EarlyStopping counter: 40 out of 100
Updating learning rate to 2.475403863159487e-16
EarlyStopping counter: 41 out of 100
Updating learning rate to 1.2377019315797434e-16
EarlyStopping counter: 42 out of 100
Updating learning rate to 6.188509657898717e-17
EarlyStopping counter: 43 out of 100
Updating learning rate to 3.0942548289493585e-17
EarlyStopping counter: 44 out of 100
Updating learning rate to 1.5471274144746792e-17
EarlyStopping counter: 45 out of 100
Updating learning rate to 7.735637072373396e-18
EarlyStopping counter: 46 out of 100
Updating learning rate to 3.867818536186698e-18
EarlyStopping counter: 47 out of 100
Updating learning rate to 1.933909268093349e-18
EarlyStopping counter: 48 out of 100
Updating learning rate to 9.669546340466745e-19
EarlyStopping counter: 49 out of 100
Updating learning rate to 4.834773170233373e-19
EarlyStopping counter: 50 out of 100
Updating learning rate to 2.4173865851166863e-19
EarlyStopping counter: 51 out of 100
Updating learning rate to 1.2086932925583432e-19
EarlyStopping counter: 52 out of 100
Updating learning rate to 6.043466462791716e-20
EarlyStopping counter: 53 out of 100
Updating learning rate to 3.021733231395858e-20
EarlyStopping counter: 54 out of 100
Updating learning rate to 1.510866615697929e-20
EarlyStopping counter: 55 out of 100
Updating learning rate to 7.554333078489645e-21
EarlyStopping counter: 56 out of 100
Updating learning rate to 3.777166539244822e-21
EarlyStopping counter: 57 out of 100
Updating learning rate to 1.888583269622411e-21
EarlyStopping counter: 58 out of 100
Updating learning rate to 9.442916348112056e-22
EarlyStopping counter: 59 out of 100
Updating learning rate to 4.721458174056028e-22
EarlyStopping counter: 60 out of 100
Updating learning rate to 2.360729087028014e-22
EarlyStopping counter: 61 out of 100
Updating learning rate to 1.180364543514007e-22
EarlyStopping counter: 62 out of 100
Updating learning rate to 5.901822717570035e-23
EarlyStopping counter: 63 out of 100
Updating learning rate to 2.9509113587850175e-23
EarlyStopping counter: 64 out of 100
Updating learning rate to 1.4754556793925087e-23
EarlyStopping counter: 65 out of 100
Updating learning rate to 7.377278396962544e-24
EarlyStopping counter: 66 out of 100
Updating learning rate to 3.688639198481272e-24
EarlyStopping counter: 67 out of 100
Updating learning rate to 1.844319599240636e-24
EarlyStopping counter: 68 out of 100
Updating learning rate to 9.22159799620318e-25
EarlyStopping counter: 69 out of 100
Updating learning rate to 4.61079899810159e-25
EarlyStopping counter: 70 out of 100
Updating learning rate to 2.305399499050795e-25
EarlyStopping counter: 71 out of 100
Updating learning rate to 1.1526997495253974e-25
EarlyStopping counter: 72 out of 100
Updating learning rate to 5.763498747626987e-26
EarlyStopping counter: 73 out of 100
Updating learning rate to 2.8817493738134936e-26
EarlyStopping counter: 74 out of 100
Updating learning rate to 1.4408746869067468e-26
EarlyStopping counter: 75 out of 100
Updating learning rate to 7.204373434533734e-27
EarlyStopping counter: 76 out of 100
Updating learning rate to 3.602186717266867e-27
EarlyStopping counter: 77 out of 100
Updating learning rate to 1.8010933586334335e-27
EarlyStopping counter: 78 out of 100
Updating learning rate to 9.005466793167168e-28
EarlyStopping counter: 79 out of 100
Updating learning rate to 4.502733396583584e-28
EarlyStopping counter: 80 out of 100
Updating learning rate to 2.251366698291792e-28
EarlyStopping counter: 81 out of 100
Updating learning rate to 1.125683349145896e-28
EarlyStopping counter: 82 out of 100
Updating learning rate to 5.62841674572948e-29
EarlyStopping counter: 83 out of 100
Updating learning rate to 2.81420837286474e-29
EarlyStopping counter: 84 out of 100
Updating learning rate to 1.40710418643237e-29
EarlyStopping counter: 85 out of 100
Updating learning rate to 7.03552093216185e-30
EarlyStopping counter: 86 out of 100
Updating learning rate to 3.517760466080925e-30
EarlyStopping counter: 87 out of 100
Updating learning rate to 1.7588802330404624e-30
EarlyStopping counter: 88 out of 100
Updating learning rate to 8.794401165202312e-31
EarlyStopping counter: 89 out of 100
Updating learning rate to 4.397200582601156e-31
EarlyStopping counter: 90 out of 100
Updating learning rate to 2.198600291300578e-31
EarlyStopping counter: 91 out of 100
Updating learning rate to 1.099300145650289e-31
EarlyStopping counter: 92 out of 100
Updating learning rate to 5.496500728251445e-32
EarlyStopping counter: 93 out of 100
Updating learning rate to 2.7482503641257225e-32
EarlyStopping counter: 94 out of 100
Updating learning rate to 1.3741251820628613e-32
EarlyStopping counter: 95 out of 100
Updating learning rate to 6.870625910314306e-33
EarlyStopping counter: 96 out of 100
Updating learning rate to 3.435312955157153e-33
EarlyStopping counter: 97 out of 100
Updating learning rate to 1.7176564775785766e-33
EarlyStopping counter: 98 out of 100
Updating learning rate to 8.588282387892883e-34
>>>>>> Testing on validation set: trial_17 >>>>>>
test 255
test shape: (255, 7, 5) (255, 7, 5)
test shape: (255, 7, 5) (255, 7, 5)


	mse:0.06707686185836792, mae:0.09950489550828934, dtw:Not calculated


                                                                                         [I 2025-10-17 02:38:13,609] Trial 17 finished with value: 0.09950489550828934 and parameters: {'seq_len': 48, 'pred_len': 7, 'expand': 2, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 1, 'batch_size': 32, 'learning_rate': 0.0005443470661970972, 'dropout': 0.06677595561332049}. Best is trial 14 with value: 0.07120024412870407.
Best trial: 14. Best value: 0.0712002:  34%|███▍      | 17/50 [41:04<1:35:11, 173.06s/it]Best trial: 14. Best value: 0.0712002:  34%|███▍      | 17/50 [41:04<1:35:11, 173.06s/it]Best trial: 14. Best value: 0.0712002:  36%|███▌      | 18/50 [41:04<1:26:01, 161.29s/it]
============================================================
Trial 18
============================================================
seq_len: 48, pred_len: 30
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000239
dropout: 0.11685152034910255
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_18 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 30
============================================================
train 4596
val 230
test 232
Validation loss decreased (inf --> 0.038733).  Saving model ...
Updating learning rate to 0.00023912076054315103
Validation loss decreased (0.038733 --> 0.037633).  Saving model ...
Updating learning rate to 0.00011956038027157551
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.978019013578776e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.989009506789388e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.494504753394694e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.47252376697347e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.736261883486735e-06
Validation loss decreased (0.037633 --> 0.036901).  Saving model ...
Updating learning rate to 1.8681309417433674e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.340654708716837e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.6703273543584185e-07
Validation loss decreased (0.036901 --> 0.036855).  Saving model ...
Updating learning rate to 2.3351636771792093e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1675818385896046e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.837909192948023e-08
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.9189545964740116e-08
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4594772982370058e-08
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.297386491185029e-09
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.6486932455925145e-09
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8243466227962572e-09
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.121733113981286e-10
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.560866556990643e-10
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.2804332784953215e-10
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.1402166392476608e-10
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.701083196238304e-11
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.850541598119152e-11
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.425270799059576e-11
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.12635399529788e-12
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.56317699764894e-12
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.78158849882447e-12
EarlyStopping counter: 18 out of 100
Updating learning rate to 8.90794249412235e-13
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.453971247061175e-13
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.2269856235305874e-13
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.1134928117652937e-13
EarlyStopping counter: 22 out of 100
Updating learning rate to 5.5674640588264686e-14
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.7837320294132343e-14
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.3918660147066171e-14
EarlyStopping counter: 25 out of 100
Updating learning rate to 6.959330073533086e-15
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.479665036766543e-15
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.7398325183832714e-15
EarlyStopping counter: 28 out of 100
Updating learning rate to 8.699162591916357e-16
EarlyStopping counter: 29 out of 100
Updating learning rate to 4.3495812959581786e-16
Validation loss decreased (0.036855 --> 0.036425).  Saving model ...
Updating learning rate to 2.1747906479790893e-16
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0873953239895446e-16
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.436976619947723e-17
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7184883099738616e-17
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3592441549869308e-17
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.796220774934654e-18
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.398110387467327e-18
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.6990551937336635e-18
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.495275968668318e-19
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.247637984334159e-19
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.1238189921670794e-19
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.0619094960835397e-19
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.3095474804176985e-20
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.6547737402088492e-20
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.3273868701044246e-20
EarlyStopping counter: 15 out of 100
Updating learning rate to 6.636934350522123e-21
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.3184671752610615e-21
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.6592335876305308e-21
EarlyStopping counter: 18 out of 100
Updating learning rate to 8.296167938152654e-22
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.148083969076327e-22
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.0740419845381635e-22
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.0370209922690817e-22
EarlyStopping counter: 22 out of 100
Updating learning rate to 5.1851049613454087e-23
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.5925524806727043e-23
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.2962762403363522e-23
EarlyStopping counter: 25 out of 100
Updating learning rate to 6.481381201681761e-24
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.2406906008408804e-24
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.6203453004204402e-24
EarlyStopping counter: 28 out of 100
Updating learning rate to 8.101726502102201e-25
EarlyStopping counter: 29 out of 100
Updating learning rate to 4.0508632510511005e-25
EarlyStopping counter: 30 out of 100
Updating learning rate to 2.0254316255255503e-25
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.0127158127627751e-25
EarlyStopping counter: 32 out of 100
Updating learning rate to 5.0635790638138757e-26
EarlyStopping counter: 33 out of 100
Updating learning rate to 2.5317895319069378e-26
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.2658947659534689e-26
EarlyStopping counter: 35 out of 100
Updating learning rate to 6.3294738297673446e-27
EarlyStopping counter: 36 out of 100
Updating learning rate to 3.1647369148836723e-27
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.5823684574418361e-27
EarlyStopping counter: 38 out of 100
Updating learning rate to 7.911842287209181e-28
EarlyStopping counter: 39 out of 100
Updating learning rate to 3.9559211436045904e-28
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.9779605718022952e-28
EarlyStopping counter: 41 out of 100
Updating learning rate to 9.889802859011476e-29
EarlyStopping counter: 42 out of 100
Updating learning rate to 4.944901429505738e-29
EarlyStopping counter: 43 out of 100
Updating learning rate to 2.472450714752869e-29
EarlyStopping counter: 44 out of 100
Updating learning rate to 1.2362253573764345e-29
EarlyStopping counter: 45 out of 100
Updating learning rate to 6.1811267868821724e-30
EarlyStopping counter: 46 out of 100
Updating learning rate to 3.0905633934410862e-30
EarlyStopping counter: 47 out of 100
Updating learning rate to 1.5452816967205431e-30
EarlyStopping counter: 48 out of 100
Updating learning rate to 7.7264084836027155e-31
EarlyStopping counter: 49 out of 100
Updating learning rate to 3.8632042418013578e-31
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.9316021209006789e-31
EarlyStopping counter: 51 out of 100
Updating learning rate to 9.658010604503394e-32
EarlyStopping counter: 52 out of 100
Updating learning rate to 4.829005302251697e-32
EarlyStopping counter: 53 out of 100
Updating learning rate to 2.4145026511258486e-32
EarlyStopping counter: 54 out of 100
Updating learning rate to 1.2072513255629243e-32
EarlyStopping counter: 55 out of 100
Updating learning rate to 6.0362566278146215e-33
EarlyStopping counter: 56 out of 100
Updating learning rate to 3.0181283139073108e-33
EarlyStopping counter: 57 out of 100
Updating learning rate to 1.5090641569536554e-33
EarlyStopping counter: 58 out of 100
Updating learning rate to 7.545320784768277e-34
EarlyStopping counter: 59 out of 100
Updating learning rate to 3.7726603923841384e-34
>>>>>> Testing on validation set: trial_18 >>>>>>
test 232
test shape: (232, 30, 5) (232, 30, 5)
test shape: (232, 30, 5) (232, 30, 5)


	mse:0.08042082190513611, mae:0.11084547638893127, dtw:Not calculated


                                                                                         [I 2025-10-17 02:40:27,133] Trial 18 finished with value: 0.11084547638893127 and parameters: {'seq_len': 48, 'pred_len': 30, 'expand': 2, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.00023912076054315103, 'dropout': 0.11685152034910255}. Best is trial 14 with value: 0.07120024412870407.
Best trial: 14. Best value: 0.0712002:  36%|███▌      | 18/50 [43:17<1:26:01, 161.29s/it]Best trial: 14. Best value: 0.0712002:  36%|███▌      | 18/50 [43:17<1:26:01, 161.29s/it]Best trial: 14. Best value: 0.0712002:  38%|███▊      | 19/50 [43:17<1:19:01, 152.95s/it]
============================================================
Trial 19
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000598
dropout: 0.16479999871474943
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_19 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.024940).  Saving model ...
Updating learning rate to 0.0005980317626724049
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00029901588133620245
Validation loss decreased (0.024940 --> 0.023692).  Saving model ...
Updating learning rate to 0.00014950794066810122
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.475397033405061e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.7376985167025306e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8688492583512653e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.344246291756326e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.672123145878163e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.3360615729390816e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1680307864695408e-06
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.840153932347704e-07
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.920076966173852e-07
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.460038483086926e-07
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.30019241543463e-08
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.650096207717315e-08
Validation loss decreased (0.023692 --> 0.023631).  Saving model ...
Updating learning rate to 1.8250481038586575e-08
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.125240519293288e-09
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.562620259646644e-09
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.281310129823322e-09
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.140655064911661e-09
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.703275324558305e-10
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.8516376622791524e-10
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4258188311395762e-10
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.129094155697881e-11
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.5645470778489404e-11
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.7822735389244702e-11
EarlyStopping counter: 11 out of 100
Updating learning rate to 8.911367694622351e-12
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.4556838473111756e-12
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.2278419236555878e-12
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.1139209618277939e-12
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.569604809138969e-13
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.7848024045694847e-13
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.3924012022847424e-13
EarlyStopping counter: 18 out of 100
Updating learning rate to 6.962006011423712e-14
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.481003005711856e-14
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.740501502855928e-14
EarlyStopping counter: 21 out of 100
Updating learning rate to 8.70250751427964e-15
EarlyStopping counter: 22 out of 100
Updating learning rate to 4.35125375713982e-15
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.17562687856991e-15
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.087813439284955e-15
EarlyStopping counter: 25 out of 100
Updating learning rate to 5.439067196424775e-16
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.7195335982123874e-16
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.3597667991061937e-16
EarlyStopping counter: 28 out of 100
Updating learning rate to 6.798833995530969e-17
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.399416997765484e-17
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.699708498882742e-17
EarlyStopping counter: 31 out of 100
Updating learning rate to 8.49854249441371e-18
EarlyStopping counter: 32 out of 100
Updating learning rate to 4.249271247206855e-18
EarlyStopping counter: 33 out of 100
Updating learning rate to 2.1246356236034277e-18
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.0623178118017138e-18
EarlyStopping counter: 35 out of 100
Updating learning rate to 5.311589059008569e-19
EarlyStopping counter: 36 out of 100
Updating learning rate to 2.6557945295042846e-19
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.3278972647521423e-19
EarlyStopping counter: 38 out of 100
Updating learning rate to 6.639486323760711e-20
EarlyStopping counter: 39 out of 100
Updating learning rate to 3.319743161880356e-20
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.659871580940178e-20
EarlyStopping counter: 41 out of 100
Updating learning rate to 8.29935790470089e-21
EarlyStopping counter: 42 out of 100
Updating learning rate to 4.149678952350445e-21
EarlyStopping counter: 43 out of 100
Updating learning rate to 2.0748394761752223e-21
EarlyStopping counter: 44 out of 100
Updating learning rate to 1.0374197380876112e-21
EarlyStopping counter: 45 out of 100
Updating learning rate to 5.187098690438056e-22
EarlyStopping counter: 46 out of 100
Updating learning rate to 2.593549345219028e-22
EarlyStopping counter: 47 out of 100
Updating learning rate to 1.296774672609514e-22
EarlyStopping counter: 48 out of 100
Updating learning rate to 6.48387336304757e-23
EarlyStopping counter: 49 out of 100
Updating learning rate to 3.241936681523785e-23
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.6209683407618925e-23
EarlyStopping counter: 51 out of 100
Updating learning rate to 8.104841703809462e-24
EarlyStopping counter: 52 out of 100
Updating learning rate to 4.052420851904731e-24
EarlyStopping counter: 53 out of 100
Updating learning rate to 2.0262104259523656e-24
EarlyStopping counter: 54 out of 100
Updating learning rate to 1.0131052129761828e-24
EarlyStopping counter: 55 out of 100
Updating learning rate to 5.065526064880914e-25
EarlyStopping counter: 56 out of 100
Updating learning rate to 2.532763032440457e-25
EarlyStopping counter: 57 out of 100
Updating learning rate to 1.2663815162202285e-25
EarlyStopping counter: 58 out of 100
Updating learning rate to 6.331907581101142e-26
EarlyStopping counter: 59 out of 100
Updating learning rate to 3.165953790550571e-26
EarlyStopping counter: 60 out of 100
Updating learning rate to 1.5829768952752856e-26
EarlyStopping counter: 61 out of 100
Updating learning rate to 7.914884476376428e-27
EarlyStopping counter: 62 out of 100
Updating learning rate to 3.957442238188214e-27
EarlyStopping counter: 63 out of 100
Updating learning rate to 1.978721119094107e-27
EarlyStopping counter: 64 out of 100
Updating learning rate to 9.893605595470535e-28
EarlyStopping counter: 65 out of 100
Updating learning rate to 4.9468027977352675e-28
EarlyStopping counter: 66 out of 100
Updating learning rate to 2.4734013988676337e-28
EarlyStopping counter: 67 out of 100
Updating learning rate to 1.2367006994338169e-28
EarlyStopping counter: 68 out of 100
Updating learning rate to 6.183503497169084e-29
EarlyStopping counter: 69 out of 100
Updating learning rate to 3.091751748584542e-29
EarlyStopping counter: 70 out of 100
Updating learning rate to 1.545875874292271e-29
EarlyStopping counter: 71 out of 100
Updating learning rate to 7.729379371461355e-30
EarlyStopping counter: 72 out of 100
Updating learning rate to 3.864689685730678e-30
EarlyStopping counter: 73 out of 100
Updating learning rate to 1.932344842865339e-30
EarlyStopping counter: 74 out of 100
Updating learning rate to 9.661724214326694e-31
EarlyStopping counter: 75 out of 100
Updating learning rate to 4.830862107163347e-31
EarlyStopping counter: 76 out of 100
Updating learning rate to 2.4154310535816736e-31
EarlyStopping counter: 77 out of 100
Updating learning rate to 1.2077155267908368e-31
EarlyStopping counter: 78 out of 100
Updating learning rate to 6.038577633954184e-32
EarlyStopping counter: 79 out of 100
Updating learning rate to 3.019288816977092e-32
EarlyStopping counter: 80 out of 100
Updating learning rate to 1.509644408488546e-32
EarlyStopping counter: 81 out of 100
Updating learning rate to 7.54822204244273e-33
EarlyStopping counter: 82 out of 100
Updating learning rate to 3.774111021221365e-33
EarlyStopping counter: 83 out of 100
Updating learning rate to 1.8870555106106825e-33
EarlyStopping counter: 84 out of 100
Updating learning rate to 9.435277553053412e-34
>>>>>> Testing on validation set: trial_19 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.04957239329814911, mae:0.07184123247861862, dtw:Not calculated


                                                                                         [I 2025-10-17 02:42:41,560] Trial 19 finished with value: 0.07184123247861862 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 2, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0005980317626724049, 'dropout': 0.16479999871474943}. Best is trial 14 with value: 0.07120024412870407.
Best trial: 14. Best value: 0.0712002:  38%|███▊      | 19/50 [45:32<1:19:01, 152.95s/it]Best trial: 14. Best value: 0.0712002:  38%|███▊      | 19/50 [45:32<1:19:01, 152.95s/it]Best trial: 14. Best value: 0.0712002:  40%|████      | 20/50 [45:32<1:13:41, 147.39s/it]
============================================================
Trial 20
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 1
batch_size: 16, lr: 0.000077
dropout: 0.048576987816718084
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_20 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.029024).  Saving model ...
Updating learning rate to 7.689367198935745e-05
Validation loss decreased (0.029024 --> 0.027146).  Saving model ...
Updating learning rate to 3.844683599467873e-05
Validation loss decreased (0.027146 --> 0.026226).  Saving model ...
Updating learning rate to 1.9223417997339363e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.611708998669682e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.805854499334841e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.4029272496674204e-06
Validation loss decreased (0.026226 --> 0.026060).  Saving model ...
Updating learning rate to 1.2014636248337102e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.007318124168551e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.0036590620842755e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5018295310421378e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.509147655210689e-08
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.7545738276053444e-08
Validation loss decreased (0.026060 --> 0.025801).  Saving model ...
Updating learning rate to 1.8772869138026722e-08
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.386434569013361e-09
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.6932172845066805e-09
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.3466086422533402e-09
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1733043211266701e-09
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.866521605633351e-10
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.9332608028166753e-10
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4666304014083377e-10
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.333152007041688e-11
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.666576003520844e-11
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.833288001760422e-11
EarlyStopping counter: 11 out of 100
Updating learning rate to 9.16644000880211e-12
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.583220004401055e-12
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.2916100022005276e-12
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.1458050011002638e-12
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.729025005501319e-13
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.8645125027506595e-13
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.4322562513753297e-13
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.161281256876649e-14
Validation loss decreased (0.025801 --> 0.025715).  Saving model ...
Updating learning rate to 3.5806406284383244e-14
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.7903203142191622e-14
Validation loss decreased (0.025715 --> 0.025713).  Saving model ...
Updating learning rate to 8.951601571095811e-15
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.4758007855479054e-15
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2379003927739527e-15
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1189501963869764e-15
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.594750981934882e-16
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.797375490967441e-16
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3986877454837205e-16
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.993438727418602e-17
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.496719363709301e-17
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.7483596818546506e-17
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.741798409273253e-18
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.3708992046366264e-18
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.1854496023183132e-18
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.0927248011591566e-18
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.463624005795783e-19
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.7318120028978915e-19
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.3659060014489458e-19
EarlyStopping counter: 17 out of 100
Updating learning rate to 6.829530007244729e-20
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.4147650036223644e-20
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.7073825018111822e-20
EarlyStopping counter: 20 out of 100
Updating learning rate to 8.536912509055911e-21
EarlyStopping counter: 21 out of 100
Updating learning rate to 4.2684562545279555e-21
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.1342281272639777e-21
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.0671140636319889e-21
EarlyStopping counter: 24 out of 100
Updating learning rate to 5.335570318159944e-22
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.667785159079972e-22
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.333892579539986e-22
EarlyStopping counter: 27 out of 100
Updating learning rate to 6.66946289769993e-23
EarlyStopping counter: 28 out of 100
Updating learning rate to 3.334731448849965e-23
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.6673657244249826e-23
EarlyStopping counter: 30 out of 100
Updating learning rate to 8.336828622124913e-24
EarlyStopping counter: 31 out of 100
Updating learning rate to 4.1684143110624565e-24
EarlyStopping counter: 32 out of 100
Updating learning rate to 2.0842071555312283e-24
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.0421035777656141e-24
EarlyStopping counter: 34 out of 100
Updating learning rate to 5.210517888828071e-25
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.6052589444140353e-25
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.3026294722070177e-25
EarlyStopping counter: 37 out of 100
Updating learning rate to 6.513147361035088e-26
EarlyStopping counter: 38 out of 100
Updating learning rate to 3.256573680517544e-26
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.628286840258772e-26
EarlyStopping counter: 40 out of 100
Updating learning rate to 8.14143420129386e-27
EarlyStopping counter: 41 out of 100
Updating learning rate to 4.07071710064693e-27
EarlyStopping counter: 42 out of 100
Updating learning rate to 2.035358550323465e-27
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.0176792751617325e-27
EarlyStopping counter: 44 out of 100
Updating learning rate to 5.088396375808663e-28
EarlyStopping counter: 45 out of 100
Updating learning rate to 2.5441981879043314e-28
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.2720990939521657e-28
EarlyStopping counter: 47 out of 100
Updating learning rate to 6.360495469760828e-29
EarlyStopping counter: 48 out of 100
Updating learning rate to 3.180247734880414e-29
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.590123867440207e-29
EarlyStopping counter: 50 out of 100
Updating learning rate to 7.950619337201036e-30
EarlyStopping counter: 51 out of 100
Updating learning rate to 3.975309668600518e-30
EarlyStopping counter: 52 out of 100
Updating learning rate to 1.987654834300259e-30
EarlyStopping counter: 53 out of 100
Updating learning rate to 9.938274171501294e-31
EarlyStopping counter: 54 out of 100
Updating learning rate to 4.969137085750647e-31
EarlyStopping counter: 55 out of 100
Updating learning rate to 2.4845685428753236e-31
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.2422842714376618e-31
EarlyStopping counter: 57 out of 100
Updating learning rate to 6.211421357188309e-32
EarlyStopping counter: 58 out of 100
Updating learning rate to 3.1057106785941545e-32
EarlyStopping counter: 59 out of 100
Updating learning rate to 1.5528553392970773e-32
EarlyStopping counter: 60 out of 100
Updating learning rate to 7.764276696485386e-33
EarlyStopping counter: 61 out of 100
Updating learning rate to 3.882138348242693e-33
EarlyStopping counter: 62 out of 100
Updating learning rate to 1.9410691741213466e-33
EarlyStopping counter: 63 out of 100
Updating learning rate to 9.705345870606733e-34
EarlyStopping counter: 64 out of 100
Updating learning rate to 4.852672935303366e-34
EarlyStopping counter: 65 out of 100
Updating learning rate to 2.426336467651683e-34
EarlyStopping counter: 66 out of 100
Updating learning rate to 1.2131682338258416e-34
>>>>>> Testing on validation set: trial_20 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.050205882638692856, mae:0.07578303664922714, dtw:Not calculated


                                                                                         [I 2025-10-17 02:47:05,565] Trial 20 finished with value: 0.07578303664922714 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 2, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 1, 'batch_size': 16, 'learning_rate': 7.689367198935745e-05, 'dropout': 0.048576987816718084}. Best is trial 14 with value: 0.07120024412870407.
Best trial: 14. Best value: 0.0712002:  40%|████      | 20/50 [49:56<1:13:41, 147.39s/it]Best trial: 14. Best value: 0.0712002:  40%|████      | 20/50 [49:56<1:13:41, 147.39s/it]Best trial: 14. Best value: 0.0712002:  42%|████▏     | 21/50 [49:56<1:28:09, 182.39s/it]
============================================================
Trial 21
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000567
dropout: 0.17892162073975054
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_21 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.028058).  Saving model ...
Updating learning rate to 0.0005668186313144024
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0002834093156572012
Validation loss decreased (0.028058 --> 0.024961).  Saving model ...
Updating learning rate to 0.0001417046578286006
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.08523289143003e-05
Validation loss decreased (0.024961 --> 0.024661).  Saving model ...
Updating learning rate to 3.542616445715015e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.7713082228575075e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.856541114287538e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.428270557143769e-06
Validation loss decreased (0.024661 --> 0.024490).  Saving model ...
Updating learning rate to 2.2141352785718844e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1070676392859422e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.535338196429711e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7676690982148555e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3838345491074278e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.919172745537139e-08
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.4595863727685694e-08
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.7297931863842847e-08
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.648965931921424e-09
Validation loss decreased (0.024490 --> 0.024294).  Saving model ...
Updating learning rate to 4.324482965960712e-09
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.162241482980356e-09
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.081120741490178e-09
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.40560370745089e-10
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.702801853725445e-10
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3514009268627224e-10
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.757004634313612e-11
Validation loss decreased (0.024294 --> 0.024268).  Saving model ...
Updating learning rate to 3.378502317156806e-11
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.689251158578403e-11
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.446255792892015e-12
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.2231278964460076e-12
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.1115639482230038e-12
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0557819741115019e-12
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.278909870557509e-13
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.6394549352787547e-13
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3197274676393774e-13
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.598637338196887e-14
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.2993186690984434e-14
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.6496593345492217e-14
EarlyStopping counter: 12 out of 100
Updating learning rate to 8.248296672746109e-15
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.124148336373054e-15
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.062074168186527e-15
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.0310370840932636e-15
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.155185420466318e-16
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.577592710233159e-16
Validation loss decreased (0.024268 --> 0.024004).  Saving model ...
Updating learning rate to 1.2887963551165795e-16
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.443981775582897e-17
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.2219908877914487e-17
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6109954438957243e-17
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.054977219478622e-18
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.027488609739311e-18
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0137443048696554e-18
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.0068721524348277e-18
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.034360762174139e-19
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.5171803810870693e-19
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.2585901905435346e-19
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.292950952717673e-20
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.1464754763588366e-20
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.5732377381794183e-20
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.866188690897091e-21
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.933094345448546e-21
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.966547172724273e-21
EarlyStopping counter: 17 out of 100
Updating learning rate to 9.832735863621364e-22
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.916367931810682e-22
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.458183965905341e-22
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.2290919829526705e-22
EarlyStopping counter: 21 out of 100
Updating learning rate to 6.145459914763353e-23
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.0727299573816764e-23
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.5363649786908382e-23
EarlyStopping counter: 24 out of 100
Updating learning rate to 7.681824893454191e-24
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.8409124467270954e-24
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.9204562233635477e-24
EarlyStopping counter: 27 out of 100
Updating learning rate to 9.602281116817739e-25
EarlyStopping counter: 28 out of 100
Updating learning rate to 4.801140558408869e-25
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.4005702792044347e-25
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.2002851396022173e-25
EarlyStopping counter: 31 out of 100
Updating learning rate to 6.001425698011087e-26
EarlyStopping counter: 32 out of 100
Updating learning rate to 3.0007128490055433e-26
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.5003564245027717e-26
EarlyStopping counter: 34 out of 100
Updating learning rate to 7.501782122513858e-27
EarlyStopping counter: 35 out of 100
Updating learning rate to 3.750891061256929e-27
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.8754455306284646e-27
EarlyStopping counter: 37 out of 100
Updating learning rate to 9.377227653142323e-28
EarlyStopping counter: 38 out of 100
Updating learning rate to 4.688613826571161e-28
EarlyStopping counter: 39 out of 100
Updating learning rate to 2.3443069132855807e-28
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.1721534566427904e-28
EarlyStopping counter: 41 out of 100
Updating learning rate to 5.860767283213952e-29
Validation loss decreased (0.024004 --> 0.023839).  Saving model ...
Updating learning rate to 2.930383641606976e-29
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.465191820803488e-29
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.32595910401744e-30
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.66297955200872e-30
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.83148977600436e-30
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.1574488800218e-31
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.5787244400109e-31
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.28936222000545e-31
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.144681110002725e-31
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.723405550013625e-32
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.8617027750068124e-32
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.4308513875034062e-32
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.154256937517031e-33
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.5771284687585155e-33
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.7885642343792577e-33
EarlyStopping counter: 15 out of 100
Updating learning rate to 8.942821171896289e-34
>>>>>> Testing on validation set: trial_21 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.04896516725420952, mae:0.07141856849193573, dtw:Not calculated


                                                                                         [I 2025-10-17 02:49:19,927] Trial 21 finished with value: 0.07141856849193573 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 2, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0005668186313144024, 'dropout': 0.17892162073975054}. Best is trial 14 with value: 0.07120024412870407.
Best trial: 14. Best value: 0.0712002:  42%|████▏     | 21/50 [52:10<1:28:09, 182.39s/it]Best trial: 14. Best value: 0.0712002:  42%|████▏     | 21/50 [52:10<1:28:09, 182.39s/it]Best trial: 14. Best value: 0.0712002:  44%|████▍     | 22/50 [52:10<1:18:23, 167.98s/it]
============================================================
Trial 22
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000627
dropout: 0.19783466554638796
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_22 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.027530).  Saving model ...
Updating learning rate to 0.0006266490071858569
Validation loss decreased (0.027530 --> 0.023684).  Saving model ...
Updating learning rate to 0.00031332450359292845
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00015666225179646423
Validation loss decreased (0.023684 --> 0.023357).  Saving model ...
Updating learning rate to 7.833112589823211e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.9165562949116056e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.9582781474558028e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.791390737279014e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.895695368639507e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.4478476843197535e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.2239238421598768e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.119619210799384e-07
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.059809605399692e-07
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.529904802699846e-07
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.64952401349923e-08
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.824762006749615e-08
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.9123810033748074e-08
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.561905016874037e-09
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.780952508437019e-09
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.3904762542185093e-09
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.1952381271092546e-09
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.976190635546273e-10
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.9880953177731366e-10
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.4940476588865683e-10
EarlyStopping counter: 20 out of 100
Updating learning rate to 7.470238294432842e-11
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.735119147216421e-11
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.8675595736082104e-11
EarlyStopping counter: 23 out of 100
Updating learning rate to 9.337797868041052e-12
EarlyStopping counter: 24 out of 100
Updating learning rate to 4.668898934020526e-12
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.334449467010263e-12
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.1672247335051315e-12
EarlyStopping counter: 27 out of 100
Updating learning rate to 5.836123667525657e-13
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.9180618337628287e-13
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.4590309168814144e-13
EarlyStopping counter: 30 out of 100
Updating learning rate to 7.295154584407072e-14
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.647577292203536e-14
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.823788646101768e-14
EarlyStopping counter: 33 out of 100
Updating learning rate to 9.11894323050884e-15
EarlyStopping counter: 34 out of 100
Updating learning rate to 4.55947161525442e-15
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.27973580762721e-15
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.139867903813605e-15
EarlyStopping counter: 37 out of 100
Updating learning rate to 5.699339519068025e-16
EarlyStopping counter: 38 out of 100
Updating learning rate to 2.8496697595340124e-16
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.4248348797670062e-16
EarlyStopping counter: 40 out of 100
Updating learning rate to 7.124174398835031e-17
EarlyStopping counter: 41 out of 100
Updating learning rate to 3.5620871994175155e-17
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.7810435997087578e-17
EarlyStopping counter: 43 out of 100
Updating learning rate to 8.905217998543789e-18
EarlyStopping counter: 44 out of 100
Updating learning rate to 4.4526089992718944e-18
EarlyStopping counter: 45 out of 100
Updating learning rate to 2.2263044996359472e-18
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.1131522498179736e-18
EarlyStopping counter: 47 out of 100
Updating learning rate to 5.565761249089868e-19
EarlyStopping counter: 48 out of 100
Updating learning rate to 2.782880624544934e-19
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.391440312272467e-19
EarlyStopping counter: 50 out of 100
Updating learning rate to 6.957201561362335e-20
EarlyStopping counter: 51 out of 100
Updating learning rate to 3.4786007806811675e-20
EarlyStopping counter: 52 out of 100
Updating learning rate to 1.7393003903405838e-20
EarlyStopping counter: 53 out of 100
Updating learning rate to 8.696501951702919e-21
EarlyStopping counter: 54 out of 100
Updating learning rate to 4.3482509758514594e-21
EarlyStopping counter: 55 out of 100
Updating learning rate to 2.1741254879257297e-21
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.0870627439628648e-21
EarlyStopping counter: 57 out of 100
Updating learning rate to 5.435313719814324e-22
Validation loss decreased (0.023357 --> 0.023324).  Saving model ...
Updating learning rate to 2.717656859907162e-22
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.358828429953581e-22
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.794142149767905e-23
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.3970710748839527e-23
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6985355374419763e-23
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.492677687209882e-24
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.246338843604941e-24
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.1231694218024704e-24
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.0615847109012352e-24
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.307923554506176e-25
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.653961777253088e-25
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.326980888626544e-25
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.63490444313272e-26
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.31745222156636e-26
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.65872611078318e-26
EarlyStopping counter: 15 out of 100
Updating learning rate to 8.2936305539159e-27
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.14681527695795e-27
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.073407638478975e-27
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.0367038192394875e-27
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.1835190961974375e-28
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.5917595480987188e-28
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.2958797740493594e-28
EarlyStopping counter: 22 out of 100
Updating learning rate to 6.479398870246797e-29
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.2396994351233984e-29
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.6198497175616992e-29
EarlyStopping counter: 25 out of 100
Updating learning rate to 8.099248587808496e-30
EarlyStopping counter: 26 out of 100
Updating learning rate to 4.049624293904248e-30
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.024812146952124e-30
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.012406073476062e-30
EarlyStopping counter: 29 out of 100
Updating learning rate to 5.06203036738031e-31
EarlyStopping counter: 30 out of 100
Updating learning rate to 2.531015183690155e-31
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.2655075918450775e-31
EarlyStopping counter: 32 out of 100
Updating learning rate to 6.327537959225388e-32
EarlyStopping counter: 33 out of 100
Updating learning rate to 3.163768979612694e-32
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.581884489806347e-32
EarlyStopping counter: 35 out of 100
Updating learning rate to 7.909422449031734e-33
EarlyStopping counter: 36 out of 100
Updating learning rate to 3.954711224515867e-33
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.9773556122579336e-33
EarlyStopping counter: 38 out of 100
Updating learning rate to 9.886778061289668e-34
>>>>>> Testing on validation set: trial_22 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.04939993843436241, mae:0.07236140966415405, dtw:Not calculated


                                                                                         [I 2025-10-17 02:51:34,522] Trial 22 finished with value: 0.07236140966415405 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 2, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0006266490071858569, 'dropout': 0.19783466554638796}. Best is trial 14 with value: 0.07120024412870407.
Best trial: 14. Best value: 0.0712002:  44%|████▍     | 22/50 [54:25<1:18:23, 167.98s/it]Best trial: 14. Best value: 0.0712002:  44%|████▍     | 22/50 [54:25<1:18:23, 167.98s/it]Best trial: 14. Best value: 0.0712002:  46%|████▌     | 23/50 [54:25<1:11:04, 157.96s/it]
============================================================
Trial 23
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000242
dropout: 0.11847701818869072
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_23 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.030316).  Saving model ...
Updating learning rate to 0.00024179285023702727
Validation loss decreased (0.030316 --> 0.028683).  Saving model ...
Updating learning rate to 0.00012089642511851364
Validation loss decreased (0.028683 --> 0.026263).  Saving model ...
Updating learning rate to 6.044821255925682e-05
Validation loss decreased (0.026263 --> 0.025667).  Saving model ...
Updating learning rate to 3.022410627962841e-05
Validation loss decreased (0.025667 --> 0.024579).  Saving model ...
Updating learning rate to 1.5112053139814205e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.556026569907102e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.778013284953551e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8890066424767756e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.445033212383878e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.722516606191939e-07
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.3612583030959695e-07
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1806291515479847e-07
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.9031457577399237e-08
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.9515728788699618e-08
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.4757864394349809e-08
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.3789321971749046e-09
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.6894660985874523e-09
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.8447330492937261e-09
EarlyStopping counter: 14 out of 100
Updating learning rate to 9.223665246468631e-10
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.6118326232343154e-10
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.3059163116171577e-10
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.1529581558085788e-10
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.764790779042894e-11
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.882395389521447e-11
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.4411976947607235e-11
EarlyStopping counter: 21 out of 100
Updating learning rate to 7.205988473803618e-12
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.602994236901809e-12
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.8014971184509044e-12
EarlyStopping counter: 24 out of 100
Updating learning rate to 9.007485592254522e-13
EarlyStopping counter: 25 out of 100
Updating learning rate to 4.503742796127261e-13
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.2518713980636305e-13
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.1259356990318153e-13
EarlyStopping counter: 28 out of 100
Updating learning rate to 5.6296784951590764e-14
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.8148392475795382e-14
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.4074196237897691e-14
EarlyStopping counter: 31 out of 100
Updating learning rate to 7.0370981189488455e-15
EarlyStopping counter: 32 out of 100
Updating learning rate to 3.5185490594744227e-15
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.7592745297372114e-15
EarlyStopping counter: 34 out of 100
Updating learning rate to 8.796372648686057e-16
EarlyStopping counter: 35 out of 100
Updating learning rate to 4.3981863243430284e-16
Validation loss decreased (0.024579 --> 0.024467).  Saving model ...
Updating learning rate to 2.1990931621715142e-16
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0995465810857571e-16
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.4977329054287855e-17
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7488664527143928e-17
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3744332263571964e-17
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.872166131785982e-18
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.436083065892991e-18
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.7180415329464955e-18
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.590207664732477e-19
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.2951038323662387e-19
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.1475519161831193e-19
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.0737759580915597e-19
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.3688797904577983e-20
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.6844398952288992e-20
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.3422199476144496e-20
EarlyStopping counter: 15 out of 100
Updating learning rate to 6.711099738072248e-21
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.355549869036124e-21
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.677774934518062e-21
EarlyStopping counter: 18 out of 100
Updating learning rate to 8.38887467259031e-22
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.194437336295155e-22
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.0972186681475775e-22
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.0486093340737887e-22
EarlyStopping counter: 22 out of 100
Updating learning rate to 5.2430466703689437e-23
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.6215233351844719e-23
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.3107616675922359e-23
EarlyStopping counter: 25 out of 100
Updating learning rate to 6.5538083379611796e-24
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.2769041689805898e-24
Validation loss decreased (0.024467 --> 0.024459).  Saving model ...
Updating learning rate to 1.6384520844902949e-24
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.1922604224514745e-25
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.0961302112257373e-25
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0480651056128686e-25
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0240325528064343e-25
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.1201627640321716e-26
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.5600813820160858e-26
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.2800406910080429e-26
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.4002034550402145e-27
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.2001017275201072e-27
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.6000508637600536e-27
EarlyStopping counter: 11 out of 100
Updating learning rate to 8.000254318800268e-28
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.000127159400134e-28
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.000063579700067e-28
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.0000317898500335e-28
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.0001589492501676e-29
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.5000794746250838e-29
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.2500397373125419e-29
EarlyStopping counter: 18 out of 100
Updating learning rate to 6.2501986865627095e-30
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.1250993432813547e-30
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.5625496716406774e-30
EarlyStopping counter: 21 out of 100
Updating learning rate to 7.812748358203387e-31
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.9063741791016934e-31
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.9531870895508467e-31
EarlyStopping counter: 24 out of 100
Updating learning rate to 9.765935447754234e-32
EarlyStopping counter: 25 out of 100
Updating learning rate to 4.882967723877117e-32
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.4414838619385584e-32
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.2207419309692792e-32
EarlyStopping counter: 28 out of 100
Updating learning rate to 6.103709654846396e-33
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.051854827423198e-33
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.525927413711599e-33
EarlyStopping counter: 31 out of 100
Updating learning rate to 7.629637068557995e-34
EarlyStopping counter: 32 out of 100
Updating learning rate to 3.8148185342789975e-34
>>>>>> Testing on validation set: trial_23 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.04971066862344742, mae:0.07384121417999268, dtw:Not calculated


                                                                                         [I 2025-10-17 02:53:49,197] Trial 23 finished with value: 0.07384121417999268 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 2, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.00024179285023702727, 'dropout': 0.11847701818869072}. Best is trial 14 with value: 0.07120024412870407.
Best trial: 14. Best value: 0.0712002:  46%|████▌     | 23/50 [56:39<1:11:04, 157.96s/it]Best trial: 14. Best value: 0.0712002:  46%|████▌     | 23/50 [56:40<1:11:04, 157.96s/it]Best trial: 14. Best value: 0.0712002:  48%|████▊     | 24/50 [56:40<1:05:25, 150.97s/it]
============================================================
Trial 24
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000623
dropout: 0.16004141658600954
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_24 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.025208).  Saving model ...
Updating learning rate to 0.0006234665089951519
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00031173325449757597
Validation loss decreased (0.025208 --> 0.024896).  Saving model ...
Updating learning rate to 0.00015586662724878799
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.793331362439399e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.8966656812196997e-05
Validation loss decreased (0.024896 --> 0.024705).  Saving model ...
Updating learning rate to 1.9483328406098498e-05
Validation loss decreased (0.024705 --> 0.024631).  Saving model ...
Updating learning rate to 9.741664203049249e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.8708321015246246e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.4354160507623123e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2177080253811561e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.088540126905781e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.0442700634528904e-07
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.5221350317264452e-07
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.610675158632226e-08
Validation loss decreased (0.024631 --> 0.024499).  Saving model ...
Updating learning rate to 3.805337579316113e-08
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.9026687896580565e-08
Validation loss decreased (0.024499 --> 0.024489).  Saving model ...
Updating learning rate to 9.513343948290282e-09
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.756671974145141e-09
Validation loss decreased (0.024489 --> 0.024084).  Saving model ...
Updating learning rate to 2.3783359870725706e-09
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1891679935362853e-09
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.945839967681426e-10
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.972919983840713e-10
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4864599919203566e-10
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.432299959601783e-11
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.7161499798008915e-11
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8580749899004458e-11
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.290374949502229e-12
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.6451874747511144e-12
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.3225937373755572e-12
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.1612968686877786e-12
Validation loss decreased (0.024084 --> 0.023989).  Saving model ...
Updating learning rate to 5.806484343438893e-13
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.9032421717194465e-13
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4516210858597233e-13
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.258105429298616e-14
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.629052714649308e-14
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.814526357324654e-14
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.07263178662327e-15
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.536315893311635e-15
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.2681579466558176e-15
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.1340789733279088e-15
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.670394866639544e-16
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.835197433319772e-16
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.417598716659886e-16
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.08799358329943e-17
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.543996791649715e-17
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.7719983958248575e-17
EarlyStopping counter: 16 out of 100
Updating learning rate to 8.859991979124287e-18
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.429995989562144e-18
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.214997994781072e-18
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.107498997390536e-18
EarlyStopping counter: 20 out of 100
Updating learning rate to 5.53749498695268e-19
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.76874749347634e-19
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.38437374673817e-19
EarlyStopping counter: 23 out of 100
Updating learning rate to 6.92186873369085e-20
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.460934366845425e-20
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.7304671834227124e-20
EarlyStopping counter: 26 out of 100
Updating learning rate to 8.652335917113562e-21
EarlyStopping counter: 27 out of 100
Updating learning rate to 4.326167958556781e-21
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.1630839792783905e-21
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.0815419896391952e-21
EarlyStopping counter: 30 out of 100
Updating learning rate to 5.407709948195976e-22
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.703854974097988e-22
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.351927487048994e-22
EarlyStopping counter: 33 out of 100
Updating learning rate to 6.75963743524497e-23
EarlyStopping counter: 34 out of 100
Updating learning rate to 3.379818717622485e-23
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.6899093588112426e-23
Validation loss decreased (0.023989 --> 0.023902).  Saving model ...
Updating learning rate to 8.449546794056213e-24
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.2247733970281064e-24
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.1123866985140532e-24
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0561933492570266e-24
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.280966746285133e-25
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.6404833731425665e-25
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3202416865712833e-25
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.601208432856416e-26
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.300604216428208e-26
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.650302108214104e-26
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.25151054107052e-27
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.12575527053526e-27
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.06287763526763e-27
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.031438817633815e-27
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.157194088169075e-28
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.5785970440845376e-28
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.2892985220422688e-28
EarlyStopping counter: 17 out of 100
Updating learning rate to 6.446492610211344e-29
Validation loss decreased (0.023902 --> 0.023851).  Saving model ...
Updating learning rate to 3.223246305105672e-29
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.611623152552836e-29
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.05811576276418e-30
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.02905788138209e-30
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.014528940691045e-30
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0072644703455225e-30
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.0363223517276125e-31
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.5181611758638063e-31
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.2590805879319031e-31
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.295402939659516e-32
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.147701469829758e-32
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.573850734914879e-32
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.869253674574395e-33
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.934626837287197e-33
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.9673134186435987e-33
EarlyStopping counter: 15 out of 100
Updating learning rate to 9.836567093217993e-34
>>>>>> Testing on validation set: trial_24 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.04986637830734253, mae:0.07182393223047256, dtw:Not calculated


                                                                                         [I 2025-10-17 02:56:03,608] Trial 24 finished with value: 0.07182393223047256 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 2, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0006234665089951519, 'dropout': 0.16004141658600954}. Best is trial 14 with value: 0.07120024412870407.
Best trial: 14. Best value: 0.0712002:  48%|████▊     | 24/50 [58:54<1:05:25, 150.97s/it]Best trial: 14. Best value: 0.0712002:  48%|████▊     | 24/50 [58:54<1:05:25, 150.97s/it]Best trial: 14. Best value: 0.0712002:  50%|█████     | 25/50 [58:54<1:00:50, 146.01s/it]
============================================================
Trial 25
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000178
dropout: 0.07313688118352858
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_25 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.028959).  Saving model ...
Updating learning rate to 0.00017821291966520407
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.910645983260203e-05
Validation loss decreased (0.028959 --> 0.025106).  Saving model ...
Updating learning rate to 4.4553229916301016e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2276614958150508e-05
Validation loss decreased (0.025106 --> 0.024604).  Saving model ...
Updating learning rate to 1.1138307479075254e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.569153739537627e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7845768697688135e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3922884348844068e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.961442174422034e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.480721087211017e-07
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.7403605436055084e-07
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.701802718027542e-08
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.350901359013771e-08
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.1754506795068856e-08
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.0877253397534428e-08
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.438626698767214e-09
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.719313349383607e-09
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.3596566746918035e-09
EarlyStopping counter: 14 out of 100
Updating learning rate to 6.798283373459017e-10
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.3991416867295087e-10
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.6995708433647543e-10
EarlyStopping counter: 17 out of 100
Updating learning rate to 8.497854216823772e-11
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.248927108411886e-11
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.124463554205943e-11
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.0622317771029715e-11
EarlyStopping counter: 21 out of 100
Updating learning rate to 5.311158885514857e-12
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.6555794427574287e-12
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.3277897213787143e-12
EarlyStopping counter: 24 out of 100
Updating learning rate to 6.638948606893572e-13
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.319474303446786e-13
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.659737151723393e-13
Validation loss decreased (0.024604 --> 0.024456).  Saving model ...
Updating learning rate to 8.298685758616965e-14
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.149342879308482e-14
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.074671439654241e-14
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0373357198271206e-14
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.186678599135603e-15
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.5933392995678014e-15
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.2966696497839007e-15
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.483348248919504e-16
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.241674124459752e-16
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.620837062229876e-16
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.10418531114938e-17
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.05209265557469e-17
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.026046327787345e-17
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.0130231638936724e-17
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.065115819468362e-18
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.532557909734181e-18
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.2662789548670905e-18
EarlyStopping counter: 17 out of 100
Updating learning rate to 6.331394774335453e-19
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.1656973871677264e-19
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.5828486935838632e-19
EarlyStopping counter: 20 out of 100
Updating learning rate to 7.914243467919316e-20
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.957121733959658e-20
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.978560866979829e-20
EarlyStopping counter: 23 out of 100
Updating learning rate to 9.892804334899145e-21
EarlyStopping counter: 24 out of 100
Updating learning rate to 4.9464021674495724e-21
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.4732010837247862e-21
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.2366005418623931e-21
EarlyStopping counter: 27 out of 100
Updating learning rate to 6.183002709311966e-22
EarlyStopping counter: 28 out of 100
Updating learning rate to 3.091501354655983e-22
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.5457506773279914e-22
EarlyStopping counter: 30 out of 100
Updating learning rate to 7.728753386639957e-23
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.8643766933199785e-23
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.9321883466599892e-23
EarlyStopping counter: 33 out of 100
Updating learning rate to 9.660941733299946e-24
EarlyStopping counter: 34 out of 100
Updating learning rate to 4.830470866649973e-24
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.4152354333249865e-24
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.2076177166624933e-24
EarlyStopping counter: 37 out of 100
Updating learning rate to 6.038088583312466e-25
EarlyStopping counter: 38 out of 100
Updating learning rate to 3.019044291656233e-25
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.5095221458281166e-25
EarlyStopping counter: 40 out of 100
Updating learning rate to 7.547610729140583e-26
EarlyStopping counter: 41 out of 100
Updating learning rate to 3.7738053645702915e-26
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.8869026822851457e-26
EarlyStopping counter: 43 out of 100
Updating learning rate to 9.434513411425729e-27
EarlyStopping counter: 44 out of 100
Updating learning rate to 4.717256705712864e-27
EarlyStopping counter: 45 out of 100
Updating learning rate to 2.358628352856432e-27
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.179314176428216e-27
EarlyStopping counter: 47 out of 100
Updating learning rate to 5.89657088214108e-28
EarlyStopping counter: 48 out of 100
Updating learning rate to 2.94828544107054e-28
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.47414272053527e-28
EarlyStopping counter: 50 out of 100
Updating learning rate to 7.37071360267635e-29
EarlyStopping counter: 51 out of 100
Updating learning rate to 3.685356801338175e-29
EarlyStopping counter: 52 out of 100
Updating learning rate to 1.8426784006690876e-29
EarlyStopping counter: 53 out of 100
Updating learning rate to 9.213392003345438e-30
EarlyStopping counter: 54 out of 100
Updating learning rate to 4.606696001672719e-30
EarlyStopping counter: 55 out of 100
Updating learning rate to 2.3033480008363595e-30
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.1516740004181798e-30
EarlyStopping counter: 57 out of 100
Updating learning rate to 5.758370002090899e-31
EarlyStopping counter: 58 out of 100
Updating learning rate to 2.8791850010454494e-31
EarlyStopping counter: 59 out of 100
Updating learning rate to 1.4395925005227247e-31
EarlyStopping counter: 60 out of 100
Updating learning rate to 7.197962502613624e-32
EarlyStopping counter: 61 out of 100
Updating learning rate to 3.598981251306812e-32
EarlyStopping counter: 62 out of 100
Updating learning rate to 1.799490625653406e-32
EarlyStopping counter: 63 out of 100
Updating learning rate to 8.99745312826703e-33
EarlyStopping counter: 64 out of 100
Updating learning rate to 4.498726564133515e-33
EarlyStopping counter: 65 out of 100
Updating learning rate to 2.2493632820667574e-33
EarlyStopping counter: 66 out of 100
Updating learning rate to 1.1246816410333787e-33
EarlyStopping counter: 67 out of 100
Updating learning rate to 5.623408205166893e-34
EarlyStopping counter: 68 out of 100
Updating learning rate to 2.8117041025834467e-34
>>>>>> Testing on validation set: trial_25 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.05038987845182419, mae:0.07498238980770111, dtw:Not calculated


                                                                                         [I 2025-10-17 02:58:18,079] Trial 25 finished with value: 0.07498238980770111 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 2, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.00017821291966520407, 'dropout': 0.07313688118352858}. Best is trial 14 with value: 0.07120024412870407.
Best trial: 14. Best value: 0.0712002:  50%|█████     | 25/50 [1:01:08<1:00:50, 146.01s/it]Best trial: 14. Best value: 0.0712002:  50%|█████     | 25/50 [1:01:08<1:00:50, 146.01s/it]Best trial: 14. Best value: 0.0712002:  52%|█████▏    | 26/50 [1:01:08<57:01, 142.54s/it]  
============================================================
Trial 26
============================================================
seq_len: 48, pred_len: 30
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000337
dropout: 0.19523704578542228
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_26 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 30
============================================================
train 4596
val 230
test 232
Validation loss decreased (inf --> 0.037025).  Saving model ...
Updating learning rate to 0.0003373459036356701
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00016867295181783505
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.433647590891753e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.216823795445876e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.108411897722938e-05
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.054205948861469e-05
Validation loss decreased (0.037025 --> 0.036002).  Saving model ...
Updating learning rate to 5.271029744307345e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.6355148721536727e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3177574360768363e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.588787180384182e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.294393590192091e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6471967950960454e-07
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.235983975480227e-08
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.1179919877401136e-08
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0589959938700568e-08
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.0294979969350284e-08
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.147489984675142e-09
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.573744992337571e-09
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.2868724961687855e-09
EarlyStopping counter: 13 out of 100
Updating learning rate to 6.434362480843927e-10
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.217181240421964e-10
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.608590620210982e-10
EarlyStopping counter: 16 out of 100
Updating learning rate to 8.04295310105491e-11
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.021476550527455e-11
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.0107382752637273e-11
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.0053691376318637e-11
EarlyStopping counter: 20 out of 100
Updating learning rate to 5.026845688159318e-12
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.513422844079659e-12
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.2567114220398296e-12
EarlyStopping counter: 23 out of 100
Updating learning rate to 6.283557110199148e-13
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.141778555099574e-13
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.570889277549787e-13
EarlyStopping counter: 26 out of 100
Updating learning rate to 7.854446387748935e-14
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.9272231938744675e-14
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.9636115969372337e-14
EarlyStopping counter: 29 out of 100
Updating learning rate to 9.818057984686169e-15
EarlyStopping counter: 30 out of 100
Updating learning rate to 4.909028992343084e-15
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.454514496171542e-15
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.227257248085771e-15
EarlyStopping counter: 33 out of 100
Updating learning rate to 6.136286240428855e-16
EarlyStopping counter: 34 out of 100
Updating learning rate to 3.0681431202144277e-16
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.5340715601072139e-16
EarlyStopping counter: 36 out of 100
Updating learning rate to 7.670357800536069e-17
EarlyStopping counter: 37 out of 100
Updating learning rate to 3.8351789002680346e-17
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.9175894501340173e-17
EarlyStopping counter: 39 out of 100
Updating learning rate to 9.587947250670087e-18
EarlyStopping counter: 40 out of 100
Updating learning rate to 4.793973625335043e-18
EarlyStopping counter: 41 out of 100
Updating learning rate to 2.3969868126675216e-18
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.1984934063337608e-18
EarlyStopping counter: 43 out of 100
Updating learning rate to 5.992467031668804e-19
EarlyStopping counter: 44 out of 100
Updating learning rate to 2.996233515834402e-19
EarlyStopping counter: 45 out of 100
Updating learning rate to 1.498116757917201e-19
EarlyStopping counter: 46 out of 100
Updating learning rate to 7.490583789586005e-20
EarlyStopping counter: 47 out of 100
Updating learning rate to 3.7452918947930026e-20
EarlyStopping counter: 48 out of 100
Updating learning rate to 1.8726459473965013e-20
EarlyStopping counter: 49 out of 100
Updating learning rate to 9.363229736982506e-21
EarlyStopping counter: 50 out of 100
Updating learning rate to 4.681614868491253e-21
EarlyStopping counter: 51 out of 100
Updating learning rate to 2.3408074342456266e-21
EarlyStopping counter: 52 out of 100
Updating learning rate to 1.1704037171228133e-21
EarlyStopping counter: 53 out of 100
Updating learning rate to 5.8520185856140665e-22
EarlyStopping counter: 54 out of 100
Updating learning rate to 2.9260092928070333e-22
EarlyStopping counter: 55 out of 100
Updating learning rate to 1.4630046464035166e-22
EarlyStopping counter: 56 out of 100
Updating learning rate to 7.315023232017583e-23
EarlyStopping counter: 57 out of 100
Updating learning rate to 3.6575116160087916e-23
EarlyStopping counter: 58 out of 100
Updating learning rate to 1.8287558080043958e-23
EarlyStopping counter: 59 out of 100
Updating learning rate to 9.143779040021979e-24
EarlyStopping counter: 60 out of 100
Updating learning rate to 4.5718895200109895e-24
EarlyStopping counter: 61 out of 100
Updating learning rate to 2.2859447600054947e-24
EarlyStopping counter: 62 out of 100
Updating learning rate to 1.1429723800027474e-24
EarlyStopping counter: 63 out of 100
Updating learning rate to 5.714861900013737e-25
EarlyStopping counter: 64 out of 100
Updating learning rate to 2.8574309500068684e-25
EarlyStopping counter: 65 out of 100
Updating learning rate to 1.4287154750034342e-25
EarlyStopping counter: 66 out of 100
Updating learning rate to 7.143577375017171e-26
EarlyStopping counter: 67 out of 100
Updating learning rate to 3.5717886875085855e-26
EarlyStopping counter: 68 out of 100
Updating learning rate to 1.7858943437542928e-26
EarlyStopping counter: 69 out of 100
Updating learning rate to 8.929471718771464e-27
EarlyStopping counter: 70 out of 100
Updating learning rate to 4.464735859385732e-27
EarlyStopping counter: 71 out of 100
Updating learning rate to 2.232367929692866e-27
EarlyStopping counter: 72 out of 100
Updating learning rate to 1.116183964846433e-27
EarlyStopping counter: 73 out of 100
Updating learning rate to 5.580919824232165e-28
EarlyStopping counter: 74 out of 100
Updating learning rate to 2.7904599121160824e-28
EarlyStopping counter: 75 out of 100
Updating learning rate to 1.3952299560580412e-28
EarlyStopping counter: 76 out of 100
Updating learning rate to 6.976149780290206e-29
EarlyStopping counter: 77 out of 100
Updating learning rate to 3.488074890145103e-29
EarlyStopping counter: 78 out of 100
Updating learning rate to 1.7440374450725515e-29
EarlyStopping counter: 79 out of 100
Updating learning rate to 8.720187225362758e-30
EarlyStopping counter: 80 out of 100
Updating learning rate to 4.360093612681379e-30
EarlyStopping counter: 81 out of 100
Updating learning rate to 2.1800468063406894e-30
EarlyStopping counter: 82 out of 100
Updating learning rate to 1.0900234031703447e-30
EarlyStopping counter: 83 out of 100
Updating learning rate to 5.4501170158517235e-31
EarlyStopping counter: 84 out of 100
Updating learning rate to 2.7250585079258618e-31
EarlyStopping counter: 85 out of 100
Updating learning rate to 1.3625292539629309e-31
EarlyStopping counter: 86 out of 100
Updating learning rate to 6.812646269814654e-32
EarlyStopping counter: 87 out of 100
Updating learning rate to 3.406323134907327e-32
EarlyStopping counter: 88 out of 100
Updating learning rate to 1.7031615674536636e-32
EarlyStopping counter: 89 out of 100
Updating learning rate to 8.515807837268318e-33
EarlyStopping counter: 90 out of 100
Updating learning rate to 4.257903918634159e-33
EarlyStopping counter: 91 out of 100
Updating learning rate to 2.1289519593170795e-33
EarlyStopping counter: 92 out of 100
Updating learning rate to 1.0644759796585397e-33
EarlyStopping counter: 93 out of 100
Updating learning rate to 5.322379898292699e-34
>>>>>> Testing on validation set: trial_26 >>>>>>
test 232
test shape: (232, 30, 5) (232, 30, 5)
test shape: (232, 30, 5) (232, 30, 5)


	mse:0.07747763395309448, mae:0.11146961152553558, dtw:Not calculated


                                                                                         [I 2025-10-17 03:00:31,640] Trial 26 finished with value: 0.11146961152553558 and parameters: {'seq_len': 48, 'pred_len': 30, 'expand': 2, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0003373459036356701, 'dropout': 0.19523704578542228}. Best is trial 14 with value: 0.07120024412870407.
Best trial: 14. Best value: 0.0712002:  52%|█████▏    | 26/50 [1:03:22<57:01, 142.54s/it]Best trial: 14. Best value: 0.0712002:  52%|█████▏    | 26/50 [1:03:22<57:01, 142.54s/it]Best trial: 14. Best value: 0.0712002:  54%|█████▍    | 27/50 [1:03:22<53:36, 139.85s/it]
============================================================
Trial 27
============================================================
seq_len: 48, pred_len: 7
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000741
dropout: 0.11901878991761566
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_27 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 7
============================================================
train 4619
val 253
test 255
Validation loss decreased (inf --> 0.038184).  Saving model ...
Updating learning rate to 0.0007413609143600442
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0003706804571800221
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.00018534022859001105
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.267011429500553e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.633505714750276e-05
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.316752857375138e-05
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.158376428687569e-05
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.791882143437845e-06
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.8959410717189227e-06
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4479705358594614e-06
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.239852679297307e-07
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.6199263396486534e-07
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.8099631698243267e-07
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.049815849121633e-08
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.524907924560817e-08
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.2624539622804084e-08
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.1312269811402042e-08
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.656134905701021e-09
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.8280674528505105e-09
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.4140337264252552e-09
EarlyStopping counter: 20 out of 100
Updating learning rate to 7.070168632126276e-10
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.535084316063138e-10
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.767542158031569e-10
EarlyStopping counter: 23 out of 100
Updating learning rate to 8.837710790157845e-11
EarlyStopping counter: 24 out of 100
Updating learning rate to 4.4188553950789226e-11
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.2094276975394613e-11
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.1047138487697306e-11
EarlyStopping counter: 27 out of 100
Updating learning rate to 5.523569243848653e-12
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.7617846219243266e-12
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.3808923109621633e-12
EarlyStopping counter: 30 out of 100
Updating learning rate to 6.904461554810817e-13
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.4522307774054083e-13
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.7261153887027041e-13
EarlyStopping counter: 33 out of 100
Updating learning rate to 8.630576943513521e-14
EarlyStopping counter: 34 out of 100
Updating learning rate to 4.3152884717567603e-14
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.1576442358783802e-14
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.0788221179391901e-14
EarlyStopping counter: 37 out of 100
Updating learning rate to 5.3941105896959504e-15
EarlyStopping counter: 38 out of 100
Updating learning rate to 2.6970552948479752e-15
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.3485276474239876e-15
EarlyStopping counter: 40 out of 100
Updating learning rate to 6.742638237119938e-16
EarlyStopping counter: 41 out of 100
Updating learning rate to 3.371319118559969e-16
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.6856595592799845e-16
EarlyStopping counter: 43 out of 100
Updating learning rate to 8.428297796399923e-17
EarlyStopping counter: 44 out of 100
Updating learning rate to 4.214148898199961e-17
EarlyStopping counter: 45 out of 100
Updating learning rate to 2.1070744490999806e-17
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.0535372245499903e-17
EarlyStopping counter: 47 out of 100
Updating learning rate to 5.2676861227499516e-18
EarlyStopping counter: 48 out of 100
Updating learning rate to 2.6338430613749758e-18
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.3169215306874879e-18
EarlyStopping counter: 50 out of 100
Updating learning rate to 6.584607653437439e-19
EarlyStopping counter: 51 out of 100
Updating learning rate to 3.2923038267187197e-19
EarlyStopping counter: 52 out of 100
Updating learning rate to 1.6461519133593599e-19
EarlyStopping counter: 53 out of 100
Updating learning rate to 8.230759566796799e-20
EarlyStopping counter: 54 out of 100
Updating learning rate to 4.1153797833983997e-20
EarlyStopping counter: 55 out of 100
Updating learning rate to 2.0576898916991998e-20
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.0288449458495999e-20
EarlyStopping counter: 57 out of 100
Updating learning rate to 5.1442247292479996e-21
EarlyStopping counter: 58 out of 100
Updating learning rate to 2.5721123646239998e-21
EarlyStopping counter: 59 out of 100
Updating learning rate to 1.2860561823119999e-21
EarlyStopping counter: 60 out of 100
Updating learning rate to 6.4302809115599995e-22
EarlyStopping counter: 61 out of 100
Updating learning rate to 3.2151404557799997e-22
EarlyStopping counter: 62 out of 100
Updating learning rate to 1.6075702278899999e-22
EarlyStopping counter: 63 out of 100
Updating learning rate to 8.037851139449999e-23
EarlyStopping counter: 64 out of 100
Updating learning rate to 4.0189255697249997e-23
EarlyStopping counter: 65 out of 100
Updating learning rate to 2.0094627848624998e-23
EarlyStopping counter: 66 out of 100
Updating learning rate to 1.0047313924312499e-23
EarlyStopping counter: 67 out of 100
Updating learning rate to 5.0236569621562496e-24
EarlyStopping counter: 68 out of 100
Updating learning rate to 2.5118284810781248e-24
EarlyStopping counter: 69 out of 100
Updating learning rate to 1.2559142405390624e-24
EarlyStopping counter: 70 out of 100
Updating learning rate to 6.279571202695312e-25
EarlyStopping counter: 71 out of 100
Updating learning rate to 3.139785601347656e-25
EarlyStopping counter: 72 out of 100
Updating learning rate to 1.569892800673828e-25
EarlyStopping counter: 73 out of 100
Updating learning rate to 7.84946400336914e-26
EarlyStopping counter: 74 out of 100
Updating learning rate to 3.92473200168457e-26
EarlyStopping counter: 75 out of 100
Updating learning rate to 1.962366000842285e-26
EarlyStopping counter: 76 out of 100
Updating learning rate to 9.811830004211425e-27
EarlyStopping counter: 77 out of 100
Updating learning rate to 4.9059150021057125e-27
EarlyStopping counter: 78 out of 100
Updating learning rate to 2.4529575010528563e-27
EarlyStopping counter: 79 out of 100
Updating learning rate to 1.2264787505264281e-27
EarlyStopping counter: 80 out of 100
Updating learning rate to 6.132393752632141e-28
EarlyStopping counter: 81 out of 100
Updating learning rate to 3.0661968763160703e-28
EarlyStopping counter: 82 out of 100
Updating learning rate to 1.5330984381580352e-28
EarlyStopping counter: 83 out of 100
Updating learning rate to 7.665492190790176e-29
EarlyStopping counter: 84 out of 100
Updating learning rate to 3.832746095395088e-29
EarlyStopping counter: 85 out of 100
Updating learning rate to 1.916373047697544e-29
EarlyStopping counter: 86 out of 100
Updating learning rate to 9.58186523848772e-30
EarlyStopping counter: 87 out of 100
Updating learning rate to 4.79093261924386e-30
EarlyStopping counter: 88 out of 100
Updating learning rate to 2.39546630962193e-30
EarlyStopping counter: 89 out of 100
Updating learning rate to 1.197733154810965e-30
EarlyStopping counter: 90 out of 100
Updating learning rate to 5.988665774054825e-31
EarlyStopping counter: 91 out of 100
Updating learning rate to 2.9943328870274124e-31
EarlyStopping counter: 92 out of 100
Updating learning rate to 1.4971664435137062e-31
EarlyStopping counter: 93 out of 100
Updating learning rate to 7.485832217568531e-32
EarlyStopping counter: 94 out of 100
Updating learning rate to 3.7429161087842655e-32
EarlyStopping counter: 95 out of 100
Updating learning rate to 1.8714580543921328e-32
EarlyStopping counter: 96 out of 100
Updating learning rate to 9.357290271960664e-33
EarlyStopping counter: 97 out of 100
Updating learning rate to 4.678645135980332e-33
EarlyStopping counter: 98 out of 100
Updating learning rate to 2.339322567990166e-33
EarlyStopping counter: 99 out of 100
Updating learning rate to 1.169661283995083e-33
>>>>>> Testing on validation set: trial_27 >>>>>>
test 255
test shape: (255, 7, 5) (255, 7, 5)
test shape: (255, 7, 5) (255, 7, 5)


	mse:0.06477507948875427, mae:0.09745178371667862, dtw:Not calculated


                                                                                         [I 2025-10-17 03:02:45,421] Trial 27 finished with value: 0.09745178371667862 and parameters: {'seq_len': 48, 'pred_len': 7, 'expand': 2, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0007413609143600442, 'dropout': 0.11901878991761566}. Best is trial 14 with value: 0.07120024412870407.
Best trial: 14. Best value: 0.0712002:  54%|█████▍    | 27/50 [1:05:36<53:36, 139.85s/it]Best trial: 14. Best value: 0.0712002:  54%|█████▍    | 27/50 [1:05:36<53:36, 139.85s/it]Best trial: 14. Best value: 0.0712002:  56%|█████▌    | 28/50 [1:05:36<50:36, 138.03s/it]
============================================================
Trial 28
============================================================
seq_len: 48, pred_len: 14
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000514
dropout: 0.0027962242935478943
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_28 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 14
============================================================
train 4612
val 246
test 248
Validation loss decreased (inf --> 0.040255).  Saving model ...
Updating learning rate to 0.0005138151934896654
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0002569075967448327
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.00012845379837241635
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.422689918620818e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.211344959310409e-05
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6056724796552044e-05
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.028362398276022e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.014181199138011e-06
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0070905995690055e-06
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.0035452997845028e-06
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.017726498922514e-07
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.508863249461257e-07
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.2544316247306284e-07
EarlyStopping counter: 13 out of 100
Updating learning rate to 6.272158123653142e-08
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.136079061826571e-08
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.5680395309132856e-08
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.840197654566428e-09
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.920098827283214e-09
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.960049413641607e-09
EarlyStopping counter: 19 out of 100
Updating learning rate to 9.800247068208035e-10
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.900123534104017e-10
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.4500617670520087e-10
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.2250308835260043e-10
EarlyStopping counter: 23 out of 100
Updating learning rate to 6.125154417630022e-11
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.062577208815011e-11
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.5312886044075054e-11
EarlyStopping counter: 26 out of 100
Updating learning rate to 7.656443022037527e-12
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.8282215110187636e-12
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.9141107555093818e-12
EarlyStopping counter: 29 out of 100
Updating learning rate to 9.570553777546909e-13
EarlyStopping counter: 30 out of 100
Updating learning rate to 4.785276888773454e-13
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.392638444386727e-13
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.1963192221933636e-13
EarlyStopping counter: 33 out of 100
Updating learning rate to 5.981596110966818e-14
EarlyStopping counter: 34 out of 100
Updating learning rate to 2.990798055483409e-14
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.4953990277417045e-14
EarlyStopping counter: 36 out of 100
Updating learning rate to 7.476995138708523e-15
EarlyStopping counter: 37 out of 100
Updating learning rate to 3.738497569354261e-15
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.8692487846771306e-15
EarlyStopping counter: 39 out of 100
Updating learning rate to 9.346243923385653e-16
EarlyStopping counter: 40 out of 100
Updating learning rate to 4.673121961692827e-16
EarlyStopping counter: 41 out of 100
Updating learning rate to 2.3365609808464133e-16
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.1682804904232067e-16
EarlyStopping counter: 43 out of 100
Updating learning rate to 5.841402452116033e-17
EarlyStopping counter: 44 out of 100
Updating learning rate to 2.9207012260580166e-17
EarlyStopping counter: 45 out of 100
Updating learning rate to 1.4603506130290083e-17
EarlyStopping counter: 46 out of 100
Updating learning rate to 7.301753065145042e-18
EarlyStopping counter: 47 out of 100
Updating learning rate to 3.650876532572521e-18
EarlyStopping counter: 48 out of 100
Updating learning rate to 1.8254382662862604e-18
EarlyStopping counter: 49 out of 100
Updating learning rate to 9.127191331431302e-19
EarlyStopping counter: 50 out of 100
Updating learning rate to 4.563595665715651e-19
EarlyStopping counter: 51 out of 100
Updating learning rate to 2.2817978328578255e-19
EarlyStopping counter: 52 out of 100
Updating learning rate to 1.1408989164289127e-19
EarlyStopping counter: 53 out of 100
Updating learning rate to 5.704494582144564e-20
EarlyStopping counter: 54 out of 100
Updating learning rate to 2.852247291072282e-20
EarlyStopping counter: 55 out of 100
Updating learning rate to 1.426123645536141e-20
EarlyStopping counter: 56 out of 100
Updating learning rate to 7.130618227680705e-21
EarlyStopping counter: 57 out of 100
Updating learning rate to 3.565309113840352e-21
EarlyStopping counter: 58 out of 100
Updating learning rate to 1.782654556920176e-21
EarlyStopping counter: 59 out of 100
Updating learning rate to 8.91327278460088e-22
EarlyStopping counter: 60 out of 100
Updating learning rate to 4.45663639230044e-22
EarlyStopping counter: 61 out of 100
Updating learning rate to 2.22831819615022e-22
EarlyStopping counter: 62 out of 100
Updating learning rate to 1.11415909807511e-22
EarlyStopping counter: 63 out of 100
Updating learning rate to 5.57079549037555e-23
EarlyStopping counter: 64 out of 100
Updating learning rate to 2.785397745187775e-23
EarlyStopping counter: 65 out of 100
Updating learning rate to 1.3926988725938876e-23
EarlyStopping counter: 66 out of 100
Updating learning rate to 6.963494362969438e-24
EarlyStopping counter: 67 out of 100
Updating learning rate to 3.481747181484719e-24
EarlyStopping counter: 68 out of 100
Updating learning rate to 1.7408735907423595e-24
EarlyStopping counter: 69 out of 100
Updating learning rate to 8.704367953711798e-25
EarlyStopping counter: 70 out of 100
Updating learning rate to 4.352183976855899e-25
EarlyStopping counter: 71 out of 100
Updating learning rate to 2.1760919884279494e-25
EarlyStopping counter: 72 out of 100
Updating learning rate to 1.0880459942139747e-25
EarlyStopping counter: 73 out of 100
Updating learning rate to 5.440229971069874e-26
EarlyStopping counter: 74 out of 100
Updating learning rate to 2.720114985534937e-26
EarlyStopping counter: 75 out of 100
Updating learning rate to 1.3600574927674684e-26
EarlyStopping counter: 76 out of 100
Updating learning rate to 6.800287463837342e-27
EarlyStopping counter: 77 out of 100
Updating learning rate to 3.400143731918671e-27
EarlyStopping counter: 78 out of 100
Updating learning rate to 1.7000718659593355e-27
EarlyStopping counter: 79 out of 100
Updating learning rate to 8.500359329796677e-28
EarlyStopping counter: 80 out of 100
Updating learning rate to 4.250179664898339e-28
EarlyStopping counter: 81 out of 100
Updating learning rate to 2.1250898324491694e-28
EarlyStopping counter: 82 out of 100
Updating learning rate to 1.0625449162245847e-28
EarlyStopping counter: 83 out of 100
Updating learning rate to 5.312724581122923e-29
EarlyStopping counter: 84 out of 100
Updating learning rate to 2.6563622905614617e-29
EarlyStopping counter: 85 out of 100
Updating learning rate to 1.3281811452807308e-29
EarlyStopping counter: 86 out of 100
Updating learning rate to 6.640905726403654e-30
EarlyStopping counter: 87 out of 100
Updating learning rate to 3.320452863201827e-30
EarlyStopping counter: 88 out of 100
Updating learning rate to 1.6602264316009136e-30
EarlyStopping counter: 89 out of 100
Updating learning rate to 8.301132158004568e-31
EarlyStopping counter: 90 out of 100
Updating learning rate to 4.150566079002284e-31
EarlyStopping counter: 91 out of 100
Updating learning rate to 2.075283039501142e-31
EarlyStopping counter: 92 out of 100
Updating learning rate to 1.037641519750571e-31
EarlyStopping counter: 93 out of 100
Updating learning rate to 5.188207598752855e-32
EarlyStopping counter: 94 out of 100
Updating learning rate to 2.5941037993764274e-32
EarlyStopping counter: 95 out of 100
Updating learning rate to 1.2970518996882137e-32
EarlyStopping counter: 96 out of 100
Updating learning rate to 6.485259498441069e-33
EarlyStopping counter: 97 out of 100
Updating learning rate to 3.242629749220534e-33
EarlyStopping counter: 98 out of 100
Updating learning rate to 1.621314874610267e-33
EarlyStopping counter: 99 out of 100
Updating learning rate to 8.106574373051336e-34
>>>>>> Testing on validation set: trial_28 >>>>>>
test 248
test shape: (248, 14, 5) (248, 14, 5)
test shape: (248, 14, 5) (248, 14, 5)


	mse:0.06990189105272293, mae:0.1024751290678978, dtw:Not calculated


                                                                                         [I 2025-10-17 03:04:58,985] Trial 28 finished with value: 0.1024751290678978 and parameters: {'seq_len': 48, 'pred_len': 14, 'expand': 2, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0005138151934896654, 'dropout': 0.0027962242935478943}. Best is trial 14 with value: 0.07120024412870407.
Best trial: 14. Best value: 0.0712002:  56%|█████▌    | 28/50 [1:07:49<50:36, 138.03s/it]Best trial: 14. Best value: 0.0712002:  56%|█████▌    | 28/50 [1:07:49<50:36, 138.03s/it]Best trial: 14. Best value: 0.0712002:  58%|█████▊    | 29/50 [1:07:49<47:50, 136.69s/it]
============================================================
Trial 29
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 16, lr: 0.000041
dropout: 0.1726882347863367
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_29 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.030653).  Saving model ...
Updating learning rate to 4.068630043942117e-05
Validation loss decreased (0.030653 --> 0.028470).  Saving model ...
Updating learning rate to 2.0343150219710584e-05
Validation loss decreased (0.028470 --> 0.027788).  Saving model ...
Updating learning rate to 1.0171575109855292e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.085787554927646e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.542893777463823e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2714468887319115e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.357234443659557e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.1786172218297787e-07
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.5893086109148894e-07
Validation loss decreased (0.027788 --> 0.027382).  Saving model ...
Updating learning rate to 7.946543054574447e-08
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.9732715272872234e-08
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.9866357636436117e-08
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.933178818218059e-09
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.966589409109029e-09
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.4832947045545146e-09
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.2416473522772573e-09
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.208236761386287e-10
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.1041183806931433e-10
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.5520591903465716e-10
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.760295951732858e-11
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.880147975866429e-11
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.9400739879332146e-11
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.700369939666073e-12
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.850184969833036e-12
Validation loss decreased (0.027382 --> 0.027336).  Saving model ...
Updating learning rate to 2.425092484916518e-12
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.212546242458259e-12
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.062731212291295e-13
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.0313656061456477e-13
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5156828030728239e-13
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.578414015364119e-14
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.7892070076820597e-14
Validation loss decreased (0.027336 --> 0.027298).  Saving model ...
Updating learning rate to 1.8946035038410298e-14
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.473017519205149e-15
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.7365087596025746e-15
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.3682543798012873e-15
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1841271899006436e-15
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.920635949503218e-16
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.960317974751609e-16
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4801589873758046e-16
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.400794936879023e-17
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.7003974684395114e-17
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.8501987342197557e-17
EarlyStopping counter: 11 out of 100
Updating learning rate to 9.250993671098778e-18
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.625496835549389e-18
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.3127484177746946e-18
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.1563742088873473e-18
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.781871044436737e-19
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.8909355222183683e-19
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.4454677611091841e-19
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.227338805545921e-20
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.6136694027729604e-20
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.8068347013864802e-20
EarlyStopping counter: 21 out of 100
Updating learning rate to 9.034173506932401e-21
EarlyStopping counter: 22 out of 100
Updating learning rate to 4.5170867534662004e-21
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.2585433767331002e-21
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.1292716883665501e-21
EarlyStopping counter: 25 out of 100
Updating learning rate to 5.646358441832751e-22
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.8231792209163753e-22
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.4115896104581876e-22
EarlyStopping counter: 28 out of 100
Updating learning rate to 7.057948052290938e-23
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.528974026145469e-23
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.7644870130727345e-23
EarlyStopping counter: 31 out of 100
Updating learning rate to 8.822435065363673e-24
EarlyStopping counter: 32 out of 100
Updating learning rate to 4.411217532681836e-24
EarlyStopping counter: 33 out of 100
Updating learning rate to 2.205608766340918e-24
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.102804383170459e-24
EarlyStopping counter: 35 out of 100
Updating learning rate to 5.514021915852295e-25
EarlyStopping counter: 36 out of 100
Updating learning rate to 2.7570109579261477e-25
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.3785054789630739e-25
EarlyStopping counter: 38 out of 100
Updating learning rate to 6.892527394815369e-26
EarlyStopping counter: 39 out of 100
Updating learning rate to 3.4462636974076847e-26
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.7231318487038423e-26
EarlyStopping counter: 41 out of 100
Updating learning rate to 8.615659243519212e-27
EarlyStopping counter: 42 out of 100
Updating learning rate to 4.307829621759606e-27
EarlyStopping counter: 43 out of 100
Updating learning rate to 2.153914810879803e-27
EarlyStopping counter: 44 out of 100
Updating learning rate to 1.0769574054399015e-27
EarlyStopping counter: 45 out of 100
Updating learning rate to 5.384787027199507e-28
EarlyStopping counter: 46 out of 100
Updating learning rate to 2.6923935135997536e-28
EarlyStopping counter: 47 out of 100
Updating learning rate to 1.3461967567998768e-28
EarlyStopping counter: 48 out of 100
Updating learning rate to 6.730983783999384e-29
EarlyStopping counter: 49 out of 100
Updating learning rate to 3.365491891999692e-29
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.682745945999846e-29
EarlyStopping counter: 51 out of 100
Updating learning rate to 8.41372972999923e-30
EarlyStopping counter: 52 out of 100
Updating learning rate to 4.206864864999615e-30
EarlyStopping counter: 53 out of 100
Updating learning rate to 2.1034324324998075e-30
EarlyStopping counter: 54 out of 100
Updating learning rate to 1.0517162162499038e-30
EarlyStopping counter: 55 out of 100
Updating learning rate to 5.258581081249519e-31
Validation loss decreased (0.027298 --> 0.027262).  Saving model ...
Updating learning rate to 2.6292905406247594e-31
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3146452703123797e-31
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.573226351561899e-32
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.286613175780949e-32
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6433065878904746e-32
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.216532939452373e-33
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.1082664697261866e-33
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.0541332348630933e-33
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.0270666174315466e-33
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.135333087157733e-34
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.5676665435788666e-34
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.2838332717894333e-34
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.419166358947167e-35
>>>>>> Testing on validation set: trial_29 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.052996065467596054, mae:0.08362670242786407, dtw:Not calculated


                                                                                         [I 2025-10-17 03:09:23,272] Trial 29 finished with value: 0.08362670242786407 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 2, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 16, 'learning_rate': 4.068630043942117e-05, 'dropout': 0.1726882347863367}. Best is trial 14 with value: 0.07120024412870407.
Best trial: 14. Best value: 0.0712002:  58%|█████▊    | 29/50 [1:12:14<47:50, 136.69s/it]Best trial: 14. Best value: 0.0712002:  58%|█████▊    | 29/50 [1:12:14<47:50, 136.69s/it]Best trial: 14. Best value: 0.0712002:  60%|██████    | 30/50 [1:12:14<58:19, 174.97s/it]
============================================================
Trial 30
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 64, lr: 0.000448
dropout: 0.09453860335337268
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_30 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.022218).  Saving model ...
Updating learning rate to 0.0004475116633810505
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00022375583169052525
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.00011187791584526262
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.593895792263131e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7969478961315656e-05
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3984739480657828e-05
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.992369740328914e-06
Validation loss decreased (0.022218 --> 0.022154).  Saving model ...
Updating learning rate to 3.496184870164457e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.7480924350822285e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.740462175411142e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.370231087705571e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.1851155438527856e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0925577719263928e-07
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.462788859631964e-08
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.731394429815982e-08
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.365697214907991e-08
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.828486074539955e-09
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.4142430372699775e-09
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.7071215186349888e-09
EarlyStopping counter: 12 out of 100
Updating learning rate to 8.535607593174944e-10
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.267803796587472e-10
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.133901898293736e-10
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.066950949146868e-10
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.33475474573434e-11
Validation loss decreased (0.022154 --> 0.021592).  Saving model ...
Updating learning rate to 2.66737737286717e-11
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.333688686433585e-11
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.668443432167925e-12
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.3342217160839624e-12
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6671108580419812e-12
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.335554290209906e-13
Validation loss decreased (0.021592 --> 0.021339).  Saving model ...
Updating learning rate to 4.167777145104953e-13
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0838885725524765e-13
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0419442862762383e-13
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.209721431381191e-14
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.6048607156905957e-14
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3024303578452978e-14
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.512151789226489e-15
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.2560758946132446e-15
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6280379473066223e-15
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.140189736533111e-16
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.0700948682665557e-16
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.0350474341332779e-16
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.0175237170666389e-16
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.0876185853331946e-17
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.5438092926665973e-17
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.2719046463332987e-17
EarlyStopping counter: 16 out of 100
Updating learning rate to 6.359523231666493e-18
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.1797616158332467e-18
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.5898808079166233e-18
EarlyStopping counter: 19 out of 100
Updating learning rate to 7.949404039583117e-19
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.9747020197915583e-19
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.9873510098957792e-19
EarlyStopping counter: 22 out of 100
Updating learning rate to 9.936755049478896e-20
EarlyStopping counter: 23 out of 100
Updating learning rate to 4.968377524739448e-20
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.484188762369724e-20
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.242094381184862e-20
EarlyStopping counter: 26 out of 100
Updating learning rate to 6.21047190592431e-21
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.105235952962155e-21
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.5526179764810775e-21
EarlyStopping counter: 29 out of 100
Updating learning rate to 7.763089882405387e-22
EarlyStopping counter: 30 out of 100
Updating learning rate to 3.8815449412026937e-22
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.9407724706013468e-22
EarlyStopping counter: 32 out of 100
Updating learning rate to 9.703862353006734e-23
EarlyStopping counter: 33 out of 100
Updating learning rate to 4.851931176503367e-23
EarlyStopping counter: 34 out of 100
Updating learning rate to 2.4259655882516835e-23
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.2129827941258418e-23
EarlyStopping counter: 36 out of 100
Updating learning rate to 6.064913970629209e-24
EarlyStopping counter: 37 out of 100
Updating learning rate to 3.0324569853146044e-24
Validation loss decreased (0.021339 --> 0.021272).  Saving model ...
Updating learning rate to 1.5162284926573022e-24
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.581142463286511e-25
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.7905712316432555e-25
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8952856158216278e-25
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.476428079108139e-26
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.7382140395540694e-26
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.3691070197770347e-26
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1845535098885174e-26
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.922767549442587e-27
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.9613837747212934e-27
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.4806918873606467e-27
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.4034594368032335e-28
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.7017297184016167e-28
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.8508648592008084e-28
EarlyStopping counter: 14 out of 100
Updating learning rate to 9.254324296004042e-29
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.627162148002021e-29
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.3135810740010105e-29
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.1567905370005052e-29
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.783952685002526e-30
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.891976342501263e-30
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.4459881712506315e-30
EarlyStopping counter: 21 out of 100
Updating learning rate to 7.229940856253158e-31
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.614970428126579e-31
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.8074852140632894e-31
EarlyStopping counter: 24 out of 100
Updating learning rate to 9.037426070316447e-32
EarlyStopping counter: 25 out of 100
Updating learning rate to 4.5187130351582235e-32
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.2593565175791118e-32
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.1296782587895559e-32
EarlyStopping counter: 28 out of 100
Updating learning rate to 5.6483912939477794e-33
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.8241956469738897e-33
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.4120978234869449e-33
EarlyStopping counter: 31 out of 100
Updating learning rate to 7.060489117434724e-34
>>>>>> Testing on validation set: trial_30 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.05118902772665024, mae:0.07406078279018402, dtw:Not calculated


                                                                                         [I 2025-10-17 03:10:32,319] Trial 30 finished with value: 0.07406078279018402 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 2, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 64, 'learning_rate': 0.0004475116633810505, 'dropout': 0.09453860335337268}. Best is trial 14 with value: 0.07120024412870407.
Best trial: 14. Best value: 0.0712002:  60%|██████    | 30/50 [1:13:23<58:19, 174.97s/it]Best trial: 14. Best value: 0.0712002:  60%|██████    | 30/50 [1:13:23<58:19, 174.97s/it]Best trial: 14. Best value: 0.0712002:  62%|██████▏   | 31/50 [1:13:23<45:20, 143.19s/it]
============================================================
Trial 31
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000713
dropout: 0.1614951733539902
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_31 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.024486).  Saving model ...
Updating learning rate to 0.0007133465844372447
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00035667329221862235
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.00017833664610931118
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.916832305465559e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.4584161527327794e-05
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2292080763663897e-05
Validation loss decreased (0.024486 --> 0.023520).  Saving model ...
Updating learning rate to 1.1146040381831948e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.573020190915974e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.786510095457987e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3932550477289936e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.966275238644968e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.483137619322484e-07
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.741568809661242e-07
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.70784404830621e-08
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.353922024153105e-08
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.1769610120765524e-08
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.0884805060382762e-08
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.442402530191381e-09
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.7212012650956906e-09
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.3606006325478453e-09
EarlyStopping counter: 14 out of 100
Updating learning rate to 6.803003162739226e-10
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.401501581369613e-10
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.7007507906848066e-10
EarlyStopping counter: 17 out of 100
Updating learning rate to 8.503753953424033e-11
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.2518769767120165e-11
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.1259384883560082e-11
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.0629692441780041e-11
EarlyStopping counter: 21 out of 100
Updating learning rate to 5.314846220890021e-12
Validation loss decreased (0.023520 --> 0.023508).  Saving model ...
Updating learning rate to 2.6574231104450103e-12
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3287115552225052e-12
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.643557776112526e-13
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.321778888056263e-13
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6608894440281314e-13
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.304447220140657e-14
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.1522236100703286e-14
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.0761118050351643e-14
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.0380559025175821e-14
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.190279512587911e-15
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.5951397562939554e-15
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.2975698781469777e-15
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.487849390734888e-16
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.243924695367444e-16
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.621962347683722e-16
EarlyStopping counter: 15 out of 100
Updating learning rate to 8.10981173841861e-17
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.054905869209305e-17
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.0274529346046526e-17
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.0137264673023263e-17
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.0686323365116316e-18
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.5343161682558158e-18
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.2671580841279079e-18
EarlyStopping counter: 22 out of 100
Updating learning rate to 6.3357904206395395e-19
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.1678952103197697e-19
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.5839476051598849e-19
EarlyStopping counter: 25 out of 100
Updating learning rate to 7.919738025799424e-20
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.959869012899712e-20
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.979934506449856e-20
EarlyStopping counter: 28 out of 100
Updating learning rate to 9.89967253224928e-21
EarlyStopping counter: 29 out of 100
Updating learning rate to 4.94983626612464e-21
EarlyStopping counter: 30 out of 100
Updating learning rate to 2.47491813306232e-21
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.23745906653116e-21
EarlyStopping counter: 32 out of 100
Updating learning rate to 6.1872953326558e-22
EarlyStopping counter: 33 out of 100
Updating learning rate to 3.0936476663279e-22
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.54682383316395e-22
EarlyStopping counter: 35 out of 100
Updating learning rate to 7.73411916581975e-23
EarlyStopping counter: 36 out of 100
Updating learning rate to 3.867059582909875e-23
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.9335297914549376e-23
EarlyStopping counter: 38 out of 100
Updating learning rate to 9.667648957274688e-24
EarlyStopping counter: 39 out of 100
Updating learning rate to 4.833824478637344e-24
EarlyStopping counter: 40 out of 100
Updating learning rate to 2.416912239318672e-24
EarlyStopping counter: 41 out of 100
Updating learning rate to 1.208456119659336e-24
EarlyStopping counter: 42 out of 100
Updating learning rate to 6.04228059829668e-25
EarlyStopping counter: 43 out of 100
Updating learning rate to 3.02114029914834e-25
EarlyStopping counter: 44 out of 100
Updating learning rate to 1.51057014957417e-25
EarlyStopping counter: 45 out of 100
Updating learning rate to 7.55285074787085e-26
EarlyStopping counter: 46 out of 100
Updating learning rate to 3.776425373935425e-26
EarlyStopping counter: 47 out of 100
Updating learning rate to 1.8882126869677125e-26
EarlyStopping counter: 48 out of 100
Updating learning rate to 9.441063434838562e-27
EarlyStopping counter: 49 out of 100
Updating learning rate to 4.720531717419281e-27
EarlyStopping counter: 50 out of 100
Updating learning rate to 2.3602658587096406e-27
EarlyStopping counter: 51 out of 100
Updating learning rate to 1.1801329293548203e-27
EarlyStopping counter: 52 out of 100
Updating learning rate to 5.9006646467741015e-28
EarlyStopping counter: 53 out of 100
Updating learning rate to 2.9503323233870508e-28
EarlyStopping counter: 54 out of 100
Updating learning rate to 1.4751661616935254e-28
EarlyStopping counter: 55 out of 100
Updating learning rate to 7.375830808467627e-29
EarlyStopping counter: 56 out of 100
Updating learning rate to 3.6879154042338135e-29
EarlyStopping counter: 57 out of 100
Updating learning rate to 1.8439577021169067e-29
EarlyStopping counter: 58 out of 100
Updating learning rate to 9.219788510584534e-30
EarlyStopping counter: 59 out of 100
Updating learning rate to 4.609894255292267e-30
EarlyStopping counter: 60 out of 100
Updating learning rate to 2.3049471276461334e-30
EarlyStopping counter: 61 out of 100
Updating learning rate to 1.1524735638230667e-30
EarlyStopping counter: 62 out of 100
Updating learning rate to 5.7623678191153335e-31
Validation loss decreased (0.023508 --> 0.023499).  Saving model ...
Updating learning rate to 2.8811839095576668e-31
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4405919547788334e-31
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.202959773894167e-32
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.6014798869470835e-32
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8007399434735417e-32
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.003699717367709e-33
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.501849858683854e-33
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.250924929341927e-33
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.1254624646709636e-33
>>>>>> Testing on validation set: trial_31 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.04975418746471405, mae:0.07112950086593628, dtw:Not calculated


                                                                                         [I 2025-10-17 03:12:47,113] Trial 31 finished with value: 0.07112950086593628 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 2, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0007133465844372447, 'dropout': 0.1614951733539902}. Best is trial 31 with value: 0.07112950086593628.
Best trial: 14. Best value: 0.0712002:  62%|██████▏   | 31/50 [1:15:37<45:20, 143.19s/it]Best trial: 31. Best value: 0.0711295:  62%|██████▏   | 31/50 [1:15:38<45:20, 143.19s/it]Best trial: 31. Best value: 0.0711295:  64%|██████▍   | 32/50 [1:15:38<42:12, 140.71s/it]
============================================================
Trial 32
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000762
dropout: 0.1442617693649307
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_32 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.027388).  Saving model ...
Updating learning rate to 0.0007616002666183073
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00038080013330915363
Validation loss decreased (0.027388 --> 0.027035).  Saving model ...
Updating learning rate to 0.00019040006665457682
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.520003332728841e-05
Validation loss decreased (0.027035 --> 0.025520).  Saving model ...
Updating learning rate to 4.7600016663644204e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.3800008331822102e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1900004165911051e-05
Validation loss decreased (0.025520 --> 0.024720).  Saving model ...
Updating learning rate to 5.9500020829555255e-06
Validation loss decreased (0.024720 --> 0.024183).  Saving model ...
Updating learning rate to 2.9750010414777628e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4875005207388814e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.437502603694407e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7187513018472034e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8593756509236017e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.296878254618009e-08
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.648439127309004e-08
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.324219563654502e-08
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.162109781827251e-08
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.810548909136255e-09
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.9052744545681277e-09
Validation loss decreased (0.024183 --> 0.023689).  Saving model ...
Updating learning rate to 1.4526372272840638e-09
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.263186136420319e-10
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.6315930682101596e-10
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8157965341050798e-10
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.078982670525399e-11
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.5394913352626995e-11
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.2697456676313498e-11
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1348728338156749e-11
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.674364169078374e-12
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.837182084539187e-12
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.4185910422695936e-12
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.092955211347968e-13
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.546477605673984e-13
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.773238802836992e-13
EarlyStopping counter: 14 out of 100
Updating learning rate to 8.86619401418496e-14
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.43309700709248e-14
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.21654850354624e-14
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.10827425177312e-14
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.5413712588656e-15
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.7706856294328e-15
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.3853428147164e-15
EarlyStopping counter: 21 out of 100
Updating learning rate to 6.926714073582e-16
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.463357036791e-16
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.7316785183955e-16
EarlyStopping counter: 24 out of 100
Updating learning rate to 8.6583925919775e-17
EarlyStopping counter: 25 out of 100
Updating learning rate to 4.32919629598875e-17
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.164598147994375e-17
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.0822990739971875e-17
EarlyStopping counter: 28 out of 100
Updating learning rate to 5.4114953699859375e-18
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.7057476849929687e-18
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.3528738424964844e-18
EarlyStopping counter: 31 out of 100
Updating learning rate to 6.764369212482422e-19
EarlyStopping counter: 32 out of 100
Updating learning rate to 3.382184606241211e-19
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.6910923031206055e-19
EarlyStopping counter: 34 out of 100
Updating learning rate to 8.455461515603027e-20
Validation loss decreased (0.023689 --> 0.023548).  Saving model ...
Updating learning rate to 4.2277307578015137e-20
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.1138653789007568e-20
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0569326894503784e-20
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.284663447251892e-21
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.642331723625946e-21
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.321165861812973e-21
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.605829309064865e-22
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.3029146545324326e-22
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6514573272662163e-22
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.257286636331081e-23
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.1286433181655407e-23
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.0643216590827703e-23
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.0321608295413852e-23
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.160804147706926e-24
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.580402073853463e-24
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.2902010369267315e-24
EarlyStopping counter: 16 out of 100
Updating learning rate to 6.451005184633657e-25
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.2255025923168287e-25
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.6127512961584143e-25
EarlyStopping counter: 19 out of 100
Updating learning rate to 8.063756480792072e-26
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.031878240396036e-26
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.015939120198018e-26
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.007969560099009e-26
EarlyStopping counter: 23 out of 100
Updating learning rate to 5.039847800495045e-27
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.5199239002475224e-27
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.2599619501237612e-27
EarlyStopping counter: 26 out of 100
Updating learning rate to 6.299809750618806e-28
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.149904875309403e-28
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.5749524376547015e-28
EarlyStopping counter: 29 out of 100
Updating learning rate to 7.874762188273507e-29
EarlyStopping counter: 30 out of 100
Updating learning rate to 3.937381094136754e-29
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.968690547068377e-29
EarlyStopping counter: 32 out of 100
Updating learning rate to 9.843452735341884e-30
EarlyStopping counter: 33 out of 100
Updating learning rate to 4.921726367670942e-30
EarlyStopping counter: 34 out of 100
Updating learning rate to 2.460863183835471e-30
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.2304315919177355e-30
EarlyStopping counter: 36 out of 100
Updating learning rate to 6.152157959588678e-31
EarlyStopping counter: 37 out of 100
Updating learning rate to 3.076078979794339e-31
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.5380394898971694e-31
EarlyStopping counter: 39 out of 100
Updating learning rate to 7.690197449485847e-32
EarlyStopping counter: 40 out of 100
Updating learning rate to 3.8450987247429236e-32
EarlyStopping counter: 41 out of 100
Updating learning rate to 1.9225493623714618e-32
EarlyStopping counter: 42 out of 100
Updating learning rate to 9.612746811857309e-33
EarlyStopping counter: 43 out of 100
Updating learning rate to 4.8063734059286545e-33
EarlyStopping counter: 44 out of 100
Updating learning rate to 2.4031867029643272e-33
EarlyStopping counter: 45 out of 100
Updating learning rate to 1.2015933514821636e-33
>>>>>> Testing on validation set: trial_32 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.05011821165680885, mae:0.07182703912258148, dtw:Not calculated


                                                                                         [I 2025-10-17 03:15:03,191] Trial 32 finished with value: 0.07182703912258148 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 2, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0007616002666183073, 'dropout': 0.1442617693649307}. Best is trial 31 with value: 0.07112950086593628.
Best trial: 31. Best value: 0.0711295:  64%|██████▍   | 32/50 [1:17:53<42:12, 140.71s/it]Best trial: 31. Best value: 0.0711295:  64%|██████▍   | 32/50 [1:17:54<42:12, 140.71s/it]Best trial: 31. Best value: 0.0711295:  66%|██████▌   | 33/50 [1:17:54<39:27, 139.28s/it]
============================================================
Trial 33
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000304
dropout: 0.183246393736482
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_33 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.027741).  Saving model ...
Updating learning rate to 0.0003044519479448634
Validation loss decreased (0.027741 --> 0.026885).  Saving model ...
Updating learning rate to 0.0001522259739724317
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.611298698621585e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.8056493493107926e-05
Validation loss decreased (0.026885 --> 0.025696).  Saving model ...
Updating learning rate to 1.9028246746553963e-05
Validation loss decreased (0.025696 --> 0.025331).  Saving model ...
Updating learning rate to 9.514123373276982e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.757061686638491e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.3785308433192454e-06
Validation loss decreased (0.025331 --> 0.024340).  Saving model ...
Updating learning rate to 1.1892654216596227e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.946327108298113e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.9731635541490567e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4865817770745284e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.432908885372642e-08
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.716454442686321e-08
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.8582272213431605e-08
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.291136106715802e-09
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.645568053357901e-09
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.3227840266789506e-09
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.1613920133394753e-09
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.806960066697376e-10
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.903480033348688e-10
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.451740016674344e-10
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.25870008337172e-11
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.62935004168586e-11
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.81467502084293e-11
EarlyStopping counter: 17 out of 100
Updating learning rate to 9.07337510421465e-12
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.536687552107325e-12
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.2683437760536627e-12
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.1341718880268313e-12
EarlyStopping counter: 21 out of 100
Updating learning rate to 5.670859440134157e-13
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.8354297200670783e-13
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.4177148600335392e-13
EarlyStopping counter: 24 out of 100
Updating learning rate to 7.088574300167696e-14
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.544287150083848e-14
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.772143575041924e-14
EarlyStopping counter: 27 out of 100
Updating learning rate to 8.86071787520962e-15
EarlyStopping counter: 28 out of 100
Updating learning rate to 4.43035893760481e-15
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.215179468802405e-15
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.1075897344012025e-15
EarlyStopping counter: 31 out of 100
Updating learning rate to 5.537948672006012e-16
EarlyStopping counter: 32 out of 100
Updating learning rate to 2.768974336003006e-16
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.384487168001503e-16
EarlyStopping counter: 34 out of 100
Updating learning rate to 6.922435840007515e-17
EarlyStopping counter: 35 out of 100
Updating learning rate to 3.461217920003758e-17
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.730608960001879e-17
EarlyStopping counter: 37 out of 100
Updating learning rate to 8.653044800009394e-18
EarlyStopping counter: 38 out of 100
Updating learning rate to 4.326522400004697e-18
EarlyStopping counter: 39 out of 100
Updating learning rate to 2.1632612000023486e-18
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.0816306000011743e-18
EarlyStopping counter: 41 out of 100
Updating learning rate to 5.408153000005871e-19
EarlyStopping counter: 42 out of 100
Updating learning rate to 2.7040765000029357e-19
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.3520382500014679e-19
EarlyStopping counter: 44 out of 100
Updating learning rate to 6.760191250007339e-20
EarlyStopping counter: 45 out of 100
Updating learning rate to 3.3800956250036697e-20
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.6900478125018348e-20
EarlyStopping counter: 47 out of 100
Updating learning rate to 8.450239062509174e-21
EarlyStopping counter: 48 out of 100
Updating learning rate to 4.225119531254587e-21
EarlyStopping counter: 49 out of 100
Updating learning rate to 2.1125597656272935e-21
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.0562798828136468e-21
EarlyStopping counter: 51 out of 100
Updating learning rate to 5.281399414068234e-22
EarlyStopping counter: 52 out of 100
Updating learning rate to 2.640699707034117e-22
EarlyStopping counter: 53 out of 100
Updating learning rate to 1.3203498535170585e-22
EarlyStopping counter: 54 out of 100
Updating learning rate to 6.601749267585292e-23
EarlyStopping counter: 55 out of 100
Updating learning rate to 3.300874633792646e-23
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.650437316896323e-23
Validation loss decreased (0.024340 --> 0.024315).  Saving model ...
Updating learning rate to 8.252186584481615e-24
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.126093292240808e-24
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.063046646120404e-24
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.031523323060202e-24
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.15761661530101e-25
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.578808307650505e-25
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.2894041538252524e-25
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.447020769126262e-26
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.223510384563131e-26
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.6117551922815655e-26
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.058775961407828e-27
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.029387980703914e-27
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.014693990351957e-27
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.0073469951759784e-27
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.036734975879892e-28
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.518367487939946e-28
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.259183743969973e-28
EarlyStopping counter: 17 out of 100
Updating learning rate to 6.295918719849865e-29
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.1479593599249326e-29
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.5739796799624663e-29
EarlyStopping counter: 20 out of 100
Updating learning rate to 7.869898399812332e-30
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.934949199906166e-30
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.967474599953083e-30
EarlyStopping counter: 23 out of 100
Updating learning rate to 9.837372999765414e-31
EarlyStopping counter: 24 out of 100
Updating learning rate to 4.918686499882707e-31
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.4593432499413536e-31
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.2296716249706768e-31
EarlyStopping counter: 27 out of 100
Updating learning rate to 6.148358124853384e-32
EarlyStopping counter: 28 out of 100
Updating learning rate to 3.074179062426692e-32
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.537089531213346e-32
EarlyStopping counter: 30 out of 100
Updating learning rate to 7.68544765606673e-33
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.842723828033365e-33
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.9213619140166825e-33
EarlyStopping counter: 33 out of 100
Updating learning rate to 9.606809570083413e-34
EarlyStopping counter: 34 out of 100
Updating learning rate to 4.803404785041706e-34
>>>>>> Testing on validation set: trial_33 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.04949142783880234, mae:0.07462617754936218, dtw:Not calculated


                                                                                         [I 2025-10-17 03:17:17,680] Trial 33 finished with value: 0.07462617754936218 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 2, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0003044519479448634, 'dropout': 0.183246393736482}. Best is trial 31 with value: 0.07112950086593628.
Best trial: 31. Best value: 0.0711295:  66%|██████▌   | 33/50 [1:20:08<39:27, 139.28s/it]Best trial: 31. Best value: 0.0711295:  66%|██████▌   | 33/50 [1:20:08<39:27, 139.28s/it]Best trial: 31. Best value: 0.0711295:  68%|██████▊   | 34/50 [1:20:08<36:45, 137.85s/it]
============================================================
Trial 34
============================================================
seq_len: 48, pred_len: 14
d_model: 64, n_heads: 4
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000986
dropout: 0.21980043357393517
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_34 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 14
============================================================
train 4612
val 246
test 248
Validation loss decreased (inf --> 0.042848).  Saving model ...
Updating learning rate to 0.0009858699895085679
Validation loss decreased (0.042848 --> 0.040225).  Saving model ...
Updating learning rate to 0.0004929349947542839
Validation loss decreased (0.040225 --> 0.039449).  Saving model ...
Updating learning rate to 0.00024646749737714197
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00012323374868857098
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.161687434428549e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.0808437172142746e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5404218586071373e-05
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.702109293035686e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.851054646517843e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.9255273232589216e-06
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.627636616294608e-07
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.813818308147304e-07
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.406909154073652e-07
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.203454577036826e-07
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.01727288518413e-08
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.008636442592065e-08
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.5043182212960325e-08
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.521591106480163e-09
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.760795553240081e-09
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.8803977766200406e-09
EarlyStopping counter: 18 out of 100
Updating learning rate to 9.401988883100203e-10
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.700994441550102e-10
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.350497220775051e-10
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.1752486103875254e-10
EarlyStopping counter: 22 out of 100
Updating learning rate to 5.876243051937627e-11
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.9381215259688135e-11
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.4690607629844067e-11
EarlyStopping counter: 25 out of 100
Updating learning rate to 7.345303814922034e-12
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.672651907461017e-12
Validation loss decreased (0.039449 --> 0.039321).  Saving model ...
Updating learning rate to 1.8363259537305084e-12
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.181629768652542e-13
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.590814884326271e-13
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2954074421631355e-13
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1477037210815678e-13
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.738518605407839e-14
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.8692593027039194e-14
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4346296513519597e-14
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.173148256759799e-15
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.586574128379899e-15
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.7932870641899496e-15
EarlyStopping counter: 11 out of 100
Updating learning rate to 8.966435320949748e-16
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.483217660474874e-16
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.241608830237437e-16
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.1208044151187185e-16
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.604022075593593e-17
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.802011037796796e-17
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.401005518898398e-17
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.00502759449199e-18
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.502513797245995e-18
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.7512568986229977e-18
EarlyStopping counter: 21 out of 100
Updating learning rate to 8.756284493114988e-19
EarlyStopping counter: 22 out of 100
Updating learning rate to 4.378142246557494e-19
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.189071123278747e-19
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.0945355616393736e-19
EarlyStopping counter: 25 out of 100
Updating learning rate to 5.472677808196868e-20
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.736338904098434e-20
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.368169452049217e-20
EarlyStopping counter: 28 out of 100
Updating learning rate to 6.840847260246085e-21
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.420423630123042e-21
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.710211815061521e-21
EarlyStopping counter: 31 out of 100
Updating learning rate to 8.551059075307606e-22
EarlyStopping counter: 32 out of 100
Updating learning rate to 4.275529537653803e-22
EarlyStopping counter: 33 out of 100
Updating learning rate to 2.1377647688269015e-22
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.0688823844134507e-22
EarlyStopping counter: 35 out of 100
Updating learning rate to 5.344411922067254e-23
EarlyStopping counter: 36 out of 100
Updating learning rate to 2.672205961033627e-23
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.3361029805168134e-23
EarlyStopping counter: 38 out of 100
Updating learning rate to 6.680514902584067e-24
EarlyStopping counter: 39 out of 100
Updating learning rate to 3.3402574512920336e-24
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.6701287256460168e-24
EarlyStopping counter: 41 out of 100
Updating learning rate to 8.350643628230084e-25
EarlyStopping counter: 42 out of 100
Updating learning rate to 4.175321814115042e-25
EarlyStopping counter: 43 out of 100
Updating learning rate to 2.087660907057521e-25
EarlyStopping counter: 44 out of 100
Updating learning rate to 1.0438304535287605e-25
EarlyStopping counter: 45 out of 100
Updating learning rate to 5.219152267643802e-26
EarlyStopping counter: 46 out of 100
Updating learning rate to 2.609576133821901e-26
EarlyStopping counter: 47 out of 100
Updating learning rate to 1.3047880669109506e-26
EarlyStopping counter: 48 out of 100
Updating learning rate to 6.523940334554753e-27
EarlyStopping counter: 49 out of 100
Updating learning rate to 3.2619701672773765e-27
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.6309850836386883e-27
EarlyStopping counter: 51 out of 100
Updating learning rate to 8.154925418193441e-28
EarlyStopping counter: 52 out of 100
Updating learning rate to 4.077462709096721e-28
EarlyStopping counter: 53 out of 100
Updating learning rate to 2.0387313545483603e-28
EarlyStopping counter: 54 out of 100
Updating learning rate to 1.0193656772741802e-28
EarlyStopping counter: 55 out of 100
Updating learning rate to 5.096828386370901e-29
EarlyStopping counter: 56 out of 100
Updating learning rate to 2.5484141931854504e-29
EarlyStopping counter: 57 out of 100
Updating learning rate to 1.2742070965927252e-29
EarlyStopping counter: 58 out of 100
Updating learning rate to 6.371035482963626e-30
EarlyStopping counter: 59 out of 100
Updating learning rate to 3.185517741481813e-30
EarlyStopping counter: 60 out of 100
Updating learning rate to 1.5927588707409065e-30
EarlyStopping counter: 61 out of 100
Updating learning rate to 7.963794353704533e-31
EarlyStopping counter: 62 out of 100
Updating learning rate to 3.981897176852266e-31
EarlyStopping counter: 63 out of 100
Updating learning rate to 1.990948588426133e-31
EarlyStopping counter: 64 out of 100
Updating learning rate to 9.954742942130666e-32
EarlyStopping counter: 65 out of 100
Updating learning rate to 4.977371471065333e-32
EarlyStopping counter: 66 out of 100
Updating learning rate to 2.4886857355326664e-32
EarlyStopping counter: 67 out of 100
Updating learning rate to 1.2443428677663332e-32
EarlyStopping counter: 68 out of 100
Updating learning rate to 6.221714338831666e-33
EarlyStopping counter: 69 out of 100
Updating learning rate to 3.110857169415833e-33
EarlyStopping counter: 70 out of 100
Updating learning rate to 1.5554285847079165e-33
>>>>>> Testing on validation set: trial_34 >>>>>>
test 248
test shape: (248, 14, 5) (248, 14, 5)
test shape: (248, 14, 5) (248, 14, 5)


	mse:0.07026718556880951, mae:0.10373761504888535, dtw:Not calculated


                                                                                         [I 2025-10-17 03:19:32,073] Trial 34 finished with value: 0.10373761504888535 and parameters: {'seq_len': 48, 'pred_len': 14, 'expand': 2, 'd_model': 64, 'n_heads': 4, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0009858699895085679, 'dropout': 0.21980043357393517}. Best is trial 31 with value: 0.07112950086593628.
Best trial: 31. Best value: 0.0711295:  68%|██████▊   | 34/50 [1:22:22<36:45, 137.85s/it]Best trial: 31. Best value: 0.0711295:  68%|██████▊   | 34/50 [1:22:22<36:45, 137.85s/it]Best trial: 31. Best value: 0.0711295:  70%|███████   | 35/50 [1:22:22<34:12, 136.81s/it]
============================================================
Trial 35
============================================================
seq_len: 96, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000749
dropout: 0.2549205348244998
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_35 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 1
============================================================
train 4577
val 259
test 261
Validation loss decreased (inf --> 0.025872).  Saving model ...
Updating learning rate to 0.0007494012440404794
Validation loss decreased (0.025872 --> 0.024270).  Saving model ...
Updating learning rate to 0.0003747006220202397
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00018735031101011984
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.367515550505992e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.683757775252996e-05
Validation loss decreased (0.024270 --> 0.023706).  Saving model ...
Updating learning rate to 2.341878887626498e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.170939443813249e-05
Validation loss decreased (0.023706 --> 0.023646).  Saving model ...
Updating learning rate to 5.854697219066245e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.9273486095331225e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4636743047665612e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.318371523832806e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.659185761916403e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8295928809582016e-07
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.147964404791008e-08
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.573982202395504e-08
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.286991101197752e-08
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.143495550598876e-08
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.71747775299438e-09
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.85873887649719e-09
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.429369438248595e-09
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.146847191242975e-10
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.5734235956214874e-10
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.7867117978107437e-10
EarlyStopping counter: 16 out of 100
Updating learning rate to 8.933558989053719e-11
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.466779494526859e-11
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.2333897472634296e-11
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.1166948736317148e-11
EarlyStopping counter: 20 out of 100
Updating learning rate to 5.583474368158574e-12
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.791737184079287e-12
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.3958685920396435e-12
EarlyStopping counter: 23 out of 100
Updating learning rate to 6.979342960198218e-13
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.489671480099109e-13
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.7448357400495544e-13
EarlyStopping counter: 26 out of 100
Updating learning rate to 8.724178700247772e-14
EarlyStopping counter: 27 out of 100
Updating learning rate to 4.362089350123886e-14
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.181044675061943e-14
Validation loss decreased (0.023646 --> 0.023626).  Saving model ...
Updating learning rate to 1.0905223375309715e-14
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.4526116876548575e-15
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7263058438274287e-15
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3631529219137144e-15
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.815764609568572e-16
Validation loss decreased (0.023626 --> 0.023546).  Saving model ...
Updating learning rate to 3.407882304784286e-16
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.703941152392143e-16
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.519705761960715e-17
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.2598528809803574e-17
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.1299264404901787e-17
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0649632202450894e-17
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.324816101225447e-18
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.6624080506127234e-18
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3312040253063617e-18
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.656020126531808e-19
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.328010063265904e-19
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.664005031632952e-19
EarlyStopping counter: 12 out of 100
Updating learning rate to 8.32002515816476e-20
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.16001257908238e-20
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.08000628954119e-20
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.040003144770595e-20
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.200015723852975e-21
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.6000078619264877e-21
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.3000039309632438e-21
EarlyStopping counter: 19 out of 100
Updating learning rate to 6.500019654816219e-22
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.2500098274081096e-22
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.6250049137040548e-22
EarlyStopping counter: 22 out of 100
Updating learning rate to 8.125024568520274e-23
EarlyStopping counter: 23 out of 100
Updating learning rate to 4.062512284260137e-23
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.0312561421300685e-23
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.0156280710650343e-23
EarlyStopping counter: 26 out of 100
Updating learning rate to 5.078140355325171e-24
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.5390701776625856e-24
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.2695350888312928e-24
EarlyStopping counter: 29 out of 100
Updating learning rate to 6.347675444156464e-25
EarlyStopping counter: 30 out of 100
Updating learning rate to 3.173837722078232e-25
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.586918861039116e-25
EarlyStopping counter: 32 out of 100
Updating learning rate to 7.93459430519558e-26
EarlyStopping counter: 33 out of 100
Updating learning rate to 3.96729715259779e-26
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.983648576298895e-26
EarlyStopping counter: 35 out of 100
Updating learning rate to 9.918242881494475e-27
EarlyStopping counter: 36 out of 100
Updating learning rate to 4.9591214407472376e-27
EarlyStopping counter: 37 out of 100
Updating learning rate to 2.4795607203736188e-27
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.2397803601868094e-27
EarlyStopping counter: 39 out of 100
Updating learning rate to 6.198901800934047e-28
EarlyStopping counter: 40 out of 100
Updating learning rate to 3.0994509004670235e-28
EarlyStopping counter: 41 out of 100
Updating learning rate to 1.5497254502335117e-28
EarlyStopping counter: 42 out of 100
Updating learning rate to 7.748627251167559e-29
EarlyStopping counter: 43 out of 100
Updating learning rate to 3.8743136255837793e-29
EarlyStopping counter: 44 out of 100
Updating learning rate to 1.9371568127918897e-29
EarlyStopping counter: 45 out of 100
Updating learning rate to 9.685784063959448e-30
EarlyStopping counter: 46 out of 100
Updating learning rate to 4.842892031979724e-30
Validation loss decreased (0.023546 --> 0.023501).  Saving model ...
Updating learning rate to 2.421446015989862e-30
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.210723007994931e-30
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.053615039974655e-31
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.0268075199873276e-31
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5134037599936638e-31
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.567018799968319e-32
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.7835093999841595e-32
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8917546999920798e-32
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.458773499960399e-33
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.7293867499801994e-33
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.3646933749900997e-33
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.1823466874950498e-33
>>>>>> Testing on validation set: trial_35 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.05086568370461464, mae:0.07508333027362823, dtw:Not calculated


                                                                                         [I 2025-10-17 03:21:45,378] Trial 35 finished with value: 0.07508333027362823 and parameters: {'seq_len': 96, 'pred_len': 1, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0007494012440404794, 'dropout': 0.2549205348244998}. Best is trial 31 with value: 0.07112950086593628.
Best trial: 31. Best value: 0.0711295:  70%|███████   | 35/50 [1:24:36<34:12, 136.81s/it]Best trial: 31. Best value: 0.0711295:  70%|███████   | 35/50 [1:24:36<34:12, 136.81s/it]Best trial: 31. Best value: 0.0711295:  72%|███████▏  | 36/50 [1:24:36<31:40, 135.76s/it]
============================================================
Trial 36
============================================================
seq_len: 48, pred_len: 1
d_model: 32, n_heads: 8
e_layers: 1, d_layers: 1
batch_size: 32, lr: 0.000476
dropout: 0.15464721246599286
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 64, expand: 2
>>>>>> Start training: trial_36 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.029835).  Saving model ...
Updating learning rate to 0.0004762871315894589
Validation loss decreased (0.029835 --> 0.026269).  Saving model ...
Updating learning rate to 0.00023814356579472944
Validation loss decreased (0.026269 --> 0.026232).  Saving model ...
Updating learning rate to 0.00011907178289736472
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.953589144868236e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.976794572434118e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.488397286217059e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.441986431085295e-06
Validation loss decreased (0.026232 --> 0.025376).  Saving model ...
Updating learning rate to 3.7209932155426475e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8604966077713238e-06
Validation loss decreased (0.025376 --> 0.025338).  Saving model ...
Updating learning rate to 9.302483038856619e-07
Validation loss decreased (0.025338 --> 0.024901).  Saving model ...
Updating learning rate to 4.6512415194283094e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.3256207597141547e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1628103798570773e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.814051899285387e-08
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.9070259496426934e-08
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4535129748213467e-08
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.2675648741067334e-09
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.6337824370533667e-09
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.8168912185266834e-09
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.084456092633417e-10
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.5422280463167084e-10
Validation loss decreased (0.024901 --> 0.024824).  Saving model ...
Updating learning rate to 2.2711140231583542e-10
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1355570115791771e-10
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.6777850578958855e-11
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.8388925289479427e-11
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4194462644739714e-11
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.097231322369857e-12
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.5486156611849284e-12
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.7743078305924642e-12
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.871539152962321e-13
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.4357695764811605e-13
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.2178847882405803e-13
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.1089423941202901e-13
Validation loss decreased (0.024824 --> 0.024660).  Saving model ...
Updating learning rate to 5.5447119706014507e-14
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7723559853007253e-14
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3861779926503627e-14
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.930889963251813e-15
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4654449816259067e-15
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.7327224908129533e-15
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.663612454064767e-16
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.3318062270323833e-16
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.1659031135161917e-16
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.0829515567580958e-16
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.414757783790479e-17
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7073788918952396e-17
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.3536894459476198e-17
EarlyStopping counter: 13 out of 100
Updating learning rate to 6.768447229738099e-18
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.3842236148690495e-18
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.6921118074345247e-18
EarlyStopping counter: 16 out of 100
Updating learning rate to 8.460559037172624e-19
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.230279518586312e-19
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.115139759293156e-19
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.057569879646578e-19
EarlyStopping counter: 20 out of 100
Updating learning rate to 5.28784939823289e-20
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.643924699116445e-20
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.3219623495582225e-20
EarlyStopping counter: 23 out of 100
Updating learning rate to 6.609811747791112e-21
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.304905873895556e-21
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.652452936947778e-21
EarlyStopping counter: 26 out of 100
Updating learning rate to 8.26226468473889e-22
EarlyStopping counter: 27 out of 100
Updating learning rate to 4.131132342369445e-22
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.0655661711847226e-22
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.0327830855923613e-22
EarlyStopping counter: 30 out of 100
Updating learning rate to 5.1639154279618065e-23
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.5819577139809032e-23
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.2909788569904516e-23
EarlyStopping counter: 33 out of 100
Updating learning rate to 6.454894284952258e-24
EarlyStopping counter: 34 out of 100
Updating learning rate to 3.227447142476129e-24
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.6137235712380645e-24
EarlyStopping counter: 36 out of 100
Updating learning rate to 8.068617856190323e-25
EarlyStopping counter: 37 out of 100
Updating learning rate to 4.0343089280951613e-25
EarlyStopping counter: 38 out of 100
Updating learning rate to 2.0171544640475806e-25
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.0085772320237903e-25
EarlyStopping counter: 40 out of 100
Updating learning rate to 5.0428861601189516e-26
EarlyStopping counter: 41 out of 100
Updating learning rate to 2.5214430800594758e-26
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.2607215400297379e-26
EarlyStopping counter: 43 out of 100
Updating learning rate to 6.3036077001486895e-27
EarlyStopping counter: 44 out of 100
Updating learning rate to 3.1518038500743448e-27
EarlyStopping counter: 45 out of 100
Updating learning rate to 1.5759019250371724e-27
EarlyStopping counter: 46 out of 100
Updating learning rate to 7.879509625185862e-28
EarlyStopping counter: 47 out of 100
Updating learning rate to 3.939754812592931e-28
EarlyStopping counter: 48 out of 100
Updating learning rate to 1.9698774062964655e-28
EarlyStopping counter: 49 out of 100
Updating learning rate to 9.849387031482327e-29
EarlyStopping counter: 50 out of 100
Updating learning rate to 4.9246935157411637e-29
EarlyStopping counter: 51 out of 100
Updating learning rate to 2.4623467578705818e-29
EarlyStopping counter: 52 out of 100
Updating learning rate to 1.2311733789352909e-29
EarlyStopping counter: 53 out of 100
Updating learning rate to 6.1558668946764546e-30
EarlyStopping counter: 54 out of 100
Updating learning rate to 3.0779334473382273e-30
EarlyStopping counter: 55 out of 100
Updating learning rate to 1.5389667236691137e-30
EarlyStopping counter: 56 out of 100
Updating learning rate to 7.694833618345568e-31
EarlyStopping counter: 57 out of 100
Updating learning rate to 3.847416809172784e-31
EarlyStopping counter: 58 out of 100
Updating learning rate to 1.923708404586392e-31
EarlyStopping counter: 59 out of 100
Updating learning rate to 9.61854202293196e-32
EarlyStopping counter: 60 out of 100
Updating learning rate to 4.80927101146598e-32
EarlyStopping counter: 61 out of 100
Updating learning rate to 2.40463550573299e-32
EarlyStopping counter: 62 out of 100
Updating learning rate to 1.202317752866495e-32
EarlyStopping counter: 63 out of 100
Updating learning rate to 6.011588764332475e-33
EarlyStopping counter: 64 out of 100
Updating learning rate to 3.0057943821662376e-33
EarlyStopping counter: 65 out of 100
Updating learning rate to 1.5028971910831188e-33
EarlyStopping counter: 66 out of 100
Updating learning rate to 7.514485955415594e-34
>>>>>> Testing on validation set: trial_36 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.05055858939886093, mae:0.07614325731992722, dtw:Not calculated


                                                                                         [I 2025-10-17 03:23:58,797] Trial 36 finished with value: 0.07614325731992722 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 2, 'd_model': 32, 'n_heads': 8, 'e_layers': 1, 'd_layers': 1, 'batch_size': 32, 'learning_rate': 0.0004762871315894589, 'dropout': 0.15464721246599286}. Best is trial 31 with value: 0.07112950086593628.
Best trial: 31. Best value: 0.0711295:  72%|███████▏  | 36/50 [1:26:49<31:40, 135.76s/it]Best trial: 31. Best value: 0.0711295:  72%|███████▏  | 36/50 [1:26:49<31:40, 135.76s/it]Best trial: 31. Best value: 0.0711295:  74%|███████▍  | 37/50 [1:26:49<29:15, 135.06s/it]
============================================================
Trial 37
============================================================
seq_len: 96, pred_len: 14
d_model: 64, n_heads: 4
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000756
dropout: 0.2269124180965051
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_37 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 14
============================================================
train 4564
val 246
test 248
Validation loss decreased (inf --> 0.040354).  Saving model ...
Updating learning rate to 0.0007559600998637432
Validation loss decreased (0.040354 --> 0.039549).  Saving model ...
Updating learning rate to 0.0003779800499318716
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0001889900249659358
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.44950124829679e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.724750624148395e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.3623753120741976e-05
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1811876560370988e-05
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.905938280185494e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.952969140092747e-06
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.4764845700463735e-06
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.382422850231867e-07
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.6912114251159337e-07
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.8456057125579668e-07
EarlyStopping counter: 12 out of 100
Updating learning rate to 9.228028562789834e-08
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.614014281394917e-08
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.3070071406974585e-08
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.1535035703487293e-08
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.767517851743646e-09
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.883758925871823e-09
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.4418794629359116e-09
EarlyStopping counter: 19 out of 100
Updating learning rate to 7.209397314679558e-10
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.604698657339779e-10
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.8023493286698895e-10
EarlyStopping counter: 22 out of 100
Updating learning rate to 9.011746643349447e-11
EarlyStopping counter: 23 out of 100
Updating learning rate to 4.505873321674724e-11
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.252936660837362e-11
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.126468330418681e-11
EarlyStopping counter: 26 out of 100
Updating learning rate to 5.632341652093405e-12
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.8161708260467023e-12
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.4080854130233512e-12
EarlyStopping counter: 29 out of 100
Updating learning rate to 7.040427065116756e-13
EarlyStopping counter: 30 out of 100
Updating learning rate to 3.520213532558378e-13
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.760106766279189e-13
EarlyStopping counter: 32 out of 100
Updating learning rate to 8.800533831395945e-14
EarlyStopping counter: 33 out of 100
Updating learning rate to 4.4002669156979724e-14
EarlyStopping counter: 34 out of 100
Updating learning rate to 2.2001334578489862e-14
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.1000667289244931e-14
EarlyStopping counter: 36 out of 100
Updating learning rate to 5.5003336446224655e-15
EarlyStopping counter: 37 out of 100
Updating learning rate to 2.7501668223112327e-15
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.3750834111556164e-15
EarlyStopping counter: 39 out of 100
Updating learning rate to 6.875417055778082e-16
EarlyStopping counter: 40 out of 100
Updating learning rate to 3.437708527889041e-16
EarlyStopping counter: 41 out of 100
Updating learning rate to 1.7188542639445205e-16
EarlyStopping counter: 42 out of 100
Updating learning rate to 8.594271319722602e-17
EarlyStopping counter: 43 out of 100
Updating learning rate to 4.297135659861301e-17
EarlyStopping counter: 44 out of 100
Updating learning rate to 2.1485678299306506e-17
EarlyStopping counter: 45 out of 100
Updating learning rate to 1.0742839149653253e-17
EarlyStopping counter: 46 out of 100
Updating learning rate to 5.3714195748266264e-18
EarlyStopping counter: 47 out of 100
Updating learning rate to 2.6857097874133132e-18
EarlyStopping counter: 48 out of 100
Updating learning rate to 1.3428548937066566e-18
EarlyStopping counter: 49 out of 100
Updating learning rate to 6.714274468533283e-19
EarlyStopping counter: 50 out of 100
Updating learning rate to 3.3571372342666415e-19
EarlyStopping counter: 51 out of 100
Updating learning rate to 1.6785686171333208e-19
EarlyStopping counter: 52 out of 100
Updating learning rate to 8.392843085666604e-20
EarlyStopping counter: 53 out of 100
Updating learning rate to 4.196421542833302e-20
EarlyStopping counter: 54 out of 100
Updating learning rate to 2.098210771416651e-20
EarlyStopping counter: 55 out of 100
Updating learning rate to 1.0491053857083255e-20
EarlyStopping counter: 56 out of 100
Updating learning rate to 5.2455269285416274e-21
EarlyStopping counter: 57 out of 100
Updating learning rate to 2.6227634642708137e-21
EarlyStopping counter: 58 out of 100
Updating learning rate to 1.3113817321354068e-21
EarlyStopping counter: 59 out of 100
Updating learning rate to 6.556908660677034e-22
EarlyStopping counter: 60 out of 100
Updating learning rate to 3.278454330338517e-22
EarlyStopping counter: 61 out of 100
Updating learning rate to 1.6392271651692586e-22
EarlyStopping counter: 62 out of 100
Updating learning rate to 8.196135825846293e-23
EarlyStopping counter: 63 out of 100
Updating learning rate to 4.0980679129231464e-23
EarlyStopping counter: 64 out of 100
Updating learning rate to 2.0490339564615732e-23
EarlyStopping counter: 65 out of 100
Updating learning rate to 1.0245169782307866e-23
EarlyStopping counter: 66 out of 100
Updating learning rate to 5.122584891153933e-24
EarlyStopping counter: 67 out of 100
Updating learning rate to 2.5612924455769665e-24
EarlyStopping counter: 68 out of 100
Updating learning rate to 1.2806462227884832e-24
EarlyStopping counter: 69 out of 100
Updating learning rate to 6.403231113942416e-25
EarlyStopping counter: 70 out of 100
Updating learning rate to 3.201615556971208e-25
EarlyStopping counter: 71 out of 100
Updating learning rate to 1.600807778485604e-25
EarlyStopping counter: 72 out of 100
Updating learning rate to 8.00403889242802e-26
EarlyStopping counter: 73 out of 100
Updating learning rate to 4.00201944621401e-26
EarlyStopping counter: 74 out of 100
Updating learning rate to 2.001009723107005e-26
EarlyStopping counter: 75 out of 100
Updating learning rate to 1.0005048615535025e-26
EarlyStopping counter: 76 out of 100
Updating learning rate to 5.002524307767513e-27
EarlyStopping counter: 77 out of 100
Updating learning rate to 2.5012621538837563e-27
EarlyStopping counter: 78 out of 100
Updating learning rate to 1.2506310769418782e-27
EarlyStopping counter: 79 out of 100
Updating learning rate to 6.253155384709391e-28
EarlyStopping counter: 80 out of 100
Updating learning rate to 3.1265776923546954e-28
EarlyStopping counter: 81 out of 100
Updating learning rate to 1.5632888461773477e-28
EarlyStopping counter: 82 out of 100
Updating learning rate to 7.816444230886739e-29
EarlyStopping counter: 83 out of 100
Updating learning rate to 3.9082221154433693e-29
EarlyStopping counter: 84 out of 100
Updating learning rate to 1.9541110577216846e-29
EarlyStopping counter: 85 out of 100
Updating learning rate to 9.770555288608423e-30
EarlyStopping counter: 86 out of 100
Updating learning rate to 4.8852776443042116e-30
EarlyStopping counter: 87 out of 100
Updating learning rate to 2.4426388221521058e-30
EarlyStopping counter: 88 out of 100
Updating learning rate to 1.2213194110760529e-30
EarlyStopping counter: 89 out of 100
Updating learning rate to 6.1065970553802645e-31
EarlyStopping counter: 90 out of 100
Updating learning rate to 3.0532985276901323e-31
EarlyStopping counter: 91 out of 100
Updating learning rate to 1.5266492638450661e-31
EarlyStopping counter: 92 out of 100
Updating learning rate to 7.633246319225331e-32
EarlyStopping counter: 93 out of 100
Updating learning rate to 3.8166231596126653e-32
EarlyStopping counter: 94 out of 100
Updating learning rate to 1.9083115798063327e-32
EarlyStopping counter: 95 out of 100
Updating learning rate to 9.541557899031663e-33
EarlyStopping counter: 96 out of 100
Updating learning rate to 4.7707789495158317e-33
EarlyStopping counter: 97 out of 100
Updating learning rate to 2.3853894747579158e-33
EarlyStopping counter: 98 out of 100
Updating learning rate to 1.1926947373789579e-33
>>>>>> Testing on validation set: trial_37 >>>>>>
test 248
test shape: (248, 14, 5) (248, 14, 5)
test shape: (248, 14, 5) (248, 14, 5)


	mse:0.07191619277000427, mae:0.10511433333158493, dtw:Not calculated


                                                                                         [I 2025-10-17 03:26:10,707] Trial 37 finished with value: 0.10511433333158493 and parameters: {'seq_len': 96, 'pred_len': 14, 'expand': 1, 'd_model': 64, 'n_heads': 4, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0007559600998637432, 'dropout': 0.2269124180965051}. Best is trial 31 with value: 0.07112950086593628.
Best trial: 31. Best value: 0.0711295:  74%|███████▍  | 37/50 [1:29:01<29:15, 135.06s/it]Best trial: 31. Best value: 0.0711295:  74%|███████▍  | 37/50 [1:29:01<29:15, 135.06s/it]Best trial: 31. Best value: 0.0711295:  76%|███████▌  | 38/50 [1:29:01<26:49, 134.11s/it]
============================================================
Trial 38
============================================================
seq_len: 48, pred_len: 1
d_model: 32, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 64, lr: 0.000310
dropout: 0.130891185597775
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 64, expand: 2
>>>>>> Start training: trial_38 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.030155).  Saving model ...
Updating learning rate to 0.00031013825910766165
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00015506912955383083
Validation loss decreased (0.030155 --> 0.024514).  Saving model ...
Updating learning rate to 7.753456477691541e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.876728238845771e-05
Validation loss decreased (0.024514 --> 0.023740).  Saving model ...
Updating learning rate to 1.9383641194228853e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.691820597114427e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.845910298557213e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.4229551492786067e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2114775746393033e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.057387873196517e-07
Validation loss decreased (0.023740 --> 0.022936).  Saving model ...
Updating learning rate to 3.0286939365982583e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5143469682991292e-07
Validation loss decreased (0.022936 --> 0.022667).  Saving model ...
Updating learning rate to 7.571734841495646e-08
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.785867420747823e-08
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8929337103739115e-08
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.464668551869557e-09
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.732334275934779e-09
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.3661671379673893e-09
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1830835689836947e-09
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.915417844918473e-10
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.9577089224592367e-10
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4788544612296183e-10
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.394272306148092e-11
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.697136153074046e-11
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.848568076537023e-11
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.242840382685115e-12
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.621420191342557e-12
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.3107100956712786e-12
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.1553550478356393e-12
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.776775239178197e-13
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.8883876195890983e-13
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.4441938097945492e-13
EarlyStopping counter: 20 out of 100
Updating learning rate to 7.220969048972746e-14
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.610484524486373e-14
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.8052422622431864e-14
EarlyStopping counter: 23 out of 100
Updating learning rate to 9.026211311215932e-15
EarlyStopping counter: 24 out of 100
Updating learning rate to 4.513105655607966e-15
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.256552827803983e-15
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.1282764139019915e-15
EarlyStopping counter: 27 out of 100
Updating learning rate to 5.641382069509958e-16
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.820691034754979e-16
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.4103455173774894e-16
EarlyStopping counter: 30 out of 100
Updating learning rate to 7.051727586887447e-17
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.5258637934437235e-17
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.7629318967218618e-17
EarlyStopping counter: 33 out of 100
Updating learning rate to 8.814659483609309e-18
EarlyStopping counter: 34 out of 100
Updating learning rate to 4.4073297418046544e-18
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.2036648709023272e-18
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.1018324354511636e-18
EarlyStopping counter: 37 out of 100
Updating learning rate to 5.509162177255818e-19
EarlyStopping counter: 38 out of 100
Updating learning rate to 2.754581088627909e-19
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.3772905443139545e-19
EarlyStopping counter: 40 out of 100
Updating learning rate to 6.886452721569772e-20
EarlyStopping counter: 41 out of 100
Updating learning rate to 3.443226360784886e-20
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.721613180392443e-20
EarlyStopping counter: 43 out of 100
Updating learning rate to 8.608065901962216e-21
EarlyStopping counter: 44 out of 100
Updating learning rate to 4.304032950981108e-21
EarlyStopping counter: 45 out of 100
Updating learning rate to 2.152016475490554e-21
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.076008237745277e-21
EarlyStopping counter: 47 out of 100
Updating learning rate to 5.380041188726385e-22
EarlyStopping counter: 48 out of 100
Updating learning rate to 2.6900205943631924e-22
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.3450102971815962e-22
EarlyStopping counter: 50 out of 100
Updating learning rate to 6.725051485907981e-23
EarlyStopping counter: 51 out of 100
Updating learning rate to 3.3625257429539905e-23
EarlyStopping counter: 52 out of 100
Updating learning rate to 1.6812628714769952e-23
EarlyStopping counter: 53 out of 100
Updating learning rate to 8.406314357384976e-24
EarlyStopping counter: 54 out of 100
Updating learning rate to 4.203157178692488e-24
EarlyStopping counter: 55 out of 100
Updating learning rate to 2.101578589346244e-24
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.050789294673122e-24
EarlyStopping counter: 57 out of 100
Updating learning rate to 5.25394647336561e-25
EarlyStopping counter: 58 out of 100
Updating learning rate to 2.626973236682805e-25
EarlyStopping counter: 59 out of 100
Updating learning rate to 1.3134866183414025e-25
EarlyStopping counter: 60 out of 100
Updating learning rate to 6.567433091707013e-26
EarlyStopping counter: 61 out of 100
Updating learning rate to 3.2837165458535063e-26
EarlyStopping counter: 62 out of 100
Updating learning rate to 1.6418582729267532e-26
EarlyStopping counter: 63 out of 100
Updating learning rate to 8.209291364633766e-27
EarlyStopping counter: 64 out of 100
Updating learning rate to 4.104645682316883e-27
EarlyStopping counter: 65 out of 100
Updating learning rate to 2.0523228411584415e-27
EarlyStopping counter: 66 out of 100
Updating learning rate to 1.0261614205792207e-27
EarlyStopping counter: 67 out of 100
Updating learning rate to 5.130807102896104e-28
EarlyStopping counter: 68 out of 100
Updating learning rate to 2.565403551448052e-28
EarlyStopping counter: 69 out of 100
Updating learning rate to 1.282701775724026e-28
EarlyStopping counter: 70 out of 100
Updating learning rate to 6.41350887862013e-29
EarlyStopping counter: 71 out of 100
Updating learning rate to 3.206754439310065e-29
EarlyStopping counter: 72 out of 100
Updating learning rate to 1.6033772196550324e-29
EarlyStopping counter: 73 out of 100
Updating learning rate to 8.016886098275162e-30
EarlyStopping counter: 74 out of 100
Updating learning rate to 4.008443049137581e-30
EarlyStopping counter: 75 out of 100
Updating learning rate to 2.0042215245687905e-30
EarlyStopping counter: 76 out of 100
Updating learning rate to 1.0021107622843952e-30
EarlyStopping counter: 77 out of 100
Updating learning rate to 5.010553811421976e-31
EarlyStopping counter: 78 out of 100
Updating learning rate to 2.505276905710988e-31
EarlyStopping counter: 79 out of 100
Updating learning rate to 1.252638452855494e-31
EarlyStopping counter: 80 out of 100
Updating learning rate to 6.26319226427747e-32
EarlyStopping counter: 81 out of 100
Updating learning rate to 3.131596132138735e-32
EarlyStopping counter: 82 out of 100
Updating learning rate to 1.5657980660693676e-32
EarlyStopping counter: 83 out of 100
Updating learning rate to 7.828990330346838e-33
EarlyStopping counter: 84 out of 100
Updating learning rate to 3.914495165173419e-33
EarlyStopping counter: 85 out of 100
Updating learning rate to 1.9572475825867095e-33
EarlyStopping counter: 86 out of 100
Updating learning rate to 9.786237912933547e-34
EarlyStopping counter: 87 out of 100
Updating learning rate to 4.893118956466774e-34
>>>>>> Testing on validation set: trial_38 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.05136031657457352, mae:0.07904944568872452, dtw:Not calculated


                                                                                         [I 2025-10-17 03:27:19,095] Trial 38 finished with value: 0.07904944568872452 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 2, 'd_model': 32, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 64, 'learning_rate': 0.00031013825910766165, 'dropout': 0.130891185597775}. Best is trial 31 with value: 0.07112950086593628.
Best trial: 31. Best value: 0.0711295:  76%|███████▌  | 38/50 [1:30:09<26:49, 134.11s/it]Best trial: 31. Best value: 0.0711295:  76%|███████▌  | 38/50 [1:30:09<26:49, 134.11s/it]Best trial: 31. Best value: 0.0711295:  78%|███████▊  | 39/50 [1:30:09<20:58, 114.39s/it]
============================================================
Trial 39
============================================================
seq_len: 96, pred_len: 30
d_model: 64, n_heads: 4
e_layers: 2, d_layers: 2
batch_size: 32, lr: 0.000449
dropout: 0.05887702097226992
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_39 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 30
============================================================
train 4548
val 230
test 232
Validation loss decreased (inf --> 0.036400).  Saving model ...
Updating learning rate to 0.00044868834877842594
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00022434417438921297
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.00011217208719460648
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.608604359730324e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.804302179865162e-05
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.402151089932581e-05
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.010755449662905e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.5053777248314526e-06
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.7526888624157263e-06
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.763444312078632e-07
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.381722156039316e-07
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.190861078019658e-07
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.095430539009829e-07
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.477152695049145e-08
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.7385763475245724e-08
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.3692881737622862e-08
EarlyStopping counter: 16 out of 100
Updating learning rate to 6.846440868811431e-09
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.4232204344057155e-09
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.7116102172028577e-09
EarlyStopping counter: 19 out of 100
Updating learning rate to 8.558051086014289e-10
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.2790255430071443e-10
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.1395127715035722e-10
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.0697563857517861e-10
EarlyStopping counter: 23 out of 100
Updating learning rate to 5.3487819287589304e-11
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.6743909643794652e-11
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.3371954821897326e-11
EarlyStopping counter: 26 out of 100
Updating learning rate to 6.685977410948663e-12
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.3429887054743315e-12
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.6714943527371658e-12
EarlyStopping counter: 29 out of 100
Updating learning rate to 8.357471763685829e-13
EarlyStopping counter: 30 out of 100
Updating learning rate to 4.1787358818429144e-13
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.0893679409214572e-13
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.0446839704607286e-13
EarlyStopping counter: 33 out of 100
Updating learning rate to 5.223419852303643e-14
EarlyStopping counter: 34 out of 100
Updating learning rate to 2.6117099261518215e-14
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.3058549630759107e-14
EarlyStopping counter: 36 out of 100
Updating learning rate to 6.529274815379554e-15
EarlyStopping counter: 37 out of 100
Updating learning rate to 3.264637407689777e-15
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.6323187038448884e-15
EarlyStopping counter: 39 out of 100
Updating learning rate to 8.161593519224442e-16
EarlyStopping counter: 40 out of 100
Updating learning rate to 4.080796759612221e-16
EarlyStopping counter: 41 out of 100
Updating learning rate to 2.0403983798061105e-16
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.0201991899030553e-16
EarlyStopping counter: 43 out of 100
Updating learning rate to 5.1009959495152764e-17
EarlyStopping counter: 44 out of 100
Updating learning rate to 2.5504979747576382e-17
EarlyStopping counter: 45 out of 100
Updating learning rate to 1.2752489873788191e-17
EarlyStopping counter: 46 out of 100
Updating learning rate to 6.3762449368940954e-18
EarlyStopping counter: 47 out of 100
Updating learning rate to 3.1881224684470477e-18
EarlyStopping counter: 48 out of 100
Updating learning rate to 1.5940612342235239e-18
EarlyStopping counter: 49 out of 100
Updating learning rate to 7.970306171117619e-19
EarlyStopping counter: 50 out of 100
Updating learning rate to 3.9851530855588097e-19
EarlyStopping counter: 51 out of 100
Updating learning rate to 1.9925765427794048e-19
EarlyStopping counter: 52 out of 100
Updating learning rate to 9.962882713897024e-20
EarlyStopping counter: 53 out of 100
Updating learning rate to 4.981441356948512e-20
EarlyStopping counter: 54 out of 100
Updating learning rate to 2.490720678474256e-20
EarlyStopping counter: 55 out of 100
Updating learning rate to 1.245360339237128e-20
EarlyStopping counter: 56 out of 100
Updating learning rate to 6.22680169618564e-21
EarlyStopping counter: 57 out of 100
Updating learning rate to 3.11340084809282e-21
EarlyStopping counter: 58 out of 100
Updating learning rate to 1.55670042404641e-21
EarlyStopping counter: 59 out of 100
Updating learning rate to 7.78350212023205e-22
EarlyStopping counter: 60 out of 100
Updating learning rate to 3.891751060116025e-22
EarlyStopping counter: 61 out of 100
Updating learning rate to 1.9458755300580125e-22
EarlyStopping counter: 62 out of 100
Updating learning rate to 9.729377650290063e-23
EarlyStopping counter: 63 out of 100
Updating learning rate to 4.8646888251450313e-23
EarlyStopping counter: 64 out of 100
Updating learning rate to 2.4323444125725157e-23
EarlyStopping counter: 65 out of 100
Updating learning rate to 1.2161722062862578e-23
EarlyStopping counter: 66 out of 100
Updating learning rate to 6.080861031431289e-24
EarlyStopping counter: 67 out of 100
Updating learning rate to 3.0404305157156446e-24
EarlyStopping counter: 68 out of 100
Updating learning rate to 1.5202152578578223e-24
EarlyStopping counter: 69 out of 100
Updating learning rate to 7.601076289289111e-25
EarlyStopping counter: 70 out of 100
Updating learning rate to 3.8005381446445557e-25
EarlyStopping counter: 71 out of 100
Updating learning rate to 1.9002690723222779e-25
EarlyStopping counter: 72 out of 100
Updating learning rate to 9.501345361611389e-26
EarlyStopping counter: 73 out of 100
Updating learning rate to 4.7506726808056946e-26
EarlyStopping counter: 74 out of 100
Updating learning rate to 2.3753363404028473e-26
EarlyStopping counter: 75 out of 100
Updating learning rate to 1.1876681702014237e-26
EarlyStopping counter: 76 out of 100
Updating learning rate to 5.938340851007118e-27
EarlyStopping counter: 77 out of 100
Updating learning rate to 2.969170425503559e-27
EarlyStopping counter: 78 out of 100
Updating learning rate to 1.4845852127517796e-27
EarlyStopping counter: 79 out of 100
Updating learning rate to 7.422926063758898e-28
EarlyStopping counter: 80 out of 100
Updating learning rate to 3.711463031879449e-28
EarlyStopping counter: 81 out of 100
Updating learning rate to 1.8557315159397245e-28
EarlyStopping counter: 82 out of 100
Updating learning rate to 9.278657579698622e-29
EarlyStopping counter: 83 out of 100
Updating learning rate to 4.639328789849311e-29
EarlyStopping counter: 84 out of 100
Updating learning rate to 2.3196643949246556e-29
EarlyStopping counter: 85 out of 100
Updating learning rate to 1.1598321974623278e-29
EarlyStopping counter: 86 out of 100
Updating learning rate to 5.799160987311639e-30
EarlyStopping counter: 87 out of 100
Updating learning rate to 2.8995804936558195e-30
EarlyStopping counter: 88 out of 100
Updating learning rate to 1.4497902468279097e-30
EarlyStopping counter: 89 out of 100
Updating learning rate to 7.248951234139549e-31
EarlyStopping counter: 90 out of 100
Updating learning rate to 3.6244756170697744e-31
EarlyStopping counter: 91 out of 100
Updating learning rate to 1.8122378085348872e-31
EarlyStopping counter: 92 out of 100
Updating learning rate to 9.061189042674436e-32
EarlyStopping counter: 93 out of 100
Updating learning rate to 4.530594521337218e-32
EarlyStopping counter: 94 out of 100
Updating learning rate to 2.265297260668609e-32
EarlyStopping counter: 95 out of 100
Updating learning rate to 1.1326486303343045e-32
EarlyStopping counter: 96 out of 100
Updating learning rate to 5.6632431516715224e-33
EarlyStopping counter: 97 out of 100
Updating learning rate to 2.8316215758357612e-33
EarlyStopping counter: 98 out of 100
Updating learning rate to 1.4158107879178806e-33
EarlyStopping counter: 99 out of 100
Updating learning rate to 7.079053939589403e-34
>>>>>> Testing on validation set: trial_39 >>>>>>
test 232
test shape: (232, 30, 5) (232, 30, 5)
test shape: (232, 30, 5) (232, 30, 5)


	mse:0.07482144236564636, mae:0.11294650286436081, dtw:Not calculated


                                                                                         [I 2025-10-17 03:29:32,679] Trial 39 finished with value: 0.11294650286436081 and parameters: {'seq_len': 96, 'pred_len': 30, 'expand': 2, 'd_model': 64, 'n_heads': 4, 'e_layers': 2, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.00044868834877842594, 'dropout': 0.05887702097226992}. Best is trial 31 with value: 0.07112950086593628.
Best trial: 31. Best value: 0.0711295:  78%|███████▊  | 39/50 [1:32:23<20:58, 114.39s/it]Best trial: 31. Best value: 0.0711295:  78%|███████▊  | 39/50 [1:32:23<20:58, 114.39s/it]Best trial: 31. Best value: 0.0711295:  80%|████████  | 40/50 [1:32:23<20:01, 120.15s/it]
============================================================
Trial 40
============================================================
seq_len: 48, pred_len: 7
d_model: 32, n_heads: 8
e_layers: 1, d_layers: 1
batch_size: 16, lr: 0.000173
dropout: 0.08468080958949388
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 64, expand: 2
>>>>>> Start training: trial_40 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 7
============================================================
train 4619
val 253
test 255
Validation loss decreased (inf --> 0.038684).  Saving model ...
Updating learning rate to 0.00017297947853745077
Validation loss decreased (0.038684 --> 0.038469).  Saving model ...
Updating learning rate to 8.648973926872538e-05
Validation loss decreased (0.038469 --> 0.038126).  Saving model ...
Updating learning rate to 4.324486963436269e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.1622434817181346e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0811217408590673e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.4056087042953364e-06
Validation loss decreased (0.038126 --> 0.037985).  Saving model ...
Updating learning rate to 2.7028043521476682e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3514021760738341e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.757010880369171e-07
Validation loss decreased (0.037985 --> 0.037945).  Saving model ...
Updating learning rate to 3.3785054401845853e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6892527200922926e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.446263600461463e-08
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.2231318002307316e-08
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.1115659001153658e-08
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0557829500576829e-08
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.2789147502884145e-09
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.6394573751442072e-09
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3197286875721036e-09
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.598643437860518e-10
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.299321718930259e-10
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.6496608594651295e-10
EarlyStopping counter: 12 out of 100
Updating learning rate to 8.248304297325648e-11
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.124152148662824e-11
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.062076074331412e-11
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.031038037165706e-11
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.15519018582853e-12
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.577595092914265e-12
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.2887975464571324e-12
EarlyStopping counter: 19 out of 100
Updating learning rate to 6.443987732285662e-13
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.221993866142831e-13
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.6109969330714156e-13
EarlyStopping counter: 22 out of 100
Updating learning rate to 8.054984665357078e-14
EarlyStopping counter: 23 out of 100
Updating learning rate to 4.027492332678539e-14
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.0137461663392694e-14
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.0068730831696347e-14
EarlyStopping counter: 26 out of 100
Updating learning rate to 5.034365415848174e-15
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.517182707924087e-15
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.2585913539620434e-15
EarlyStopping counter: 29 out of 100
Updating learning rate to 6.292956769810217e-16
EarlyStopping counter: 30 out of 100
Updating learning rate to 3.1464783849051085e-16
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.5732391924525543e-16
EarlyStopping counter: 32 out of 100
Updating learning rate to 7.866195962262771e-17
EarlyStopping counter: 33 out of 100
Updating learning rate to 3.9330979811313856e-17
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.9665489905656928e-17
EarlyStopping counter: 35 out of 100
Updating learning rate to 9.832744952828464e-18
EarlyStopping counter: 36 out of 100
Updating learning rate to 4.916372476414232e-18
EarlyStopping counter: 37 out of 100
Updating learning rate to 2.458186238207116e-18
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.229093119103558e-18
EarlyStopping counter: 39 out of 100
Updating learning rate to 6.14546559551779e-19
EarlyStopping counter: 40 out of 100
Updating learning rate to 3.072732797758895e-19
EarlyStopping counter: 41 out of 100
Updating learning rate to 1.5363663988794475e-19
EarlyStopping counter: 42 out of 100
Updating learning rate to 7.681831994397238e-20
EarlyStopping counter: 43 out of 100
Updating learning rate to 3.840915997198619e-20
EarlyStopping counter: 44 out of 100
Updating learning rate to 1.9204579985993094e-20
EarlyStopping counter: 45 out of 100
Updating learning rate to 9.602289992996547e-21
EarlyStopping counter: 46 out of 100
Updating learning rate to 4.8011449964982735e-21
EarlyStopping counter: 47 out of 100
Updating learning rate to 2.4005724982491367e-21
EarlyStopping counter: 48 out of 100
Updating learning rate to 1.2002862491245684e-21
EarlyStopping counter: 49 out of 100
Updating learning rate to 6.001431245622842e-22
EarlyStopping counter: 50 out of 100
Updating learning rate to 3.000715622811421e-22
EarlyStopping counter: 51 out of 100
Updating learning rate to 1.5003578114057105e-22
EarlyStopping counter: 52 out of 100
Updating learning rate to 7.501789057028552e-23
EarlyStopping counter: 53 out of 100
Updating learning rate to 3.750894528514276e-23
EarlyStopping counter: 54 out of 100
Updating learning rate to 1.875447264257138e-23
EarlyStopping counter: 55 out of 100
Updating learning rate to 9.37723632128569e-24
EarlyStopping counter: 56 out of 100
Updating learning rate to 4.688618160642845e-24
Validation loss decreased (0.037945 --> 0.037929).  Saving model ...
Updating learning rate to 2.3443090803214226e-24
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1721545401607113e-24
Validation loss decreased (0.037929 --> 0.037886).  Saving model ...
Updating learning rate to 5.8607727008035565e-25
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.9303863504017782e-25
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4651931752008891e-25
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.325965876004446e-26
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.662982938002223e-26
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8314914690011114e-26
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.157457345005557e-27
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.5787286725027785e-27
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.2893643362513893e-27
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.1446821681256946e-27
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.723410840628473e-28
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.8617054203142366e-28
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.4308527101571183e-28
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.154263550785591e-29
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.5771317753927957e-29
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.7885658876963979e-29
EarlyStopping counter: 16 out of 100
Updating learning rate to 8.942829438481989e-30
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.4714147192409946e-30
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.2357073596204973e-30
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.1178536798102487e-30
EarlyStopping counter: 20 out of 100
Updating learning rate to 5.589268399051243e-31
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.7946341995256217e-31
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.3973170997628108e-31
EarlyStopping counter: 23 out of 100
Updating learning rate to 6.986585498814054e-32
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.493292749407027e-32
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.7466463747035135e-32
EarlyStopping counter: 26 out of 100
Updating learning rate to 8.733231873517568e-33
EarlyStopping counter: 27 out of 100
Updating learning rate to 4.366615936758784e-33
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.183307968379392e-33
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.091653984189696e-33
EarlyStopping counter: 30 out of 100
Updating learning rate to 5.45826992094848e-34
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.72913496047424e-34
>>>>>> Testing on validation set: trial_40 >>>>>>
test 255
test shape: (255, 7, 5) (255, 7, 5)
test shape: (255, 7, 5) (255, 7, 5)


	mse:0.06614144146442413, mae:0.09742578864097595, dtw:Not calculated


                                                                                         [I 2025-10-17 03:33:54,215] Trial 40 finished with value: 0.09742578864097595 and parameters: {'seq_len': 48, 'pred_len': 7, 'expand': 2, 'd_model': 32, 'n_heads': 8, 'e_layers': 1, 'd_layers': 1, 'batch_size': 16, 'learning_rate': 0.00017297947853745077, 'dropout': 0.08468080958949388}. Best is trial 31 with value: 0.07112950086593628.
Best trial: 31. Best value: 0.0711295:  80%|████████  | 40/50 [1:36:44<20:01, 120.15s/it]Best trial: 31. Best value: 0.0711295:  80%|████████  | 40/50 [1:36:45<20:01, 120.15s/it]Best trial: 31. Best value: 0.0711295:  82%|████████▏ | 41/50 [1:36:45<24:23, 162.57s/it]
============================================================
Trial 41
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000642
dropout: 0.10333521496828589
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_41 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.025243).  Saving model ...
Updating learning rate to 0.0006418830810772697
Validation loss decreased (0.025243 --> 0.024566).  Saving model ...
Updating learning rate to 0.00032094154053863484
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00016047077026931742
Validation loss decreased (0.024566 --> 0.023731).  Saving model ...
Updating learning rate to 8.023538513465871e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.0117692567329355e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0058846283664677e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0029423141832339e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.014711570916169e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.5073557854580847e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.2536778927290423e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.268389463645212e-07
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.134194731822606e-07
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.567097365911303e-07
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.835486829556515e-08
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.917743414778257e-08
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.9588717073891286e-08
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.794358536945643e-09
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.897179268472822e-09
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.448589634236411e-09
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.2242948171182054e-09
EarlyStopping counter: 17 out of 100
Updating learning rate to 6.121474085591027e-10
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.0607370427955135e-10
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.5303685213977568e-10
EarlyStopping counter: 20 out of 100
Updating learning rate to 7.651842606988784e-11
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.825921303494392e-11
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.912960651747196e-11
EarlyStopping counter: 23 out of 100
Updating learning rate to 9.56480325873598e-12
EarlyStopping counter: 24 out of 100
Updating learning rate to 4.78240162936799e-12
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.391200814683995e-12
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.1956004073419975e-12
EarlyStopping counter: 27 out of 100
Updating learning rate to 5.978002036709987e-13
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.9890010183549937e-13
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.4945005091774968e-13
EarlyStopping counter: 30 out of 100
Updating learning rate to 7.472502545887484e-14
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.736251272943742e-14
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.868125636471871e-14
EarlyStopping counter: 33 out of 100
Updating learning rate to 9.340628182359355e-15
EarlyStopping counter: 34 out of 100
Updating learning rate to 4.6703140911796776e-15
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.3351570455898388e-15
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.1675785227949194e-15
EarlyStopping counter: 37 out of 100
Updating learning rate to 5.837892613974597e-16
EarlyStopping counter: 38 out of 100
Updating learning rate to 2.9189463069872985e-16
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.4594731534936492e-16
EarlyStopping counter: 40 out of 100
Updating learning rate to 7.297365767468246e-17
EarlyStopping counter: 41 out of 100
Updating learning rate to 3.648682883734123e-17
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.8243414418670616e-17
EarlyStopping counter: 43 out of 100
Updating learning rate to 9.121707209335308e-18
EarlyStopping counter: 44 out of 100
Updating learning rate to 4.560853604667654e-18
EarlyStopping counter: 45 out of 100
Updating learning rate to 2.280426802333827e-18
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.1402134011669135e-18
EarlyStopping counter: 47 out of 100
Updating learning rate to 5.701067005834567e-19
EarlyStopping counter: 48 out of 100
Updating learning rate to 2.8505335029172837e-19
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.4252667514586418e-19
EarlyStopping counter: 50 out of 100
Updating learning rate to 7.126333757293209e-20
EarlyStopping counter: 51 out of 100
Updating learning rate to 3.5631668786466046e-20
EarlyStopping counter: 52 out of 100
Updating learning rate to 1.7815834393233023e-20
EarlyStopping counter: 53 out of 100
Updating learning rate to 8.907917196616512e-21
EarlyStopping counter: 54 out of 100
Updating learning rate to 4.453958598308256e-21
EarlyStopping counter: 55 out of 100
Updating learning rate to 2.226979299154128e-21
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.113489649577064e-21
EarlyStopping counter: 57 out of 100
Updating learning rate to 5.56744824788532e-22
EarlyStopping counter: 58 out of 100
Updating learning rate to 2.78372412394266e-22
EarlyStopping counter: 59 out of 100
Updating learning rate to 1.39186206197133e-22
Validation loss decreased (0.023731 --> 0.023684).  Saving model ...
Updating learning rate to 6.95931030985665e-23
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.479655154928325e-23
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.7398275774641624e-23
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.699137887320812e-24
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.349568943660406e-24
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.174784471830203e-24
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.0873922359151015e-24
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.4369611795755075e-25
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7184805897877538e-25
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.3592402948938769e-25
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.796201474469384e-26
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.398100737234692e-26
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.699050368617346e-26
EarlyStopping counter: 13 out of 100
Updating learning rate to 8.49525184308673e-27
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.247625921543365e-27
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.1238129607716826e-27
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.0619064803858413e-27
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.309532401929207e-28
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.6547662009646033e-28
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.3273831004823016e-28
EarlyStopping counter: 20 out of 100
Updating learning rate to 6.636915502411508e-29
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.318457751205754e-29
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.659228875602877e-29
EarlyStopping counter: 23 out of 100
Updating learning rate to 8.296144378014385e-30
EarlyStopping counter: 24 out of 100
Updating learning rate to 4.1480721890071926e-30
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.0740360945035963e-30
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.0370180472517982e-30
EarlyStopping counter: 27 out of 100
Updating learning rate to 5.185090236258991e-31
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.5925451181294954e-31
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.2962725590647477e-31
EarlyStopping counter: 30 out of 100
Updating learning rate to 6.481362795323738e-32
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.240681397661869e-32
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.6203406988309346e-32
EarlyStopping counter: 33 out of 100
Updating learning rate to 8.101703494154673e-33
EarlyStopping counter: 34 out of 100
Updating learning rate to 4.0508517470773366e-33
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.0254258735386683e-33
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.0127129367693341e-33
>>>>>> Testing on validation set: trial_41 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.050202127546072006, mae:0.07208584994077682, dtw:Not calculated


                                                                                         [I 2025-10-17 03:36:08,991] Trial 41 finished with value: 0.07208584994077682 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 2, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0006418830810772697, 'dropout': 0.10333521496828589}. Best is trial 31 with value: 0.07112950086593628.
Best trial: 31. Best value: 0.0711295:  82%|████████▏ | 41/50 [1:38:59<24:23, 162.57s/it]Best trial: 31. Best value: 0.0711295:  82%|████████▏ | 41/50 [1:38:59<24:23, 162.57s/it]Best trial: 31. Best value: 0.0711295:  84%|████████▍ | 42/50 [1:38:59<20:33, 154.23s/it]
============================================================
Trial 42
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000846
dropout: 0.16295223517697724
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_42 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.026078).  Saving model ...
Updating learning rate to 0.0008460392757787526
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0004230196378893763
Validation loss decreased (0.026078 --> 0.024975).  Saving model ...
Updating learning rate to 0.00021150981894468816
Validation loss decreased (0.024975 --> 0.023790).  Saving model ...
Updating learning rate to 0.00010575490947234408
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.287745473617204e-05
Validation loss decreased (0.023790 --> 0.023584).  Saving model ...
Updating learning rate to 2.643872736808602e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.321936368404301e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.609681842021505e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.3048409210107524e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6524204605053762e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.262102302526881e-07
Validation loss decreased (0.023584 --> 0.023437).  Saving model ...
Updating learning rate to 4.1310511512634406e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0655255756317203e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0327627878158601e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.163813939079301e-08
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.5819069695396503e-08
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2909534847698252e-08
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.454767423849126e-09
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.227383711924563e-09
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6136918559622815e-09
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.068459279811407e-10
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.0342296399057037e-10
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.0171148199528518e-10
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.0085574099764259e-10
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.0427870498821296e-11
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.5213935249410648e-11
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.2606967624705324e-11
EarlyStopping counter: 16 out of 100
Updating learning rate to 6.303483812352662e-12
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.151741906176331e-12
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.5758709530881655e-12
EarlyStopping counter: 19 out of 100
Updating learning rate to 7.879354765440827e-13
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.9396773827204137e-13
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.9698386913602069e-13
EarlyStopping counter: 22 out of 100
Updating learning rate to 9.849193456801034e-14
EarlyStopping counter: 23 out of 100
Updating learning rate to 4.924596728400517e-14
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.4622983642002586e-14
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.2311491821001293e-14
EarlyStopping counter: 26 out of 100
Updating learning rate to 6.1557459105006465e-15
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.0778729552503232e-15
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.5389364776251616e-15
EarlyStopping counter: 29 out of 100
Updating learning rate to 7.694682388125808e-16
EarlyStopping counter: 30 out of 100
Updating learning rate to 3.847341194062904e-16
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.923670597031452e-16
EarlyStopping counter: 32 out of 100
Updating learning rate to 9.61835298515726e-17
EarlyStopping counter: 33 out of 100
Updating learning rate to 4.80917649257863e-17
EarlyStopping counter: 34 out of 100
Updating learning rate to 2.404588246289315e-17
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.2022941231446575e-17
EarlyStopping counter: 36 out of 100
Updating learning rate to 6.0114706157232876e-18
EarlyStopping counter: 37 out of 100
Updating learning rate to 3.0057353078616438e-18
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.5028676539308219e-18
EarlyStopping counter: 39 out of 100
Updating learning rate to 7.514338269654109e-19
EarlyStopping counter: 40 out of 100
Updating learning rate to 3.7571691348270547e-19
EarlyStopping counter: 41 out of 100
Updating learning rate to 1.8785845674135274e-19
EarlyStopping counter: 42 out of 100
Updating learning rate to 9.392922837067637e-20
EarlyStopping counter: 43 out of 100
Updating learning rate to 4.6964614185338184e-20
EarlyStopping counter: 44 out of 100
Updating learning rate to 2.3482307092669092e-20
EarlyStopping counter: 45 out of 100
Updating learning rate to 1.1741153546334546e-20
EarlyStopping counter: 46 out of 100
Updating learning rate to 5.870576773167273e-21
EarlyStopping counter: 47 out of 100
Updating learning rate to 2.9352883865836365e-21
EarlyStopping counter: 48 out of 100
Updating learning rate to 1.4676441932918183e-21
EarlyStopping counter: 49 out of 100
Updating learning rate to 7.338220966459091e-22
EarlyStopping counter: 50 out of 100
Updating learning rate to 3.6691104832295456e-22
EarlyStopping counter: 51 out of 100
Updating learning rate to 1.8345552416147728e-22
EarlyStopping counter: 52 out of 100
Updating learning rate to 9.172776208073864e-23
EarlyStopping counter: 53 out of 100
Updating learning rate to 4.586388104036932e-23
EarlyStopping counter: 54 out of 100
Updating learning rate to 2.293194052018466e-23
EarlyStopping counter: 55 out of 100
Updating learning rate to 1.146597026009233e-23
EarlyStopping counter: 56 out of 100
Updating learning rate to 5.732985130046165e-24
EarlyStopping counter: 57 out of 100
Updating learning rate to 2.8664925650230825e-24
EarlyStopping counter: 58 out of 100
Updating learning rate to 1.4332462825115413e-24
EarlyStopping counter: 59 out of 100
Updating learning rate to 7.166231412557706e-25
EarlyStopping counter: 60 out of 100
Updating learning rate to 3.583115706278853e-25
EarlyStopping counter: 61 out of 100
Updating learning rate to 1.7915578531394266e-25
EarlyStopping counter: 62 out of 100
Updating learning rate to 8.957789265697133e-26
EarlyStopping counter: 63 out of 100
Updating learning rate to 4.4788946328485664e-26
EarlyStopping counter: 64 out of 100
Updating learning rate to 2.2394473164242832e-26
EarlyStopping counter: 65 out of 100
Updating learning rate to 1.1197236582121416e-26
EarlyStopping counter: 66 out of 100
Updating learning rate to 5.598618291060708e-27
EarlyStopping counter: 67 out of 100
Updating learning rate to 2.799309145530354e-27
EarlyStopping counter: 68 out of 100
Updating learning rate to 1.399654572765177e-27
EarlyStopping counter: 69 out of 100
Updating learning rate to 6.998272863825885e-28
EarlyStopping counter: 70 out of 100
Updating learning rate to 3.4991364319129425e-28
EarlyStopping counter: 71 out of 100
Updating learning rate to 1.7495682159564713e-28
Validation loss decreased (0.023437 --> 0.023352).  Saving model ...
Updating learning rate to 8.747841079782356e-29
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.373920539891178e-29
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.186960269945589e-29
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0934801349727945e-29
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.467400674863973e-30
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7337003374319864e-30
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3668501687159932e-30
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.834250843579966e-31
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.417125421789983e-31
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.7085627108949915e-31
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.542813554474957e-32
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.2714067772374787e-32
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.1357033886187393e-32
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.0678516943093697e-32
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.3392584715468484e-33
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.6696292357734242e-33
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.3348146178867121e-33
>>>>>> Testing on validation set: trial_42 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.050847481936216354, mae:0.07311742007732391, dtw:Not calculated


                                                                                         [I 2025-10-17 03:38:23,757] Trial 42 finished with value: 0.07311742007732391 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 2, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0008460392757787526, 'dropout': 0.16295223517697724}. Best is trial 31 with value: 0.07112950086593628.
Best trial: 31. Best value: 0.0711295:  84%|████████▍ | 42/50 [1:41:14<20:33, 154.23s/it]Best trial: 31. Best value: 0.0711295:  84%|████████▍ | 42/50 [1:41:14<20:33, 154.23s/it]Best trial: 31. Best value: 0.0711295:  86%|████████▌ | 43/50 [1:41:14<17:18, 148.39s/it]
============================================================
Trial 43
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000608
dropout: 0.18350981458344537
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_43 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.028089).  Saving model ...
Updating learning rate to 0.0006075916811582731
Validation loss decreased (0.028089 --> 0.024006).  Saving model ...
Updating learning rate to 0.00030379584057913656
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00015189792028956828
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.594896014478414e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.797448007239207e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8987240036196035e-05
Validation loss decreased (0.024006 --> 0.023713).  Saving model ...
Updating learning rate to 9.493620018098017e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.746810009049009e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.3734050045245044e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1867025022622522e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.933512511311261e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.9667562556556304e-07
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.4833781278278152e-07
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.416890639139076e-08
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.708445319569538e-08
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.854222659784769e-08
EarlyStopping counter: 10 out of 100
Updating learning rate to 9.271113298923845e-09
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.6355566494619226e-09
Validation loss decreased (0.023713 --> 0.023651).  Saving model ...
Updating learning rate to 2.3177783247309613e-09
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1588891623654806e-09
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.794445811827403e-10
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.8972229059137016e-10
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4486114529568508e-10
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.243057264784254e-11
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.621528632392127e-11
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8107643161960635e-11
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.053821580980318e-12
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.526910790490159e-12
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.2634553952450794e-12
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.1317276976225397e-12
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.658638488112698e-13
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.829319244056349e-13
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.4146596220281746e-13
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.073298110140873e-14
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.5366490550704365e-14
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.7683245275352183e-14
EarlyStopping counter: 18 out of 100
Updating learning rate to 8.841622637676091e-15
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.420811318838046e-15
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.210405659419023e-15
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.1052028297095114e-15
EarlyStopping counter: 22 out of 100
Updating learning rate to 5.526014148547557e-16
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.7630070742737785e-16
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.3815035371368893e-16
EarlyStopping counter: 25 out of 100
Updating learning rate to 6.907517685684446e-17
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.453758842842223e-17
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.7268794214211116e-17
EarlyStopping counter: 28 out of 100
Updating learning rate to 8.634397107105558e-18
EarlyStopping counter: 29 out of 100
Updating learning rate to 4.317198553552779e-18
EarlyStopping counter: 30 out of 100
Updating learning rate to 2.1585992767763895e-18
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.0792996383881947e-18
EarlyStopping counter: 32 out of 100
Updating learning rate to 5.396498191940974e-19
EarlyStopping counter: 33 out of 100
Updating learning rate to 2.698249095970487e-19
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.3491245479852434e-19
EarlyStopping counter: 35 out of 100
Updating learning rate to 6.745622739926217e-20
EarlyStopping counter: 36 out of 100
Updating learning rate to 3.3728113699631086e-20
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.6864056849815543e-20
EarlyStopping counter: 38 out of 100
Updating learning rate to 8.432028424907771e-21
EarlyStopping counter: 39 out of 100
Updating learning rate to 4.216014212453886e-21
EarlyStopping counter: 40 out of 100
Updating learning rate to 2.108007106226943e-21
EarlyStopping counter: 41 out of 100
Updating learning rate to 1.0540035531134714e-21
EarlyStopping counter: 42 out of 100
Updating learning rate to 5.270017765567357e-22
EarlyStopping counter: 43 out of 100
Updating learning rate to 2.6350088827836786e-22
EarlyStopping counter: 44 out of 100
Updating learning rate to 1.3175044413918393e-22
EarlyStopping counter: 45 out of 100
Updating learning rate to 6.587522206959196e-23
EarlyStopping counter: 46 out of 100
Updating learning rate to 3.293761103479598e-23
EarlyStopping counter: 47 out of 100
Updating learning rate to 1.646880551739799e-23
EarlyStopping counter: 48 out of 100
Updating learning rate to 8.234402758698996e-24
EarlyStopping counter: 49 out of 100
Updating learning rate to 4.117201379349498e-24
EarlyStopping counter: 50 out of 100
Updating learning rate to 2.058600689674749e-24
EarlyStopping counter: 51 out of 100
Updating learning rate to 1.0293003448373744e-24
EarlyStopping counter: 52 out of 100
Updating learning rate to 5.146501724186872e-25
EarlyStopping counter: 53 out of 100
Updating learning rate to 2.573250862093436e-25
EarlyStopping counter: 54 out of 100
Updating learning rate to 1.286625431046718e-25
EarlyStopping counter: 55 out of 100
Updating learning rate to 6.43312715523359e-26
EarlyStopping counter: 56 out of 100
Updating learning rate to 3.216563577616795e-26
EarlyStopping counter: 57 out of 100
Updating learning rate to 1.6082817888083976e-26
EarlyStopping counter: 58 out of 100
Updating learning rate to 8.041408944041988e-27
EarlyStopping counter: 59 out of 100
Updating learning rate to 4.020704472020994e-27
EarlyStopping counter: 60 out of 100
Updating learning rate to 2.010352236010497e-27
EarlyStopping counter: 61 out of 100
Updating learning rate to 1.0051761180052485e-27
EarlyStopping counter: 62 out of 100
Updating learning rate to 5.025880590026242e-28
EarlyStopping counter: 63 out of 100
Updating learning rate to 2.512940295013121e-28
EarlyStopping counter: 64 out of 100
Updating learning rate to 1.2564701475065606e-28
EarlyStopping counter: 65 out of 100
Updating learning rate to 6.282350737532803e-29
EarlyStopping counter: 66 out of 100
Updating learning rate to 3.1411753687664015e-29
EarlyStopping counter: 67 out of 100
Updating learning rate to 1.5705876843832007e-29
EarlyStopping counter: 68 out of 100
Updating learning rate to 7.852938421916004e-30
EarlyStopping counter: 69 out of 100
Updating learning rate to 3.926469210958002e-30
EarlyStopping counter: 70 out of 100
Updating learning rate to 1.963234605479001e-30
EarlyStopping counter: 71 out of 100
Updating learning rate to 9.816173027395005e-31
EarlyStopping counter: 72 out of 100
Updating learning rate to 4.908086513697502e-31
EarlyStopping counter: 73 out of 100
Updating learning rate to 2.454043256848751e-31
EarlyStopping counter: 74 out of 100
Updating learning rate to 1.2270216284243756e-31
EarlyStopping counter: 75 out of 100
Updating learning rate to 6.135108142121878e-32
EarlyStopping counter: 76 out of 100
Updating learning rate to 3.067554071060939e-32
EarlyStopping counter: 77 out of 100
Updating learning rate to 1.5337770355304695e-32
Validation loss decreased (0.023651 --> 0.023597).  Saving model ...
Updating learning rate to 7.668885177652347e-33
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.834442588826174e-33
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.917221294413087e-33
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.586106472065434e-34
>>>>>> Testing on validation set: trial_43 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.04959917813539505, mae:0.07224669307470322, dtw:Not calculated


                                                                                         [I 2025-10-17 03:40:38,133] Trial 43 finished with value: 0.07224669307470322 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 2, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0006075916811582731, 'dropout': 0.18350981458344537}. Best is trial 31 with value: 0.07112950086593628.
Best trial: 31. Best value: 0.0711295:  86%|████████▌ | 43/50 [1:43:28<17:18, 148.39s/it]Best trial: 31. Best value: 0.0711295:  86%|████████▌ | 43/50 [1:43:28<17:18, 148.39s/it]Best trial: 31. Best value: 0.0711295:  88%|████████▊ | 44/50 [1:43:28<14:25, 144.19s/it]
============================================================
Trial 44
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000520
dropout: 0.21257018070092704
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_44 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.028401).  Saving model ...
Updating learning rate to 0.000520484574999753
Validation loss decreased (0.028401 --> 0.025344).  Saving model ...
Updating learning rate to 0.0002602422874998765
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00013012114374993825
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.506057187496912e-05
Validation loss decreased (0.025344 --> 0.024190).  Saving model ...
Updating learning rate to 3.253028593748456e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.626514296874228e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.13257148437114e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.06628574218557e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.033142871092785e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0165714355463925e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.082857177731963e-07
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.5414285888659814e-07
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.2707142944329907e-07
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.353571472164953e-08
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.176785736082477e-08
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.5883928680412384e-08
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.941964340206192e-09
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.970982170103096e-09
Validation loss decreased (0.024190 --> 0.024010).  Saving model ...
Updating learning rate to 1.985491085051548e-09
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.92745542525774e-10
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.96372771262887e-10
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.481863856314435e-10
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2409319281572175e-10
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.204659640786087e-11
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.1023298203930437e-11
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.5511649101965218e-11
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.755824550982609e-12
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.8779122754913046e-12
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.9389561377456523e-12
EarlyStopping counter: 11 out of 100
Updating learning rate to 9.694780688728261e-13
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.847390344364131e-13
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.4236951721820654e-13
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.2118475860910327e-13
EarlyStopping counter: 15 out of 100
Updating learning rate to 6.059237930455163e-14
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.029618965227582e-14
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.514809482613791e-14
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.574047413068954e-15
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.787023706534477e-15
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.8935118532672386e-15
EarlyStopping counter: 21 out of 100
Updating learning rate to 9.467559266336193e-16
EarlyStopping counter: 22 out of 100
Updating learning rate to 4.733779633168096e-16
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.366889816584048e-16
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.183444908292024e-16
EarlyStopping counter: 25 out of 100
Updating learning rate to 5.91722454146012e-17
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.95861227073006e-17
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.47930613536503e-17
EarlyStopping counter: 28 out of 100
Updating learning rate to 7.39653067682515e-18
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.698265338412575e-18
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.8491326692062877e-18
EarlyStopping counter: 31 out of 100
Updating learning rate to 9.245663346031438e-19
EarlyStopping counter: 32 out of 100
Updating learning rate to 4.622831673015719e-19
EarlyStopping counter: 33 out of 100
Updating learning rate to 2.3114158365078596e-19
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.1557079182539298e-19
EarlyStopping counter: 35 out of 100
Updating learning rate to 5.778539591269649e-20
EarlyStopping counter: 36 out of 100
Updating learning rate to 2.8892697956348245e-20
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.4446348978174122e-20
EarlyStopping counter: 38 out of 100
Updating learning rate to 7.223174489087061e-21
EarlyStopping counter: 39 out of 100
Updating learning rate to 3.6115872445435306e-21
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.8057936222717653e-21
EarlyStopping counter: 41 out of 100
Updating learning rate to 9.028968111358826e-22
EarlyStopping counter: 42 out of 100
Updating learning rate to 4.514484055679413e-22
EarlyStopping counter: 43 out of 100
Updating learning rate to 2.2572420278397066e-22
EarlyStopping counter: 44 out of 100
Updating learning rate to 1.1286210139198533e-22
EarlyStopping counter: 45 out of 100
Updating learning rate to 5.643105069599267e-23
EarlyStopping counter: 46 out of 100
Updating learning rate to 2.821552534799633e-23
EarlyStopping counter: 47 out of 100
Updating learning rate to 1.4107762673998166e-23
EarlyStopping counter: 48 out of 100
Updating learning rate to 7.053881336999083e-24
EarlyStopping counter: 49 out of 100
Updating learning rate to 3.5269406684995416e-24
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.7634703342497708e-24
EarlyStopping counter: 51 out of 100
Updating learning rate to 8.817351671248854e-25
EarlyStopping counter: 52 out of 100
Updating learning rate to 4.408675835624427e-25
EarlyStopping counter: 53 out of 100
Updating learning rate to 2.2043379178122135e-25
EarlyStopping counter: 54 out of 100
Updating learning rate to 1.1021689589061067e-25
EarlyStopping counter: 55 out of 100
Updating learning rate to 5.510844794530534e-26
EarlyStopping counter: 56 out of 100
Updating learning rate to 2.755422397265267e-26
EarlyStopping counter: 57 out of 100
Updating learning rate to 1.3777111986326334e-26
EarlyStopping counter: 58 out of 100
Updating learning rate to 6.888555993163167e-27
EarlyStopping counter: 59 out of 100
Updating learning rate to 3.4442779965815836e-27
EarlyStopping counter: 60 out of 100
Updating learning rate to 1.7221389982907918e-27
EarlyStopping counter: 61 out of 100
Updating learning rate to 8.610694991453959e-28
EarlyStopping counter: 62 out of 100
Updating learning rate to 4.3053474957269795e-28
EarlyStopping counter: 63 out of 100
Updating learning rate to 2.1526737478634897e-28
EarlyStopping counter: 64 out of 100
Updating learning rate to 1.0763368739317449e-28
EarlyStopping counter: 65 out of 100
Updating learning rate to 5.381684369658724e-29
EarlyStopping counter: 66 out of 100
Updating learning rate to 2.690842184829362e-29
EarlyStopping counter: 67 out of 100
Updating learning rate to 1.345421092414681e-29
EarlyStopping counter: 68 out of 100
Updating learning rate to 6.727105462073405e-30
EarlyStopping counter: 69 out of 100
Updating learning rate to 3.363552731036703e-30
EarlyStopping counter: 70 out of 100
Updating learning rate to 1.6817763655183514e-30
EarlyStopping counter: 71 out of 100
Updating learning rate to 8.408881827591757e-31
EarlyStopping counter: 72 out of 100
Updating learning rate to 4.204440913795878e-31
EarlyStopping counter: 73 out of 100
Updating learning rate to 2.102220456897939e-31
Validation loss decreased (0.024010 --> 0.024009).  Saving model ...
Updating learning rate to 1.0511102284489696e-31
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.255551142244848e-32
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.627775571122424e-32
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.313887785561212e-32
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.56943892780606e-33
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.28471946390303e-33
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.642359731951515e-33
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.211798659757575e-34
>>>>>> Testing on validation set: trial_44 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.04975620284676552, mae:0.07206737995147705, dtw:Not calculated


                                                                                         [I 2025-10-17 03:42:52,597] Trial 44 finished with value: 0.07206737995147705 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 2, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.000520484574999753, 'dropout': 0.21257018070092704}. Best is trial 31 with value: 0.07112950086593628.
Best trial: 31. Best value: 0.0711295:  88%|████████▊ | 44/50 [1:45:43<14:25, 144.19s/it]Best trial: 31. Best value: 0.0711295:  88%|████████▊ | 44/50 [1:45:43<14:25, 144.19s/it]Best trial: 31. Best value: 0.0711295:  90%|█████████ | 45/50 [1:45:43<11:46, 141.27s/it]
============================================================
Trial 45
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 2, d_layers: 2
batch_size: 64, lr: 0.000389
dropout: 0.15246454412399807
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_45 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.029322).  Saving model ...
Updating learning rate to 0.0003893905884092001
Validation loss decreased (0.029322 --> 0.025817).  Saving model ...
Updating learning rate to 0.00019469529420460005
Validation loss decreased (0.025817 --> 0.024412).  Saving model ...
Updating learning rate to 9.734764710230002e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.867382355115001e-05
Validation loss decreased (0.024412 --> 0.021775).  Saving model ...
Updating learning rate to 2.4336911775575006e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2168455887787503e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.084227943893751e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.0421139719468757e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5210569859734379e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.605284929867189e-07
Validation loss decreased (0.021775 --> 0.021477).  Saving model ...
Updating learning rate to 3.8026424649335946e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.9013212324667973e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.506606162333987e-08
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.753303081166993e-08
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.3766515405834966e-08
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1883257702917483e-08
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.941628851458742e-09
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.970814425729371e-09
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.4854072128646854e-09
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.427036064323427e-10
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.7135180321617135e-10
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.8567590160808568e-10
EarlyStopping counter: 12 out of 100
Updating learning rate to 9.283795080404284e-11
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.641897540202142e-11
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.320948770101071e-11
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.1604743850505355e-11
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.802371925252677e-12
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.9011859626263387e-12
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.4505929813131693e-12
EarlyStopping counter: 19 out of 100
Updating learning rate to 7.252964906565847e-13
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.6264824532829234e-13
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.8132412266414617e-13
EarlyStopping counter: 22 out of 100
Updating learning rate to 9.066206133207308e-14
EarlyStopping counter: 23 out of 100
Updating learning rate to 4.533103066603654e-14
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.266551533301827e-14
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.1332757666509135e-14
EarlyStopping counter: 26 out of 100
Updating learning rate to 5.666378833254568e-15
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.833189416627284e-15
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.416594708313642e-15
Validation loss decreased (0.021477 --> 0.021298).  Saving model ...
Updating learning rate to 7.08297354156821e-16
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.541486770784105e-16
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.7707433853920524e-16
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.853716926960262e-17
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.426858463480131e-17
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2134292317400655e-17
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1067146158700328e-17
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.533573079350164e-18
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.766786539675082e-18
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.383393269837541e-18
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.916966349187705e-19
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.4584831745938524e-19
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.7292415872969262e-19
EarlyStopping counter: 13 out of 100
Updating learning rate to 8.646207936484631e-20
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.3231039682423155e-20
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.1615519841211577e-20
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.0807759920605789e-20
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.403879960302894e-21
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.701939980151447e-21
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.3509699900757236e-21
EarlyStopping counter: 20 out of 100
Updating learning rate to 6.754849950378618e-22
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.377424975189309e-22
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.6887124875946545e-22
EarlyStopping counter: 23 out of 100
Updating learning rate to 8.443562437973272e-23
EarlyStopping counter: 24 out of 100
Updating learning rate to 4.221781218986636e-23
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.110890609493318e-23
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.055445304746659e-23
EarlyStopping counter: 27 out of 100
Updating learning rate to 5.277226523733295e-24
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.6386132618666476e-24
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.3193066309333238e-24
EarlyStopping counter: 30 out of 100
Updating learning rate to 6.596533154666619e-25
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.2982665773333095e-25
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.6491332886666548e-25
EarlyStopping counter: 33 out of 100
Updating learning rate to 8.245666443333274e-26
EarlyStopping counter: 34 out of 100
Updating learning rate to 4.122833221666637e-26
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.0614166108333185e-26
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.0307083054166592e-26
EarlyStopping counter: 37 out of 100
Updating learning rate to 5.153541527083296e-27
EarlyStopping counter: 38 out of 100
Updating learning rate to 2.576770763541648e-27
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.288385381770824e-27
EarlyStopping counter: 40 out of 100
Updating learning rate to 6.44192690885412e-28
EarlyStopping counter: 41 out of 100
Updating learning rate to 3.22096345442706e-28
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.61048172721353e-28
EarlyStopping counter: 43 out of 100
Updating learning rate to 8.05240863606765e-29
EarlyStopping counter: 44 out of 100
Updating learning rate to 4.026204318033825e-29
EarlyStopping counter: 45 out of 100
Updating learning rate to 2.0131021590169126e-29
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.0065510795084563e-29
EarlyStopping counter: 47 out of 100
Updating learning rate to 5.0327553975422814e-30
EarlyStopping counter: 48 out of 100
Updating learning rate to 2.5163776987711407e-30
Validation loss decreased (0.021298 --> 0.021111).  Saving model ...
Updating learning rate to 1.2581888493855703e-30
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.290944246927852e-31
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.145472123463926e-31
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.572736061731963e-31
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.863680308659815e-32
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.9318401543299073e-32
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.9659200771649537e-32
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.829600385824768e-33
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.914800192912384e-33
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.457400096456192e-33
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.228700048228096e-33
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.14350024114048e-34
>>>>>> Testing on validation set: trial_45 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.04906168207526207, mae:0.07421481609344482, dtw:Not calculated


                                                                                         [I 2025-10-17 03:44:01,794] Trial 45 finished with value: 0.07421481609344482 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 2, 'd_model': 64, 'n_heads': 8, 'e_layers': 2, 'd_layers': 2, 'batch_size': 64, 'learning_rate': 0.0003893905884092001, 'dropout': 0.15246454412399807}. Best is trial 31 with value: 0.07112950086593628.
Best trial: 31. Best value: 0.0711295:  90%|█████████ | 45/50 [1:46:52<11:46, 141.27s/it]Best trial: 31. Best value: 0.0711295:  90%|█████████ | 45/50 [1:46:52<11:46, 141.27s/it]Best trial: 31. Best value: 0.0711295:  92%|█████████▏| 46/50 [1:46:52<07:58, 119.65s/it]
============================================================
Trial 46
============================================================
seq_len: 96, pred_len: 1
d_model: 64, n_heads: 4
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000016
dropout: 0.12811170276082962
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_46 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 1
============================================================
train 4577
val 259
test 261
Validation loss decreased (inf --> 0.033152).  Saving model ...
Updating learning rate to 1.63800750030214e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.1900375015107e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.09501875075535e-06
Validation loss decreased (0.033152 --> 0.031320).  Saving model ...
Updating learning rate to 2.047509375377675e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0237546876888376e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.118773438444188e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.559386719222094e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.279693359611047e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.398466798055235e-08
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.1992333990276174e-08
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.5996166995138087e-08
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.998083497569044e-09
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.999041748784522e-09
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.999520874392261e-09
EarlyStopping counter: 11 out of 100
Updating learning rate to 9.997604371961304e-10
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.998802185980652e-10
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.499401092990326e-10
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.249700546495163e-10
EarlyStopping counter: 15 out of 100
Updating learning rate to 6.248502732475815e-11
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.1242513662379077e-11
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.5621256831189538e-11
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.810628415594769e-12
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.9053142077973846e-12
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.9526571038986923e-12
EarlyStopping counter: 21 out of 100
Updating learning rate to 9.763285519493461e-13
EarlyStopping counter: 22 out of 100
Updating learning rate to 4.881642759746731e-13
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.4408213798733654e-13
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.2204106899366827e-13
EarlyStopping counter: 25 out of 100
Updating learning rate to 6.102053449683413e-14
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.051026724841707e-14
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.5255133624208533e-14
EarlyStopping counter: 28 out of 100
Updating learning rate to 7.627566812104267e-15
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.813783406052133e-15
Validation loss decreased (0.031320 --> 0.031151).  Saving model ...
Updating learning rate to 1.9068917030260667e-15
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.534458515130333e-16
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.767229257565167e-16
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.3836146287825834e-16
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1918073143912917e-16
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.959036571956458e-17
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.979518285978229e-17
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4897591429891146e-17
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.448795714945573e-18
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.7243978574727865e-18
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.8621989287363932e-18
EarlyStopping counter: 11 out of 100
Updating learning rate to 9.310994643681966e-19
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.655497321840983e-19
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.3277486609204916e-19
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.1638743304602458e-19
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.819371652301229e-20
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.9096858261506144e-20
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.4548429130753072e-20
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.274214565376536e-21
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.637107282688268e-21
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.818553641344134e-21
EarlyStopping counter: 21 out of 100
Updating learning rate to 9.09276820672067e-22
EarlyStopping counter: 22 out of 100
Updating learning rate to 4.546384103360335e-22
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.2731920516801675e-22
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.1365960258400838e-22
EarlyStopping counter: 25 out of 100
Updating learning rate to 5.682980129200419e-23
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.8414900646002094e-23
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.4207450323001047e-23
EarlyStopping counter: 28 out of 100
Updating learning rate to 7.103725161500524e-24
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.551862580750262e-24
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.775931290375131e-24
EarlyStopping counter: 31 out of 100
Updating learning rate to 8.879656451875654e-25
EarlyStopping counter: 32 out of 100
Updating learning rate to 4.439828225937827e-25
EarlyStopping counter: 33 out of 100
Updating learning rate to 2.2199141129689136e-25
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.1099570564844568e-25
EarlyStopping counter: 35 out of 100
Updating learning rate to 5.549785282422284e-26
EarlyStopping counter: 36 out of 100
Updating learning rate to 2.774892641211142e-26
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.387446320605571e-26
EarlyStopping counter: 38 out of 100
Updating learning rate to 6.937231603027855e-27
EarlyStopping counter: 39 out of 100
Updating learning rate to 3.4686158015139275e-27
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.7343079007569638e-27
EarlyStopping counter: 41 out of 100
Updating learning rate to 8.671539503784819e-28
EarlyStopping counter: 42 out of 100
Updating learning rate to 4.335769751892409e-28
EarlyStopping counter: 43 out of 100
Updating learning rate to 2.1678848759462047e-28
EarlyStopping counter: 44 out of 100
Updating learning rate to 1.0839424379731023e-28
EarlyStopping counter: 45 out of 100
Updating learning rate to 5.419712189865512e-29
EarlyStopping counter: 46 out of 100
Updating learning rate to 2.709856094932756e-29
EarlyStopping counter: 47 out of 100
Updating learning rate to 1.354928047466378e-29
EarlyStopping counter: 48 out of 100
Updating learning rate to 6.77464023733189e-30
EarlyStopping counter: 49 out of 100
Updating learning rate to 3.387320118665945e-30
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.6936600593329724e-30
EarlyStopping counter: 51 out of 100
Updating learning rate to 8.468300296664862e-31
EarlyStopping counter: 52 out of 100
Updating learning rate to 4.234150148332431e-31
EarlyStopping counter: 53 out of 100
Updating learning rate to 2.1170750741662155e-31
EarlyStopping counter: 54 out of 100
Updating learning rate to 1.0585375370831078e-31
EarlyStopping counter: 55 out of 100
Updating learning rate to 5.292687685415539e-32
EarlyStopping counter: 56 out of 100
Updating learning rate to 2.6463438427077694e-32
EarlyStopping counter: 57 out of 100
Updating learning rate to 1.3231719213538847e-32
EarlyStopping counter: 58 out of 100
Updating learning rate to 6.615859606769424e-33
EarlyStopping counter: 59 out of 100
Updating learning rate to 3.307929803384712e-33
EarlyStopping counter: 60 out of 100
Updating learning rate to 1.653964901692356e-33
EarlyStopping counter: 61 out of 100
Updating learning rate to 8.26982450846178e-34
EarlyStopping counter: 62 out of 100
Updating learning rate to 4.13491225423089e-34
EarlyStopping counter: 63 out of 100
Updating learning rate to 2.067456127115445e-34
EarlyStopping counter: 64 out of 100
Updating learning rate to 1.0337280635577224e-34
EarlyStopping counter: 65 out of 100
Updating learning rate to 5.168640317788612e-35
EarlyStopping counter: 66 out of 100
Updating learning rate to 2.584320158894306e-35
>>>>>> Testing on validation set: trial_46 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.06476103514432907, mae:0.11220557987689972, dtw:Not calculated


                                                                                         [I 2025-10-17 03:46:14,820] Trial 46 finished with value: 0.11220557987689972 and parameters: {'seq_len': 96, 'pred_len': 1, 'expand': 1, 'd_model': 64, 'n_heads': 4, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 1.63800750030214e-05, 'dropout': 0.12811170276082962}. Best is trial 31 with value: 0.07112950086593628.
Best trial: 31. Best value: 0.0711295:  92%|█████████▏| 46/50 [1:49:05<07:58, 119.65s/it]Best trial: 31. Best value: 0.0711295:  92%|█████████▏| 46/50 [1:49:05<07:58, 119.65s/it]Best trial: 31. Best value: 0.0711295:  94%|█████████▍| 47/50 [1:49:05<06:10, 123.66s/it]
============================================================
Trial 47
============================================================
seq_len: 48, pred_len: 14
d_model: 32, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000971
dropout: 0.10832567801011261
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 64, expand: 2
>>>>>> Start training: trial_47 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 14
============================================================
train 4612
val 246
test 248
Validation loss decreased (inf --> 0.041118).  Saving model ...
Updating learning rate to 0.0009713656774281264
Validation loss decreased (0.041118 --> 0.040152).  Saving model ...
Updating learning rate to 0.0004856828387140632
Validation loss decreased (0.040152 --> 0.039332).  Saving model ...
Updating learning rate to 0.0002428414193570316
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0001214207096785158
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.07103548392579e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.035517741962895e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5177588709814474e-05
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.588794354907237e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.7943971774536186e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8971985887268093e-06
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.485992943634047e-07
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.7429964718170233e-07
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.3714982359085116e-07
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.1857491179542558e-07
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.928745589771279e-08
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.9643727948856395e-08
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.4821863974428198e-08
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.410931987214099e-09
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.7054659936070494e-09
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.8527329968035247e-09
EarlyStopping counter: 18 out of 100
Updating learning rate to 9.263664984017624e-10
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.631832492008812e-10
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.315916246004406e-10
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.157958123002203e-10
EarlyStopping counter: 22 out of 100
Updating learning rate to 5.789790615011015e-11
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.8948953075055074e-11
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.4474476537527537e-11
EarlyStopping counter: 25 out of 100
Updating learning rate to 7.2372382687637684e-12
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.6186191343818842e-12
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.8093095671909421e-12
EarlyStopping counter: 28 out of 100
Updating learning rate to 9.046547835954711e-13
EarlyStopping counter: 29 out of 100
Updating learning rate to 4.5232739179773553e-13
EarlyStopping counter: 30 out of 100
Updating learning rate to 2.2616369589886776e-13
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.1308184794943388e-13
EarlyStopping counter: 32 out of 100
Updating learning rate to 5.654092397471694e-14
EarlyStopping counter: 33 out of 100
Updating learning rate to 2.827046198735847e-14
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.4135230993679235e-14
EarlyStopping counter: 35 out of 100
Updating learning rate to 7.0676154968396176e-15
EarlyStopping counter: 36 out of 100
Updating learning rate to 3.5338077484198088e-15
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.7669038742099044e-15
EarlyStopping counter: 38 out of 100
Updating learning rate to 8.834519371049522e-16
EarlyStopping counter: 39 out of 100
Updating learning rate to 4.417259685524761e-16
EarlyStopping counter: 40 out of 100
Updating learning rate to 2.2086298427623805e-16
EarlyStopping counter: 41 out of 100
Updating learning rate to 1.1043149213811902e-16
EarlyStopping counter: 42 out of 100
Updating learning rate to 5.521574606905951e-17
EarlyStopping counter: 43 out of 100
Updating learning rate to 2.7607873034529756e-17
EarlyStopping counter: 44 out of 100
Updating learning rate to 1.3803936517264878e-17
EarlyStopping counter: 45 out of 100
Updating learning rate to 6.901968258632439e-18
EarlyStopping counter: 46 out of 100
Updating learning rate to 3.4509841293162195e-18
EarlyStopping counter: 47 out of 100
Updating learning rate to 1.7254920646581098e-18
EarlyStopping counter: 48 out of 100
Updating learning rate to 8.627460323290549e-19
EarlyStopping counter: 49 out of 100
Updating learning rate to 4.3137301616452744e-19
EarlyStopping counter: 50 out of 100
Updating learning rate to 2.1568650808226372e-19
EarlyStopping counter: 51 out of 100
Updating learning rate to 1.0784325404113186e-19
EarlyStopping counter: 52 out of 100
Updating learning rate to 5.392162702056593e-20
EarlyStopping counter: 53 out of 100
Updating learning rate to 2.6960813510282965e-20
EarlyStopping counter: 54 out of 100
Updating learning rate to 1.3480406755141483e-20
EarlyStopping counter: 55 out of 100
Updating learning rate to 6.740203377570741e-21
EarlyStopping counter: 56 out of 100
Updating learning rate to 3.3701016887853706e-21
EarlyStopping counter: 57 out of 100
Updating learning rate to 1.6850508443926853e-21
EarlyStopping counter: 58 out of 100
Updating learning rate to 8.425254221963427e-22
EarlyStopping counter: 59 out of 100
Updating learning rate to 4.2126271109817133e-22
EarlyStopping counter: 60 out of 100
Updating learning rate to 2.1063135554908566e-22
EarlyStopping counter: 61 out of 100
Updating learning rate to 1.0531567777454283e-22
EarlyStopping counter: 62 out of 100
Updating learning rate to 5.2657838887271416e-23
EarlyStopping counter: 63 out of 100
Updating learning rate to 2.6328919443635708e-23
EarlyStopping counter: 64 out of 100
Updating learning rate to 1.3164459721817854e-23
EarlyStopping counter: 65 out of 100
Updating learning rate to 6.582229860908927e-24
EarlyStopping counter: 66 out of 100
Updating learning rate to 3.2911149304544635e-24
EarlyStopping counter: 67 out of 100
Updating learning rate to 1.6455574652272318e-24
EarlyStopping counter: 68 out of 100
Updating learning rate to 8.227787326136159e-25
EarlyStopping counter: 69 out of 100
Updating learning rate to 4.1138936630680794e-25
EarlyStopping counter: 70 out of 100
Updating learning rate to 2.0569468315340397e-25
EarlyStopping counter: 71 out of 100
Updating learning rate to 1.0284734157670198e-25
EarlyStopping counter: 72 out of 100
Updating learning rate to 5.142367078835099e-26
EarlyStopping counter: 73 out of 100
Updating learning rate to 2.5711835394175496e-26
EarlyStopping counter: 74 out of 100
Updating learning rate to 1.2855917697087748e-26
EarlyStopping counter: 75 out of 100
Updating learning rate to 6.427958848543874e-27
EarlyStopping counter: 76 out of 100
Updating learning rate to 3.213979424271937e-27
EarlyStopping counter: 77 out of 100
Updating learning rate to 1.6069897121359685e-27
EarlyStopping counter: 78 out of 100
Updating learning rate to 8.0349485606798425e-28
EarlyStopping counter: 79 out of 100
Updating learning rate to 4.0174742803399213e-28
EarlyStopping counter: 80 out of 100
Updating learning rate to 2.0087371401699606e-28
EarlyStopping counter: 81 out of 100
Updating learning rate to 1.0043685700849803e-28
EarlyStopping counter: 82 out of 100
Updating learning rate to 5.0218428504249016e-29
EarlyStopping counter: 83 out of 100
Updating learning rate to 2.5109214252124508e-29
EarlyStopping counter: 84 out of 100
Updating learning rate to 1.2554607126062254e-29
EarlyStopping counter: 85 out of 100
Updating learning rate to 6.277303563031127e-30
EarlyStopping counter: 86 out of 100
Updating learning rate to 3.1386517815155635e-30
EarlyStopping counter: 87 out of 100
Updating learning rate to 1.5693258907577817e-30
EarlyStopping counter: 88 out of 100
Updating learning rate to 7.846629453788909e-31
EarlyStopping counter: 89 out of 100
Updating learning rate to 3.9233147268944544e-31
EarlyStopping counter: 90 out of 100
Updating learning rate to 1.9616573634472272e-31
EarlyStopping counter: 91 out of 100
Updating learning rate to 9.808286817236136e-32
EarlyStopping counter: 92 out of 100
Updating learning rate to 4.904143408618068e-32
EarlyStopping counter: 93 out of 100
Updating learning rate to 2.452071704309034e-32
EarlyStopping counter: 94 out of 100
Updating learning rate to 1.226035852154517e-32
EarlyStopping counter: 95 out of 100
Updating learning rate to 6.130179260772585e-33
EarlyStopping counter: 96 out of 100
Updating learning rate to 3.0650896303862925e-33
EarlyStopping counter: 97 out of 100
Updating learning rate to 1.5325448151931462e-33
>>>>>> Testing on validation set: trial_47 >>>>>>
test 248
test shape: (248, 14, 5) (248, 14, 5)
test shape: (248, 14, 5) (248, 14, 5)


	mse:0.06900282949209213, mae:0.1039469912648201, dtw:Not calculated


                                                                                         [I 2025-10-17 03:48:27,941] Trial 47 finished with value: 0.1039469912648201 and parameters: {'seq_len': 48, 'pred_len': 14, 'expand': 2, 'd_model': 32, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0009713656774281264, 'dropout': 0.10832567801011261}. Best is trial 31 with value: 0.07112950086593628.
Best trial: 31. Best value: 0.0711295:  94%|█████████▍| 47/50 [1:51:18<06:10, 123.66s/it]Best trial: 31. Best value: 0.0711295:  94%|█████████▍| 47/50 [1:51:18<06:10, 123.66s/it]Best trial: 31. Best value: 0.0711295:  96%|█████████▌| 48/50 [1:51:18<04:12, 126.50s/it]
============================================================
Trial 48
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000285
dropout: 0.17673345586103384
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_48 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.027937).  Saving model ...
Updating learning rate to 0.00028452041811287757
Validation loss decreased (0.027937 --> 0.027507).  Saving model ...
Updating learning rate to 0.00014226020905643878
Validation loss decreased (0.027507 --> 0.025533).  Saving model ...
Updating learning rate to 7.113010452821939e-05
Validation loss decreased (0.025533 --> 0.025373).  Saving model ...
Updating learning rate to 3.5565052264109696e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.7782526132054848e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.891263066027424e-06
Validation loss decreased (0.025373 --> 0.024700).  Saving model ...
Updating learning rate to 4.445631533013712e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.222815766506856e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.111407883253428e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.55703941626714e-07
Validation loss decreased (0.024700 --> 0.024668).  Saving model ...
Updating learning rate to 2.77851970813357e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.389259854066785e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.946299270333925e-08
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4731496351669625e-08
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.7365748175834812e-08
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.682874087917406e-09
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.341437043958703e-09
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.1707185219793515e-09
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.0853592609896758e-09
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.426796304948379e-10
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7133981524741894e-10
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.3566990762370947e-10
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.783495381185474e-11
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.391747690592737e-11
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.6958738452963684e-11
EarlyStopping counter: 15 out of 100
Updating learning rate to 8.479369226481842e-12
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.239684613240921e-12
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.1198423066204605e-12
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.0599211533102302e-12
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.299605766551151e-13
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.6498028832755756e-13
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.3249014416377878e-13
EarlyStopping counter: 22 out of 100
Updating learning rate to 6.624507208188939e-14
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.3122536040944695e-14
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.6561268020472348e-14
Validation loss decreased (0.024668 --> 0.024599).  Saving model ...
Updating learning rate to 8.280634010236174e-15
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.140317005118087e-15
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0701585025590434e-15
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0350792512795217e-15
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.175396256397609e-16
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.5876981281988043e-16
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.2938490640994022e-16
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.469245320497011e-17
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.2346226602485054e-17
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.6173113301242527e-17
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.086556650621263e-18
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.043278325310632e-18
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.021639162655316e-18
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.010819581327658e-18
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.05409790663829e-19
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.527048953319145e-19
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.2635244766595724e-19
EarlyStopping counter: 17 out of 100
Updating learning rate to 6.317622383297862e-20
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.158811191648931e-20
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.5794055958244655e-20
EarlyStopping counter: 20 out of 100
Updating learning rate to 7.897027979122328e-21
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.948513989561164e-21
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.974256994780582e-21
EarlyStopping counter: 23 out of 100
Updating learning rate to 9.87128497390291e-22
EarlyStopping counter: 24 out of 100
Updating learning rate to 4.935642486951455e-22
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.4678212434757274e-22
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.2339106217378637e-22
EarlyStopping counter: 27 out of 100
Updating learning rate to 6.169553108689318e-23
EarlyStopping counter: 28 out of 100
Updating learning rate to 3.084776554344659e-23
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.5423882771723296e-23
EarlyStopping counter: 30 out of 100
Updating learning rate to 7.711941385861648e-24
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.855970692930824e-24
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.927985346465412e-24
EarlyStopping counter: 33 out of 100
Updating learning rate to 9.63992673232706e-25
EarlyStopping counter: 34 out of 100
Updating learning rate to 4.81996336616353e-25
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.409981683081765e-25
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.2049908415408825e-25
EarlyStopping counter: 37 out of 100
Updating learning rate to 6.024954207704413e-26
EarlyStopping counter: 38 out of 100
Updating learning rate to 3.012477103852206e-26
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.506238551926103e-26
EarlyStopping counter: 40 out of 100
Updating learning rate to 7.531192759630516e-27
EarlyStopping counter: 41 out of 100
Updating learning rate to 3.765596379815258e-27
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.882798189907629e-27
EarlyStopping counter: 43 out of 100
Updating learning rate to 9.413990949538145e-28
EarlyStopping counter: 44 out of 100
Updating learning rate to 4.706995474769072e-28
EarlyStopping counter: 45 out of 100
Updating learning rate to 2.353497737384536e-28
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.176748868692268e-28
EarlyStopping counter: 47 out of 100
Updating learning rate to 5.88374434346134e-29
EarlyStopping counter: 48 out of 100
Updating learning rate to 2.94187217173067e-29
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.470936085865335e-29
EarlyStopping counter: 50 out of 100
Updating learning rate to 7.354680429326675e-30
EarlyStopping counter: 51 out of 100
Updating learning rate to 3.677340214663338e-30
EarlyStopping counter: 52 out of 100
Updating learning rate to 1.838670107331669e-30
EarlyStopping counter: 53 out of 100
Updating learning rate to 9.193350536658344e-31
EarlyStopping counter: 54 out of 100
Updating learning rate to 4.596675268329172e-31
EarlyStopping counter: 55 out of 100
Updating learning rate to 2.298337634164586e-31
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.149168817082293e-31
EarlyStopping counter: 57 out of 100
Updating learning rate to 5.745844085411465e-32
EarlyStopping counter: 58 out of 100
Updating learning rate to 2.8729220427057326e-32
EarlyStopping counter: 59 out of 100
Updating learning rate to 1.4364610213528663e-32
EarlyStopping counter: 60 out of 100
Updating learning rate to 7.182305106764332e-33
EarlyStopping counter: 61 out of 100
Updating learning rate to 3.591152553382166e-33
EarlyStopping counter: 62 out of 100
Updating learning rate to 1.795576276691083e-33
EarlyStopping counter: 63 out of 100
Updating learning rate to 8.977881383455414e-34
EarlyStopping counter: 64 out of 100
Updating learning rate to 4.488940691727707e-34
>>>>>> Testing on validation set: trial_48 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.05084463581442833, mae:0.07561824470758438, dtw:Not calculated


                                                                                         [I 2025-10-17 03:50:43,088] Trial 48 finished with value: 0.07561824470758438 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 2, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.00028452041811287757, 'dropout': 0.17673345586103384}. Best is trial 31 with value: 0.07112950086593628.
Best trial: 31. Best value: 0.0711295:  96%|█████████▌| 48/50 [1:53:33<04:12, 126.50s/it]Best trial: 31. Best value: 0.0711295:  96%|█████████▌| 48/50 [1:53:33<04:12, 126.50s/it]Best trial: 31. Best value: 0.0711295:  98%|█████████▊| 49/50 [1:53:33<02:09, 129.09s/it]
============================================================
Trial 49
============================================================
seq_len: 48, pred_len: 7
d_model: 64, n_heads: 8
e_layers: 2, d_layers: 2
batch_size: 64, lr: 0.000109
dropout: 0.029855418853640917
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_49 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 7
============================================================
train 4619
val 253
test 255
Validation loss decreased (inf --> 0.038068).  Saving model ...
Updating learning rate to 0.00010910690862274269
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.4553454311371344e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7276727155685672e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3638363577842836e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.819181788921418e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.409590894460709e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.7047954472303545e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.523977236151772e-07
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.261988618075886e-07
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.130994309037943e-07
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.0654971545189716e-07
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.327485772594858e-08
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.663742886297429e-08
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.3318714431487144e-08
EarlyStopping counter: 14 out of 100
Updating learning rate to 6.659357215743572e-09
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.329678607871786e-09
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.664839303935893e-09
EarlyStopping counter: 17 out of 100
Updating learning rate to 8.324196519679465e-10
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.1620982598397327e-10
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.0810491299198663e-10
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.0405245649599332e-10
EarlyStopping counter: 21 out of 100
Updating learning rate to 5.202622824799666e-11
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.601311412399833e-11
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.3006557061999165e-11
EarlyStopping counter: 24 out of 100
Updating learning rate to 6.503278530999582e-12
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.251639265499791e-12
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.6258196327498956e-12
EarlyStopping counter: 27 out of 100
Updating learning rate to 8.129098163749478e-13
EarlyStopping counter: 28 out of 100
Updating learning rate to 4.064549081874739e-13
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.0322745409373695e-13
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.0161372704686847e-13
EarlyStopping counter: 31 out of 100
Updating learning rate to 5.0806863523434236e-14
EarlyStopping counter: 32 out of 100
Updating learning rate to 2.5403431761717118e-14
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.2701715880858559e-14
EarlyStopping counter: 34 out of 100
Updating learning rate to 6.3508579404292796e-15
EarlyStopping counter: 35 out of 100
Updating learning rate to 3.1754289702146398e-15
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.5877144851073199e-15
EarlyStopping counter: 37 out of 100
Updating learning rate to 7.938572425536599e-16
EarlyStopping counter: 38 out of 100
Updating learning rate to 3.9692862127682997e-16
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.9846431063841499e-16
EarlyStopping counter: 40 out of 100
Updating learning rate to 9.923215531920749e-17
EarlyStopping counter: 41 out of 100
Updating learning rate to 4.9616077659603747e-17
EarlyStopping counter: 42 out of 100
Updating learning rate to 2.4808038829801873e-17
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.2404019414900937e-17
EarlyStopping counter: 44 out of 100
Updating learning rate to 6.202009707450468e-18
EarlyStopping counter: 45 out of 100
Updating learning rate to 3.101004853725234e-18
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.550502426862617e-18
EarlyStopping counter: 47 out of 100
Updating learning rate to 7.752512134313085e-19
EarlyStopping counter: 48 out of 100
Updating learning rate to 3.8762560671565427e-19
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.9381280335782714e-19
EarlyStopping counter: 50 out of 100
Updating learning rate to 9.690640167891357e-20
EarlyStopping counter: 51 out of 100
Updating learning rate to 4.8453200839456784e-20
EarlyStopping counter: 52 out of 100
Updating learning rate to 2.4226600419728392e-20
EarlyStopping counter: 53 out of 100
Updating learning rate to 1.2113300209864196e-20
EarlyStopping counter: 54 out of 100
Updating learning rate to 6.056650104932098e-21
EarlyStopping counter: 55 out of 100
Updating learning rate to 3.028325052466049e-21
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.5141625262330245e-21
EarlyStopping counter: 57 out of 100
Updating learning rate to 7.570812631165122e-22
EarlyStopping counter: 58 out of 100
Updating learning rate to 3.785406315582561e-22
EarlyStopping counter: 59 out of 100
Updating learning rate to 1.8927031577912806e-22
EarlyStopping counter: 60 out of 100
Updating learning rate to 9.463515788956403e-23
EarlyStopping counter: 61 out of 100
Updating learning rate to 4.7317578944782015e-23
EarlyStopping counter: 62 out of 100
Updating learning rate to 2.3658789472391008e-23
EarlyStopping counter: 63 out of 100
Updating learning rate to 1.1829394736195504e-23
EarlyStopping counter: 64 out of 100
Updating learning rate to 5.914697368097752e-24
EarlyStopping counter: 65 out of 100
Updating learning rate to 2.957348684048876e-24
EarlyStopping counter: 66 out of 100
Updating learning rate to 1.478674342024438e-24
EarlyStopping counter: 67 out of 100
Updating learning rate to 7.39337171012219e-25
EarlyStopping counter: 68 out of 100
Updating learning rate to 3.696685855061095e-25
EarlyStopping counter: 69 out of 100
Updating learning rate to 1.8483429275305475e-25
EarlyStopping counter: 70 out of 100
Updating learning rate to 9.241714637652737e-26
EarlyStopping counter: 71 out of 100
Updating learning rate to 4.6208573188263687e-26
EarlyStopping counter: 72 out of 100
Updating learning rate to 2.3104286594131843e-26
EarlyStopping counter: 73 out of 100
Updating learning rate to 1.1552143297065922e-26
EarlyStopping counter: 74 out of 100
Updating learning rate to 5.776071648532961e-27
EarlyStopping counter: 75 out of 100
Updating learning rate to 2.8880358242664804e-27
EarlyStopping counter: 76 out of 100
Updating learning rate to 1.4440179121332402e-27
EarlyStopping counter: 77 out of 100
Updating learning rate to 7.220089560666201e-28
EarlyStopping counter: 78 out of 100
Updating learning rate to 3.6100447803331005e-28
EarlyStopping counter: 79 out of 100
Updating learning rate to 1.8050223901665503e-28
EarlyStopping counter: 80 out of 100
Updating learning rate to 9.025111950832751e-29
EarlyStopping counter: 81 out of 100
Updating learning rate to 4.5125559754163757e-29
EarlyStopping counter: 82 out of 100
Updating learning rate to 2.2562779877081878e-29
EarlyStopping counter: 83 out of 100
Updating learning rate to 1.1281389938540939e-29
EarlyStopping counter: 84 out of 100
Updating learning rate to 5.6406949692704696e-30
EarlyStopping counter: 85 out of 100
Updating learning rate to 2.8203474846352348e-30
EarlyStopping counter: 86 out of 100
Updating learning rate to 1.4101737423176174e-30
EarlyStopping counter: 87 out of 100
Updating learning rate to 7.050868711588087e-31
EarlyStopping counter: 88 out of 100
Updating learning rate to 3.5254343557940435e-31
EarlyStopping counter: 89 out of 100
Updating learning rate to 1.7627171778970217e-31
EarlyStopping counter: 90 out of 100
Updating learning rate to 8.813585889485109e-32
EarlyStopping counter: 91 out of 100
Updating learning rate to 4.4067929447425544e-32
EarlyStopping counter: 92 out of 100
Updating learning rate to 2.2033964723712772e-32
EarlyStopping counter: 93 out of 100
Updating learning rate to 1.1016982361856386e-32
EarlyStopping counter: 94 out of 100
Updating learning rate to 5.508491180928193e-33
EarlyStopping counter: 95 out of 100
Updating learning rate to 2.7542455904640965e-33
EarlyStopping counter: 96 out of 100
Updating learning rate to 1.3771227952320482e-33
EarlyStopping counter: 97 out of 100
Updating learning rate to 6.885613976160241e-34
EarlyStopping counter: 98 out of 100
Updating learning rate to 3.4428069880801206e-34
EarlyStopping counter: 99 out of 100
Updating learning rate to 1.7214034940400603e-34
>>>>>> Testing on validation set: trial_49 >>>>>>
test 255
test shape: (255, 7, 5) (255, 7, 5)
test shape: (255, 7, 5) (255, 7, 5)


	mse:0.06398563832044601, mae:0.09794306755065918, dtw:Not calculated


                                                                                         [I 2025-10-17 03:51:52,036] Trial 49 finished with value: 0.09794306755065918 and parameters: {'seq_len': 48, 'pred_len': 7, 'expand': 2, 'd_model': 64, 'n_heads': 8, 'e_layers': 2, 'd_layers': 2, 'batch_size': 64, 'learning_rate': 0.00010910690862274269, 'dropout': 0.029855418853640917}. Best is trial 31 with value: 0.07112950086593628.
Best trial: 31. Best value: 0.0711295:  98%|█████████▊| 49/50 [1:54:42<02:09, 129.09s/it]Best trial: 31. Best value: 0.0711295:  98%|█████████▊| 49/50 [1:54:42<02:09, 129.09s/it]Best trial: 31. Best value: 0.0711295: 100%|██████████| 50/50 [1:54:42<00:00, 111.05s/it]Best trial: 31. Best value: 0.0711295: 100%|██████████| 50/50 [1:54:42<00:00, 137.66s/it]

======================================================================
Optimization Complete!
======================================================================
Number of finished trials: 50

Best trial:
  Value (MSE): 0.071130

Best hyperparameters:
  seq_len: 48
  pred_len: 1
  expand: 2
  d_model: 64
  n_heads: 8
  e_layers: 1
  d_layers: 2
  batch_size: 32
  learning_rate: 0.0007133465844372447
  dropout: 0.1614951733539902
======================================================================

✅ Best parameters saved to: ./optuna_results/Mamba_Exchange_7_best_params.json
✅ Visualizations saved to ./optuna_results/

======================================================================
✅ Hyperparameter tuning complete!
✅ Best parameters saved to: ./optuna_results/Mamba_Exchange_7_best_params.json
======================================================================

Next steps:
  1. Review visualizations in optuna_results/ folder
  2. Train final model:
     python train_best_model.py --model Mamba --train_epochs 100
======================================================================
[I 2025-10-17 03:52:03,890] A new study created in RDB with name: Mamba_Exchange_14

======================================================================
Starting Optuna Hyperparameter Optimization
======================================================================
Model: Mamba
Dataset: custom
Number of trials: 50
Study name: Mamba_Exchange_14
Storage: sqlite:///optuna_study.db
======================================================================

  0%|          | 0/50 [00:00<?, ?it/s]
============================================================
Trial 0
============================================================
seq_len: 48, pred_len: 14
d_model: 32, n_heads: 8
e_layers: 2, d_layers: 1
batch_size: 16, lr: 0.000015
dropout: 0.0023555670171972686
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 64, expand: 2
>>>>>> Start training: trial_0 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 14
============================================================
train 4612
val 246
test 248
Validation loss decreased (inf --> 0.038528).  Saving model ...
Updating learning rate to 1.5104384376764543e-05
Validation loss decreased (0.038528 --> 0.038231).  Saving model ...
Updating learning rate to 7.552192188382271e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.7760960941911357e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8880480470955678e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.440240235477839e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.7201201177389196e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.3600600588694598e-07
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1800300294347299e-07
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.9001501471736495e-08
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.9500750735868248e-08
Validation loss decreased (0.038231 --> 0.038191).  Saving model ...
Updating learning rate to 1.4750375367934124e-08
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.375187683967062e-09
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.687593841983531e-09
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8437969209917655e-09
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.218984604958827e-10
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.6094923024794137e-10
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.3047461512397068e-10
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1523730756198534e-10
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.761865378099267e-11
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.8809326890496336e-11
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.4404663445248168e-11
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.202331722624084e-12
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.601165861312042e-12
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.800582930656021e-12
EarlyStopping counter: 14 out of 100
Updating learning rate to 9.002914653280105e-13
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.5014573266400524e-13
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.2507286633200262e-13
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.1253643316600131e-13
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.6268216583000655e-14
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.8134108291500328e-14
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.4067054145750164e-14
EarlyStopping counter: 21 out of 100
Updating learning rate to 7.033527072875082e-15
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.516763536437541e-15
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.7583817682187705e-15
EarlyStopping counter: 24 out of 100
Updating learning rate to 8.791908841093852e-16
EarlyStopping counter: 25 out of 100
Updating learning rate to 4.395954420546926e-16
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.197977210273463e-16
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.0989886051367316e-16
EarlyStopping counter: 28 out of 100
Updating learning rate to 5.494943025683658e-17
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.747471512841829e-17
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.3737357564209144e-17
EarlyStopping counter: 31 out of 100
Updating learning rate to 6.868678782104572e-18
EarlyStopping counter: 32 out of 100
Updating learning rate to 3.434339391052286e-18
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.717169695526143e-18
EarlyStopping counter: 34 out of 100
Updating learning rate to 8.585848477630715e-19
EarlyStopping counter: 35 out of 100
Updating learning rate to 4.2929242388153576e-19
EarlyStopping counter: 36 out of 100
Updating learning rate to 2.1464621194076788e-19
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.0732310597038394e-19
EarlyStopping counter: 38 out of 100
Updating learning rate to 5.366155298519197e-20
EarlyStopping counter: 39 out of 100
Updating learning rate to 2.6830776492595985e-20
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.3415388246297993e-20
EarlyStopping counter: 41 out of 100
Updating learning rate to 6.707694123148996e-21
EarlyStopping counter: 42 out of 100
Updating learning rate to 3.353847061574498e-21
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.676923530787249e-21
EarlyStopping counter: 44 out of 100
Updating learning rate to 8.384617653936245e-22
EarlyStopping counter: 45 out of 100
Updating learning rate to 4.1923088269681227e-22
EarlyStopping counter: 46 out of 100
Updating learning rate to 2.0961544134840613e-22
EarlyStopping counter: 47 out of 100
Updating learning rate to 1.0480772067420307e-22
EarlyStopping counter: 48 out of 100
Updating learning rate to 5.2403860337101533e-23
EarlyStopping counter: 49 out of 100
Updating learning rate to 2.6201930168550767e-23
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.3100965084275383e-23
EarlyStopping counter: 51 out of 100
Updating learning rate to 6.550482542137692e-24
EarlyStopping counter: 52 out of 100
Updating learning rate to 3.275241271068846e-24
EarlyStopping counter: 53 out of 100
Updating learning rate to 1.637620635534423e-24
EarlyStopping counter: 54 out of 100
Updating learning rate to 8.188103177672115e-25
EarlyStopping counter: 55 out of 100
Updating learning rate to 4.0940515888360573e-25
EarlyStopping counter: 56 out of 100
Updating learning rate to 2.0470257944180287e-25
EarlyStopping counter: 57 out of 100
Updating learning rate to 1.0235128972090143e-25
EarlyStopping counter: 58 out of 100
Updating learning rate to 5.1175644860450716e-26
EarlyStopping counter: 59 out of 100
Updating learning rate to 2.5587822430225358e-26
EarlyStopping counter: 60 out of 100
Updating learning rate to 1.2793911215112679e-26
EarlyStopping counter: 61 out of 100
Updating learning rate to 6.3969556075563395e-27
EarlyStopping counter: 62 out of 100
Updating learning rate to 3.1984778037781698e-27
EarlyStopping counter: 63 out of 100
Updating learning rate to 1.5992389018890849e-27
EarlyStopping counter: 64 out of 100
Updating learning rate to 7.996194509445424e-28
EarlyStopping counter: 65 out of 100
Updating learning rate to 3.998097254722712e-28
EarlyStopping counter: 66 out of 100
Updating learning rate to 1.999048627361356e-28
EarlyStopping counter: 67 out of 100
Updating learning rate to 9.99524313680678e-29
EarlyStopping counter: 68 out of 100
Updating learning rate to 4.99762156840339e-29
EarlyStopping counter: 69 out of 100
Updating learning rate to 2.498810784201695e-29
EarlyStopping counter: 70 out of 100
Updating learning rate to 1.2494053921008476e-29
EarlyStopping counter: 71 out of 100
Updating learning rate to 6.247026960504238e-30
EarlyStopping counter: 72 out of 100
Updating learning rate to 3.123513480252119e-30
EarlyStopping counter: 73 out of 100
Updating learning rate to 1.5617567401260595e-30
EarlyStopping counter: 74 out of 100
Updating learning rate to 7.808783700630297e-31
EarlyStopping counter: 75 out of 100
Updating learning rate to 3.9043918503151486e-31
EarlyStopping counter: 76 out of 100
Updating learning rate to 1.9521959251575743e-31
EarlyStopping counter: 77 out of 100
Updating learning rate to 9.760979625787872e-32
EarlyStopping counter: 78 out of 100
Updating learning rate to 4.880489812893936e-32
EarlyStopping counter: 79 out of 100
Updating learning rate to 2.440244906446968e-32
EarlyStopping counter: 80 out of 100
Updating learning rate to 1.220122453223484e-32
EarlyStopping counter: 81 out of 100
Updating learning rate to 6.10061226611742e-33
EarlyStopping counter: 82 out of 100
Updating learning rate to 3.05030613305871e-33
EarlyStopping counter: 83 out of 100
Updating learning rate to 1.525153066529355e-33
EarlyStopping counter: 84 out of 100
Updating learning rate to 7.625765332646775e-34
EarlyStopping counter: 85 out of 100
Updating learning rate to 3.8128826663233873e-34
EarlyStopping counter: 86 out of 100
Updating learning rate to 1.9064413331616937e-34
EarlyStopping counter: 87 out of 100
Updating learning rate to 9.532206665808468e-35
EarlyStopping counter: 88 out of 100
Updating learning rate to 4.766103332904234e-35
EarlyStopping counter: 89 out of 100
Updating learning rate to 2.383051666452117e-35
>>>>>> Testing on validation set: trial_0 >>>>>>
test 248
test shape: (248, 14, 5) (248, 14, 5)
test shape: (248, 14, 5) (248, 14, 5)


	mse:0.06418509781360626, mae:0.09936007857322693, dtw:Not calculated


                                      [I 2025-10-17 03:56:28,011] Trial 0 finished with value: 0.09936007857322693 and parameters: {'seq_len': 48, 'pred_len': 14, 'expand': 2, 'd_model': 32, 'n_heads': 8, 'e_layers': 2, 'd_layers': 1, 'batch_size': 16, 'learning_rate': 1.5104384376764543e-05, 'dropout': 0.0023555670171972686}. Best is trial 0 with value: 0.09936007857322693.
  0%|          | 0/50 [04:24<?, ?it/s]Best trial: 0. Best value: 0.0993601:   0%|          | 0/50 [04:24<?, ?it/s]Best trial: 0. Best value: 0.0993601:   2%|▏         | 1/50 [04:24<3:35:42, 264.14s/it]
============================================================
Trial 1
============================================================
seq_len: 96, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 2, d_layers: 1
batch_size: 64, lr: 0.000019
dropout: 0.2073140188391994
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_1 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 1
============================================================
train 4577
val 259
test 261
Validation loss decreased (inf --> 0.036471).  Saving model ...
Updating learning rate to 1.9371471616076844e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.685735808038422e-06
Validation loss decreased (0.036471 --> 0.033609).  Saving model ...
Updating learning rate to 4.842867904019211e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.4214339520096055e-06
Validation loss decreased (0.033609 --> 0.030320).  Saving model ...
Updating learning rate to 1.2107169760048027e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.053584880024014e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.026792440012007e-07
Validation loss decreased (0.030320 --> 0.029503).  Saving model ...
Updating learning rate to 1.5133962200060034e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.566981100030017e-08
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.7834905500150086e-08
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8917452750075043e-08
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.458726375037521e-09
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.729363187518761e-09
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.3646815937593804e-09
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1823407968796902e-09
Validation loss decreased (0.029503 --> 0.029100).  Saving model ...
Updating learning rate to 5.911703984398451e-10
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.9558519921992255e-10
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4779259960996127e-10
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.389629980498064e-11
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.694814990249032e-11
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.847407495124516e-11
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.23703747562258e-12
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.61851873781129e-12
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.309259368905645e-12
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.1546296844528224e-12
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.773148422264112e-13
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.886574211132056e-13
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.443287105566028e-13
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.21643552783014e-14
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.60821776391507e-14
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.804108881957535e-14
EarlyStopping counter: 16 out of 100
Updating learning rate to 9.020544409787675e-15
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.510272204893838e-15
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.255136102446919e-15
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.1275680512234594e-15
EarlyStopping counter: 20 out of 100
Updating learning rate to 5.637840256117297e-16
Validation loss decreased (0.029100 --> 0.028903).  Saving model ...
Updating learning rate to 2.8189201280586486e-16
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4094600640293243e-16
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.047300320146621e-17
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.5236501600733107e-17
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.7618250800366553e-17
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.809125400183277e-18
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.404562700091638e-18
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.202281350045819e-18
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.1011406750229096e-18
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.505703375114548e-19
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.752851687557274e-19
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.376425843778637e-19
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.882129218893185e-20
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.4410646094465925e-20
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.7205323047232962e-20
EarlyStopping counter: 15 out of 100
Updating learning rate to 8.602661523616481e-21
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.3013307618082406e-21
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.1506653809041203e-21
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.0753326904520601e-21
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.376663452260301e-22
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.6883317261301504e-22
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.3441658630650752e-22
EarlyStopping counter: 22 out of 100
Updating learning rate to 6.720829315325376e-23
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.360414657662688e-23
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.680207328831344e-23
EarlyStopping counter: 25 out of 100
Updating learning rate to 8.40103664415672e-24
EarlyStopping counter: 26 out of 100
Updating learning rate to 4.20051832207836e-24
Validation loss decreased (0.028903 --> 0.028814).  Saving model ...
Updating learning rate to 2.10025916103918e-24
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.05012958051959e-24
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.25064790259795e-25
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.625323951298975e-25
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3126619756494875e-25
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.563309878247437e-26
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.2816549391237187e-26
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.6408274695618594e-26
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.204137347809297e-27
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.1020686739046484e-27
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.0510343369523242e-27
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.0255171684761621e-27
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.1275858423808105e-28
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.5637929211904052e-28
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.2818964605952026e-28
EarlyStopping counter: 15 out of 100
Updating learning rate to 6.409482302976013e-29
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.2047411514880066e-29
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.6023705757440033e-29
EarlyStopping counter: 18 out of 100
Updating learning rate to 8.011852878720016e-30
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.005926439360008e-30
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.002963219680004e-30
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.001481609840002e-30
EarlyStopping counter: 22 out of 100
Updating learning rate to 5.00740804920001e-31
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.503704024600005e-31
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.2518520123000026e-31
EarlyStopping counter: 25 out of 100
Updating learning rate to 6.259260061500013e-32
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.1296300307500064e-32
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.5648150153750032e-32
EarlyStopping counter: 28 out of 100
Updating learning rate to 7.824075076875016e-33
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.912037538437508e-33
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.956018769218754e-33
EarlyStopping counter: 31 out of 100
Updating learning rate to 9.78009384609377e-34
EarlyStopping counter: 32 out of 100
Updating learning rate to 4.890046923046885e-34
EarlyStopping counter: 33 out of 100
Updating learning rate to 2.4450234615234425e-34
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.2225117307617212e-34
EarlyStopping counter: 35 out of 100
Updating learning rate to 6.112558653808606e-35
EarlyStopping counter: 36 out of 100
Updating learning rate to 3.056279326904303e-35
>>>>>> Testing on validation set: trial_1 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.06558897346258163, mae:0.11350896209478378, dtw:Not calculated


                                                                                       [I 2025-10-17 03:57:36,472] Trial 1 finished with value: 0.11350896209478378 and parameters: {'seq_len': 96, 'pred_len': 1, 'expand': 2, 'd_model': 64, 'n_heads': 8, 'e_layers': 2, 'd_layers': 1, 'batch_size': 64, 'learning_rate': 1.9371471616076844e-05, 'dropout': 0.2073140188391994}. Best is trial 0 with value: 0.09936007857322693.
Best trial: 0. Best value: 0.0993601:   2%|▏         | 1/50 [05:32<3:35:42, 264.14s/it]Best trial: 0. Best value: 0.0993601:   2%|▏         | 1/50 [05:32<3:35:42, 264.14s/it]Best trial: 0. Best value: 0.0993601:   4%|▍         | 2/50 [05:32<1:59:13, 149.04s/it]
============================================================
Trial 2
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 16, lr: 0.000051
dropout: 0.06132600044700881
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_2 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.033134).  Saving model ...
Updating learning rate to 5.050718195486395e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.5253590977431976e-05
Validation loss decreased (0.033134 --> 0.028950).  Saving model ...
Updating learning rate to 1.2626795488715988e-05
Validation loss decreased (0.028950 --> 0.028367).  Saving model ...
Updating learning rate to 6.313397744357994e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.156698872178997e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5783494360894985e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.891747180447493e-07
Validation loss decreased (0.028367 --> 0.027899).  Saving model ...
Updating learning rate to 3.9458735902237463e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.9729367951118732e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.864683975559366e-08
Validation loss decreased (0.027899 --> 0.027599).  Saving model ...
Updating learning rate to 4.932341987779683e-08
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.4661709938898414e-08
Validation loss decreased (0.027599 --> 0.027464).  Saving model ...
Updating learning rate to 1.2330854969449207e-08
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.165427484724604e-09
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.082713742362302e-09
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.541356871181151e-09
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.706784355905754e-10
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.853392177952877e-10
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.9266960889764386e-10
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.633480444882193e-11
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.8167402224410966e-11
Validation loss decreased (0.027464 --> 0.027233).  Saving model ...
Updating learning rate to 2.4083701112205483e-11
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2041850556102741e-11
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.020925278051371e-12
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.0104626390256854e-12
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5052313195128427e-12
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.526156597564213e-13
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.7630782987821067e-13
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8815391493910533e-13
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.407695746955267e-14
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.7038478734776334e-14
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.3519239367388167e-14
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.1759619683694083e-14
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.879809841847042e-15
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.939904920923521e-15
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.4699524604617604e-15
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.349762302308802e-16
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.674881151154401e-16
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.8374405755772005e-16
EarlyStopping counter: 18 out of 100
Updating learning rate to 9.187202877886003e-17
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.5936014389430013e-17
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.2968007194715007e-17
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.1484003597357503e-17
EarlyStopping counter: 22 out of 100
Updating learning rate to 5.742001798678752e-18
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.871000899339376e-18
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.435500449669688e-18
EarlyStopping counter: 25 out of 100
Updating learning rate to 7.17750224834844e-19
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.58875112417422e-19
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.79437556208711e-19
EarlyStopping counter: 28 out of 100
Updating learning rate to 8.97187781043555e-20
EarlyStopping counter: 29 out of 100
Updating learning rate to 4.485938905217775e-20
EarlyStopping counter: 30 out of 100
Updating learning rate to 2.2429694526088874e-20
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.1214847263044437e-20
EarlyStopping counter: 32 out of 100
Updating learning rate to 5.6074236315222184e-21
EarlyStopping counter: 33 out of 100
Updating learning rate to 2.8037118157611092e-21
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.4018559078805546e-21
EarlyStopping counter: 35 out of 100
Updating learning rate to 7.009279539402773e-22
EarlyStopping counter: 36 out of 100
Updating learning rate to 3.5046397697013865e-22
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.7523198848506933e-22
EarlyStopping counter: 38 out of 100
Updating learning rate to 8.761599424253466e-23
EarlyStopping counter: 39 out of 100
Updating learning rate to 4.380799712126733e-23
EarlyStopping counter: 40 out of 100
Updating learning rate to 2.1903998560633666e-23
EarlyStopping counter: 41 out of 100
Updating learning rate to 1.0951999280316833e-23
EarlyStopping counter: 42 out of 100
Updating learning rate to 5.4759996401584164e-24
EarlyStopping counter: 43 out of 100
Updating learning rate to 2.7379998200792082e-24
EarlyStopping counter: 44 out of 100
Updating learning rate to 1.3689999100396041e-24
EarlyStopping counter: 45 out of 100
Updating learning rate to 6.8449995501980205e-25
EarlyStopping counter: 46 out of 100
Updating learning rate to 3.4224997750990103e-25
EarlyStopping counter: 47 out of 100
Updating learning rate to 1.7112498875495051e-25
EarlyStopping counter: 48 out of 100
Updating learning rate to 8.556249437747526e-26
EarlyStopping counter: 49 out of 100
Updating learning rate to 4.278124718873763e-26
EarlyStopping counter: 50 out of 100
Updating learning rate to 2.1390623594368814e-26
EarlyStopping counter: 51 out of 100
Updating learning rate to 1.0695311797184407e-26
EarlyStopping counter: 52 out of 100
Updating learning rate to 5.3476558985922035e-27
EarlyStopping counter: 53 out of 100
Updating learning rate to 2.6738279492961018e-27
EarlyStopping counter: 54 out of 100
Updating learning rate to 1.3369139746480509e-27
EarlyStopping counter: 55 out of 100
Updating learning rate to 6.684569873240254e-28
EarlyStopping counter: 56 out of 100
Updating learning rate to 3.342284936620127e-28
EarlyStopping counter: 57 out of 100
Updating learning rate to 1.6711424683100636e-28
EarlyStopping counter: 58 out of 100
Updating learning rate to 8.355712341550318e-29
EarlyStopping counter: 59 out of 100
Updating learning rate to 4.177856170775159e-29
EarlyStopping counter: 60 out of 100
Updating learning rate to 2.0889280853875795e-29
EarlyStopping counter: 61 out of 100
Updating learning rate to 1.0444640426937898e-29
EarlyStopping counter: 62 out of 100
Updating learning rate to 5.222320213468949e-30
EarlyStopping counter: 63 out of 100
Updating learning rate to 2.6111601067344744e-30
EarlyStopping counter: 64 out of 100
Updating learning rate to 1.3055800533672372e-30
EarlyStopping counter: 65 out of 100
Updating learning rate to 6.527900266836186e-31
EarlyStopping counter: 66 out of 100
Updating learning rate to 3.263950133418093e-31
EarlyStopping counter: 67 out of 100
Updating learning rate to 1.6319750667090465e-31
EarlyStopping counter: 68 out of 100
Updating learning rate to 8.159875333545232e-32
EarlyStopping counter: 69 out of 100
Updating learning rate to 4.079937666772616e-32
EarlyStopping counter: 70 out of 100
Updating learning rate to 2.039968833386308e-32
EarlyStopping counter: 71 out of 100
Updating learning rate to 1.019984416693154e-32
EarlyStopping counter: 72 out of 100
Updating learning rate to 5.09992208346577e-33
EarlyStopping counter: 73 out of 100
Updating learning rate to 2.549961041732885e-33
EarlyStopping counter: 74 out of 100
Updating learning rate to 1.2749805208664426e-33
EarlyStopping counter: 75 out of 100
Updating learning rate to 6.374902604332213e-34
EarlyStopping counter: 76 out of 100
Updating learning rate to 3.1874513021661064e-34
EarlyStopping counter: 77 out of 100
Updating learning rate to 1.5937256510830532e-34
EarlyStopping counter: 78 out of 100
Updating learning rate to 7.968628255415266e-35
>>>>>> Testing on validation set: trial_2 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.05445204675197601, mae:0.08393566310405731, dtw:Not calculated


                                                                                       [I 2025-10-17 04:01:58,992] Trial 2 finished with value: 0.08393566310405731 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 16, 'learning_rate': 5.050718195486395e-05, 'dropout': 0.06132600044700881}. Best is trial 2 with value: 0.08393566310405731.
Best trial: 0. Best value: 0.0993601:   4%|▍         | 2/50 [09:55<1:59:13, 149.04s/it]Best trial: 2. Best value: 0.0839357:   4%|▍         | 2/50 [09:55<1:59:13, 149.04s/it]Best trial: 2. Best value: 0.0839357:   6%|▌         | 3/50 [09:55<2:37:20, 200.86s/it]
============================================================
Trial 3
============================================================
seq_len: 96, pred_len: 1
d_model: 32, n_heads: 8
e_layers: 2, d_layers: 2
batch_size: 64, lr: 0.000062
dropout: 0.025589191481125893
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 32, expand: 1
>>>>>> Start training: trial_3 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 1
============================================================
train 4577
val 259
test 261
Validation loss decreased (inf --> 0.033389).  Saving model ...
Updating learning rate to 6.241831168759722e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.120915584379861e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5604577921899306e-05
Validation loss decreased (0.033389 --> 0.030475).  Saving model ...
Updating learning rate to 7.802288960949653e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.9011444804748266e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.9505722402374133e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.752861201187066e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.876430600593533e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.4382153002967666e-07
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.2191076501483833e-07
Validation loss decreased (0.030475 --> 0.030408).  Saving model ...
Updating learning rate to 6.095538250741916e-08
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.047769125370958e-08
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.523884562685479e-08
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.619422813427396e-09
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.809711406713698e-09
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.904855703356849e-09
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.524278516784245e-10
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.762139258392122e-10
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.381069629196061e-10
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.1905348145980306e-10
Validation loss decreased (0.030408 --> 0.028954).  Saving model ...
Updating learning rate to 5.952674072990153e-11
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.9763370364950764e-11
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4881685182475382e-11
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.440842591237691e-12
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.7204212956188455e-12
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8602106478094228e-12
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.301053239047114e-13
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.650526619523557e-13
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.3252633097617784e-13
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.1626316548808892e-13
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.813158274404446e-14
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.906579137202223e-14
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.4532895686011115e-14
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.266447843005558e-15
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.633223921502779e-15
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.8166119607513894e-15
EarlyStopping counter: 16 out of 100
Updating learning rate to 9.083059803756947e-16
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.541529901878474e-16
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.270764950939237e-16
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.1353824754696184e-16
EarlyStopping counter: 20 out of 100
Updating learning rate to 5.676912377348092e-17
Validation loss decreased (0.028954 --> 0.028588).  Saving model ...
Updating learning rate to 2.838456188674046e-17
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.419228094337023e-17
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.096140471685115e-18
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.5480702358425574e-18
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.7740351179212787e-18
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.870175589606394e-19
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.435087794803197e-19
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2175438974015984e-19
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.1087719487007992e-19
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.543859743503996e-20
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.771929871751998e-20
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.385964935875999e-20
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.929824679379995e-21
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.4649123396899975e-21
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.7324561698449988e-21
EarlyStopping counter: 15 out of 100
Updating learning rate to 8.662280849224994e-22
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.331140424612497e-22
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.1655702123062484e-22
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.0827851061531242e-22
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.413925530765621e-23
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.7069627653828106e-23
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.3534813826914053e-23
EarlyStopping counter: 22 out of 100
Updating learning rate to 6.767406913457026e-24
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.383703456728513e-24
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.6918517283642566e-24
EarlyStopping counter: 25 out of 100
Updating learning rate to 8.459258641821283e-25
EarlyStopping counter: 26 out of 100
Updating learning rate to 4.2296293209106415e-25
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.1148146604553207e-25
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.0574073302276604e-25
EarlyStopping counter: 29 out of 100
Updating learning rate to 5.287036651138302e-26
EarlyStopping counter: 30 out of 100
Updating learning rate to 2.643518325569151e-26
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.3217591627845755e-26
EarlyStopping counter: 32 out of 100
Updating learning rate to 6.608795813922877e-27
EarlyStopping counter: 33 out of 100
Updating learning rate to 3.304397906961439e-27
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.6521989534807193e-27
EarlyStopping counter: 35 out of 100
Updating learning rate to 8.260994767403597e-28
EarlyStopping counter: 36 out of 100
Updating learning rate to 4.130497383701798e-28
EarlyStopping counter: 37 out of 100
Updating learning rate to 2.065248691850899e-28
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.0326243459254496e-28
EarlyStopping counter: 39 out of 100
Updating learning rate to 5.163121729627248e-29
EarlyStopping counter: 40 out of 100
Updating learning rate to 2.581560864813624e-29
EarlyStopping counter: 41 out of 100
Updating learning rate to 1.290780432406812e-29
EarlyStopping counter: 42 out of 100
Updating learning rate to 6.45390216203406e-30
EarlyStopping counter: 43 out of 100
Updating learning rate to 3.22695108101703e-30
EarlyStopping counter: 44 out of 100
Updating learning rate to 1.613475540508515e-30
EarlyStopping counter: 45 out of 100
Updating learning rate to 8.067377702542575e-31
EarlyStopping counter: 46 out of 100
Updating learning rate to 4.033688851271287e-31
EarlyStopping counter: 47 out of 100
Updating learning rate to 2.0168444256356437e-31
EarlyStopping counter: 48 out of 100
Updating learning rate to 1.0084222128178219e-31
EarlyStopping counter: 49 out of 100
Updating learning rate to 5.042111064089109e-32
EarlyStopping counter: 50 out of 100
Updating learning rate to 2.5210555320445546e-32
EarlyStopping counter: 51 out of 100
Updating learning rate to 1.2605277660222773e-32
EarlyStopping counter: 52 out of 100
Updating learning rate to 6.302638830111387e-33
EarlyStopping counter: 53 out of 100
Updating learning rate to 3.151319415055693e-33
EarlyStopping counter: 54 out of 100
Updating learning rate to 1.5756597075278467e-33
EarlyStopping counter: 55 out of 100
Updating learning rate to 7.878298537639233e-34
EarlyStopping counter: 56 out of 100
Updating learning rate to 3.939149268819617e-34
EarlyStopping counter: 57 out of 100
Updating learning rate to 1.9695746344098083e-34
EarlyStopping counter: 58 out of 100
Updating learning rate to 9.847873172049042e-35
>>>>>> Testing on validation set: trial_3 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.06484248489141464, mae:0.11285004019737244, dtw:Not calculated


                                                                                       [I 2025-10-17 04:03:06,472] Trial 3 finished with value: 0.11285004019737244 and parameters: {'seq_len': 96, 'pred_len': 1, 'expand': 1, 'd_model': 32, 'n_heads': 8, 'e_layers': 2, 'd_layers': 2, 'batch_size': 64, 'learning_rate': 6.241831168759722e-05, 'dropout': 0.025589191481125893}. Best is trial 2 with value: 0.08393566310405731.
Best trial: 2. Best value: 0.0839357:   6%|▌         | 3/50 [11:02<2:37:20, 200.86s/it]Best trial: 2. Best value: 0.0839357:   6%|▌         | 3/50 [11:02<2:37:20, 200.86s/it]Best trial: 2. Best value: 0.0839357:   8%|▊         | 4/50 [11:02<1:53:37, 148.20s/it]
============================================================
Trial 4
============================================================
seq_len: 96, pred_len: 30
d_model: 64, n_heads: 4
e_layers: 2, d_layers: 2
batch_size: 16, lr: 0.000120
dropout: 0.033411468773728026
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_4 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 30
============================================================
train 4548
val 230
test 232
Validation loss decreased (inf --> 0.035792).  Saving model ...
Updating learning rate to 0.00012011389910807577
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.0056949554037886e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.0028474777018943e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5014237388509472e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.507118694254736e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.753559347127368e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.876779673563684e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.38389836781842e-07
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.69194918390921e-07
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.345974591954605e-07
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.1729872959773025e-07
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.864936479886512e-08
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.932468239943256e-08
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.466234119971628e-08
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.33117059985814e-09
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.66558529992907e-09
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.832792649964535e-09
EarlyStopping counter: 17 out of 100
Updating learning rate to 9.163963249822675e-10
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.581981624911338e-10
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.290990812455669e-10
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.1454954062278344e-10
EarlyStopping counter: 21 out of 100
Updating learning rate to 5.727477031139172e-11
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.863738515569586e-11
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.431869257784793e-11
EarlyStopping counter: 24 out of 100
Updating learning rate to 7.159346288923965e-12
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.5796731444619826e-12
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.7898365722309913e-12
EarlyStopping counter: 27 out of 100
Updating learning rate to 8.949182861154957e-13
EarlyStopping counter: 28 out of 100
Updating learning rate to 4.4745914305774783e-13
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.2372957152887391e-13
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.1186478576443696e-13
EarlyStopping counter: 31 out of 100
Updating learning rate to 5.593239288221848e-14
EarlyStopping counter: 32 out of 100
Updating learning rate to 2.796619644110924e-14
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.398309822055462e-14
EarlyStopping counter: 34 out of 100
Updating learning rate to 6.99154911027731e-15
EarlyStopping counter: 35 out of 100
Updating learning rate to 3.495774555138655e-15
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.7478872775693274e-15
EarlyStopping counter: 37 out of 100
Updating learning rate to 8.739436387846637e-16
EarlyStopping counter: 38 out of 100
Updating learning rate to 4.3697181939233186e-16
EarlyStopping counter: 39 out of 100
Updating learning rate to 2.1848590969616593e-16
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.0924295484808297e-16
EarlyStopping counter: 41 out of 100
Updating learning rate to 5.462147742404148e-17
EarlyStopping counter: 42 out of 100
Updating learning rate to 2.731073871202074e-17
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.365536935601037e-17
EarlyStopping counter: 44 out of 100
Updating learning rate to 6.827684678005185e-18
EarlyStopping counter: 45 out of 100
Updating learning rate to 3.4138423390025927e-18
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.7069211695012963e-18
EarlyStopping counter: 47 out of 100
Updating learning rate to 8.534605847506482e-19
EarlyStopping counter: 48 out of 100
Updating learning rate to 4.267302923753241e-19
EarlyStopping counter: 49 out of 100
Updating learning rate to 2.1336514618766204e-19
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.0668257309383102e-19
EarlyStopping counter: 51 out of 100
Updating learning rate to 5.334128654691551e-20
EarlyStopping counter: 52 out of 100
Updating learning rate to 2.6670643273457755e-20
EarlyStopping counter: 53 out of 100
Updating learning rate to 1.3335321636728878e-20
EarlyStopping counter: 54 out of 100
Updating learning rate to 6.667660818364439e-21
EarlyStopping counter: 55 out of 100
Updating learning rate to 3.3338304091822194e-21
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.6669152045911097e-21
EarlyStopping counter: 57 out of 100
Updating learning rate to 8.3345760229555485e-22
EarlyStopping counter: 58 out of 100
Updating learning rate to 4.1672880114777743e-22
EarlyStopping counter: 59 out of 100
Updating learning rate to 2.0836440057388871e-22
EarlyStopping counter: 60 out of 100
Updating learning rate to 1.0418220028694436e-22
EarlyStopping counter: 61 out of 100
Updating learning rate to 5.209110014347218e-23
EarlyStopping counter: 62 out of 100
Updating learning rate to 2.604555007173609e-23
EarlyStopping counter: 63 out of 100
Updating learning rate to 1.3022775035868045e-23
EarlyStopping counter: 64 out of 100
Updating learning rate to 6.511387517934022e-24
EarlyStopping counter: 65 out of 100
Updating learning rate to 3.255693758967011e-24
EarlyStopping counter: 66 out of 100
Updating learning rate to 1.6278468794835056e-24
EarlyStopping counter: 67 out of 100
Updating learning rate to 8.139234397417528e-25
EarlyStopping counter: 68 out of 100
Updating learning rate to 4.069617198708764e-25
EarlyStopping counter: 69 out of 100
Updating learning rate to 2.034808599354382e-25
EarlyStopping counter: 70 out of 100
Updating learning rate to 1.017404299677191e-25
EarlyStopping counter: 71 out of 100
Updating learning rate to 5.087021498385955e-26
EarlyStopping counter: 72 out of 100
Updating learning rate to 2.5435107491929775e-26
EarlyStopping counter: 73 out of 100
Updating learning rate to 1.2717553745964887e-26
EarlyStopping counter: 74 out of 100
Updating learning rate to 6.3587768729824436e-27
EarlyStopping counter: 75 out of 100
Updating learning rate to 3.1793884364912218e-27
EarlyStopping counter: 76 out of 100
Updating learning rate to 1.5896942182456109e-27
EarlyStopping counter: 77 out of 100
Updating learning rate to 7.9484710912280545e-28
EarlyStopping counter: 78 out of 100
Updating learning rate to 3.9742355456140273e-28
EarlyStopping counter: 79 out of 100
Updating learning rate to 1.9871177728070136e-28
EarlyStopping counter: 80 out of 100
Updating learning rate to 9.935588864035068e-29
EarlyStopping counter: 81 out of 100
Updating learning rate to 4.967794432017534e-29
EarlyStopping counter: 82 out of 100
Updating learning rate to 2.483897216008767e-29
EarlyStopping counter: 83 out of 100
Updating learning rate to 1.2419486080043835e-29
EarlyStopping counter: 84 out of 100
Updating learning rate to 6.2097430400219176e-30
EarlyStopping counter: 85 out of 100
Updating learning rate to 3.1048715200109588e-30
EarlyStopping counter: 86 out of 100
Updating learning rate to 1.5524357600054794e-30
EarlyStopping counter: 87 out of 100
Updating learning rate to 7.762178800027397e-31
EarlyStopping counter: 88 out of 100
Updating learning rate to 3.8810894000136985e-31
EarlyStopping counter: 89 out of 100
Updating learning rate to 1.9405447000068493e-31
EarlyStopping counter: 90 out of 100
Updating learning rate to 9.702723500034246e-32
EarlyStopping counter: 91 out of 100
Updating learning rate to 4.851361750017123e-32
EarlyStopping counter: 92 out of 100
Updating learning rate to 2.4256808750085616e-32
EarlyStopping counter: 93 out of 100
Updating learning rate to 1.2128404375042808e-32
EarlyStopping counter: 94 out of 100
Updating learning rate to 6.064202187521404e-33
EarlyStopping counter: 95 out of 100
Updating learning rate to 3.032101093760702e-33
EarlyStopping counter: 96 out of 100
Updating learning rate to 1.516050546880351e-33
EarlyStopping counter: 97 out of 100
Updating learning rate to 7.580252734401755e-34
EarlyStopping counter: 98 out of 100
Updating learning rate to 3.7901263672008774e-34
EarlyStopping counter: 99 out of 100
Updating learning rate to 1.8950631836004387e-34
>>>>>> Testing on validation set: trial_4 >>>>>>
test 232
test shape: (232, 30, 5) (232, 30, 5)
test shape: (232, 30, 5) (232, 30, 5)


	mse:0.07413143664598465, mae:0.11582613736391068, dtw:Not calculated


                                                                                       [I 2025-10-17 04:07:27,063] Trial 4 finished with value: 0.11582613736391068 and parameters: {'seq_len': 96, 'pred_len': 30, 'expand': 2, 'd_model': 64, 'n_heads': 4, 'e_layers': 2, 'd_layers': 2, 'batch_size': 16, 'learning_rate': 0.00012011389910807577, 'dropout': 0.033411468773728026}. Best is trial 2 with value: 0.08393566310405731.
Best trial: 2. Best value: 0.0839357:   8%|▊         | 4/50 [15:23<1:53:37, 148.20s/it]Best trial: 2. Best value: 0.0839357:   8%|▊         | 4/50 [15:23<1:53:37, 148.20s/it]Best trial: 2. Best value: 0.0839357:  10%|█         | 5/50 [15:23<2:21:32, 188.73s/it]
============================================================
Trial 5
============================================================
seq_len: 48, pred_len: 1
d_model: 32, n_heads: 8
e_layers: 2, d_layers: 1
batch_size: 16, lr: 0.000636
dropout: 0.09021973932574846
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 32, expand: 1
>>>>>> Start training: trial_5 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.027171).  Saving model ...
Updating learning rate to 0.0006356460616796699
Validation loss decreased (0.027171 --> 0.026443).  Saving model ...
Updating learning rate to 0.00031782303083983493
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00015891151541991746
Validation loss decreased (0.026443 --> 0.025525).  Saving model ...
Updating learning rate to 7.945575770995873e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.9727878854979366e-05
Validation loss decreased (0.025525 --> 0.025411).  Saving model ...
Updating learning rate to 1.9863939427489683e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.931969713744841e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.965984856872421e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.4829924284362104e-06
Validation loss decreased (0.025411 --> 0.025218).  Saving model ...
Updating learning rate to 1.2414962142181052e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.207481071090526e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.103740535545263e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5518702677726315e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.759351338863157e-08
Validation loss decreased (0.025218 --> 0.025074).  Saving model ...
Updating learning rate to 3.879675669431579e-08
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.9398378347157894e-08
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.699189173578947e-09
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.849594586789473e-09
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.4247972933947367e-09
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2123986466973683e-09
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.061993233486842e-10
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.030996616743421e-10
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.5154983083717104e-10
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.577491541858552e-11
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.788745770929276e-11
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.894372885464638e-11
EarlyStopping counter: 12 out of 100
Updating learning rate to 9.47186442732319e-12
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.735932213661595e-12
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.3679661068307975e-12
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.1839830534153988e-12
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.919915267076994e-13
Validation loss decreased (0.025074 --> 0.024994).  Saving model ...
Updating learning rate to 2.959957633538497e-13
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4799788167692485e-13
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.399894083846242e-14
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.699947041923121e-14
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8499735209615606e-14
Validation loss decreased (0.024994 --> 0.024959).  Saving model ...
Updating learning rate to 9.249867604807803e-15
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6249338024039015e-15
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.3124669012019507e-15
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1562334506009754e-15
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.781167253004877e-16
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.8905836265024384e-16
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.4452918132512192e-16
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.226459066256096e-17
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.613229533128048e-17
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.806614766564024e-17
EarlyStopping counter: 10 out of 100
Updating learning rate to 9.03307383282012e-18
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.51653691641006e-18
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.25826845820503e-18
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.129134229102515e-18
Validation loss decreased (0.024959 --> 0.024929).  Saving model ...
Updating learning rate to 5.645671145512575e-19
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.8228355727562875e-19
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4114177863781438e-19
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.057088931890719e-20
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.5285444659453594e-20
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.7642722329726797e-20
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.821361164863398e-21
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.410680582431699e-21
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.2053402912158496e-21
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.1026701456079248e-21
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.513350728039624e-22
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.756675364019812e-22
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.378337682009906e-22
EarlyStopping counter: 13 out of 100
Updating learning rate to 6.89168841004953e-23
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.445844205024765e-23
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.7229221025123825e-23
EarlyStopping counter: 16 out of 100
Updating learning rate to 8.614610512561913e-24
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.307305256280956e-24
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.153652628140478e-24
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.076826314070239e-24
EarlyStopping counter: 20 out of 100
Updating learning rate to 5.384131570351195e-25
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.6920657851755977e-25
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.3460328925877988e-25
EarlyStopping counter: 23 out of 100
Updating learning rate to 6.730164462938994e-26
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.365082231469497e-26
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.6825411157347485e-26
EarlyStopping counter: 26 out of 100
Updating learning rate to 8.412705578673743e-27
EarlyStopping counter: 27 out of 100
Updating learning rate to 4.2063527893368714e-27
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.1031763946684357e-27
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.0515881973342178e-27
EarlyStopping counter: 30 out of 100
Updating learning rate to 5.257940986671089e-28
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.6289704933355446e-28
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.3144852466677723e-28
EarlyStopping counter: 33 out of 100
Updating learning rate to 6.572426233338862e-29
EarlyStopping counter: 34 out of 100
Updating learning rate to 3.286213116669431e-29
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.6431065583347154e-29
EarlyStopping counter: 36 out of 100
Updating learning rate to 8.215532791673577e-30
EarlyStopping counter: 37 out of 100
Updating learning rate to 4.1077663958367884e-30
EarlyStopping counter: 38 out of 100
Updating learning rate to 2.0538831979183942e-30
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.0269415989591971e-30
EarlyStopping counter: 40 out of 100
Updating learning rate to 5.134707994795986e-31
Validation loss decreased (0.024929 --> 0.024901).  Saving model ...
Updating learning rate to 2.567353997397993e-31
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2836769986989964e-31
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.418384993494982e-32
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.209192496747491e-32
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6045962483737455e-32
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.022981241868727e-33
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.011490620934364e-33
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.005745310467182e-33
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.002872655233591e-33
>>>>>> Testing on validation set: trial_5 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.050095025449991226, mae:0.07396138459444046, dtw:Not calculated


                                                                                       [I 2025-10-17 04:11:49,077] Trial 5 finished with value: 0.07396138459444046 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 1, 'd_model': 32, 'n_heads': 8, 'e_layers': 2, 'd_layers': 1, 'batch_size': 16, 'learning_rate': 0.0006356460616796699, 'dropout': 0.09021973932574846}. Best is trial 5 with value: 0.07396138459444046.
Best trial: 2. Best value: 0.0839357:  10%|█         | 5/50 [19:45<2:21:32, 188.73s/it]Best trial: 5. Best value: 0.0739614:  10%|█         | 5/50 [19:45<2:21:32, 188.73s/it]Best trial: 5. Best value: 0.0739614:  12%|█▏        | 6/50 [19:45<2:36:40, 213.65s/it]
============================================================
Trial 6
============================================================
seq_len: 48, pred_len: 14
d_model: 32, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 64, lr: 0.000828
dropout: 0.04480040884596951
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 32, expand: 1
>>>>>> Start training: trial_6 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 14
============================================================
train 4612
val 246
test 248
Validation loss decreased (inf --> 0.040609).  Saving model ...
Updating learning rate to 0.0008283972821660536
Validation loss decreased (0.040609 --> 0.038182).  Saving model ...
Updating learning rate to 0.0004141986410830268
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0002070993205415134
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.0001035496602707567
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.177483013537835e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.5887415067689174e-05
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2943707533844587e-05
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.4718537669222935e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.2359268834611468e-06
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6179634417305734e-06
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.089817208652867e-07
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.0449086043264335e-07
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.0224543021632167e-07
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.0112271510816084e-07
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.056135755408042e-08
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.528067877704021e-08
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.2640339388520105e-08
EarlyStopping counter: 16 out of 100
Updating learning rate to 6.320169694260052e-09
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.160084847130026e-09
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.580042423565013e-09
EarlyStopping counter: 19 out of 100
Updating learning rate to 7.900212117825065e-10
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.9501060589125327e-10
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.9750530294562663e-10
EarlyStopping counter: 22 out of 100
Updating learning rate to 9.875265147281332e-11
EarlyStopping counter: 23 out of 100
Updating learning rate to 4.937632573640666e-11
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.468816286820333e-11
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.2344081434101665e-11
EarlyStopping counter: 26 out of 100
Updating learning rate to 6.172040717050832e-12
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.086020358525416e-12
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.543010179262708e-12
EarlyStopping counter: 29 out of 100
Updating learning rate to 7.71505089631354e-13
EarlyStopping counter: 30 out of 100
Updating learning rate to 3.85752544815677e-13
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.928762724078385e-13
EarlyStopping counter: 32 out of 100
Updating learning rate to 9.643813620391925e-14
EarlyStopping counter: 33 out of 100
Updating learning rate to 4.821906810195963e-14
EarlyStopping counter: 34 out of 100
Updating learning rate to 2.4109534050979814e-14
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.2054767025489907e-14
EarlyStopping counter: 36 out of 100
Updating learning rate to 6.0273835127449534e-15
EarlyStopping counter: 37 out of 100
Updating learning rate to 3.0136917563724767e-15
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.5068458781862384e-15
EarlyStopping counter: 39 out of 100
Updating learning rate to 7.534229390931192e-16
EarlyStopping counter: 40 out of 100
Updating learning rate to 3.767114695465596e-16
EarlyStopping counter: 41 out of 100
Updating learning rate to 1.883557347732798e-16
EarlyStopping counter: 42 out of 100
Updating learning rate to 9.41778673866399e-17
EarlyStopping counter: 43 out of 100
Updating learning rate to 4.708893369331995e-17
EarlyStopping counter: 44 out of 100
Updating learning rate to 2.3544466846659974e-17
EarlyStopping counter: 45 out of 100
Updating learning rate to 1.1772233423329987e-17
EarlyStopping counter: 46 out of 100
Updating learning rate to 5.8861167116649936e-18
EarlyStopping counter: 47 out of 100
Updating learning rate to 2.9430583558324968e-18
EarlyStopping counter: 48 out of 100
Updating learning rate to 1.4715291779162484e-18
EarlyStopping counter: 49 out of 100
Updating learning rate to 7.357645889581242e-19
EarlyStopping counter: 50 out of 100
Updating learning rate to 3.678822944790621e-19
EarlyStopping counter: 51 out of 100
Updating learning rate to 1.8394114723953105e-19
EarlyStopping counter: 52 out of 100
Updating learning rate to 9.197057361976552e-20
EarlyStopping counter: 53 out of 100
Updating learning rate to 4.598528680988276e-20
EarlyStopping counter: 54 out of 100
Updating learning rate to 2.299264340494138e-20
EarlyStopping counter: 55 out of 100
Updating learning rate to 1.149632170247069e-20
EarlyStopping counter: 56 out of 100
Updating learning rate to 5.748160851235345e-21
EarlyStopping counter: 57 out of 100
Updating learning rate to 2.8740804256176727e-21
EarlyStopping counter: 58 out of 100
Updating learning rate to 1.4370402128088363e-21
EarlyStopping counter: 59 out of 100
Updating learning rate to 7.185201064044182e-22
EarlyStopping counter: 60 out of 100
Updating learning rate to 3.592600532022091e-22
EarlyStopping counter: 61 out of 100
Updating learning rate to 1.7963002660110454e-22
EarlyStopping counter: 62 out of 100
Updating learning rate to 8.981501330055227e-23
EarlyStopping counter: 63 out of 100
Updating learning rate to 4.4907506650276135e-23
EarlyStopping counter: 64 out of 100
Updating learning rate to 2.2453753325138068e-23
EarlyStopping counter: 65 out of 100
Updating learning rate to 1.1226876662569034e-23
EarlyStopping counter: 66 out of 100
Updating learning rate to 5.613438331284517e-24
EarlyStopping counter: 67 out of 100
Updating learning rate to 2.8067191656422584e-24
EarlyStopping counter: 68 out of 100
Updating learning rate to 1.4033595828211292e-24
EarlyStopping counter: 69 out of 100
Updating learning rate to 7.016797914105646e-25
EarlyStopping counter: 70 out of 100
Updating learning rate to 3.508398957052823e-25
EarlyStopping counter: 71 out of 100
Updating learning rate to 1.7541994785264115e-25
EarlyStopping counter: 72 out of 100
Updating learning rate to 8.770997392632058e-26
EarlyStopping counter: 73 out of 100
Updating learning rate to 4.385498696316029e-26
EarlyStopping counter: 74 out of 100
Updating learning rate to 2.1927493481580144e-26
EarlyStopping counter: 75 out of 100
Updating learning rate to 1.0963746740790072e-26
EarlyStopping counter: 76 out of 100
Updating learning rate to 5.481873370395036e-27
EarlyStopping counter: 77 out of 100
Updating learning rate to 2.740936685197518e-27
EarlyStopping counter: 78 out of 100
Updating learning rate to 1.370468342598759e-27
EarlyStopping counter: 79 out of 100
Updating learning rate to 6.852341712993795e-28
EarlyStopping counter: 80 out of 100
Updating learning rate to 3.4261708564968975e-28
EarlyStopping counter: 81 out of 100
Updating learning rate to 1.7130854282484488e-28
EarlyStopping counter: 82 out of 100
Updating learning rate to 8.565427141242244e-29
EarlyStopping counter: 83 out of 100
Updating learning rate to 4.282713570621122e-29
EarlyStopping counter: 84 out of 100
Updating learning rate to 2.141356785310561e-29
EarlyStopping counter: 85 out of 100
Updating learning rate to 1.0706783926552805e-29
EarlyStopping counter: 86 out of 100
Updating learning rate to 5.3533919632764024e-30
EarlyStopping counter: 87 out of 100
Updating learning rate to 2.6766959816382012e-30
EarlyStopping counter: 88 out of 100
Updating learning rate to 1.3383479908191006e-30
EarlyStopping counter: 89 out of 100
Updating learning rate to 6.691739954095503e-31
EarlyStopping counter: 90 out of 100
Updating learning rate to 3.3458699770477515e-31
EarlyStopping counter: 91 out of 100
Updating learning rate to 1.6729349885238757e-31
EarlyStopping counter: 92 out of 100
Updating learning rate to 8.364674942619379e-32
EarlyStopping counter: 93 out of 100
Updating learning rate to 4.1823374713096894e-32
EarlyStopping counter: 94 out of 100
Updating learning rate to 2.0911687356548447e-32
EarlyStopping counter: 95 out of 100
Updating learning rate to 1.0455843678274223e-32
EarlyStopping counter: 96 out of 100
Updating learning rate to 5.227921839137112e-33
EarlyStopping counter: 97 out of 100
Updating learning rate to 2.613960919568556e-33
EarlyStopping counter: 98 out of 100
Updating learning rate to 1.306980459784278e-33
>>>>>> Testing on validation set: trial_6 >>>>>>
test 248
test shape: (248, 14, 5) (248, 14, 5)
test shape: (248, 14, 5) (248, 14, 5)


	mse:0.06508458405733109, mae:0.09955481439828873, dtw:Not calculated


                                                                                       [I 2025-10-17 04:12:57,273] Trial 6 finished with value: 0.09955481439828873 and parameters: {'seq_len': 48, 'pred_len': 14, 'expand': 1, 'd_model': 32, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 64, 'learning_rate': 0.0008283972821660536, 'dropout': 0.04480040884596951}. Best is trial 5 with value: 0.07396138459444046.
Best trial: 5. Best value: 0.0739614:  12%|█▏        | 6/50 [20:53<2:36:40, 213.65s/it]Best trial: 5. Best value: 0.0739614:  12%|█▏        | 6/50 [20:53<2:36:40, 213.65s/it]Best trial: 5. Best value: 0.0739614:  14%|█▍        | 7/50 [20:53<1:59:02, 166.10s/it]
============================================================
Trial 7
============================================================
seq_len: 96, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000451
dropout: 0.09214988700304615
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_7 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 1
============================================================
train 4577
val 259
test 261
Validation loss decreased (inf --> 0.028491).  Saving model ...
Updating learning rate to 0.00045125558660519233
Validation loss decreased (0.028491 --> 0.026798).  Saving model ...
Updating learning rate to 0.00022562779330259617
Validation loss decreased (0.026798 --> 0.023385).  Saving model ...
Updating learning rate to 0.00011281389665129808
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.640694832564904e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.820347416282452e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.410173708141226e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.05086854070613e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.525434270353065e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.7627171351765326e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.813585675882663e-07
Validation loss decreased (0.023385 --> 0.022994).  Saving model ...
Updating learning rate to 4.4067928379413314e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2033964189706657e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1016982094853328e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.508491047426664e-08
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.754245523713332e-08
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.377122761856666e-08
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.88561380928333e-09
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.442806904641665e-09
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.7214034523208326e-09
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.607017261604163e-10
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.3035086308020814e-10
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.1517543154010407e-10
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.0758771577005204e-10
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.379385788502602e-11
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.689692894251301e-11
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.3448464471256504e-11
EarlyStopping counter: 16 out of 100
Updating learning rate to 6.724232235628252e-12
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.362116117814126e-12
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.681058058907063e-12
EarlyStopping counter: 19 out of 100
Updating learning rate to 8.405290294535315e-13
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.2026451472676576e-13
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.1013225736338288e-13
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.0506612868169144e-13
EarlyStopping counter: 23 out of 100
Updating learning rate to 5.253306434084572e-14
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.626653217042286e-14
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.313326608521143e-14
EarlyStopping counter: 26 out of 100
Updating learning rate to 6.566633042605715e-15
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.2833165213028575e-15
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.6416582606514288e-15
EarlyStopping counter: 29 out of 100
Updating learning rate to 8.208291303257144e-16
EarlyStopping counter: 30 out of 100
Updating learning rate to 4.104145651628572e-16
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.052072825814286e-16
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.026036412907143e-16
EarlyStopping counter: 33 out of 100
Updating learning rate to 5.130182064535715e-17
EarlyStopping counter: 34 out of 100
Updating learning rate to 2.5650910322678574e-17
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.2825455161339287e-17
EarlyStopping counter: 36 out of 100
Updating learning rate to 6.412727580669644e-18
EarlyStopping counter: 37 out of 100
Updating learning rate to 3.206363790334822e-18
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.603181895167411e-18
EarlyStopping counter: 39 out of 100
Updating learning rate to 8.015909475837055e-19
EarlyStopping counter: 40 out of 100
Updating learning rate to 4.0079547379185273e-19
EarlyStopping counter: 41 out of 100
Updating learning rate to 2.0039773689592636e-19
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.0019886844796318e-19
EarlyStopping counter: 43 out of 100
Updating learning rate to 5.009943422398159e-20
EarlyStopping counter: 44 out of 100
Updating learning rate to 2.5049717111990795e-20
EarlyStopping counter: 45 out of 100
Updating learning rate to 1.2524858555995398e-20
EarlyStopping counter: 46 out of 100
Updating learning rate to 6.262429277997699e-21
EarlyStopping counter: 47 out of 100
Updating learning rate to 3.1312146389988494e-21
EarlyStopping counter: 48 out of 100
Updating learning rate to 1.5656073194994247e-21
EarlyStopping counter: 49 out of 100
Updating learning rate to 7.828036597497124e-22
EarlyStopping counter: 50 out of 100
Updating learning rate to 3.914018298748562e-22
EarlyStopping counter: 51 out of 100
Updating learning rate to 1.957009149374281e-22
EarlyStopping counter: 52 out of 100
Updating learning rate to 9.785045746871404e-23
EarlyStopping counter: 53 out of 100
Updating learning rate to 4.892522873435702e-23
EarlyStopping counter: 54 out of 100
Updating learning rate to 2.446261436717851e-23
EarlyStopping counter: 55 out of 100
Updating learning rate to 1.2231307183589256e-23
EarlyStopping counter: 56 out of 100
Updating learning rate to 6.115653591794628e-24
EarlyStopping counter: 57 out of 100
Updating learning rate to 3.057826795897314e-24
EarlyStopping counter: 58 out of 100
Updating learning rate to 1.528913397948657e-24
EarlyStopping counter: 59 out of 100
Updating learning rate to 7.644566989743285e-25
EarlyStopping counter: 60 out of 100
Updating learning rate to 3.8222834948716424e-25
EarlyStopping counter: 61 out of 100
Updating learning rate to 1.9111417474358212e-25
EarlyStopping counter: 62 out of 100
Updating learning rate to 9.555708737179106e-26
EarlyStopping counter: 63 out of 100
Updating learning rate to 4.777854368589553e-26
EarlyStopping counter: 64 out of 100
Updating learning rate to 2.3889271842947765e-26
EarlyStopping counter: 65 out of 100
Updating learning rate to 1.1944635921473882e-26
EarlyStopping counter: 66 out of 100
Updating learning rate to 5.972317960736941e-27
EarlyStopping counter: 67 out of 100
Updating learning rate to 2.9861589803684706e-27
EarlyStopping counter: 68 out of 100
Updating learning rate to 1.4930794901842353e-27
EarlyStopping counter: 69 out of 100
Updating learning rate to 7.4653974509211765e-28
EarlyStopping counter: 70 out of 100
Updating learning rate to 3.7326987254605882e-28
EarlyStopping counter: 71 out of 100
Updating learning rate to 1.8663493627302941e-28
EarlyStopping counter: 72 out of 100
Updating learning rate to 9.331746813651471e-29
EarlyStopping counter: 73 out of 100
Updating learning rate to 4.6658734068257353e-29
EarlyStopping counter: 74 out of 100
Updating learning rate to 2.3329367034128677e-29
EarlyStopping counter: 75 out of 100
Updating learning rate to 1.1664683517064338e-29
EarlyStopping counter: 76 out of 100
Updating learning rate to 5.832341758532169e-30
EarlyStopping counter: 77 out of 100
Updating learning rate to 2.9161708792660846e-30
EarlyStopping counter: 78 out of 100
Updating learning rate to 1.4580854396330423e-30
EarlyStopping counter: 79 out of 100
Updating learning rate to 7.290427198165211e-31
EarlyStopping counter: 80 out of 100
Updating learning rate to 3.6452135990826057e-31
EarlyStopping counter: 81 out of 100
Updating learning rate to 1.8226067995413029e-31
EarlyStopping counter: 82 out of 100
Updating learning rate to 9.113033997706514e-32
EarlyStopping counter: 83 out of 100
Updating learning rate to 4.556516998853257e-32
EarlyStopping counter: 84 out of 100
Updating learning rate to 2.2782584994266286e-32
EarlyStopping counter: 85 out of 100
Updating learning rate to 1.1391292497133143e-32
EarlyStopping counter: 86 out of 100
Updating learning rate to 5.6956462485665714e-33
EarlyStopping counter: 87 out of 100
Updating learning rate to 2.8478231242832857e-33
EarlyStopping counter: 88 out of 100
Updating learning rate to 1.4239115621416429e-33
EarlyStopping counter: 89 out of 100
Updating learning rate to 7.119557810708214e-34
>>>>>> Testing on validation set: trial_7 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.05020567774772644, mae:0.07517904788255692, dtw:Not calculated


                                                                                       [I 2025-10-17 04:15:11,661] Trial 7 finished with value: 0.07517904788255692 and parameters: {'seq_len': 96, 'pred_len': 1, 'expand': 2, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.00045125558660519233, 'dropout': 0.09214988700304615}. Best is trial 5 with value: 0.07396138459444046.
Best trial: 5. Best value: 0.0739614:  14%|█▍        | 7/50 [23:07<1:59:02, 166.10s/it]Best trial: 5. Best value: 0.0739614:  14%|█▍        | 7/50 [23:07<1:59:02, 166.10s/it]Best trial: 5. Best value: 0.0739614:  16%|█▌        | 8/50 [23:07<1:49:12, 156.00s/it]
============================================================
Trial 8
============================================================
seq_len: 48, pred_len: 1
d_model: 32, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000508
dropout: 0.16733482455859858
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 64, expand: 2
>>>>>> Start training: trial_8 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.029668).  Saving model ...
Updating learning rate to 0.0005076666068521298
Validation loss decreased (0.029668 --> 0.027397).  Saving model ...
Updating learning rate to 0.0002538333034260649
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00012691665171303245
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.345832585651622e-05
Validation loss decreased (0.027397 --> 0.025331).  Saving model ...
Updating learning rate to 3.172916292825811e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5864581464129056e-05
Validation loss decreased (0.025331 --> 0.024535).  Saving model ...
Updating learning rate to 7.932290732064528e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.966145366032264e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.983072683016132e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.91536341508066e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.95768170754033e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.478840853770165e-07
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.2394204268850825e-07
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.197102134425412e-08
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.098551067212706e-08
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.549275533606353e-08
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.746377668031766e-09
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.873188834015883e-09
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.9365944170079414e-09
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.682972085039707e-10
Validation loss decreased (0.024535 --> 0.024245).  Saving model ...
Updating learning rate to 4.841486042519853e-10
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.4207430212599267e-10
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2103715106299634e-10
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.051857553149817e-11
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.0259287765749084e-11
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.5129643882874542e-11
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.564821941437271e-12
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.7824109707186355e-12
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.8912054853593178e-12
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.456027426796589e-13
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.728013713398294e-13
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.364006856699147e-13
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.1820034283495736e-13
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.910017141747868e-14
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.955008570873934e-14
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.477504285436967e-14
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.387521427184835e-15
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.6937607135924175e-15
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.8468803567962088e-15
EarlyStopping counter: 19 out of 100
Updating learning rate to 9.234401783981044e-16
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.617200891990522e-16
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.308600445995261e-16
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.1543002229976305e-16
EarlyStopping counter: 23 out of 100
Updating learning rate to 5.771501114988152e-17
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.885750557494076e-17
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.442875278747038e-17
EarlyStopping counter: 26 out of 100
Updating learning rate to 7.21437639373519e-18
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.607188196867595e-18
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.8035940984337976e-18
EarlyStopping counter: 29 out of 100
Updating learning rate to 9.017970492168988e-19
EarlyStopping counter: 30 out of 100
Updating learning rate to 4.508985246084494e-19
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.254492623042247e-19
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.1272463115211235e-19
EarlyStopping counter: 33 out of 100
Updating learning rate to 5.636231557605618e-20
EarlyStopping counter: 34 out of 100
Updating learning rate to 2.818115778802809e-20
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.4090578894014044e-20
EarlyStopping counter: 36 out of 100
Updating learning rate to 7.045289447007022e-21
EarlyStopping counter: 37 out of 100
Updating learning rate to 3.522644723503511e-21
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.7613223617517555e-21
EarlyStopping counter: 39 out of 100
Updating learning rate to 8.806611808758777e-22
EarlyStopping counter: 40 out of 100
Updating learning rate to 4.403305904379389e-22
EarlyStopping counter: 41 out of 100
Updating learning rate to 2.2016529521896943e-22
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.1008264760948472e-22
EarlyStopping counter: 43 out of 100
Updating learning rate to 5.504132380474236e-23
EarlyStopping counter: 44 out of 100
Updating learning rate to 2.752066190237118e-23
EarlyStopping counter: 45 out of 100
Updating learning rate to 1.376033095118559e-23
EarlyStopping counter: 46 out of 100
Updating learning rate to 6.880165475592795e-24
EarlyStopping counter: 47 out of 100
Updating learning rate to 3.4400827377963974e-24
EarlyStopping counter: 48 out of 100
Updating learning rate to 1.7200413688981987e-24
EarlyStopping counter: 49 out of 100
Updating learning rate to 8.600206844490994e-25
EarlyStopping counter: 50 out of 100
Updating learning rate to 4.300103422245497e-25
EarlyStopping counter: 51 out of 100
Updating learning rate to 2.1500517111227484e-25
EarlyStopping counter: 52 out of 100
Updating learning rate to 1.0750258555613742e-25
EarlyStopping counter: 53 out of 100
Updating learning rate to 5.375129277806871e-26
EarlyStopping counter: 54 out of 100
Updating learning rate to 2.6875646389034355e-26
EarlyStopping counter: 55 out of 100
Updating learning rate to 1.3437823194517177e-26
EarlyStopping counter: 56 out of 100
Updating learning rate to 6.718911597258589e-27
EarlyStopping counter: 57 out of 100
Updating learning rate to 3.359455798629294e-27
EarlyStopping counter: 58 out of 100
Updating learning rate to 1.679727899314647e-27
EarlyStopping counter: 59 out of 100
Updating learning rate to 8.398639496573236e-28
EarlyStopping counter: 60 out of 100
Updating learning rate to 4.199319748286618e-28
EarlyStopping counter: 61 out of 100
Updating learning rate to 2.099659874143309e-28
EarlyStopping counter: 62 out of 100
Updating learning rate to 1.0498299370716545e-28
EarlyStopping counter: 63 out of 100
Updating learning rate to 5.249149685358272e-29
EarlyStopping counter: 64 out of 100
Updating learning rate to 2.624574842679136e-29
EarlyStopping counter: 65 out of 100
Updating learning rate to 1.312287421339568e-29
EarlyStopping counter: 66 out of 100
Updating learning rate to 6.56143710669784e-30
EarlyStopping counter: 67 out of 100
Updating learning rate to 3.28071855334892e-30
EarlyStopping counter: 68 out of 100
Updating learning rate to 1.64035927667446e-30
EarlyStopping counter: 69 out of 100
Updating learning rate to 8.2017963833723e-31
EarlyStopping counter: 70 out of 100
Updating learning rate to 4.10089819168615e-31
EarlyStopping counter: 71 out of 100
Updating learning rate to 2.050449095843075e-31
EarlyStopping counter: 72 out of 100
Updating learning rate to 1.0252245479215376e-31
EarlyStopping counter: 73 out of 100
Updating learning rate to 5.126122739607688e-32
EarlyStopping counter: 74 out of 100
Updating learning rate to 2.563061369803844e-32
EarlyStopping counter: 75 out of 100
Updating learning rate to 1.281530684901922e-32
EarlyStopping counter: 76 out of 100
Updating learning rate to 6.40765342450961e-33
EarlyStopping counter: 77 out of 100
Updating learning rate to 3.203826712254805e-33
EarlyStopping counter: 78 out of 100
Updating learning rate to 1.6019133561274025e-33
EarlyStopping counter: 79 out of 100
Updating learning rate to 8.009566780637012e-34
>>>>>> Testing on validation set: trial_8 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.049998797476291656, mae:0.0743560865521431, dtw:Not calculated


                                                                                       [I 2025-10-17 04:17:25,451] Trial 8 finished with value: 0.0743560865521431 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 2, 'd_model': 32, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0005076666068521298, 'dropout': 0.16733482455859858}. Best is trial 5 with value: 0.07396138459444046.
Best trial: 5. Best value: 0.0739614:  16%|█▌        | 8/50 [25:21<1:49:12, 156.00s/it]Best trial: 5. Best value: 0.0739614:  16%|█▌        | 8/50 [25:21<1:49:12, 156.00s/it]Best trial: 5. Best value: 0.0739614:  18%|█▊        | 9/50 [25:21<1:41:51, 149.06s/it]
============================================================
Trial 9
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 2, d_layers: 1
batch_size: 32, lr: 0.000031
dropout: 0.2819576616412142
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_9 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.041536).  Saving model ...
Updating learning rate to 3.109023034827718e-05
Validation loss decreased (0.041536 --> 0.036422).  Saving model ...
Updating learning rate to 1.554511517413859e-05
Validation loss decreased (0.036422 --> 0.033285).  Saving model ...
Updating learning rate to 7.772557587069294e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.886278793534647e-06
Validation loss decreased (0.033285 --> 0.030587).  Saving model ...
Updating learning rate to 1.9431393967673236e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.715696983836618e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.857848491918309e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.4289242459591545e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2144621229795773e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.072310614897886e-08
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.036155307448943e-08
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.5180776537244716e-08
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.590388268622358e-09
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.795194134311179e-09
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.8975970671555895e-09
EarlyStopping counter: 11 out of 100
Updating learning rate to 9.487985335777947e-10
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.743992667888974e-10
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.371996333944487e-10
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.1859981669722434e-10
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.929990834861217e-11
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.9649954174306085e-11
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.4824977087153043e-11
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.412488543576521e-12
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.706244271788261e-12
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.8531221358941303e-12
EarlyStopping counter: 21 out of 100
Updating learning rate to 9.265610679470652e-13
EarlyStopping counter: 22 out of 100
Updating learning rate to 4.632805339735326e-13
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.316402669867663e-13
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.1582013349338315e-13
EarlyStopping counter: 25 out of 100
Updating learning rate to 5.791006674669157e-14
Validation loss decreased (0.030587 --> 0.030305).  Saving model ...
Updating learning rate to 2.8955033373345786e-14
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4477516686672893e-14
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.238758343336447e-15
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.619379171668223e-15
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8096895858341116e-15
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.048447929170558e-16
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.524223964585279e-16
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2621119822926396e-16
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.1310559911463198e-16
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.655279955731599e-17
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.8276399778657994e-17
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.4138199889328997e-17
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.069099944664499e-18
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.534549972332249e-18
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.7672749861661247e-18
EarlyStopping counter: 15 out of 100
Updating learning rate to 8.836374930830623e-19
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.418187465415312e-19
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.209093732707656e-19
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.104546866353828e-19
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.52273433176914e-20
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.76136716588457e-20
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.380683582942285e-20
EarlyStopping counter: 22 out of 100
Updating learning rate to 6.903417914711424e-21
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.451708957355712e-21
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.725854478677856e-21
EarlyStopping counter: 25 out of 100
Updating learning rate to 8.62927239338928e-22
EarlyStopping counter: 26 out of 100
Updating learning rate to 4.31463619669464e-22
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.15731809834732e-22
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.07865904917366e-22
EarlyStopping counter: 29 out of 100
Updating learning rate to 5.3932952458683e-23
EarlyStopping counter: 30 out of 100
Updating learning rate to 2.69664762293415e-23
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.348323811467075e-23
EarlyStopping counter: 32 out of 100
Updating learning rate to 6.741619057335375e-24
EarlyStopping counter: 33 out of 100
Updating learning rate to 3.370809528667688e-24
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.685404764333844e-24
EarlyStopping counter: 35 out of 100
Updating learning rate to 8.42702382166922e-25
EarlyStopping counter: 36 out of 100
Updating learning rate to 4.21351191083461e-25
EarlyStopping counter: 37 out of 100
Updating learning rate to 2.106755955417305e-25
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.0533779777086524e-25
EarlyStopping counter: 39 out of 100
Updating learning rate to 5.266889888543262e-26
EarlyStopping counter: 40 out of 100
Updating learning rate to 2.633444944271631e-26
EarlyStopping counter: 41 out of 100
Updating learning rate to 1.3167224721358155e-26
EarlyStopping counter: 42 out of 100
Updating learning rate to 6.583612360679078e-27
EarlyStopping counter: 43 out of 100
Updating learning rate to 3.291806180339539e-27
EarlyStopping counter: 44 out of 100
Updating learning rate to 1.6459030901697694e-27
EarlyStopping counter: 45 out of 100
Updating learning rate to 8.229515450848847e-28
EarlyStopping counter: 46 out of 100
Updating learning rate to 4.1147577254244235e-28
EarlyStopping counter: 47 out of 100
Updating learning rate to 2.0573788627122117e-28
EarlyStopping counter: 48 out of 100
Updating learning rate to 1.0286894313561059e-28
EarlyStopping counter: 49 out of 100
Updating learning rate to 5.143447156780529e-29
EarlyStopping counter: 50 out of 100
Updating learning rate to 2.5717235783902647e-29
EarlyStopping counter: 51 out of 100
Updating learning rate to 1.2858617891951323e-29
EarlyStopping counter: 52 out of 100
Updating learning rate to 6.429308945975662e-30
EarlyStopping counter: 53 out of 100
Updating learning rate to 3.214654472987831e-30
EarlyStopping counter: 54 out of 100
Updating learning rate to 1.6073272364939154e-30
EarlyStopping counter: 55 out of 100
Updating learning rate to 8.036636182469577e-31
EarlyStopping counter: 56 out of 100
Updating learning rate to 4.0183180912347886e-31
EarlyStopping counter: 57 out of 100
Updating learning rate to 2.0091590456173943e-31
EarlyStopping counter: 58 out of 100
Updating learning rate to 1.0045795228086971e-31
EarlyStopping counter: 59 out of 100
Updating learning rate to 5.022897614043486e-32
EarlyStopping counter: 60 out of 100
Updating learning rate to 2.511448807021743e-32
EarlyStopping counter: 61 out of 100
Updating learning rate to 1.2557244035108714e-32
EarlyStopping counter: 62 out of 100
Updating learning rate to 6.278622017554357e-33
EarlyStopping counter: 63 out of 100
Updating learning rate to 3.1393110087771786e-33
EarlyStopping counter: 64 out of 100
Updating learning rate to 1.5696555043885893e-33
EarlyStopping counter: 65 out of 100
Updating learning rate to 7.848277521942946e-34
EarlyStopping counter: 66 out of 100
Updating learning rate to 3.924138760971473e-34
EarlyStopping counter: 67 out of 100
Updating learning rate to 1.9620693804857366e-34
EarlyStopping counter: 68 out of 100
Updating learning rate to 9.810346902428683e-35
EarlyStopping counter: 69 out of 100
Updating learning rate to 4.905173451214341e-35
>>>>>> Testing on validation set: trial_9 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.06097738817334175, mae:0.09440631419420242, dtw:Not calculated


                                                                                       [I 2025-10-17 04:19:39,212] Trial 9 finished with value: 0.09440631419420242 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 2, 'd_layers': 1, 'batch_size': 32, 'learning_rate': 3.109023034827718e-05, 'dropout': 0.2819576616412142}. Best is trial 5 with value: 0.07396138459444046.
Best trial: 5. Best value: 0.0739614:  18%|█▊        | 9/50 [27:35<1:41:51, 149.06s/it]Best trial: 5. Best value: 0.0739614:  18%|█▊        | 9/50 [27:35<1:41:51, 149.06s/it]Best trial: 5. Best value: 0.0739614:  20%|██        | 10/50 [27:35<1:36:13, 144.34s/it]
============================================================
Trial 10
============================================================
seq_len: 48, pred_len: 7
d_model: 32, n_heads: 4
e_layers: 2, d_layers: 1
batch_size: 16, lr: 0.000171
dropout: 0.12097878366295882
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 32, expand: 1
>>>>>> Start training: trial_10 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 7
============================================================
train 4619
val 253
test 255
Validation loss decreased (inf --> 0.037706).  Saving model ...
Updating learning rate to 0.00017062323005795926
Validation loss decreased (0.037706 --> 0.037442).  Saving model ...
Updating learning rate to 8.531161502897963e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.2655807514489816e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.1327903757244908e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0663951878622454e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.331975939311227e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.6659879696556135e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3329939848278068e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.664969924139034e-07
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.332484962069517e-07
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.6662424810347584e-07
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.331212405173792e-08
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.165606202586896e-08
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.082803101293448e-08
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.041401550646724e-08
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.20700775323362e-09
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.60350387661681e-09
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.301751938308405e-09
EarlyStopping counter: 17 out of 100
Updating learning rate to 6.508759691542025e-10
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.2543798457710126e-10
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.6271899228855063e-10
EarlyStopping counter: 20 out of 100
Updating learning rate to 8.135949614427531e-11
EarlyStopping counter: 21 out of 100
Updating learning rate to 4.067974807213766e-11
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.033987403606883e-11
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.0169937018034414e-11
EarlyStopping counter: 24 out of 100
Updating learning rate to 5.084968509017207e-12
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.5424842545086036e-12
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.2712421272543018e-12
EarlyStopping counter: 27 out of 100
Updating learning rate to 6.356210636271509e-13
EarlyStopping counter: 28 out of 100
Updating learning rate to 3.1781053181357545e-13
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.5890526590678772e-13
EarlyStopping counter: 30 out of 100
Updating learning rate to 7.945263295339386e-14
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.972631647669693e-14
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.9863158238348465e-14
EarlyStopping counter: 33 out of 100
Updating learning rate to 9.931579119174233e-15
EarlyStopping counter: 34 out of 100
Updating learning rate to 4.965789559587116e-15
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.482894779793558e-15
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.241447389896779e-15
EarlyStopping counter: 37 out of 100
Updating learning rate to 6.207236949483895e-16
EarlyStopping counter: 38 out of 100
Updating learning rate to 3.1036184747419477e-16
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.5518092373709739e-16
EarlyStopping counter: 40 out of 100
Updating learning rate to 7.759046186854869e-17
EarlyStopping counter: 41 out of 100
Updating learning rate to 3.8795230934274347e-17
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.9397615467137173e-17
EarlyStopping counter: 43 out of 100
Updating learning rate to 9.698807733568587e-18
EarlyStopping counter: 44 out of 100
Updating learning rate to 4.849403866784293e-18
EarlyStopping counter: 45 out of 100
Updating learning rate to 2.4247019333921467e-18
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.2123509666960733e-18
EarlyStopping counter: 47 out of 100
Updating learning rate to 6.061754833480367e-19
EarlyStopping counter: 48 out of 100
Updating learning rate to 3.0308774167401833e-19
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.5154387083700917e-19
EarlyStopping counter: 50 out of 100
Updating learning rate to 7.577193541850458e-20
EarlyStopping counter: 51 out of 100
Updating learning rate to 3.788596770925229e-20
EarlyStopping counter: 52 out of 100
Updating learning rate to 1.8942983854626146e-20
EarlyStopping counter: 53 out of 100
Updating learning rate to 9.471491927313073e-21
EarlyStopping counter: 54 out of 100
Updating learning rate to 4.7357459636565365e-21
EarlyStopping counter: 55 out of 100
Updating learning rate to 2.3678729818282682e-21
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.1839364909141341e-21
EarlyStopping counter: 57 out of 100
Updating learning rate to 5.919682454570671e-22
EarlyStopping counter: 58 out of 100
Updating learning rate to 2.9598412272853353e-22
EarlyStopping counter: 59 out of 100
Updating learning rate to 1.4799206136426676e-22
EarlyStopping counter: 60 out of 100
Updating learning rate to 7.399603068213338e-23
EarlyStopping counter: 61 out of 100
Updating learning rate to 3.699801534106669e-23
EarlyStopping counter: 62 out of 100
Updating learning rate to 1.8499007670533346e-23
EarlyStopping counter: 63 out of 100
Updating learning rate to 9.249503835266673e-24
EarlyStopping counter: 64 out of 100
Updating learning rate to 4.6247519176333364e-24
EarlyStopping counter: 65 out of 100
Updating learning rate to 2.3123759588166682e-24
EarlyStopping counter: 66 out of 100
Updating learning rate to 1.1561879794083341e-24
EarlyStopping counter: 67 out of 100
Updating learning rate to 5.7809398970416705e-25
EarlyStopping counter: 68 out of 100
Updating learning rate to 2.8904699485208352e-25
EarlyStopping counter: 69 out of 100
Updating learning rate to 1.4452349742604176e-25
EarlyStopping counter: 70 out of 100
Updating learning rate to 7.226174871302088e-26
EarlyStopping counter: 71 out of 100
Updating learning rate to 3.613087435651044e-26
EarlyStopping counter: 72 out of 100
Updating learning rate to 1.806543717825522e-26
EarlyStopping counter: 73 out of 100
Updating learning rate to 9.03271858912761e-27
EarlyStopping counter: 74 out of 100
Updating learning rate to 4.516359294563805e-27
EarlyStopping counter: 75 out of 100
Updating learning rate to 2.2581796472819025e-27
EarlyStopping counter: 76 out of 100
Updating learning rate to 1.1290898236409513e-27
EarlyStopping counter: 77 out of 100
Updating learning rate to 5.645449118204756e-28
EarlyStopping counter: 78 out of 100
Updating learning rate to 2.822724559102378e-28
EarlyStopping counter: 79 out of 100
Updating learning rate to 1.411362279551189e-28
EarlyStopping counter: 80 out of 100
Updating learning rate to 7.056811397755945e-29
EarlyStopping counter: 81 out of 100
Updating learning rate to 3.5284056988779727e-29
EarlyStopping counter: 82 out of 100
Updating learning rate to 1.7642028494389864e-29
EarlyStopping counter: 83 out of 100
Updating learning rate to 8.821014247194932e-30
EarlyStopping counter: 84 out of 100
Updating learning rate to 4.410507123597466e-30
EarlyStopping counter: 85 out of 100
Updating learning rate to 2.205253561798733e-30
EarlyStopping counter: 86 out of 100
Updating learning rate to 1.1026267808993665e-30
EarlyStopping counter: 87 out of 100
Updating learning rate to 5.513133904496832e-31
EarlyStopping counter: 88 out of 100
Updating learning rate to 2.756566952248416e-31
EarlyStopping counter: 89 out of 100
Updating learning rate to 1.378283476124208e-31
EarlyStopping counter: 90 out of 100
Updating learning rate to 6.89141738062104e-32
EarlyStopping counter: 91 out of 100
Updating learning rate to 3.44570869031052e-32
EarlyStopping counter: 92 out of 100
Updating learning rate to 1.72285434515526e-32
EarlyStopping counter: 93 out of 100
Updating learning rate to 8.6142717257763e-33
EarlyStopping counter: 94 out of 100
Updating learning rate to 4.30713586288815e-33
EarlyStopping counter: 95 out of 100
Updating learning rate to 2.153567931444075e-33
EarlyStopping counter: 96 out of 100
Updating learning rate to 1.0767839657220376e-33
EarlyStopping counter: 97 out of 100
Updating learning rate to 5.383919828610188e-34
EarlyStopping counter: 98 out of 100
Updating learning rate to 2.691959914305094e-34
>>>>>> Testing on validation set: trial_10 >>>>>>
test 255
test shape: (255, 7, 5) (255, 7, 5)
test shape: (255, 7, 5) (255, 7, 5)


	mse:0.0656866505742073, mae:0.09787409752607346, dtw:Not calculated


                                                                                        [I 2025-10-17 04:24:00,496] Trial 10 finished with value: 0.09787409752607346 and parameters: {'seq_len': 48, 'pred_len': 7, 'expand': 1, 'd_model': 32, 'n_heads': 4, 'e_layers': 2, 'd_layers': 1, 'batch_size': 16, 'learning_rate': 0.00017062323005795926, 'dropout': 0.12097878366295882}. Best is trial 5 with value: 0.07396138459444046.
Best trial: 5. Best value: 0.0739614:  20%|██        | 10/50 [31:56<1:36:13, 144.34s/it]Best trial: 5. Best value: 0.0739614:  20%|██        | 10/50 [31:56<1:36:13, 144.34s/it]Best trial: 5. Best value: 0.0739614:  22%|██▏       | 11/50 [31:56<1:57:04, 180.13s/it]
============================================================
Trial 11
============================================================
seq_len: 48, pred_len: 30
d_model: 32, n_heads: 4
e_layers: 1, d_layers: 1
batch_size: 32, lr: 0.000318
dropout: 0.19185983122347414
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 64, expand: 2
>>>>>> Start training: trial_11 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 30
============================================================
train 4596
val 230
test 232
Validation loss decreased (inf --> 0.037526).  Saving model ...
Updating learning rate to 0.0003178207757537396
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0001589103878768698
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.94551939384349e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.972759696921745e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.9863798484608724e-05
Validation loss decreased (0.037526 --> 0.036754).  Saving model ...
Updating learning rate to 9.931899242304362e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.965949621152181e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.4829748105760905e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2414874052880452e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.207437026440226e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.103718513220113e-07
Validation loss decreased (0.036754 --> 0.036160).  Saving model ...
Updating learning rate to 1.5518592566100566e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.759296283050283e-08
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.8796481415251414e-08
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.9398240707625707e-08
Validation loss decreased (0.036160 --> 0.036002).  Saving model ...
Updating learning rate to 9.699120353812853e-09
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.849560176906427e-09
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.4247800884532134e-09
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2123900442266067e-09
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.061950221133033e-10
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.0309751105665167e-10
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.5154875552832584e-10
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.577437776416292e-11
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.788718888208146e-11
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.894359444104073e-11
EarlyStopping counter: 10 out of 100
Updating learning rate to 9.471797220520365e-12
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.735898610260182e-12
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.367949305130091e-12
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.1839746525650456e-12
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.919873262825228e-13
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.959936631412614e-13
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.479968315706307e-13
EarlyStopping counter: 17 out of 100
Updating learning rate to 7.399841578531535e-14
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.6999207892657675e-14
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.8499603946328837e-14
EarlyStopping counter: 20 out of 100
Updating learning rate to 9.249801973164419e-15
EarlyStopping counter: 21 out of 100
Updating learning rate to 4.624900986582209e-15
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.3124504932911047e-15
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.1562252466455523e-15
EarlyStopping counter: 24 out of 100
Updating learning rate to 5.781126233227762e-16
Validation loss decreased (0.036002 --> 0.035788).  Saving model ...
Updating learning rate to 2.890563116613881e-16
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4452815583069404e-16
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.226407791534702e-17
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.613203895767351e-17
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8066019478836755e-17
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.033009739418378e-18
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.516504869709189e-18
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2582524348545944e-18
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.1291262174272972e-18
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.645631087136486e-19
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.822815543568243e-19
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.4114077717841215e-19
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.057038858920608e-20
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.528519429460304e-20
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.764259714730152e-20
EarlyStopping counter: 15 out of 100
Updating learning rate to 8.82129857365076e-21
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.41064928682538e-21
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.20532464341269e-21
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.102662321706345e-21
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.513311608531725e-22
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.7566558042658623e-22
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.3783279021329312e-22
EarlyStopping counter: 22 out of 100
Updating learning rate to 6.891639510664656e-23
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.445819755332328e-23
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.722909877666164e-23
EarlyStopping counter: 25 out of 100
Updating learning rate to 8.61454938833082e-24
EarlyStopping counter: 26 out of 100
Updating learning rate to 4.30727469416541e-24
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.153637347082705e-24
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.0768186735413525e-24
EarlyStopping counter: 29 out of 100
Updating learning rate to 5.384093367706762e-25
EarlyStopping counter: 30 out of 100
Updating learning rate to 2.692046683853381e-25
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.3460233419266906e-25
EarlyStopping counter: 32 out of 100
Updating learning rate to 6.730116709633453e-26
EarlyStopping counter: 33 out of 100
Updating learning rate to 3.3650583548167265e-26
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.6825291774083632e-26
EarlyStopping counter: 35 out of 100
Updating learning rate to 8.412645887041816e-27
EarlyStopping counter: 36 out of 100
Updating learning rate to 4.206322943520908e-27
EarlyStopping counter: 37 out of 100
Updating learning rate to 2.103161471760454e-27
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.051580735880227e-27
EarlyStopping counter: 39 out of 100
Updating learning rate to 5.257903679401135e-28
EarlyStopping counter: 40 out of 100
Updating learning rate to 2.6289518397005675e-28
EarlyStopping counter: 41 out of 100
Updating learning rate to 1.3144759198502838e-28
EarlyStopping counter: 42 out of 100
Updating learning rate to 6.572379599251419e-29
EarlyStopping counter: 43 out of 100
Updating learning rate to 3.2861897996257094e-29
EarlyStopping counter: 44 out of 100
Updating learning rate to 1.6430948998128547e-29
EarlyStopping counter: 45 out of 100
Updating learning rate to 8.215474499064274e-30
EarlyStopping counter: 46 out of 100
Updating learning rate to 4.107737249532137e-30
EarlyStopping counter: 47 out of 100
Updating learning rate to 2.0538686247660684e-30
EarlyStopping counter: 48 out of 100
Updating learning rate to 1.0269343123830342e-30
EarlyStopping counter: 49 out of 100
Updating learning rate to 5.134671561915171e-31
EarlyStopping counter: 50 out of 100
Updating learning rate to 2.5673357809575855e-31
EarlyStopping counter: 51 out of 100
Updating learning rate to 1.2836678904787927e-31
EarlyStopping counter: 52 out of 100
Updating learning rate to 6.418339452393964e-32
EarlyStopping counter: 53 out of 100
Updating learning rate to 3.209169726196982e-32
EarlyStopping counter: 54 out of 100
Updating learning rate to 1.604584863098491e-32
EarlyStopping counter: 55 out of 100
Updating learning rate to 8.022924315492455e-33
EarlyStopping counter: 56 out of 100
Updating learning rate to 4.011462157746227e-33
EarlyStopping counter: 57 out of 100
Updating learning rate to 2.0057310788731137e-33
EarlyStopping counter: 58 out of 100
Updating learning rate to 1.0028655394365568e-33
EarlyStopping counter: 59 out of 100
Updating learning rate to 5.014327697182784e-34
>>>>>> Testing on validation set: trial_11 >>>>>>
test 232
test shape: (232, 30, 5) (232, 30, 5)
test shape: (232, 30, 5) (232, 30, 5)


	mse:0.06821834295988083, mae:0.10779896378517151, dtw:Not calculated


                                                                                        [I 2025-10-17 04:26:13,065] Trial 11 finished with value: 0.10779896378517151 and parameters: {'seq_len': 48, 'pred_len': 30, 'expand': 2, 'd_model': 32, 'n_heads': 4, 'e_layers': 1, 'd_layers': 1, 'batch_size': 32, 'learning_rate': 0.0003178207757537396, 'dropout': 0.19185983122347414}. Best is trial 5 with value: 0.07396138459444046.
Best trial: 5. Best value: 0.0739614:  22%|██▏       | 11/50 [34:09<1:57:04, 180.13s/it]Best trial: 5. Best value: 0.0739614:  22%|██▏       | 11/50 [34:09<1:57:04, 180.13s/it]Best trial: 5. Best value: 0.0739614:  24%|██▍       | 12/50 [34:09<1:44:55, 165.66s/it]
============================================================
Trial 12
============================================================
seq_len: 48, pred_len: 7
d_model: 32, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000989
dropout: 0.1658939672958422
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 64, expand: 2
>>>>>> Start training: trial_12 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 7
============================================================
train 4619
val 253
test 255
Validation loss decreased (inf --> 0.038647).  Saving model ...
Updating learning rate to 0.000988582685311218
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.000494291342655609
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.0002471456713278045
EarlyStopping counter: 3 out of 100
Updating learning rate to 0.00012357283566390224
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.178641783195112e-05
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.089320891597556e-05
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.544660445798778e-05
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.72330222899389e-06
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.861651114496945e-06
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.9308255572484725e-06
EarlyStopping counter: 10 out of 100
Updating learning rate to 9.654127786242363e-07
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.827063893121181e-07
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.4135319465605907e-07
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.2067659732802953e-07
EarlyStopping counter: 14 out of 100
Updating learning rate to 6.033829866401477e-08
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.016914933200738e-08
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.508457466600369e-08
EarlyStopping counter: 17 out of 100
Updating learning rate to 7.542287333001846e-09
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.771143666500923e-09
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.8855718332504614e-09
EarlyStopping counter: 20 out of 100
Updating learning rate to 9.427859166252307e-10
EarlyStopping counter: 21 out of 100
Updating learning rate to 4.713929583126154e-10
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.356964791563077e-10
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.1784823957815384e-10
EarlyStopping counter: 24 out of 100
Updating learning rate to 5.892411978907692e-11
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.946205989453846e-11
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.473102994726923e-11
EarlyStopping counter: 27 out of 100
Updating learning rate to 7.365514973634615e-12
EarlyStopping counter: 28 out of 100
Updating learning rate to 3.6827574868173075e-12
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.8413787434086538e-12
EarlyStopping counter: 30 out of 100
Updating learning rate to 9.206893717043269e-13
EarlyStopping counter: 31 out of 100
Updating learning rate to 4.603446858521634e-13
EarlyStopping counter: 32 out of 100
Updating learning rate to 2.301723429260817e-13
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.1508617146304086e-13
EarlyStopping counter: 34 out of 100
Updating learning rate to 5.754308573152043e-14
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.8771542865760215e-14
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.4385771432880107e-14
EarlyStopping counter: 37 out of 100
Updating learning rate to 7.192885716440054e-15
EarlyStopping counter: 38 out of 100
Updating learning rate to 3.596442858220027e-15
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.7982214291100134e-15
EarlyStopping counter: 40 out of 100
Updating learning rate to 8.991107145550067e-16
EarlyStopping counter: 41 out of 100
Updating learning rate to 4.495553572775034e-16
EarlyStopping counter: 42 out of 100
Updating learning rate to 2.247776786387517e-16
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.1238883931937584e-16
EarlyStopping counter: 44 out of 100
Updating learning rate to 5.619441965968792e-17
EarlyStopping counter: 45 out of 100
Updating learning rate to 2.809720982984396e-17
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.404860491492198e-17
EarlyStopping counter: 47 out of 100
Updating learning rate to 7.02430245746099e-18
EarlyStopping counter: 48 out of 100
Updating learning rate to 3.512151228730495e-18
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.7560756143652475e-18
EarlyStopping counter: 50 out of 100
Updating learning rate to 8.780378071826237e-19
EarlyStopping counter: 51 out of 100
Updating learning rate to 4.390189035913119e-19
EarlyStopping counter: 52 out of 100
Updating learning rate to 2.1950945179565594e-19
EarlyStopping counter: 53 out of 100
Updating learning rate to 1.0975472589782797e-19
EarlyStopping counter: 54 out of 100
Updating learning rate to 5.487736294891398e-20
EarlyStopping counter: 55 out of 100
Updating learning rate to 2.743868147445699e-20
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.3719340737228496e-20
EarlyStopping counter: 57 out of 100
Updating learning rate to 6.859670368614248e-21
EarlyStopping counter: 58 out of 100
Updating learning rate to 3.429835184307124e-21
EarlyStopping counter: 59 out of 100
Updating learning rate to 1.714917592153562e-21
EarlyStopping counter: 60 out of 100
Updating learning rate to 8.57458796076781e-22
EarlyStopping counter: 61 out of 100
Updating learning rate to 4.287293980383905e-22
EarlyStopping counter: 62 out of 100
Updating learning rate to 2.1436469901919525e-22
EarlyStopping counter: 63 out of 100
Updating learning rate to 1.0718234950959763e-22
EarlyStopping counter: 64 out of 100
Updating learning rate to 5.359117475479881e-23
EarlyStopping counter: 65 out of 100
Updating learning rate to 2.6795587377399406e-23
EarlyStopping counter: 66 out of 100
Updating learning rate to 1.3397793688699703e-23
EarlyStopping counter: 67 out of 100
Updating learning rate to 6.698896844349852e-24
EarlyStopping counter: 68 out of 100
Updating learning rate to 3.349448422174926e-24
EarlyStopping counter: 69 out of 100
Updating learning rate to 1.674724211087463e-24
EarlyStopping counter: 70 out of 100
Updating learning rate to 8.373621055437314e-25
EarlyStopping counter: 71 out of 100
Updating learning rate to 4.186810527718657e-25
EarlyStopping counter: 72 out of 100
Updating learning rate to 2.0934052638593286e-25
EarlyStopping counter: 73 out of 100
Updating learning rate to 1.0467026319296643e-25
EarlyStopping counter: 74 out of 100
Updating learning rate to 5.233513159648322e-26
EarlyStopping counter: 75 out of 100
Updating learning rate to 2.616756579824161e-26
EarlyStopping counter: 76 out of 100
Updating learning rate to 1.3083782899120804e-26
EarlyStopping counter: 77 out of 100
Updating learning rate to 6.541891449560402e-27
EarlyStopping counter: 78 out of 100
Updating learning rate to 3.270945724780201e-27
EarlyStopping counter: 79 out of 100
Updating learning rate to 1.6354728623901005e-27
EarlyStopping counter: 80 out of 100
Updating learning rate to 8.177364311950502e-28
EarlyStopping counter: 81 out of 100
Updating learning rate to 4.088682155975251e-28
EarlyStopping counter: 82 out of 100
Updating learning rate to 2.0443410779876256e-28
EarlyStopping counter: 83 out of 100
Updating learning rate to 1.0221705389938128e-28
EarlyStopping counter: 84 out of 100
Updating learning rate to 5.110852694969064e-29
EarlyStopping counter: 85 out of 100
Updating learning rate to 2.555426347484532e-29
EarlyStopping counter: 86 out of 100
Updating learning rate to 1.277713173742266e-29
EarlyStopping counter: 87 out of 100
Updating learning rate to 6.38856586871133e-30
EarlyStopping counter: 88 out of 100
Updating learning rate to 3.194282934355665e-30
EarlyStopping counter: 89 out of 100
Updating learning rate to 1.5971414671778325e-30
EarlyStopping counter: 90 out of 100
Updating learning rate to 7.985707335889163e-31
EarlyStopping counter: 91 out of 100
Updating learning rate to 3.992853667944581e-31
EarlyStopping counter: 92 out of 100
Updating learning rate to 1.9964268339722906e-31
EarlyStopping counter: 93 out of 100
Updating learning rate to 9.982134169861453e-32
EarlyStopping counter: 94 out of 100
Updating learning rate to 4.991067084930727e-32
EarlyStopping counter: 95 out of 100
Updating learning rate to 2.4955335424653633e-32
EarlyStopping counter: 96 out of 100
Updating learning rate to 1.2477667712326816e-32
EarlyStopping counter: 97 out of 100
Updating learning rate to 6.238833856163408e-33
EarlyStopping counter: 98 out of 100
Updating learning rate to 3.119416928081704e-33
EarlyStopping counter: 99 out of 100
Updating learning rate to 1.559708464040852e-33
>>>>>> Testing on validation set: trial_12 >>>>>>
test 255
test shape: (255, 7, 5) (255, 7, 5)
test shape: (255, 7, 5) (255, 7, 5)


	mse:0.06647853553295135, mae:0.0979897528886795, dtw:Not calculated


                                                                                        [I 2025-10-17 04:28:26,648] Trial 12 finished with value: 0.0979897528886795 and parameters: {'seq_len': 48, 'pred_len': 7, 'expand': 2, 'd_model': 32, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.000988582685311218, 'dropout': 0.1658939672958422}. Best is trial 5 with value: 0.07396138459444046.
Best trial: 5. Best value: 0.0739614:  24%|██▍       | 12/50 [36:22<1:44:55, 165.66s/it]Best trial: 5. Best value: 0.0739614:  24%|██▍       | 12/50 [36:22<1:44:55, 165.66s/it]Best trial: 5. Best value: 0.0739614:  26%|██▌       | 13/50 [36:22<1:36:09, 155.94s/it]
============================================================
Trial 13
============================================================
seq_len: 48, pred_len: 1
d_model: 32, n_heads: 8
e_layers: 1, d_layers: 1
batch_size: 16, lr: 0.000309
dropout: 0.24988643088358137
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 32, expand: 1
>>>>>> Start training: trial_13 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.029347).  Saving model ...
Updating learning rate to 0.0003086055889629638
Validation loss decreased (0.029347 --> 0.028360).  Saving model ...
Updating learning rate to 0.0001543027944814819
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.715139724074095e-05
Validation loss decreased (0.028360 --> 0.026559).  Saving model ...
Updating learning rate to 3.857569862037047e-05
Validation loss decreased (0.026559 --> 0.026267).  Saving model ...
Updating learning rate to 1.9287849310185237e-05
Validation loss decreased (0.026267 --> 0.026085).  Saving model ...
Updating learning rate to 9.643924655092618e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.821962327546309e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.4109811637731546e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2054905818865773e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.027452909432886e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.013726454716443e-07
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.5068632273582216e-07
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.534316136791108e-08
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.767158068395554e-08
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.883579034197777e-08
EarlyStopping counter: 10 out of 100
Updating learning rate to 9.417895170988885e-09
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.7089475854944425e-09
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.3544737927472213e-09
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.1772368963736106e-09
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.886184481868053e-10
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.9430922409340266e-10
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.4715461204670133e-10
EarlyStopping counter: 17 out of 100
Updating learning rate to 7.357730602335066e-11
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.678865301167533e-11
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.8394326505837666e-11
EarlyStopping counter: 20 out of 100
Updating learning rate to 9.197163252918833e-12
EarlyStopping counter: 21 out of 100
Updating learning rate to 4.5985816264594165e-12
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.2992908132297083e-12
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.1496454066148541e-12
EarlyStopping counter: 24 out of 100
Updating learning rate to 5.748227033074271e-13
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.8741135165371353e-13
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.4370567582685677e-13
EarlyStopping counter: 27 out of 100
Updating learning rate to 7.185283791342838e-14
EarlyStopping counter: 28 out of 100
Updating learning rate to 3.592641895671419e-14
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.7963209478357096e-14
EarlyStopping counter: 30 out of 100
Updating learning rate to 8.981604739178548e-15
EarlyStopping counter: 31 out of 100
Updating learning rate to 4.490802369589274e-15
EarlyStopping counter: 32 out of 100
Updating learning rate to 2.245401184794637e-15
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.1227005923973185e-15
EarlyStopping counter: 34 out of 100
Updating learning rate to 5.613502961986592e-16
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.806751480993296e-16
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.403375740496648e-16
EarlyStopping counter: 37 out of 100
Updating learning rate to 7.01687870248324e-17
EarlyStopping counter: 38 out of 100
Updating learning rate to 3.50843935124162e-17
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.75421967562081e-17
EarlyStopping counter: 40 out of 100
Updating learning rate to 8.77109837810405e-18
EarlyStopping counter: 41 out of 100
Updating learning rate to 4.385549189052025e-18
EarlyStopping counter: 42 out of 100
Updating learning rate to 2.1927745945260127e-18
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.0963872972630063e-18
EarlyStopping counter: 44 out of 100
Updating learning rate to 5.481936486315032e-19
EarlyStopping counter: 45 out of 100
Updating learning rate to 2.740968243157516e-19
Validation loss decreased (0.026085 --> 0.026018).  Saving model ...
Updating learning rate to 1.370484121578758e-19
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.85242060789379e-20
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.426210303946895e-20
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.7131051519734474e-20
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.565525759867237e-21
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.2827628799336185e-21
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.1413814399668092e-21
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.0706907199834046e-21
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.353453599917023e-22
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.6767267999585116e-22
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.3383633999792558e-22
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.691816999896279e-23
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.3459084999481394e-23
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.6729542499740697e-23
EarlyStopping counter: 14 out of 100
Updating learning rate to 8.364771249870349e-24
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.182385624935174e-24
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.091192812467587e-24
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.0455964062337936e-24
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.227982031168968e-25
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.613991015584484e-25
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.306995507792242e-25
EarlyStopping counter: 21 out of 100
Updating learning rate to 6.53497753896121e-26
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.267488769480605e-26
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.6337443847403025e-26
EarlyStopping counter: 24 out of 100
Updating learning rate to 8.168721923701512e-27
EarlyStopping counter: 25 out of 100
Updating learning rate to 4.084360961850756e-27
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.042180480925378e-27
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.021090240462689e-27
EarlyStopping counter: 28 out of 100
Updating learning rate to 5.105451202313445e-28
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.5527256011567226e-28
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.2763628005783613e-28
EarlyStopping counter: 31 out of 100
Updating learning rate to 6.381814002891806e-29
EarlyStopping counter: 32 out of 100
Updating learning rate to 3.190907001445903e-29
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.5954535007229516e-29
EarlyStopping counter: 34 out of 100
Updating learning rate to 7.977267503614758e-30
EarlyStopping counter: 35 out of 100
Updating learning rate to 3.988633751807379e-30
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.9943168759036895e-30
EarlyStopping counter: 37 out of 100
Updating learning rate to 9.971584379518448e-31
EarlyStopping counter: 38 out of 100
Updating learning rate to 4.985792189759224e-31
EarlyStopping counter: 39 out of 100
Updating learning rate to 2.492896094879612e-31
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.246448047439806e-31
EarlyStopping counter: 41 out of 100
Updating learning rate to 6.23224023719903e-32
EarlyStopping counter: 42 out of 100
Updating learning rate to 3.116120118599515e-32
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.5580600592997574e-32
EarlyStopping counter: 44 out of 100
Updating learning rate to 7.790300296498787e-33
EarlyStopping counter: 45 out of 100
Updating learning rate to 3.8951501482493936e-33
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.9475750741246968e-33
EarlyStopping counter: 47 out of 100
Updating learning rate to 9.737875370623484e-34
EarlyStopping counter: 48 out of 100
Updating learning rate to 4.868937685311742e-34
>>>>>> Testing on validation set: trial_13 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.0522998608648777, mae:0.0776662677526474, dtw:Not calculated


                                                                                        [I 2025-10-17 04:32:49,078] Trial 13 finished with value: 0.0776662677526474 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 1, 'd_model': 32, 'n_heads': 8, 'e_layers': 1, 'd_layers': 1, 'batch_size': 16, 'learning_rate': 0.0003086055889629638, 'dropout': 0.24988643088358137}. Best is trial 5 with value: 0.07396138459444046.
Best trial: 5. Best value: 0.0739614:  26%|██▌       | 13/50 [40:45<1:36:09, 155.94s/it]Best trial: 5. Best value: 0.0739614:  26%|██▌       | 13/50 [40:45<1:36:09, 155.94s/it]Best trial: 5. Best value: 0.0739614:  28%|██▊       | 14/50 [40:45<1:52:51, 188.11s/it]
============================================================
Trial 14
============================================================
seq_len: 48, pred_len: 1
d_model: 32, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000532
dropout: 0.12330306995219142
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 32, expand: 1
>>>>>> Start training: trial_14 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.029638).  Saving model ...
Updating learning rate to 0.0005324511923528652
Validation loss decreased (0.029638 --> 0.026404).  Saving model ...
Updating learning rate to 0.0002662255961764326
Validation loss decreased (0.026404 --> 0.025431).  Saving model ...
Updating learning rate to 0.0001331127980882163
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.655639904410815e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.327819952205407e-05
Validation loss decreased (0.025431 --> 0.024903).  Saving model ...
Updating learning rate to 1.6639099761027036e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.319549880513518e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.159774940256759e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0798874701283795e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0399437350641898e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.199718675320949e-07
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.5998593376604744e-07
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.2999296688302372e-07
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.499648344151186e-08
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.249824172075593e-08
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.6249120860377965e-08
EarlyStopping counter: 11 out of 100
Updating learning rate to 8.124560430188983e-09
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.062280215094491e-09
Validation loss decreased (0.024903 --> 0.024070).  Saving model ...
Updating learning rate to 2.0311401075472457e-09
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0155700537736228e-09
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.077850268868114e-10
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.538925134434057e-10
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2694625672170285e-10
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.347312836085143e-11
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.1736564180425713e-11
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.5868282090212857e-11
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.934141045106428e-12
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.967070522553214e-12
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.983535261276607e-12
EarlyStopping counter: 11 out of 100
Updating learning rate to 9.917676306383035e-13
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.958838153191518e-13
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.479419076595759e-13
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.2397095382978794e-13
EarlyStopping counter: 15 out of 100
Updating learning rate to 6.198547691489397e-14
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.0992738457446986e-14
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.5496369228723493e-14
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.748184614361746e-15
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.874092307180873e-15
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.9370461535904366e-15
EarlyStopping counter: 21 out of 100
Updating learning rate to 9.685230767952183e-16
EarlyStopping counter: 22 out of 100
Updating learning rate to 4.842615383976092e-16
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.421307691988046e-16
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.210653845994023e-16
EarlyStopping counter: 25 out of 100
Updating learning rate to 6.053269229970114e-17
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.026634614985057e-17
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.5133173074925286e-17
EarlyStopping counter: 28 out of 100
Updating learning rate to 7.566586537462643e-18
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.7832932687313215e-18
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.8916466343656607e-18
EarlyStopping counter: 31 out of 100
Updating learning rate to 9.458233171828304e-19
EarlyStopping counter: 32 out of 100
Updating learning rate to 4.729116585914152e-19
EarlyStopping counter: 33 out of 100
Updating learning rate to 2.364558292957076e-19
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.182279146478538e-19
EarlyStopping counter: 35 out of 100
Updating learning rate to 5.91139573239269e-20
EarlyStopping counter: 36 out of 100
Updating learning rate to 2.955697866196345e-20
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.4778489330981725e-20
EarlyStopping counter: 38 out of 100
Updating learning rate to 7.389244665490862e-21
EarlyStopping counter: 39 out of 100
Updating learning rate to 3.694622332745431e-21
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.8473111663727156e-21
EarlyStopping counter: 41 out of 100
Updating learning rate to 9.236555831863578e-22
EarlyStopping counter: 42 out of 100
Updating learning rate to 4.618277915931789e-22
EarlyStopping counter: 43 out of 100
Updating learning rate to 2.3091389579658945e-22
EarlyStopping counter: 44 out of 100
Updating learning rate to 1.1545694789829472e-22
EarlyStopping counter: 45 out of 100
Updating learning rate to 5.772847394914736e-23
EarlyStopping counter: 46 out of 100
Updating learning rate to 2.886423697457368e-23
EarlyStopping counter: 47 out of 100
Updating learning rate to 1.443211848728684e-23
EarlyStopping counter: 48 out of 100
Updating learning rate to 7.21605924364342e-24
EarlyStopping counter: 49 out of 100
Updating learning rate to 3.60802962182171e-24
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.804014810910855e-24
EarlyStopping counter: 51 out of 100
Updating learning rate to 9.020074054554275e-25
EarlyStopping counter: 52 out of 100
Updating learning rate to 4.510037027277138e-25
EarlyStopping counter: 53 out of 100
Updating learning rate to 2.255018513638569e-25
EarlyStopping counter: 54 out of 100
Updating learning rate to 1.1275092568192844e-25
EarlyStopping counter: 55 out of 100
Updating learning rate to 5.637546284096422e-26
EarlyStopping counter: 56 out of 100
Updating learning rate to 2.818773142048211e-26
EarlyStopping counter: 57 out of 100
Updating learning rate to 1.4093865710241055e-26
EarlyStopping counter: 58 out of 100
Updating learning rate to 7.046932855120528e-27
EarlyStopping counter: 59 out of 100
Updating learning rate to 3.523466427560264e-27
Validation loss decreased (0.024070 --> 0.024032).  Saving model ...
Updating learning rate to 1.761733213780132e-27
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.80866606890066e-28
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.40433303445033e-28
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.202166517225165e-28
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1010832586125824e-28
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.505416293062912e-29
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.752708146531456e-29
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.376354073265728e-29
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.88177036632864e-30
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.44088518316432e-30
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.72044259158216e-30
EarlyStopping counter: 11 out of 100
Updating learning rate to 8.6022129579108e-31
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.3011064789554e-31
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.1505532394777e-31
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.07527661973885e-31
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.37638309869425e-32
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.688191549347125e-32
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.3440957746735625e-32
EarlyStopping counter: 18 out of 100
Updating learning rate to 6.720478873367813e-33
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.360239436683906e-33
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.680119718341953e-33
EarlyStopping counter: 21 out of 100
Updating learning rate to 8.400598591709766e-34
>>>>>> Testing on validation set: trial_14 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.05038214847445488, mae:0.07446379959583282, dtw:Not calculated


                                                                                        [I 2025-10-17 04:35:02,372] Trial 14 finished with value: 0.07446379959583282 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 1, 'd_model': 32, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0005324511923528652, 'dropout': 0.12330306995219142}. Best is trial 5 with value: 0.07396138459444046.
Best trial: 5. Best value: 0.0739614:  28%|██▊       | 14/50 [42:58<1:52:51, 188.11s/it]Best trial: 5. Best value: 0.0739614:  28%|██▊       | 14/50 [42:58<1:52:51, 188.11s/it]Best trial: 5. Best value: 0.0739614:  30%|███       | 15/50 [42:58<1:40:05, 171.58s/it]
============================================================
Trial 15
============================================================
seq_len: 48, pred_len: 1
d_model: 32, n_heads: 4
e_layers: 2, d_layers: 1
batch_size: 16, lr: 0.000195
dropout: 0.09290591879812045
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 64, expand: 2
>>>>>> Start training: trial_15 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.030116).  Saving model ...
Updating learning rate to 0.00019463629973069335
Validation loss decreased (0.030116 --> 0.026815).  Saving model ...
Updating learning rate to 9.731814986534667e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.865907493267334e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.432953746633667e-05
Validation loss decreased (0.026815 --> 0.026518).  Saving model ...
Updating learning rate to 1.2164768733168334e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.082384366584167e-06
Validation loss decreased (0.026518 --> 0.026480).  Saving model ...
Updating learning rate to 3.0411921832920836e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5205960916460418e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.602980458230209e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.8014902291151044e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.9007451145575522e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.503725572787761e-08
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.7518627863938805e-08
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.3759313931969403e-08
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.1879656965984701e-08
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.939828482992351e-09
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.9699142414961753e-09
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.4849571207480877e-09
Validation loss decreased (0.026480 --> 0.026365).  Saving model ...
Updating learning rate to 7.424785603740438e-10
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.712392801870219e-10
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8561964009351096e-10
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.280982004675548e-11
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.640491002337774e-11
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.320245501168887e-11
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1601227505844435e-11
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.8006137529222175e-12
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.9003068764611087e-12
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4501534382305544e-12
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.250767191152772e-13
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.625383595576386e-13
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.812691797788193e-13
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.063458988940965e-14
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.5317294944704824e-14
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.2658647472352412e-14
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.1329323736176206e-14
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.664661868088103e-15
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.8323309340440515e-15
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.4161654670220257e-15
EarlyStopping counter: 20 out of 100
Updating learning rate to 7.080827335110129e-16
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.5404136675550644e-16
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.7702068337775322e-16
Validation loss decreased (0.026365 --> 0.026358).  Saving model ...
Updating learning rate to 8.851034168887661e-17
Validation loss decreased (0.026358 --> 0.026356).  Saving model ...
Updating learning rate to 4.4255170844438305e-17
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2127585422219152e-17
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1063792711109576e-17
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.531896355554788e-18
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.765948177777394e-18
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.382974088888697e-18
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.914870444443485e-19
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.4574352222217425e-19
Validation loss decreased (0.026356 --> 0.026273).  Saving model ...
Updating learning rate to 1.7287176111108713e-19
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.643588055554356e-20
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.321794027777178e-20
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.160897013888589e-20
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0804485069442945e-20
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.402242534721473e-21
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7011212673607364e-21
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3505606336803682e-21
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.752803168401841e-22
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.3764015842009205e-22
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.6882007921004602e-22
EarlyStopping counter: 11 out of 100
Updating learning rate to 8.441003960502301e-23
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.2205019802511506e-23
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.1102509901255753e-23
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.0551254950627876e-23
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.275627475313938e-24
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.637813737656969e-24
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.3189068688284846e-24
EarlyStopping counter: 18 out of 100
Updating learning rate to 6.594534344142423e-25
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.2972671720712114e-25
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.6486335860356057e-25
EarlyStopping counter: 21 out of 100
Updating learning rate to 8.243167930178028e-26
EarlyStopping counter: 22 out of 100
Updating learning rate to 4.121583965089014e-26
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.060791982544507e-26
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.0303959912722536e-26
EarlyStopping counter: 25 out of 100
Updating learning rate to 5.151979956361268e-27
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.575989978180634e-27
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.287994989090317e-27
EarlyStopping counter: 28 out of 100
Updating learning rate to 6.439974945451585e-28
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.2199874727257924e-28
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.6099937363628962e-28
EarlyStopping counter: 31 out of 100
Updating learning rate to 8.049968681814481e-29
Validation loss decreased (0.026273 --> 0.026273).  Saving model ...
Updating learning rate to 4.0249843409072405e-29
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0124921704536202e-29
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0062460852268101e-29
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.0312304261340506e-30
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.5156152130670253e-30
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2578076065335126e-30
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.289038032667563e-31
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.1445190163337816e-31
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.5722595081668908e-31
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.861297540834454e-32
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.930648770417227e-32
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.9653243852086135e-32
Validation loss decreased (0.026273 --> 0.026262).  Saving model ...
Updating learning rate to 9.826621926043068e-33
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.913310963021534e-33
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.456655481510767e-33
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2283277407553834e-33
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.141638703776917e-34
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.0708193518884586e-34
>>>>>> Testing on validation set: trial_15 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.05106141418218613, mae:0.07671661674976349, dtw:Not calculated


                                                                                        [I 2025-10-17 04:39:25,258] Trial 15 finished with value: 0.07671661674976349 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 2, 'd_model': 32, 'n_heads': 4, 'e_layers': 2, 'd_layers': 1, 'batch_size': 16, 'learning_rate': 0.00019463629973069335, 'dropout': 0.09290591879812045}. Best is trial 5 with value: 0.07396138459444046.
Best trial: 5. Best value: 0.0739614:  30%|███       | 15/50 [47:21<1:40:05, 171.58s/it]Best trial: 5. Best value: 0.0739614:  30%|███       | 15/50 [47:21<1:40:05, 171.58s/it]Best trial: 5. Best value: 0.0739614:  32%|███▏      | 16/50 [47:21<1:52:48, 199.07s/it]
============================================================
Trial 16
============================================================
seq_len: 48, pred_len: 7
d_model: 32, n_heads: 8
e_layers: 1, d_layers: 1
batch_size: 32, lr: 0.000532
dropout: 0.15629021381733638
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 32, expand: 1
>>>>>> Start training: trial_16 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 7
============================================================
train 4619
val 253
test 255
Validation loss decreased (inf --> 0.038850).  Saving model ...
Updating learning rate to 0.0005316886987671559
Validation loss decreased (0.038850 --> 0.036522).  Saving model ...
Updating learning rate to 0.00026584434938357795
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00013292217469178897
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.646108734589449e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.3230543672947243e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6615271836473622e-05
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.307635918236811e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.1538179591184054e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.0769089795592027e-06
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.0384544897796014e-06
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.192272448898007e-07
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.5961362244490034e-07
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.2980681122245017e-07
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.490340561122508e-08
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.245170280561254e-08
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.622585140280627e-08
EarlyStopping counter: 15 out of 100
Updating learning rate to 8.112925701403136e-09
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.056462850701568e-09
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.028231425350784e-09
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.014115712675392e-09
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.07057856337696e-10
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.53528928168848e-10
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.26764464084424e-10
EarlyStopping counter: 22 out of 100
Updating learning rate to 6.3382232042212e-11
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.1691116021106e-11
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.5845558010553e-11
EarlyStopping counter: 25 out of 100
Updating learning rate to 7.9227790052765e-12
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.96138950263825e-12
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.980694751319125e-12
EarlyStopping counter: 28 out of 100
Updating learning rate to 9.903473756595625e-13
EarlyStopping counter: 29 out of 100
Updating learning rate to 4.951736878297812e-13
EarlyStopping counter: 30 out of 100
Updating learning rate to 2.475868439148906e-13
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.237934219574453e-13
EarlyStopping counter: 32 out of 100
Updating learning rate to 6.189671097872265e-14
EarlyStopping counter: 33 out of 100
Updating learning rate to 3.0948355489361327e-14
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.5474177744680663e-14
EarlyStopping counter: 35 out of 100
Updating learning rate to 7.737088872340332e-15
EarlyStopping counter: 36 out of 100
Updating learning rate to 3.868544436170166e-15
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.934272218085083e-15
EarlyStopping counter: 38 out of 100
Updating learning rate to 9.671361090425415e-16
EarlyStopping counter: 39 out of 100
Updating learning rate to 4.835680545212707e-16
EarlyStopping counter: 40 out of 100
Updating learning rate to 2.4178402726063536e-16
EarlyStopping counter: 41 out of 100
Updating learning rate to 1.2089201363031768e-16
EarlyStopping counter: 42 out of 100
Updating learning rate to 6.044600681515884e-17
EarlyStopping counter: 43 out of 100
Updating learning rate to 3.022300340757942e-17
EarlyStopping counter: 44 out of 100
Updating learning rate to 1.511150170378971e-17
EarlyStopping counter: 45 out of 100
Updating learning rate to 7.555750851894855e-18
EarlyStopping counter: 46 out of 100
Updating learning rate to 3.7778754259474276e-18
EarlyStopping counter: 47 out of 100
Updating learning rate to 1.8889377129737138e-18
EarlyStopping counter: 48 out of 100
Updating learning rate to 9.444688564868569e-19
EarlyStopping counter: 49 out of 100
Updating learning rate to 4.722344282434284e-19
EarlyStopping counter: 50 out of 100
Updating learning rate to 2.361172141217142e-19
EarlyStopping counter: 51 out of 100
Updating learning rate to 1.180586070608571e-19
EarlyStopping counter: 52 out of 100
Updating learning rate to 5.902930353042856e-20
EarlyStopping counter: 53 out of 100
Updating learning rate to 2.951465176521428e-20
EarlyStopping counter: 54 out of 100
Updating learning rate to 1.475732588260714e-20
EarlyStopping counter: 55 out of 100
Updating learning rate to 7.37866294130357e-21
EarlyStopping counter: 56 out of 100
Updating learning rate to 3.689331470651785e-21
EarlyStopping counter: 57 out of 100
Updating learning rate to 1.8446657353258924e-21
EarlyStopping counter: 58 out of 100
Updating learning rate to 9.223328676629462e-22
EarlyStopping counter: 59 out of 100
Updating learning rate to 4.611664338314731e-22
EarlyStopping counter: 60 out of 100
Updating learning rate to 2.3058321691573655e-22
EarlyStopping counter: 61 out of 100
Updating learning rate to 1.1529160845786827e-22
EarlyStopping counter: 62 out of 100
Updating learning rate to 5.764580422893414e-23
EarlyStopping counter: 63 out of 100
Updating learning rate to 2.882290211446707e-23
EarlyStopping counter: 64 out of 100
Updating learning rate to 1.4411451057233534e-23
EarlyStopping counter: 65 out of 100
Updating learning rate to 7.205725528616767e-24
EarlyStopping counter: 66 out of 100
Updating learning rate to 3.6028627643083835e-24
EarlyStopping counter: 67 out of 100
Updating learning rate to 1.8014313821541918e-24
EarlyStopping counter: 68 out of 100
Updating learning rate to 9.007156910770959e-25
EarlyStopping counter: 69 out of 100
Updating learning rate to 4.503578455385479e-25
EarlyStopping counter: 70 out of 100
Updating learning rate to 2.2517892276927397e-25
EarlyStopping counter: 71 out of 100
Updating learning rate to 1.1258946138463699e-25
EarlyStopping counter: 72 out of 100
Updating learning rate to 5.629473069231849e-26
EarlyStopping counter: 73 out of 100
Updating learning rate to 2.8147365346159246e-26
EarlyStopping counter: 74 out of 100
Updating learning rate to 1.4073682673079623e-26
EarlyStopping counter: 75 out of 100
Updating learning rate to 7.036841336539812e-27
EarlyStopping counter: 76 out of 100
Updating learning rate to 3.518420668269906e-27
EarlyStopping counter: 77 out of 100
Updating learning rate to 1.759210334134953e-27
EarlyStopping counter: 78 out of 100
Updating learning rate to 8.796051670674764e-28
EarlyStopping counter: 79 out of 100
Updating learning rate to 4.398025835337382e-28
EarlyStopping counter: 80 out of 100
Updating learning rate to 2.199012917668691e-28
EarlyStopping counter: 81 out of 100
Updating learning rate to 1.0995064588343456e-28
EarlyStopping counter: 82 out of 100
Updating learning rate to 5.497532294171728e-29
EarlyStopping counter: 83 out of 100
Updating learning rate to 2.748766147085864e-29
EarlyStopping counter: 84 out of 100
Updating learning rate to 1.374383073542932e-29
EarlyStopping counter: 85 out of 100
Updating learning rate to 6.87191536771466e-30
EarlyStopping counter: 86 out of 100
Updating learning rate to 3.43595768385733e-30
EarlyStopping counter: 87 out of 100
Updating learning rate to 1.717978841928665e-30
EarlyStopping counter: 88 out of 100
Updating learning rate to 8.589894209643325e-31
EarlyStopping counter: 89 out of 100
Updating learning rate to 4.294947104821662e-31
EarlyStopping counter: 90 out of 100
Updating learning rate to 2.147473552410831e-31
EarlyStopping counter: 91 out of 100
Updating learning rate to 1.0737367762054156e-31
EarlyStopping counter: 92 out of 100
Updating learning rate to 5.368683881027078e-32
EarlyStopping counter: 93 out of 100
Updating learning rate to 2.684341940513539e-32
EarlyStopping counter: 94 out of 100
Updating learning rate to 1.3421709702567695e-32
EarlyStopping counter: 95 out of 100
Updating learning rate to 6.710854851283847e-33
EarlyStopping counter: 96 out of 100
Updating learning rate to 3.355427425641924e-33
EarlyStopping counter: 97 out of 100
Updating learning rate to 1.677713712820962e-33
EarlyStopping counter: 98 out of 100
Updating learning rate to 8.38856856410481e-34
>>>>>> Testing on validation set: trial_16 >>>>>>
test 255
test shape: (255, 7, 5) (255, 7, 5)
test shape: (255, 7, 5) (255, 7, 5)


	mse:0.0674552172422409, mae:0.09754927456378937, dtw:Not calculated


                                                                                        [I 2025-10-17 04:41:38,474] Trial 16 finished with value: 0.09754927456378937 and parameters: {'seq_len': 48, 'pred_len': 7, 'expand': 1, 'd_model': 32, 'n_heads': 8, 'e_layers': 1, 'd_layers': 1, 'batch_size': 32, 'learning_rate': 0.0005316886987671559, 'dropout': 0.15629021381733638}. Best is trial 5 with value: 0.07396138459444046.
Best trial: 5. Best value: 0.0739614:  32%|███▏      | 16/50 [49:34<1:52:48, 199.07s/it]Best trial: 5. Best value: 0.0739614:  32%|███▏      | 16/50 [49:34<1:52:48, 199.07s/it]Best trial: 5. Best value: 0.0739614:  34%|███▍      | 17/50 [49:34<1:38:35, 179.26s/it]
============================================================
Trial 17
============================================================
seq_len: 48, pred_len: 14
d_model: 32, n_heads: 8
e_layers: 2, d_layers: 2
batch_size: 32, lr: 0.000211
dropout: 0.22419019389833159
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 64, expand: 2
>>>>>> Start training: trial_17 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 14
============================================================
train 4612
val 246
test 248
Validation loss decreased (inf --> 0.038827).  Saving model ...
Updating learning rate to 0.0002105272523751562
Validation loss decreased (0.038827 --> 0.038556).  Saving model ...
Updating learning rate to 0.0001052636261875781
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.263181309378905e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.6315906546894527e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3157953273447263e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.578976636723632e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.289488318361816e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.644744159180908e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.22372079590454e-07
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.11186039795227e-07
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.055930198976135e-07
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.0279650994880674e-07
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.139825497440337e-08
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.5699127487201686e-08
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.2849563743600843e-08
EarlyStopping counter: 14 out of 100
Updating learning rate to 6.4247818718004215e-09
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.2123909359002108e-09
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.6061954679501054e-09
EarlyStopping counter: 17 out of 100
Updating learning rate to 8.030977339750527e-10
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.0154886698752635e-10
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.0077443349376317e-10
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.0038721674688159e-10
EarlyStopping counter: 21 out of 100
Updating learning rate to 5.0193608373440793e-11
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.5096804186720397e-11
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.2548402093360198e-11
EarlyStopping counter: 24 out of 100
Updating learning rate to 6.274201046680099e-12
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.1371005233400496e-12
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.5685502616700248e-12
EarlyStopping counter: 27 out of 100
Updating learning rate to 7.842751308350124e-13
EarlyStopping counter: 28 out of 100
Updating learning rate to 3.921375654175062e-13
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.960687827087531e-13
EarlyStopping counter: 30 out of 100
Updating learning rate to 9.803439135437655e-14
EarlyStopping counter: 31 out of 100
Updating learning rate to 4.9017195677188275e-14
EarlyStopping counter: 32 out of 100
Updating learning rate to 2.4508597838594137e-14
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.2254298919297069e-14
EarlyStopping counter: 34 out of 100
Updating learning rate to 6.127149459648534e-15
EarlyStopping counter: 35 out of 100
Updating learning rate to 3.063574729824267e-15
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.5317873649121336e-15
EarlyStopping counter: 37 out of 100
Updating learning rate to 7.658936824560668e-16
EarlyStopping counter: 38 out of 100
Updating learning rate to 3.829468412280334e-16
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.914734206140167e-16
EarlyStopping counter: 40 out of 100
Updating learning rate to 9.573671030700835e-17
EarlyStopping counter: 41 out of 100
Updating learning rate to 4.7868355153504175e-17
EarlyStopping counter: 42 out of 100
Updating learning rate to 2.3934177576752087e-17
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.1967088788376044e-17
EarlyStopping counter: 44 out of 100
Updating learning rate to 5.983544394188022e-18
EarlyStopping counter: 45 out of 100
Updating learning rate to 2.991772197094011e-18
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.4958860985470055e-18
EarlyStopping counter: 47 out of 100
Updating learning rate to 7.479430492735027e-19
EarlyStopping counter: 48 out of 100
Updating learning rate to 3.7397152463675136e-19
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.8698576231837568e-19
EarlyStopping counter: 50 out of 100
Updating learning rate to 9.349288115918784e-20
EarlyStopping counter: 51 out of 100
Updating learning rate to 4.674644057959392e-20
EarlyStopping counter: 52 out of 100
Updating learning rate to 2.337322028979696e-20
EarlyStopping counter: 53 out of 100
Updating learning rate to 1.168661014489848e-20
EarlyStopping counter: 54 out of 100
Updating learning rate to 5.84330507244924e-21
EarlyStopping counter: 55 out of 100
Updating learning rate to 2.92165253622462e-21
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.46082626811231e-21
EarlyStopping counter: 57 out of 100
Updating learning rate to 7.30413134056155e-22
EarlyStopping counter: 58 out of 100
Updating learning rate to 3.652065670280775e-22
EarlyStopping counter: 59 out of 100
Updating learning rate to 1.8260328351403875e-22
EarlyStopping counter: 60 out of 100
Updating learning rate to 9.130164175701938e-23
EarlyStopping counter: 61 out of 100
Updating learning rate to 4.565082087850969e-23
EarlyStopping counter: 62 out of 100
Updating learning rate to 2.2825410439254844e-23
EarlyStopping counter: 63 out of 100
Updating learning rate to 1.1412705219627422e-23
EarlyStopping counter: 64 out of 100
Updating learning rate to 5.706352609813711e-24
EarlyStopping counter: 65 out of 100
Updating learning rate to 2.8531763049068555e-24
EarlyStopping counter: 66 out of 100
Updating learning rate to 1.4265881524534277e-24
EarlyStopping counter: 67 out of 100
Updating learning rate to 7.132940762267139e-25
EarlyStopping counter: 68 out of 100
Updating learning rate to 3.5664703811335694e-25
EarlyStopping counter: 69 out of 100
Updating learning rate to 1.7832351905667847e-25
EarlyStopping counter: 70 out of 100
Updating learning rate to 8.916175952833923e-26
EarlyStopping counter: 71 out of 100
Updating learning rate to 4.4580879764169617e-26
EarlyStopping counter: 72 out of 100
Updating learning rate to 2.2290439882084809e-26
EarlyStopping counter: 73 out of 100
Updating learning rate to 1.1145219941042404e-26
EarlyStopping counter: 74 out of 100
Updating learning rate to 5.572609970521202e-27
EarlyStopping counter: 75 out of 100
Updating learning rate to 2.786304985260601e-27
EarlyStopping counter: 76 out of 100
Updating learning rate to 1.3931524926303005e-27
EarlyStopping counter: 77 out of 100
Updating learning rate to 6.965762463151503e-28
EarlyStopping counter: 78 out of 100
Updating learning rate to 3.4828812315757513e-28
EarlyStopping counter: 79 out of 100
Updating learning rate to 1.7414406157878757e-28
EarlyStopping counter: 80 out of 100
Updating learning rate to 8.707203078939378e-29
EarlyStopping counter: 81 out of 100
Updating learning rate to 4.353601539469689e-29
EarlyStopping counter: 82 out of 100
Updating learning rate to 2.1768007697348446e-29
EarlyStopping counter: 83 out of 100
Updating learning rate to 1.0884003848674223e-29
EarlyStopping counter: 84 out of 100
Updating learning rate to 5.4420019243371115e-30
EarlyStopping counter: 85 out of 100
Updating learning rate to 2.7210009621685557e-30
EarlyStopping counter: 86 out of 100
Updating learning rate to 1.3605004810842779e-30
EarlyStopping counter: 87 out of 100
Updating learning rate to 6.802502405421389e-31
EarlyStopping counter: 88 out of 100
Updating learning rate to 3.4012512027106947e-31
EarlyStopping counter: 89 out of 100
Updating learning rate to 1.7006256013553473e-31
EarlyStopping counter: 90 out of 100
Updating learning rate to 8.503128006776737e-32
EarlyStopping counter: 91 out of 100
Updating learning rate to 4.2515640033883683e-32
EarlyStopping counter: 92 out of 100
Updating learning rate to 2.1257820016941842e-32
EarlyStopping counter: 93 out of 100
Updating learning rate to 1.0628910008470921e-32
EarlyStopping counter: 94 out of 100
Updating learning rate to 5.3144550042354604e-33
EarlyStopping counter: 95 out of 100
Updating learning rate to 2.6572275021177302e-33
EarlyStopping counter: 96 out of 100
Updating learning rate to 1.3286137510588651e-33
EarlyStopping counter: 97 out of 100
Updating learning rate to 6.6430687552943255e-34
EarlyStopping counter: 98 out of 100
Updating learning rate to 3.3215343776471628e-34
>>>>>> Testing on validation set: trial_17 >>>>>>
test 248
test shape: (248, 14, 5) (248, 14, 5)
test shape: (248, 14, 5) (248, 14, 5)


	mse:0.06506979465484619, mae:0.09948411583900452, dtw:Not calculated


                                                                                        [I 2025-10-17 04:43:51,706] Trial 17 finished with value: 0.09948411583900452 and parameters: {'seq_len': 48, 'pred_len': 14, 'expand': 2, 'd_model': 32, 'n_heads': 8, 'e_layers': 2, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0002105272523751562, 'dropout': 0.22419019389833159}. Best is trial 5 with value: 0.07396138459444046.
Best trial: 5. Best value: 0.0739614:  34%|███▍      | 17/50 [51:47<1:38:35, 179.26s/it]Best trial: 5. Best value: 0.0739614:  34%|███▍      | 17/50 [51:47<1:38:35, 179.26s/it]Best trial: 5. Best value: 0.0739614:  36%|███▌      | 18/50 [51:47<1:28:13, 165.43s/it]
============================================================
Trial 18
============================================================
seq_len: 96, pred_len: 30
d_model: 32, n_heads: 4
e_layers: 1, d_layers: 1
batch_size: 16, lr: 0.000092
dropout: 0.12616251923421157
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 32, expand: 1
>>>>>> Start training: trial_18 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 30
============================================================
train 4548
val 230
test 232
Validation loss decreased (inf --> 0.037804).  Saving model ...
Updating learning rate to 9.196605786187385e-05
Validation loss decreased (0.037804 --> 0.036806).  Saving model ...
Updating learning rate to 4.598302893093693e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2991514465468464e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1495757232734232e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.747878616367116e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.873939308183558e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.436969654091779e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.184848270458895e-07
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.5924241352294475e-07
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.7962120676147237e-07
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.981060338073619e-08
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.490530169036809e-08
Validation loss decreased (0.036806 --> 0.036461).  Saving model ...
Updating learning rate to 2.2452650845184047e-08
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1226325422592023e-08
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.613162711296012e-09
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.806581355648006e-09
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.403290677824003e-09
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.016453389120015e-10
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.5082266945600073e-10
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.7541133472800036e-10
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.770566736400018e-11
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.385283368200009e-11
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.1926416841000046e-11
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.0963208420500023e-11
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.481604210250011e-12
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.7408021051250057e-12
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.3704010525625028e-12
EarlyStopping counter: 15 out of 100
Updating learning rate to 6.852005262812514e-13
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.426002631406257e-13
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.7130013157031286e-13
EarlyStopping counter: 18 out of 100
Updating learning rate to 8.565006578515643e-14
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.2825032892578214e-14
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.1412516446289107e-14
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.0706258223144553e-14
EarlyStopping counter: 22 out of 100
Updating learning rate to 5.353129111572277e-15
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.6765645557861384e-15
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.3382822778930692e-15
EarlyStopping counter: 25 out of 100
Updating learning rate to 6.691411389465346e-16
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.345705694732673e-16
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.6728528473663365e-16
EarlyStopping counter: 28 out of 100
Updating learning rate to 8.364264236831682e-17
EarlyStopping counter: 29 out of 100
Updating learning rate to 4.182132118415841e-17
EarlyStopping counter: 30 out of 100
Updating learning rate to 2.0910660592079206e-17
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.0455330296039603e-17
EarlyStopping counter: 32 out of 100
Updating learning rate to 5.2276651480198015e-18
EarlyStopping counter: 33 out of 100
Updating learning rate to 2.6138325740099007e-18
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.3069162870049504e-18
EarlyStopping counter: 35 out of 100
Updating learning rate to 6.534581435024752e-19
EarlyStopping counter: 36 out of 100
Updating learning rate to 3.267290717512376e-19
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.633645358756188e-19
EarlyStopping counter: 38 out of 100
Updating learning rate to 8.16822679378094e-20
EarlyStopping counter: 39 out of 100
Updating learning rate to 4.08411339689047e-20
EarlyStopping counter: 40 out of 100
Updating learning rate to 2.042056698445235e-20
EarlyStopping counter: 41 out of 100
Updating learning rate to 1.0210283492226175e-20
EarlyStopping counter: 42 out of 100
Updating learning rate to 5.1051417461130874e-21
EarlyStopping counter: 43 out of 100
Updating learning rate to 2.5525708730565437e-21
EarlyStopping counter: 44 out of 100
Updating learning rate to 1.2762854365282719e-21
EarlyStopping counter: 45 out of 100
Updating learning rate to 6.381427182641359e-22
EarlyStopping counter: 46 out of 100
Updating learning rate to 3.1907135913206796e-22
EarlyStopping counter: 47 out of 100
Updating learning rate to 1.5953567956603398e-22
EarlyStopping counter: 48 out of 100
Updating learning rate to 7.976783978301699e-23
Validation loss decreased (0.036461 --> 0.036365).  Saving model ...
Updating learning rate to 3.9883919891508495e-23
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.9941959945754248e-23
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.970979972877124e-24
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.985489986438562e-24
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.492744993219281e-24
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2463724966096405e-24
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.231862483048202e-25
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.115931241524101e-25
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.5579656207620506e-25
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.789828103810253e-26
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.8949140519051265e-26
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.9474570259525632e-26
EarlyStopping counter: 12 out of 100
Updating learning rate to 9.737285129762816e-27
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.868642564881408e-27
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.434321282440704e-27
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.217160641220352e-27
EarlyStopping counter: 16 out of 100
Updating learning rate to 6.08580320610176e-28
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.04290160305088e-28
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.52145080152544e-28
EarlyStopping counter: 19 out of 100
Updating learning rate to 7.6072540076272e-29
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.8036270038136e-29
Validation loss decreased (0.036365 --> 0.036261).  Saving model ...
Updating learning rate to 1.9018135019068e-29
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.509067509534e-30
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.754533754767e-30
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.3772668773835e-30
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.18863343869175e-30
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.94316719345875e-31
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.971583596729375e-31
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4857917983646875e-31
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.428958991823438e-32
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.714479495911719e-32
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.8572397479558594e-32
EarlyStopping counter: 11 out of 100
Updating learning rate to 9.286198739779297e-33
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.6430993698896486e-33
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.3215496849448243e-33
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.1607748424724121e-33
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.803874212362061e-34
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.9019371061810303e-34
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.4509685530905152e-34
>>>>>> Testing on validation set: trial_18 >>>>>>
test 232
test shape: (232, 30, 5) (232, 30, 5)
test shape: (232, 30, 5) (232, 30, 5)


	mse:0.07247068732976913, mae:0.11756177246570587, dtw:Not calculated


                                                                                        [I 2025-10-17 04:48:10,718] Trial 18 finished with value: 0.11756177246570587 and parameters: {'seq_len': 96, 'pred_len': 30, 'expand': 1, 'd_model': 32, 'n_heads': 4, 'e_layers': 1, 'd_layers': 1, 'batch_size': 16, 'learning_rate': 9.196605786187385e-05, 'dropout': 0.12616251923421157}. Best is trial 5 with value: 0.07396138459444046.
Best trial: 5. Best value: 0.0739614:  36%|███▌      | 18/50 [56:06<1:28:13, 165.43s/it]Best trial: 5. Best value: 0.0739614:  36%|███▌      | 18/50 [56:06<1:28:13, 165.43s/it]Best trial: 5. Best value: 0.0739614:  38%|███▊      | 19/50 [56:06<1:39:59, 193.54s/it]
============================================================
Trial 19
============================================================
seq_len: 48, pred_len: 1
d_model: 32, n_heads: 8
e_layers: 2, d_layers: 2
batch_size: 64, lr: 0.000691
dropout: 0.07773039521004345
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 64, expand: 2
>>>>>> Start training: trial_19 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.030092).  Saving model ...
Updating learning rate to 0.0006910112428241356
Validation loss decreased (0.030092 --> 0.028103).  Saving model ...
Updating learning rate to 0.0003455056214120678
Validation loss decreased (0.028103 --> 0.025087).  Saving model ...
Updating learning rate to 0.0001727528107060339
Validation loss decreased (0.025087 --> 0.023550).  Saving model ...
Updating learning rate to 8.637640535301695e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.318820267650848e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.159410133825424e-05
Validation loss decreased (0.023550 --> 0.023097).  Saving model ...
Updating learning rate to 1.079705066912712e-05
Validation loss decreased (0.023097 --> 0.022977).  Saving model ...
Updating learning rate to 5.39852533456356e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.69926266728178e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.34963133364089e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.74815666820445e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.374078334102225e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6870391670511124e-07
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.435195835255562e-08
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.217597917627781e-08
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.1087989588138905e-08
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.0543994794069452e-08
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.271997397034726e-09
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.635998698517363e-09
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.3179993492586816e-09
EarlyStopping counter: 13 out of 100
Updating learning rate to 6.589996746293408e-10
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.294998373146704e-10
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.647499186573352e-10
EarlyStopping counter: 16 out of 100
Updating learning rate to 8.23749593286676e-11
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.11874796643338e-11
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.05937398321669e-11
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.029686991608345e-11
EarlyStopping counter: 20 out of 100
Updating learning rate to 5.148434958041725e-12
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.5742174790208624e-12
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.2871087395104312e-12
EarlyStopping counter: 23 out of 100
Updating learning rate to 6.435543697552156e-13
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.217771848776078e-13
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.608885924388039e-13
EarlyStopping counter: 26 out of 100
Updating learning rate to 8.044429621940195e-14
Validation loss decreased (0.022977 --> 0.022899).  Saving model ...
Updating learning rate to 4.0222148109700975e-14
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0111074054850488e-14
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0055537027425244e-14
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.027768513712622e-15
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.513884256856311e-15
Validation loss decreased (0.022899 --> 0.022859).  Saving model ...
Updating learning rate to 1.2569421284281555e-15
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.284710642140777e-16
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.1423553210703887e-16
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5711776605351943e-16
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855888302675972e-17
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.927944151337986e-17
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.963972075668993e-17
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.819860378344965e-18
Validation loss decreased (0.022859 --> 0.022373).  Saving model ...
Updating learning rate to 4.909930189172482e-18
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.454965094586241e-18
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2274825472931206e-18
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.137412736465603e-19
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.0687063682328015e-19
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.5343531841164007e-19
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.671765920582004e-20
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.835882960291002e-20
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.917941480145501e-20
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.589707400727505e-21
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.794853700363752e-21
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.397426850181876e-21
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.198713425090938e-21
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.99356712545469e-22
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.996783562727345e-22
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.4983917813636726e-22
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.491958906818363e-23
Validation loss decreased (0.022373 --> 0.022205).  Saving model ...
Updating learning rate to 3.7459794534091815e-23
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8729897267045907e-23
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.364948633522954e-24
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.682474316761477e-24
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.3412371583807384e-24
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1706185791903692e-24
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.853092895951846e-25
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.926546447975923e-25
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.4632732239879615e-25
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.316366119939808e-26
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.658183059969904e-26
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.829091529984952e-26
EarlyStopping counter: 12 out of 100
Updating learning rate to 9.14545764992476e-27
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.57272882496238e-27
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.28636441248119e-27
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.143182206240595e-27
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.715911031202975e-28
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.8579555156014873e-28
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.4289777578007437e-28
EarlyStopping counter: 19 out of 100
Updating learning rate to 7.144888789003718e-29
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.572444394501859e-29
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.7862221972509296e-29
EarlyStopping counter: 22 out of 100
Updating learning rate to 8.931110986254648e-30
EarlyStopping counter: 23 out of 100
Updating learning rate to 4.465555493127324e-30
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.232777746563662e-30
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.116388873281831e-30
EarlyStopping counter: 26 out of 100
Updating learning rate to 5.581944366409155e-31
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.7909721832045775e-31
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.3954860916022887e-31
EarlyStopping counter: 29 out of 100
Updating learning rate to 6.977430458011444e-32
EarlyStopping counter: 30 out of 100
Updating learning rate to 3.488715229005722e-32
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.744357614502861e-32
EarlyStopping counter: 32 out of 100
Updating learning rate to 8.721788072514305e-33
EarlyStopping counter: 33 out of 100
Updating learning rate to 4.360894036257152e-33
EarlyStopping counter: 34 out of 100
Updating learning rate to 2.180447018128576e-33
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.090223509064288e-33
>>>>>> Testing on validation set: trial_19 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.049953170120716095, mae:0.07711717486381531, dtw:Not calculated


                                                                                        [I 2025-10-17 04:49:19,163] Trial 19 finished with value: 0.07711717486381531 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 2, 'd_model': 32, 'n_heads': 8, 'e_layers': 2, 'd_layers': 2, 'batch_size': 64, 'learning_rate': 0.0006910112428241356, 'dropout': 0.07773039521004345}. Best is trial 5 with value: 0.07396138459444046.
Best trial: 5. Best value: 0.0739614:  38%|███▊      | 19/50 [57:15<1:39:59, 193.54s/it]Best trial: 5. Best value: 0.0739614:  38%|███▊      | 19/50 [57:15<1:39:59, 193.54s/it]Best trial: 5. Best value: 0.0739614:  40%|████      | 20/50 [57:15<1:17:59, 155.98s/it]
============================================================
Trial 20
============================================================
seq_len: 48, pred_len: 1
d_model: 32, n_heads: 8
e_layers: 1, d_layers: 1
batch_size: 32, lr: 0.000336
dropout: 0.18157174054461495
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 32, expand: 1
>>>>>> Start training: trial_20 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.028560).  Saving model ...
Updating learning rate to 0.00033592498201137833
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00016796249100568917
Validation loss decreased (0.028560 --> 0.024919).  Saving model ...
Updating learning rate to 8.398124550284458e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.199062275142229e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0995311375711146e-05
Validation loss decreased (0.024919 --> 0.024850).  Saving model ...
Updating learning rate to 1.0497655687855573e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.2488278439277865e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.6244139219638932e-06
Validation loss decreased (0.024850 --> 0.024417).  Saving model ...
Updating learning rate to 1.3122069609819466e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.561034804909733e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.2805174024548665e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6402587012274333e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.201293506137166e-08
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.100646753068583e-08
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0503233765342916e-08
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.0251616882671458e-08
Validation loss decreased (0.024417 --> 0.024348).  Saving model ...
Updating learning rate to 5.125808441335729e-09
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.5629042206678645e-09
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2814521103339322e-09
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.407260551669661e-10
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.2036302758348306e-10
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6018151379174153e-10
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.009075689587077e-11
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.004537844793538e-11
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.002268922396769e-11
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.0011344611983846e-11
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.005672305991923e-12
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.5028361529959614e-12
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.2514180764979807e-12
EarlyStopping counter: 13 out of 100
Updating learning rate to 6.257090382489904e-13
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.128545191244952e-13
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.564272595622476e-13
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.82136297811238e-14
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.91068148905619e-14
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.955340744528095e-14
EarlyStopping counter: 19 out of 100
Updating learning rate to 9.776703722640474e-15
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.888351861320237e-15
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.4441759306601186e-15
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.2220879653300593e-15
EarlyStopping counter: 23 out of 100
Updating learning rate to 6.110439826650296e-16
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.055219913325148e-16
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.527609956662574e-16
EarlyStopping counter: 26 out of 100
Updating learning rate to 7.63804978331287e-17
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.819024891656435e-17
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.9095124458282176e-17
EarlyStopping counter: 29 out of 100
Updating learning rate to 9.547562229141088e-18
EarlyStopping counter: 30 out of 100
Updating learning rate to 4.773781114570544e-18
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.386890557285272e-18
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.193445278642636e-18
EarlyStopping counter: 33 out of 100
Updating learning rate to 5.96722639321318e-19
EarlyStopping counter: 34 out of 100
Updating learning rate to 2.98361319660659e-19
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.491806598303295e-19
EarlyStopping counter: 36 out of 100
Updating learning rate to 7.459032991516475e-20
EarlyStopping counter: 37 out of 100
Updating learning rate to 3.7295164957582376e-20
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.8647582478791188e-20
EarlyStopping counter: 39 out of 100
Updating learning rate to 9.323791239395594e-21
EarlyStopping counter: 40 out of 100
Updating learning rate to 4.661895619697797e-21
EarlyStopping counter: 41 out of 100
Updating learning rate to 2.3309478098488985e-21
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.1654739049244492e-21
EarlyStopping counter: 43 out of 100
Updating learning rate to 5.827369524622246e-22
EarlyStopping counter: 44 out of 100
Updating learning rate to 2.913684762311123e-22
EarlyStopping counter: 45 out of 100
Updating learning rate to 1.4568423811555615e-22
EarlyStopping counter: 46 out of 100
Updating learning rate to 7.284211905777808e-23
EarlyStopping counter: 47 out of 100
Updating learning rate to 3.642105952888904e-23
EarlyStopping counter: 48 out of 100
Updating learning rate to 1.821052976444452e-23
EarlyStopping counter: 49 out of 100
Updating learning rate to 9.10526488222226e-24
EarlyStopping counter: 50 out of 100
Updating learning rate to 4.55263244111113e-24
EarlyStopping counter: 51 out of 100
Updating learning rate to 2.276316220555565e-24
EarlyStopping counter: 52 out of 100
Updating learning rate to 1.1381581102777825e-24
EarlyStopping counter: 53 out of 100
Updating learning rate to 5.690790551388912e-25
EarlyStopping counter: 54 out of 100
Updating learning rate to 2.845395275694456e-25
EarlyStopping counter: 55 out of 100
Updating learning rate to 1.422697637847228e-25
EarlyStopping counter: 56 out of 100
Updating learning rate to 7.11348818923614e-26
EarlyStopping counter: 57 out of 100
Updating learning rate to 3.55674409461807e-26
EarlyStopping counter: 58 out of 100
Updating learning rate to 1.778372047309035e-26
EarlyStopping counter: 59 out of 100
Updating learning rate to 8.891860236545175e-27
EarlyStopping counter: 60 out of 100
Updating learning rate to 4.445930118272588e-27
EarlyStopping counter: 61 out of 100
Updating learning rate to 2.222965059136294e-27
EarlyStopping counter: 62 out of 100
Updating learning rate to 1.111482529568147e-27
EarlyStopping counter: 63 out of 100
Updating learning rate to 5.557412647840735e-28
EarlyStopping counter: 64 out of 100
Updating learning rate to 2.7787063239203673e-28
EarlyStopping counter: 65 out of 100
Updating learning rate to 1.3893531619601837e-28
EarlyStopping counter: 66 out of 100
Updating learning rate to 6.946765809800918e-29
EarlyStopping counter: 67 out of 100
Updating learning rate to 3.473382904900459e-29
EarlyStopping counter: 68 out of 100
Updating learning rate to 1.7366914524502296e-29
EarlyStopping counter: 69 out of 100
Updating learning rate to 8.683457262251148e-30
EarlyStopping counter: 70 out of 100
Updating learning rate to 4.341728631125574e-30
EarlyStopping counter: 71 out of 100
Updating learning rate to 2.170864315562787e-30
EarlyStopping counter: 72 out of 100
Updating learning rate to 1.0854321577813935e-30
EarlyStopping counter: 73 out of 100
Updating learning rate to 5.427160788906967e-31
EarlyStopping counter: 74 out of 100
Updating learning rate to 2.7135803944534837e-31
EarlyStopping counter: 75 out of 100
Updating learning rate to 1.3567901972267419e-31
EarlyStopping counter: 76 out of 100
Updating learning rate to 6.783950986133709e-32
EarlyStopping counter: 77 out of 100
Updating learning rate to 3.3919754930668546e-32
EarlyStopping counter: 78 out of 100
Updating learning rate to 1.6959877465334273e-32
EarlyStopping counter: 79 out of 100
Updating learning rate to 8.479938732667137e-33
EarlyStopping counter: 80 out of 100
Updating learning rate to 4.239969366333568e-33
EarlyStopping counter: 81 out of 100
Updating learning rate to 2.119984683166784e-33
EarlyStopping counter: 82 out of 100
Updating learning rate to 1.059992341583392e-33
EarlyStopping counter: 83 out of 100
Updating learning rate to 5.29996170791696e-34
>>>>>> Testing on validation set: trial_20 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.051382359117269516, mae:0.07855277508497238, dtw:Not calculated


                                                                                        [I 2025-10-17 04:51:32,741] Trial 20 finished with value: 0.07855277508497238 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 1, 'd_model': 32, 'n_heads': 8, 'e_layers': 1, 'd_layers': 1, 'batch_size': 32, 'learning_rate': 0.00033592498201137833, 'dropout': 0.18157174054461495}. Best is trial 5 with value: 0.07396138459444046.
Best trial: 5. Best value: 0.0739614:  40%|████      | 20/50 [59:28<1:17:59, 155.98s/it]Best trial: 5. Best value: 0.0739614:  40%|████      | 20/50 [59:28<1:17:59, 155.98s/it]Best trial: 5. Best value: 0.0739614:  42%|████▏     | 21/50 [59:28<1:12:08, 149.25s/it]
============================================================
Trial 21
============================================================
seq_len: 48, pred_len: 1
d_model: 32, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000536
dropout: 0.1280441862661525
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 32, expand: 1
>>>>>> Start training: trial_21 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.030042).  Saving model ...
Updating learning rate to 0.0005355193446098775
Validation loss decreased (0.030042 --> 0.026266).  Saving model ...
Updating learning rate to 0.0002677596723049387
Validation loss decreased (0.026266 --> 0.025024).  Saving model ...
Updating learning rate to 0.00013387983615246936
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.693991807623468e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.346995903811734e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.673497951905867e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.367489759529335e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.183744879764668e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.091872439882334e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.045936219941167e-06
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.229681099705834e-07
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.614840549852917e-07
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.3074202749264586e-07
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.537101374632293e-08
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.2685506873161466e-08
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.6342753436580733e-08
EarlyStopping counter: 14 out of 100
Updating learning rate to 8.171376718290366e-09
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.085688359145183e-09
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.0428441795725916e-09
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.0214220897862958e-09
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.107110448931479e-10
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.5535552244657395e-10
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.2767776122328697e-10
Validation loss decreased (0.025024 --> 0.024884).  Saving model ...
Updating learning rate to 6.383888061164349e-11
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.1919440305821744e-11
Validation loss decreased (0.024884 --> 0.024653).  Saving model ...
Updating learning rate to 1.5959720152910872e-11
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.979860076455436e-12
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.989930038227718e-12
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.994965019113859e-12
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.974825095569295e-13
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.987412547784647e-13
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.4937062738923237e-13
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.2468531369461619e-13
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.234265684730809e-14
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.1171328423654047e-14
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.5585664211827023e-14
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.792832105913512e-15
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.896416052956756e-15
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.948208026478378e-15
EarlyStopping counter: 14 out of 100
Updating learning rate to 9.74104013239189e-16
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.870520066195945e-16
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.4352600330979724e-16
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.2176300165489862e-16
EarlyStopping counter: 18 out of 100
Updating learning rate to 6.088150082744931e-17
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.0440750413724655e-17
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.5220375206862327e-17
EarlyStopping counter: 21 out of 100
Updating learning rate to 7.610187603431164e-18
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.805093801715582e-18
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.902546900857791e-18
EarlyStopping counter: 24 out of 100
Updating learning rate to 9.512734504288955e-19
EarlyStopping counter: 25 out of 100
Updating learning rate to 4.756367252144477e-19
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.3781836260722387e-19
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.1890918130361193e-19
EarlyStopping counter: 28 out of 100
Updating learning rate to 5.945459065180597e-20
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.9727295325902983e-20
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.4863647662951492e-20
EarlyStopping counter: 31 out of 100
Updating learning rate to 7.431823831475746e-21
EarlyStopping counter: 32 out of 100
Updating learning rate to 3.715911915737873e-21
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.8579559578689365e-21
EarlyStopping counter: 34 out of 100
Updating learning rate to 9.289779789344682e-22
EarlyStopping counter: 35 out of 100
Updating learning rate to 4.644889894672341e-22
EarlyStopping counter: 36 out of 100
Updating learning rate to 2.3224449473361706e-22
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.1612224736680853e-22
EarlyStopping counter: 38 out of 100
Updating learning rate to 5.806112368340426e-23
EarlyStopping counter: 39 out of 100
Updating learning rate to 2.903056184170213e-23
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.4515280920851066e-23
EarlyStopping counter: 41 out of 100
Updating learning rate to 7.257640460425533e-24
EarlyStopping counter: 42 out of 100
Updating learning rate to 3.6288202302127665e-24
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.8144101151063833e-24
EarlyStopping counter: 44 out of 100
Updating learning rate to 9.072050575531916e-25
EarlyStopping counter: 45 out of 100
Updating learning rate to 4.536025287765958e-25
EarlyStopping counter: 46 out of 100
Updating learning rate to 2.268012643882979e-25
EarlyStopping counter: 47 out of 100
Updating learning rate to 1.1340063219414895e-25
EarlyStopping counter: 48 out of 100
Updating learning rate to 5.670031609707448e-26
EarlyStopping counter: 49 out of 100
Updating learning rate to 2.835015804853724e-26
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.417507902426862e-26
EarlyStopping counter: 51 out of 100
Updating learning rate to 7.08753951213431e-27
EarlyStopping counter: 52 out of 100
Updating learning rate to 3.543769756067155e-27
EarlyStopping counter: 53 out of 100
Updating learning rate to 1.7718848780335774e-27
EarlyStopping counter: 54 out of 100
Updating learning rate to 8.859424390167887e-28
EarlyStopping counter: 55 out of 100
Updating learning rate to 4.4297121950839435e-28
EarlyStopping counter: 56 out of 100
Updating learning rate to 2.2148560975419717e-28
EarlyStopping counter: 57 out of 100
Updating learning rate to 1.1074280487709859e-28
EarlyStopping counter: 58 out of 100
Updating learning rate to 5.537140243854929e-29
EarlyStopping counter: 59 out of 100
Updating learning rate to 2.7685701219274647e-29
EarlyStopping counter: 60 out of 100
Updating learning rate to 1.3842850609637323e-29
EarlyStopping counter: 61 out of 100
Updating learning rate to 6.921425304818662e-30
EarlyStopping counter: 62 out of 100
Updating learning rate to 3.460712652409331e-30
EarlyStopping counter: 63 out of 100
Updating learning rate to 1.7303563262046654e-30
EarlyStopping counter: 64 out of 100
Updating learning rate to 8.651781631023327e-31
EarlyStopping counter: 65 out of 100
Updating learning rate to 4.325890815511664e-31
EarlyStopping counter: 66 out of 100
Updating learning rate to 2.162945407755832e-31
EarlyStopping counter: 67 out of 100
Updating learning rate to 1.081472703877916e-31
EarlyStopping counter: 68 out of 100
Updating learning rate to 5.40736351938958e-32
EarlyStopping counter: 69 out of 100
Updating learning rate to 2.70368175969479e-32
EarlyStopping counter: 70 out of 100
Updating learning rate to 1.351840879847395e-32
EarlyStopping counter: 71 out of 100
Updating learning rate to 6.759204399236974e-33
EarlyStopping counter: 72 out of 100
Updating learning rate to 3.379602199618487e-33
EarlyStopping counter: 73 out of 100
Updating learning rate to 1.6898010998092436e-33
EarlyStopping counter: 74 out of 100
Updating learning rate to 8.449005499046218e-34
>>>>>> Testing on validation set: trial_21 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.051284294575452805, mae:0.07801323384046555, dtw:Not calculated


                                                                                        [I 2025-10-17 04:53:45,377] Trial 21 finished with value: 0.07801323384046555 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 1, 'd_model': 32, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0005355193446098775, 'dropout': 0.1280441862661525}. Best is trial 5 with value: 0.07396138459444046.
Best trial: 5. Best value: 0.0739614:  42%|████▏     | 21/50 [1:01:41<1:12:08, 149.25s/it]Best trial: 5. Best value: 0.0739614:  42%|████▏     | 21/50 [1:01:41<1:12:08, 149.25s/it]Best trial: 5. Best value: 0.0739614:  44%|████▍     | 22/50 [1:01:41<1:07:19, 144.27s/it]
============================================================
Trial 22
============================================================
seq_len: 48, pred_len: 1
d_model: 32, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000454
dropout: 0.13626778297989994
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 32, expand: 1
>>>>>> Start training: trial_22 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.034007).  Saving model ...
Updating learning rate to 0.00045438373507416944
Validation loss decreased (0.034007 --> 0.027258).  Saving model ...
Updating learning rate to 0.00022719186753708472
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00011359593376854236
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.679796688427118e-05
Validation loss decreased (0.027258 --> 0.025777).  Saving model ...
Updating learning rate to 2.839898344213559e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4199491721067795e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.0997458605338975e-06
Validation loss decreased (0.025777 --> 0.024990).  Saving model ...
Updating learning rate to 3.5498729302669487e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.7749364651334744e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.874682325667372e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.437341162833686e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.218670581416843e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1093352907084215e-07
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.5466764535421074e-08
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7733382267710537e-08
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3866691133855268e-08
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.933345566927634e-09
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.466672783463817e-09
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.7333363917319086e-09
Validation loss decreased (0.024990 --> 0.024431).  Saving model ...
Updating learning rate to 8.666681958659543e-10
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.3333409793297714e-10
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.1666704896648857e-10
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0833352448324428e-10
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.416676224162214e-11
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.708338112081107e-11
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3541690560405536e-11
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.770845280202768e-12
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.385422640101384e-12
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.692711320050692e-12
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.46355660025346e-13
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.23177830012673e-13
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.115889150063365e-13
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.0579445750316825e-13
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.2897228751584124e-14
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.6448614375792062e-14
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.3224307187896031e-14
EarlyStopping counter: 17 out of 100
Updating learning rate to 6.6121535939480154e-15
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.3060767969740077e-15
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.6530383984870039e-15
EarlyStopping counter: 20 out of 100
Updating learning rate to 8.265191992435019e-16
EarlyStopping counter: 21 out of 100
Updating learning rate to 4.1325959962175097e-16
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.0662979981087548e-16
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.0331489990543774e-16
EarlyStopping counter: 24 out of 100
Updating learning rate to 5.165744995271887e-17
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.5828724976359435e-17
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.2914362488179718e-17
EarlyStopping counter: 27 out of 100
Updating learning rate to 6.457181244089859e-18
EarlyStopping counter: 28 out of 100
Updating learning rate to 3.2285906220449294e-18
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.6142953110224647e-18
EarlyStopping counter: 30 out of 100
Updating learning rate to 8.071476555112324e-19
EarlyStopping counter: 31 out of 100
Updating learning rate to 4.035738277556162e-19
EarlyStopping counter: 32 out of 100
Updating learning rate to 2.017869138778081e-19
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.0089345693890404e-19
EarlyStopping counter: 34 out of 100
Updating learning rate to 5.044672846945202e-20
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.522336423472601e-20
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.2611682117363006e-20
EarlyStopping counter: 37 out of 100
Updating learning rate to 6.305841058681503e-21
EarlyStopping counter: 38 out of 100
Updating learning rate to 3.1529205293407514e-21
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.5764602646703757e-21
EarlyStopping counter: 40 out of 100
Updating learning rate to 7.882301323351878e-22
EarlyStopping counter: 41 out of 100
Updating learning rate to 3.941150661675939e-22
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.9705753308379696e-22
EarlyStopping counter: 43 out of 100
Updating learning rate to 9.852876654189848e-23
EarlyStopping counter: 44 out of 100
Updating learning rate to 4.926438327094924e-23
EarlyStopping counter: 45 out of 100
Updating learning rate to 2.463219163547462e-23
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.231609581773731e-23
EarlyStopping counter: 47 out of 100
Updating learning rate to 6.158047908868655e-24
EarlyStopping counter: 48 out of 100
Updating learning rate to 3.0790239544343275e-24
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.5395119772171638e-24
EarlyStopping counter: 50 out of 100
Updating learning rate to 7.697559886085819e-25
EarlyStopping counter: 51 out of 100
Updating learning rate to 3.8487799430429094e-25
EarlyStopping counter: 52 out of 100
Updating learning rate to 1.9243899715214547e-25
EarlyStopping counter: 53 out of 100
Updating learning rate to 9.621949857607274e-26
EarlyStopping counter: 54 out of 100
Updating learning rate to 4.810974928803637e-26
EarlyStopping counter: 55 out of 100
Updating learning rate to 2.4054874644018184e-26
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.2027437322009092e-26
EarlyStopping counter: 57 out of 100
Updating learning rate to 6.013718661004546e-27
EarlyStopping counter: 58 out of 100
Updating learning rate to 3.006859330502273e-27
EarlyStopping counter: 59 out of 100
Updating learning rate to 1.5034296652511365e-27
EarlyStopping counter: 60 out of 100
Updating learning rate to 7.517148326255682e-28
EarlyStopping counter: 61 out of 100
Updating learning rate to 3.758574163127841e-28
EarlyStopping counter: 62 out of 100
Updating learning rate to 1.8792870815639206e-28
EarlyStopping counter: 63 out of 100
Updating learning rate to 9.396435407819603e-29
EarlyStopping counter: 64 out of 100
Updating learning rate to 4.6982177039098015e-29
EarlyStopping counter: 65 out of 100
Updating learning rate to 2.3491088519549008e-29
EarlyStopping counter: 66 out of 100
Updating learning rate to 1.1745544259774504e-29
EarlyStopping counter: 67 out of 100
Updating learning rate to 5.872772129887252e-30
EarlyStopping counter: 68 out of 100
Updating learning rate to 2.936386064943626e-30
EarlyStopping counter: 69 out of 100
Updating learning rate to 1.468193032471813e-30
EarlyStopping counter: 70 out of 100
Updating learning rate to 7.340965162359065e-31
EarlyStopping counter: 71 out of 100
Updating learning rate to 3.6704825811795324e-31
EarlyStopping counter: 72 out of 100
Updating learning rate to 1.8352412905897662e-31
EarlyStopping counter: 73 out of 100
Updating learning rate to 9.176206452948831e-32
EarlyStopping counter: 74 out of 100
Updating learning rate to 4.5881032264744155e-32
EarlyStopping counter: 75 out of 100
Updating learning rate to 2.2940516132372078e-32
EarlyStopping counter: 76 out of 100
Updating learning rate to 1.1470258066186039e-32
EarlyStopping counter: 77 out of 100
Updating learning rate to 5.7351290330930194e-33
EarlyStopping counter: 78 out of 100
Updating learning rate to 2.8675645165465097e-33
EarlyStopping counter: 79 out of 100
Updating learning rate to 1.4337822582732549e-33
EarlyStopping counter: 80 out of 100
Updating learning rate to 7.168911291366274e-34
>>>>>> Testing on validation set: trial_22 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.050850965082645416, mae:0.07875917106866837, dtw:Not calculated


                                                                                          [I 2025-10-17 04:55:58,476] Trial 22 finished with value: 0.07875917106866837 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 1, 'd_model': 32, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.00045438373507416944, 'dropout': 0.13626778297989994}. Best is trial 5 with value: 0.07396138459444046.
Best trial: 5. Best value: 0.0739614:  44%|████▍     | 22/50 [1:03:54<1:07:19, 144.27s/it]Best trial: 5. Best value: 0.0739614:  44%|████▍     | 22/50 [1:03:54<1:07:19, 144.27s/it]Best trial: 5. Best value: 0.0739614:  46%|████▌     | 23/50 [1:03:54<1:03:24, 140.92s/it]
============================================================
Trial 23
============================================================
seq_len: 48, pred_len: 1
d_model: 32, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000705
dropout: 0.10328638523190456
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 32, expand: 1
>>>>>> Start training: trial_23 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.030442).  Saving model ...
Updating learning rate to 0.0007054055983630686
Validation loss decreased (0.030442 --> 0.027046).  Saving model ...
Updating learning rate to 0.0003527027991815343
Validation loss decreased (0.027046 --> 0.025360).  Saving model ...
Updating learning rate to 0.00017635139959076715
Validation loss decreased (0.025360 --> 0.024979).  Saving model ...
Updating learning rate to 8.817569979538358e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.408784989769179e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2043924948845894e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1021962474422947e-05
Validation loss decreased (0.024979 --> 0.024528).  Saving model ...
Updating learning rate to 5.5109812372114735e-06
Validation loss decreased (0.024528 --> 0.024394).  Saving model ...
Updating learning rate to 2.7554906186057367e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3777453093028684e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.888726546514342e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.444363273257171e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.7221816366285855e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.610908183142927e-08
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.3054540915714637e-08
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.1527270457857318e-08
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.0763635228928659e-08
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.3818176144643296e-09
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.6909088072321648e-09
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.3454544036160824e-09
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.727272018080412e-10
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.363636009040206e-10
Validation loss decreased (0.024394 --> 0.024324).  Saving model ...
Updating learning rate to 1.681818004520103e-10
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.409090022600515e-11
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.2045450113002575e-11
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.1022725056501287e-11
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0511362528250644e-11
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.255681264125322e-12
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.627840632062661e-12
Validation loss decreased (0.024324 --> 0.024269).  Saving model ...
Updating learning rate to 1.3139203160313305e-12
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.569601580156652e-13
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.284800790078326e-13
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.642400395039163e-13
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.212001975195815e-14
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.106000987597908e-14
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.053000493798954e-14
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.026500246899477e-14
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.132501234497385e-15
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.5662506172486923e-15
Validation loss decreased (0.024269 --> 0.024260).  Saving model ...
Updating learning rate to 1.2831253086243462e-15
Validation loss decreased (0.024260 --> 0.024144).  Saving model ...
Updating learning rate to 6.415626543121731e-16
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.2078132715608654e-16
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6039066357804327e-16
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.019533178902163e-17
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.009766589451082e-17
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.004883294725541e-17
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.0024416473627704e-17
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.012208236813852e-18
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.506104118406926e-18
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.253052059203463e-18
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.265260296017315e-19
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.1326301480086576e-19
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.5663150740043288e-19
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.831575370021644e-20
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.915787685010822e-20
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.957893842505411e-20
EarlyStopping counter: 16 out of 100
Updating learning rate to 9.789469212527055e-21
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.8947346062635275e-21
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.4473673031317638e-21
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.2236836515658819e-21
EarlyStopping counter: 20 out of 100
Updating learning rate to 6.118418257829409e-22
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.0592091289147047e-22
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.5296045644573523e-22
EarlyStopping counter: 23 out of 100
Updating learning rate to 7.648022822286762e-23
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.824011411143381e-23
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.9120057055716904e-23
EarlyStopping counter: 26 out of 100
Updating learning rate to 9.560028527858452e-24
EarlyStopping counter: 27 out of 100
Updating learning rate to 4.780014263929226e-24
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.390007131964613e-24
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.1950035659823065e-24
EarlyStopping counter: 30 out of 100
Updating learning rate to 5.975017829911533e-25
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.9875089149557663e-25
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.4937544574778832e-25
EarlyStopping counter: 33 out of 100
Updating learning rate to 7.468772287389416e-26
EarlyStopping counter: 34 out of 100
Updating learning rate to 3.734386143694708e-26
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.867193071847354e-26
EarlyStopping counter: 36 out of 100
Updating learning rate to 9.33596535923677e-27
EarlyStopping counter: 37 out of 100
Updating learning rate to 4.667982679618385e-27
EarlyStopping counter: 38 out of 100
Updating learning rate to 2.3339913398091924e-27
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.1669956699045962e-27
EarlyStopping counter: 40 out of 100
Updating learning rate to 5.834978349522981e-28
EarlyStopping counter: 41 out of 100
Updating learning rate to 2.9174891747614905e-28
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.4587445873807453e-28
EarlyStopping counter: 43 out of 100
Updating learning rate to 7.293722936903726e-29
EarlyStopping counter: 44 out of 100
Updating learning rate to 3.646861468451863e-29
EarlyStopping counter: 45 out of 100
Updating learning rate to 1.8234307342259316e-29
EarlyStopping counter: 46 out of 100
Updating learning rate to 9.117153671129658e-30
EarlyStopping counter: 47 out of 100
Updating learning rate to 4.558576835564829e-30
EarlyStopping counter: 48 out of 100
Updating learning rate to 2.2792884177824145e-30
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.1396442088912072e-30
Validation loss decreased (0.024144 --> 0.024140).  Saving model ...
Updating learning rate to 5.698221044456036e-31
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.849110522228018e-31
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.424555261114009e-31
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.122776305570045e-32
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.5613881527850226e-32
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.7806940763925113e-32
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.903470381962557e-33
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.451735190981278e-33
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.225867595490639e-33
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.1129337977453196e-33
>>>>>> Testing on validation set: trial_23 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.04976581037044525, mae:0.07450992614030838, dtw:Not calculated


                                                                                          [I 2025-10-17 04:58:12,136] Trial 23 finished with value: 0.07450992614030838 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 1, 'd_model': 32, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0007054055983630686, 'dropout': 0.10328638523190456}. Best is trial 5 with value: 0.07396138459444046.
Best trial: 5. Best value: 0.0739614:  46%|████▌     | 23/50 [1:06:08<1:03:24, 140.92s/it]Best trial: 5. Best value: 0.0739614:  46%|████▌     | 23/50 [1:06:08<1:03:24, 140.92s/it]Best trial: 5. Best value: 0.0739614:  48%|████▊     | 24/50 [1:06:08<1:00:07, 138.74s/it]
============================================================
Trial 24
============================================================
seq_len: 48, pred_len: 1
d_model: 32, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000240
dropout: 0.15341689467445369
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 32, expand: 1
>>>>>> Start training: trial_24 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.031294).  Saving model ...
Updating learning rate to 0.00024028003165845244
Validation loss decreased (0.031294 --> 0.027276).  Saving model ...
Updating learning rate to 0.00012014001582922622
Validation loss decreased (0.027276 --> 0.026489).  Saving model ...
Updating learning rate to 6.007000791461311e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.0035003957306555e-05
Validation loss decreased (0.026489 --> 0.026172).  Saving model ...
Updating learning rate to 1.5017501978653278e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.508750989326639e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.7543754946633194e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8771877473316597e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.385938736658298e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.692969368329149e-07
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.3464846841645746e-07
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1732423420822873e-07
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.8662117104114365e-08
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.9331058552057183e-08
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.4665529276028591e-08
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.332764638014296e-09
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.666382319007148e-09
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.833191159503574e-09
EarlyStopping counter: 14 out of 100
Updating learning rate to 9.16595579751787e-10
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.582977898758935e-10
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.2914889493794674e-10
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.1457444746897337e-10
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.7287223734486685e-11
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.8643611867243342e-11
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.4321805933621671e-11
EarlyStopping counter: 21 out of 100
Updating learning rate to 7.160902966810836e-12
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.580451483405418e-12
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.790225741702709e-12
EarlyStopping counter: 24 out of 100
Updating learning rate to 8.951128708513545e-13
EarlyStopping counter: 25 out of 100
Updating learning rate to 4.4755643542567723e-13
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.2377821771283861e-13
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.1188910885641931e-13
EarlyStopping counter: 28 out of 100
Updating learning rate to 5.5944554428209653e-14
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.7972277214104827e-14
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.3986138607052413e-14
EarlyStopping counter: 31 out of 100
Updating learning rate to 6.993069303526207e-15
Validation loss decreased (0.026172 --> 0.026089).  Saving model ...
Updating learning rate to 3.4965346517631033e-15
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.7482673258815517e-15
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.741336629407758e-16
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.370668314703879e-16
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.1853341573519396e-16
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0926670786759698e-16
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.463335393379849e-17
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7316676966899245e-17
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3658338483449622e-17
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.829169241724811e-18
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.4145846208624056e-18
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.7072923104312028e-18
EarlyStopping counter: 12 out of 100
Updating learning rate to 8.536461552156014e-19
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.268230776078007e-19
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.1341153880390035e-19
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.0670576940195017e-19
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.335288470097509e-20
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.6676442350487544e-20
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.3338221175243772e-20
EarlyStopping counter: 19 out of 100
Updating learning rate to 6.669110587621886e-21
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.334555293810943e-21
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.6672776469054715e-21
EarlyStopping counter: 22 out of 100
Updating learning rate to 8.336388234527357e-22
EarlyStopping counter: 23 out of 100
Updating learning rate to 4.1681941172636787e-22
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.0840970586318394e-22
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.0420485293159197e-22
EarlyStopping counter: 26 out of 100
Updating learning rate to 5.2102426465795984e-23
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.6051213232897992e-23
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.3025606616448996e-23
EarlyStopping counter: 29 out of 100
Updating learning rate to 6.512803308224498e-24
EarlyStopping counter: 30 out of 100
Updating learning rate to 3.256401654112249e-24
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.6282008270561245e-24
EarlyStopping counter: 32 out of 100
Updating learning rate to 8.1410041352806225e-25
EarlyStopping counter: 33 out of 100
Updating learning rate to 4.0705020676403112e-25
EarlyStopping counter: 34 out of 100
Updating learning rate to 2.0352510338201556e-25
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.0176255169100778e-25
EarlyStopping counter: 36 out of 100
Updating learning rate to 5.088127584550389e-26
EarlyStopping counter: 37 out of 100
Updating learning rate to 2.5440637922751945e-26
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.2720318961375973e-26
EarlyStopping counter: 39 out of 100
Updating learning rate to 6.360159480687986e-27
EarlyStopping counter: 40 out of 100
Updating learning rate to 3.180079740343993e-27
EarlyStopping counter: 41 out of 100
Updating learning rate to 1.5900398701719966e-27
EarlyStopping counter: 42 out of 100
Updating learning rate to 7.950199350859983e-28
EarlyStopping counter: 43 out of 100
Updating learning rate to 3.9750996754299914e-28
EarlyStopping counter: 44 out of 100
Updating learning rate to 1.9875498377149957e-28
EarlyStopping counter: 45 out of 100
Updating learning rate to 9.937749188574979e-29
EarlyStopping counter: 46 out of 100
Updating learning rate to 4.9688745942874893e-29
EarlyStopping counter: 47 out of 100
Updating learning rate to 2.4844372971437446e-29
EarlyStopping counter: 48 out of 100
Updating learning rate to 1.2422186485718723e-29
EarlyStopping counter: 49 out of 100
Updating learning rate to 6.2110932428593616e-30
EarlyStopping counter: 50 out of 100
Updating learning rate to 3.1055466214296808e-30
EarlyStopping counter: 51 out of 100
Updating learning rate to 1.5527733107148404e-30
EarlyStopping counter: 52 out of 100
Updating learning rate to 7.763866553574202e-31
EarlyStopping counter: 53 out of 100
Updating learning rate to 3.881933276787101e-31
EarlyStopping counter: 54 out of 100
Updating learning rate to 1.9409666383935505e-31
EarlyStopping counter: 55 out of 100
Updating learning rate to 9.704833191967753e-32
EarlyStopping counter: 56 out of 100
Updating learning rate to 4.852416595983876e-32
EarlyStopping counter: 57 out of 100
Updating learning rate to 2.426208297991938e-32
EarlyStopping counter: 58 out of 100
Updating learning rate to 1.213104148995969e-32
EarlyStopping counter: 59 out of 100
Updating learning rate to 6.065520744979845e-33
EarlyStopping counter: 60 out of 100
Updating learning rate to 3.0327603724899227e-33
EarlyStopping counter: 61 out of 100
Updating learning rate to 1.5163801862449613e-33
EarlyStopping counter: 62 out of 100
Updating learning rate to 7.581900931224807e-34
EarlyStopping counter: 63 out of 100
Updating learning rate to 3.7909504656124033e-34
>>>>>> Testing on validation set: trial_24 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.052901268005371094, mae:0.08110562711954117, dtw:Not calculated


                                                                                          [I 2025-10-17 05:00:25,541] Trial 24 finished with value: 0.08110562711954117 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 1, 'd_model': 32, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.00024028003165845244, 'dropout': 0.15341689467445369}. Best is trial 5 with value: 0.07396138459444046.
Best trial: 5. Best value: 0.0739614:  48%|████▊     | 24/50 [1:08:21<1:00:07, 138.74s/it]Best trial: 5. Best value: 0.0739614:  48%|████▊     | 24/50 [1:08:21<1:00:07, 138.74s/it]Best trial: 5. Best value: 0.0739614:  50%|█████     | 25/50 [1:08:21<57:08, 137.14s/it]  
============================================================
Trial 25
============================================================
seq_len: 48, pred_len: 1
d_model: 32, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 16, lr: 0.000140
dropout: 0.10656603532675478
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 32, expand: 1
>>>>>> Start training: trial_25 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.033090).  Saving model ...
Updating learning rate to 0.0001395746692964776
Validation loss decreased (0.033090 --> 0.031000).  Saving model ...
Updating learning rate to 6.97873346482388e-05
Validation loss decreased (0.031000 --> 0.028646).  Saving model ...
Updating learning rate to 3.48936673241194e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.74468336620597e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.72341683102985e-06
Validation loss decreased (0.028646 --> 0.028490).  Saving model ...
Updating learning rate to 4.361708415514925e-06
Validation loss decreased (0.028490 --> 0.028385).  Saving model ...
Updating learning rate to 2.1808542077574623e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0904271038787312e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.452135519393656e-07
Validation loss decreased (0.028385 --> 0.028234).  Saving model ...
Updating learning rate to 2.726067759696828e-07
Validation loss decreased (0.028234 --> 0.027752).  Saving model ...
Updating learning rate to 1.363033879848414e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.81516939924207e-08
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.407584699621035e-08
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.7037923498105175e-08
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.518961749052587e-09
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.259480874526294e-09
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.129740437263147e-09
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.0648702186315734e-09
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.324351093157867e-10
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.6621755465789335e-10
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.3310877732894668e-10
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.655438866447334e-11
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.327719433223667e-11
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.6638597166118335e-11
EarlyStopping counter: 14 out of 100
Updating learning rate to 8.319298583059167e-12
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.159649291529584e-12
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.079824645764792e-12
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.039912322882396e-12
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.19956161441198e-13
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.59978080720599e-13
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.299890403602995e-13
EarlyStopping counter: 21 out of 100
Updating learning rate to 6.499452018014974e-14
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.249726009007487e-14
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.6248630045037436e-14
EarlyStopping counter: 24 out of 100
Updating learning rate to 8.124315022518718e-15
EarlyStopping counter: 25 out of 100
Updating learning rate to 4.062157511259359e-15
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.0310787556296795e-15
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.0155393778148398e-15
EarlyStopping counter: 28 out of 100
Updating learning rate to 5.077696889074199e-16
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.5388484445370994e-16
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.2694242222685497e-16
EarlyStopping counter: 31 out of 100
Updating learning rate to 6.347121111342748e-17
EarlyStopping counter: 32 out of 100
Updating learning rate to 3.173560555671374e-17
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.586780277835687e-17
EarlyStopping counter: 34 out of 100
Updating learning rate to 7.933901389178436e-18
EarlyStopping counter: 35 out of 100
Updating learning rate to 3.966950694589218e-18
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.983475347294609e-18
EarlyStopping counter: 37 out of 100
Updating learning rate to 9.917376736473044e-19
EarlyStopping counter: 38 out of 100
Updating learning rate to 4.958688368236522e-19
EarlyStopping counter: 39 out of 100
Updating learning rate to 2.479344184118261e-19
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.2396720920591306e-19
EarlyStopping counter: 41 out of 100
Updating learning rate to 6.198360460295653e-20
EarlyStopping counter: 42 out of 100
Updating learning rate to 3.0991802301478264e-20
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.5495901150739132e-20
EarlyStopping counter: 44 out of 100
Updating learning rate to 7.747950575369566e-21
EarlyStopping counter: 45 out of 100
Updating learning rate to 3.873975287684783e-21
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.9369876438423915e-21
EarlyStopping counter: 47 out of 100
Updating learning rate to 9.684938219211958e-22
EarlyStopping counter: 48 out of 100
Updating learning rate to 4.842469109605979e-22
EarlyStopping counter: 49 out of 100
Updating learning rate to 2.4212345548029894e-22
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.2106172774014947e-22
EarlyStopping counter: 51 out of 100
Updating learning rate to 6.053086387007473e-23
EarlyStopping counter: 52 out of 100
Updating learning rate to 3.026543193503737e-23
EarlyStopping counter: 53 out of 100
Updating learning rate to 1.5132715967518684e-23
EarlyStopping counter: 54 out of 100
Updating learning rate to 7.566357983759342e-24
EarlyStopping counter: 55 out of 100
Updating learning rate to 3.783178991879671e-24
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.8915894959398355e-24
EarlyStopping counter: 57 out of 100
Updating learning rate to 9.457947479699177e-25
EarlyStopping counter: 58 out of 100
Updating learning rate to 4.728973739849589e-25
EarlyStopping counter: 59 out of 100
Updating learning rate to 2.3644868699247943e-25
EarlyStopping counter: 60 out of 100
Updating learning rate to 1.1822434349623972e-25
EarlyStopping counter: 61 out of 100
Updating learning rate to 5.911217174811986e-26
EarlyStopping counter: 62 out of 100
Updating learning rate to 2.955608587405993e-26
EarlyStopping counter: 63 out of 100
Updating learning rate to 1.4778042937029964e-26
EarlyStopping counter: 64 out of 100
Updating learning rate to 7.389021468514982e-27
EarlyStopping counter: 65 out of 100
Updating learning rate to 3.694510734257491e-27
EarlyStopping counter: 66 out of 100
Updating learning rate to 1.8472553671287456e-27
EarlyStopping counter: 67 out of 100
Updating learning rate to 9.236276835643728e-28
EarlyStopping counter: 68 out of 100
Updating learning rate to 4.618138417821864e-28
EarlyStopping counter: 69 out of 100
Updating learning rate to 2.309069208910932e-28
EarlyStopping counter: 70 out of 100
Updating learning rate to 1.154534604455466e-28
EarlyStopping counter: 71 out of 100
Updating learning rate to 5.77267302227733e-29
EarlyStopping counter: 72 out of 100
Updating learning rate to 2.886336511138665e-29
EarlyStopping counter: 73 out of 100
Updating learning rate to 1.4431682555693325e-29
EarlyStopping counter: 74 out of 100
Updating learning rate to 7.215841277846662e-30
EarlyStopping counter: 75 out of 100
Updating learning rate to 3.607920638923331e-30
EarlyStopping counter: 76 out of 100
Updating learning rate to 1.8039603194616656e-30
EarlyStopping counter: 77 out of 100
Updating learning rate to 9.019801597308328e-31
EarlyStopping counter: 78 out of 100
Updating learning rate to 4.509900798654164e-31
EarlyStopping counter: 79 out of 100
Updating learning rate to 2.254950399327082e-31
EarlyStopping counter: 80 out of 100
Updating learning rate to 1.127475199663541e-31
EarlyStopping counter: 81 out of 100
Updating learning rate to 5.637375998317705e-32
EarlyStopping counter: 82 out of 100
Updating learning rate to 2.8186879991588525e-32
EarlyStopping counter: 83 out of 100
Updating learning rate to 1.4093439995794262e-32
EarlyStopping counter: 84 out of 100
Updating learning rate to 7.046719997897131e-33
EarlyStopping counter: 85 out of 100
Updating learning rate to 3.5233599989485656e-33
EarlyStopping counter: 86 out of 100
Updating learning rate to 1.7616799994742828e-33
EarlyStopping counter: 87 out of 100
Updating learning rate to 8.808399997371414e-34
EarlyStopping counter: 88 out of 100
Updating learning rate to 4.404199998685707e-34
EarlyStopping counter: 89 out of 100
Updating learning rate to 2.2020999993428535e-34
>>>>>> Testing on validation set: trial_25 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.05390064790844917, mae:0.08347418904304504, dtw:Not calculated


                                                                                        [I 2025-10-17 05:04:47,728] Trial 25 finished with value: 0.08347418904304504 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 1, 'd_model': 32, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 16, 'learning_rate': 0.0001395746692964776, 'dropout': 0.10656603532675478}. Best is trial 5 with value: 0.07396138459444046.
Best trial: 5. Best value: 0.0739614:  50%|█████     | 25/50 [1:12:43<57:08, 137.14s/it]Best trial: 5. Best value: 0.0739614:  50%|█████     | 25/50 [1:12:43<57:08, 137.14s/it]Best trial: 5. Best value: 0.0739614:  52%|█████▏    | 26/50 [1:12:43<1:09:51, 174.66s/it]
============================================================
Trial 26
============================================================
seq_len: 48, pred_len: 7
d_model: 64, n_heads: 8
e_layers: 2, d_layers: 2
batch_size: 32, lr: 0.000944
dropout: 0.23356351359603789
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_26 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 7
============================================================
train 4619
val 253
test 255
Validation loss decreased (inf --> 0.037451).  Saving model ...
Updating learning rate to 0.0009437786043971697
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00047188930219858486
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.00023594465109929243
EarlyStopping counter: 3 out of 100
Updating learning rate to 0.00011797232554964622
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.898616277482311e-05
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.9493081387411554e-05
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.4746540693705777e-05
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.3732703468528885e-06
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.6866351734264442e-06
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.8433175867132221e-06
EarlyStopping counter: 10 out of 100
Updating learning rate to 9.216587933566111e-07
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.6082939667830553e-07
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.3041469833915276e-07
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.1520734916957638e-07
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.760367458478819e-08
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.8801837292394096e-08
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.4400918646197048e-08
EarlyStopping counter: 17 out of 100
Updating learning rate to 7.200459323098524e-09
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.600229661549262e-09
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.800114830774631e-09
EarlyStopping counter: 20 out of 100
Updating learning rate to 9.000574153873155e-10
EarlyStopping counter: 21 out of 100
Updating learning rate to 4.5002870769365774e-10
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.2501435384682887e-10
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.1250717692341444e-10
EarlyStopping counter: 24 out of 100
Updating learning rate to 5.625358846170722e-11
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.812679423085361e-11
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.4063397115426805e-11
EarlyStopping counter: 27 out of 100
Updating learning rate to 7.031698557713402e-12
EarlyStopping counter: 28 out of 100
Updating learning rate to 3.515849278856701e-12
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.7579246394283506e-12
EarlyStopping counter: 30 out of 100
Updating learning rate to 8.789623197141753e-13
EarlyStopping counter: 31 out of 100
Updating learning rate to 4.3948115985708764e-13
EarlyStopping counter: 32 out of 100
Updating learning rate to 2.1974057992854382e-13
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.0987028996427191e-13
EarlyStopping counter: 34 out of 100
Updating learning rate to 5.4935144982135955e-14
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.7467572491067978e-14
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.3733786245533989e-14
EarlyStopping counter: 37 out of 100
Updating learning rate to 6.866893122766994e-15
EarlyStopping counter: 38 out of 100
Updating learning rate to 3.433446561383497e-15
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.7167232806917486e-15
EarlyStopping counter: 40 out of 100
Updating learning rate to 8.583616403458743e-16
EarlyStopping counter: 41 out of 100
Updating learning rate to 4.2918082017293715e-16
EarlyStopping counter: 42 out of 100
Updating learning rate to 2.1459041008646857e-16
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.0729520504323429e-16
EarlyStopping counter: 44 out of 100
Updating learning rate to 5.3647602521617144e-17
EarlyStopping counter: 45 out of 100
Updating learning rate to 2.6823801260808572e-17
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.3411900630404286e-17
EarlyStopping counter: 47 out of 100
Updating learning rate to 6.705950315202143e-18
EarlyStopping counter: 48 out of 100
Updating learning rate to 3.3529751576010715e-18
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.6764875788005357e-18
EarlyStopping counter: 50 out of 100
Updating learning rate to 8.382437894002679e-19
EarlyStopping counter: 51 out of 100
Updating learning rate to 4.1912189470013393e-19
EarlyStopping counter: 52 out of 100
Updating learning rate to 2.0956094735006697e-19
EarlyStopping counter: 53 out of 100
Updating learning rate to 1.0478047367503348e-19
EarlyStopping counter: 54 out of 100
Updating learning rate to 5.239023683751674e-20
EarlyStopping counter: 55 out of 100
Updating learning rate to 2.619511841875837e-20
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.3097559209379185e-20
EarlyStopping counter: 57 out of 100
Updating learning rate to 6.548779604689593e-21
EarlyStopping counter: 58 out of 100
Updating learning rate to 3.2743898023447964e-21
EarlyStopping counter: 59 out of 100
Updating learning rate to 1.6371949011723982e-21
EarlyStopping counter: 60 out of 100
Updating learning rate to 8.185974505861991e-22
EarlyStopping counter: 61 out of 100
Updating learning rate to 4.0929872529309955e-22
EarlyStopping counter: 62 out of 100
Updating learning rate to 2.0464936264654977e-22
EarlyStopping counter: 63 out of 100
Updating learning rate to 1.0232468132327489e-22
EarlyStopping counter: 64 out of 100
Updating learning rate to 5.1162340661637443e-23
EarlyStopping counter: 65 out of 100
Updating learning rate to 2.5581170330818722e-23
EarlyStopping counter: 66 out of 100
Updating learning rate to 1.2790585165409361e-23
EarlyStopping counter: 67 out of 100
Updating learning rate to 6.3952925827046804e-24
EarlyStopping counter: 68 out of 100
Updating learning rate to 3.1976462913523402e-24
EarlyStopping counter: 69 out of 100
Updating learning rate to 1.5988231456761701e-24
EarlyStopping counter: 70 out of 100
Updating learning rate to 7.9941157283808505e-25
EarlyStopping counter: 71 out of 100
Updating learning rate to 3.9970578641904252e-25
EarlyStopping counter: 72 out of 100
Updating learning rate to 1.9985289320952126e-25
EarlyStopping counter: 73 out of 100
Updating learning rate to 9.992644660476063e-26
EarlyStopping counter: 74 out of 100
Updating learning rate to 4.9963223302380316e-26
EarlyStopping counter: 75 out of 100
Updating learning rate to 2.4981611651190158e-26
EarlyStopping counter: 76 out of 100
Updating learning rate to 1.2490805825595079e-26
EarlyStopping counter: 77 out of 100
Updating learning rate to 6.2454029127975395e-27
EarlyStopping counter: 78 out of 100
Updating learning rate to 3.1227014563987697e-27
EarlyStopping counter: 79 out of 100
Updating learning rate to 1.5613507281993849e-27
EarlyStopping counter: 80 out of 100
Updating learning rate to 7.806753640996924e-28
EarlyStopping counter: 81 out of 100
Updating learning rate to 3.903376820498462e-28
EarlyStopping counter: 82 out of 100
Updating learning rate to 1.951688410249231e-28
EarlyStopping counter: 83 out of 100
Updating learning rate to 9.758442051246155e-29
EarlyStopping counter: 84 out of 100
Updating learning rate to 4.8792210256230777e-29
EarlyStopping counter: 85 out of 100
Updating learning rate to 2.4396105128115388e-29
EarlyStopping counter: 86 out of 100
Updating learning rate to 1.2198052564057694e-29
EarlyStopping counter: 87 out of 100
Updating learning rate to 6.099026282028847e-30
EarlyStopping counter: 88 out of 100
Updating learning rate to 3.0495131410144236e-30
EarlyStopping counter: 89 out of 100
Updating learning rate to 1.5247565705072118e-30
EarlyStopping counter: 90 out of 100
Updating learning rate to 7.623782852536059e-31
EarlyStopping counter: 91 out of 100
Updating learning rate to 3.8118914262680295e-31
EarlyStopping counter: 92 out of 100
Updating learning rate to 1.9059457131340147e-31
EarlyStopping counter: 93 out of 100
Updating learning rate to 9.529728565670074e-32
EarlyStopping counter: 94 out of 100
Updating learning rate to 4.764864282835037e-32
EarlyStopping counter: 95 out of 100
Updating learning rate to 2.3824321414175184e-32
EarlyStopping counter: 96 out of 100
Updating learning rate to 1.1912160707087592e-32
EarlyStopping counter: 97 out of 100
Updating learning rate to 5.956080353543796e-33
EarlyStopping counter: 98 out of 100
Updating learning rate to 2.978040176771898e-33
EarlyStopping counter: 99 out of 100
Updating learning rate to 1.489020088385949e-33
>>>>>> Testing on validation set: trial_26 >>>>>>
test 255
test shape: (255, 7, 5) (255, 7, 5)
test shape: (255, 7, 5) (255, 7, 5)


	mse:0.06539275497198105, mae:0.09686707705259323, dtw:Not calculated


                                                                                          [I 2025-10-17 05:07:02,366] Trial 26 finished with value: 0.09686707705259323 and parameters: {'seq_len': 48, 'pred_len': 7, 'expand': 2, 'd_model': 64, 'n_heads': 8, 'e_layers': 2, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0009437786043971697, 'dropout': 0.23356351359603789}. Best is trial 5 with value: 0.07396138459444046.
Best trial: 5. Best value: 0.0739614:  52%|█████▏    | 26/50 [1:14:58<1:09:51, 174.66s/it]Best trial: 5. Best value: 0.0739614:  52%|█████▏    | 26/50 [1:14:58<1:09:51, 174.66s/it]Best trial: 5. Best value: 0.0739614:  54%|█████▍    | 27/50 [1:14:58<1:02:20, 162.65s/it]
============================================================
Trial 27
============================================================
seq_len: 96, pred_len: 14
d_model: 32, n_heads: 4
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000354
dropout: 0.18076937616172917
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 32, expand: 1
>>>>>> Start training: trial_27 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 14
============================================================
train 4564
val 246
test 248
Validation loss decreased (inf --> 0.038541).  Saving model ...
Updating learning rate to 0.00035377222498117846
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00017688611249058923
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.844305624529462e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.422152812264731e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2110764061323654e-05
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1055382030661827e-05
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.5276910153309135e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7638455076654567e-06
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3819227538327284e-06
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.909613769163642e-07
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.454806884581821e-07
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.7274034422909105e-07
EarlyStopping counter: 12 out of 100
Updating learning rate to 8.637017211454552e-08
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.318508605727276e-08
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.159254302863638e-08
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.079627151431819e-08
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.398135757159095e-09
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.6990678785795476e-09
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.3495339392897738e-09
EarlyStopping counter: 19 out of 100
Updating learning rate to 6.747669696448869e-10
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.3738348482244345e-10
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.6869174241122172e-10
EarlyStopping counter: 22 out of 100
Updating learning rate to 8.434587120561086e-11
EarlyStopping counter: 23 out of 100
Updating learning rate to 4.217293560280543e-11
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.1086467801402716e-11
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.0543233900701358e-11
EarlyStopping counter: 26 out of 100
Updating learning rate to 5.271616950350679e-12
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.6358084751753395e-12
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.3179042375876697e-12
EarlyStopping counter: 29 out of 100
Updating learning rate to 6.589521187938349e-13
EarlyStopping counter: 30 out of 100
Updating learning rate to 3.2947605939691743e-13
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.6473802969845872e-13
EarlyStopping counter: 32 out of 100
Updating learning rate to 8.236901484922936e-14
EarlyStopping counter: 33 out of 100
Updating learning rate to 4.118450742461468e-14
EarlyStopping counter: 34 out of 100
Updating learning rate to 2.059225371230734e-14
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.029612685615367e-14
EarlyStopping counter: 36 out of 100
Updating learning rate to 5.148063428076835e-15
EarlyStopping counter: 37 out of 100
Updating learning rate to 2.5740317140384174e-15
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.2870158570192087e-15
EarlyStopping counter: 39 out of 100
Updating learning rate to 6.435079285096044e-16
EarlyStopping counter: 40 out of 100
Updating learning rate to 3.217539642548022e-16
EarlyStopping counter: 41 out of 100
Updating learning rate to 1.608769821274011e-16
EarlyStopping counter: 42 out of 100
Updating learning rate to 8.043849106370054e-17
EarlyStopping counter: 43 out of 100
Updating learning rate to 4.021924553185027e-17
EarlyStopping counter: 44 out of 100
Updating learning rate to 2.0109622765925136e-17
EarlyStopping counter: 45 out of 100
Updating learning rate to 1.0054811382962568e-17
EarlyStopping counter: 46 out of 100
Updating learning rate to 5.027405691481284e-18
EarlyStopping counter: 47 out of 100
Updating learning rate to 2.513702845740642e-18
EarlyStopping counter: 48 out of 100
Updating learning rate to 1.256851422870321e-18
EarlyStopping counter: 49 out of 100
Updating learning rate to 6.284257114351605e-19
EarlyStopping counter: 50 out of 100
Updating learning rate to 3.1421285571758025e-19
EarlyStopping counter: 51 out of 100
Updating learning rate to 1.5710642785879013e-19
EarlyStopping counter: 52 out of 100
Updating learning rate to 7.855321392939506e-20
EarlyStopping counter: 53 out of 100
Updating learning rate to 3.927660696469753e-20
EarlyStopping counter: 54 out of 100
Updating learning rate to 1.9638303482348766e-20
EarlyStopping counter: 55 out of 100
Updating learning rate to 9.819151741174383e-21
EarlyStopping counter: 56 out of 100
Updating learning rate to 4.9095758705871915e-21
EarlyStopping counter: 57 out of 100
Updating learning rate to 2.4547879352935957e-21
EarlyStopping counter: 58 out of 100
Updating learning rate to 1.2273939676467979e-21
EarlyStopping counter: 59 out of 100
Updating learning rate to 6.136969838233989e-22
EarlyStopping counter: 60 out of 100
Updating learning rate to 3.0684849191169947e-22
EarlyStopping counter: 61 out of 100
Updating learning rate to 1.5342424595584973e-22
EarlyStopping counter: 62 out of 100
Updating learning rate to 7.671212297792487e-23
EarlyStopping counter: 63 out of 100
Updating learning rate to 3.8356061488962433e-23
EarlyStopping counter: 64 out of 100
Updating learning rate to 1.9178030744481217e-23
EarlyStopping counter: 65 out of 100
Updating learning rate to 9.589015372240608e-24
EarlyStopping counter: 66 out of 100
Updating learning rate to 4.794507686120304e-24
EarlyStopping counter: 67 out of 100
Updating learning rate to 2.397253843060152e-24
EarlyStopping counter: 68 out of 100
Updating learning rate to 1.198626921530076e-24
EarlyStopping counter: 69 out of 100
Updating learning rate to 5.99313460765038e-25
EarlyStopping counter: 70 out of 100
Updating learning rate to 2.99656730382519e-25
EarlyStopping counter: 71 out of 100
Updating learning rate to 1.498283651912595e-25
EarlyStopping counter: 72 out of 100
Updating learning rate to 7.491418259562975e-26
EarlyStopping counter: 73 out of 100
Updating learning rate to 3.7457091297814876e-26
EarlyStopping counter: 74 out of 100
Updating learning rate to 1.8728545648907438e-26
EarlyStopping counter: 75 out of 100
Updating learning rate to 9.364272824453719e-27
EarlyStopping counter: 76 out of 100
Updating learning rate to 4.6821364122268595e-27
EarlyStopping counter: 77 out of 100
Updating learning rate to 2.3410682061134298e-27
EarlyStopping counter: 78 out of 100
Updating learning rate to 1.1705341030567149e-27
EarlyStopping counter: 79 out of 100
Updating learning rate to 5.852670515283574e-28
EarlyStopping counter: 80 out of 100
Updating learning rate to 2.926335257641787e-28
EarlyStopping counter: 81 out of 100
Updating learning rate to 1.4631676288208936e-28
EarlyStopping counter: 82 out of 100
Updating learning rate to 7.315838144104468e-29
EarlyStopping counter: 83 out of 100
Updating learning rate to 3.657919072052234e-29
EarlyStopping counter: 84 out of 100
Updating learning rate to 1.828959536026117e-29
EarlyStopping counter: 85 out of 100
Updating learning rate to 9.144797680130585e-30
EarlyStopping counter: 86 out of 100
Updating learning rate to 4.5723988400652925e-30
EarlyStopping counter: 87 out of 100
Updating learning rate to 2.2861994200326463e-30
EarlyStopping counter: 88 out of 100
Updating learning rate to 1.1430997100163231e-30
EarlyStopping counter: 89 out of 100
Updating learning rate to 5.715498550081616e-31
EarlyStopping counter: 90 out of 100
Updating learning rate to 2.857749275040808e-31
EarlyStopping counter: 91 out of 100
Updating learning rate to 1.428874637520404e-31
EarlyStopping counter: 92 out of 100
Updating learning rate to 7.14437318760202e-32
EarlyStopping counter: 93 out of 100
Updating learning rate to 3.57218659380101e-32
EarlyStopping counter: 94 out of 100
Updating learning rate to 1.786093296900505e-32
EarlyStopping counter: 95 out of 100
Updating learning rate to 8.930466484502524e-33
EarlyStopping counter: 96 out of 100
Updating learning rate to 4.465233242251262e-33
EarlyStopping counter: 97 out of 100
Updating learning rate to 2.232616621125631e-33
EarlyStopping counter: 98 out of 100
Updating learning rate to 1.1163083105628156e-33
EarlyStopping counter: 99 out of 100
Updating learning rate to 5.581541552814078e-34
>>>>>> Testing on validation set: trial_27 >>>>>>
test 248
test shape: (248, 14, 5) (248, 14, 5)
test shape: (248, 14, 5) (248, 14, 5)


	mse:0.06909581273794174, mae:0.11128410696983337, dtw:Not calculated


                                                                                          [I 2025-10-17 05:09:14,443] Trial 27 finished with value: 0.11128410696983337 and parameters: {'seq_len': 96, 'pred_len': 14, 'expand': 1, 'd_model': 32, 'n_heads': 4, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.00035377222498117846, 'dropout': 0.18076937616172917}. Best is trial 5 with value: 0.07396138459444046.
Best trial: 5. Best value: 0.0739614:  54%|█████▍    | 27/50 [1:17:10<1:02:20, 162.65s/it]Best trial: 5. Best value: 0.0739614:  54%|█████▍    | 27/50 [1:17:10<1:02:20, 162.65s/it]Best trial: 5. Best value: 0.0739614:  56%|█████▌    | 28/50 [1:17:10<56:16, 153.48s/it]  
============================================================
Trial 28
============================================================
seq_len: 48, pred_len: 30
d_model: 32, n_heads: 8
e_layers: 2, d_layers: 1
batch_size: 16, lr: 0.000596
dropout: 0.06925698097319331
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 64, expand: 2
>>>>>> Start training: trial_28 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 30
============================================================
train 4596
val 230
test 232
Validation loss decreased (inf --> 0.038209).  Saving model ...
Updating learning rate to 0.0005964590913674975
Validation loss decreased (0.038209 --> 0.036952).  Saving model ...
Updating learning rate to 0.00029822954568374874
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00014911477284187437
Validation loss decreased (0.036952 --> 0.036826).  Saving model ...
Updating learning rate to 7.455738642093718e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.727869321046859e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8639346605234296e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.319673302617148e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.659836651308574e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.329918325654287e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1649591628271435e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.824795814135718e-07
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.912397907067859e-07
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4561989535339294e-07
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.280994767669647e-08
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.6404973838348234e-08
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.8202486919174117e-08
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.101243459587059e-09
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.550621729793529e-09
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.2753108648967647e-09
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.1376554324483823e-09
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.688277162241912e-10
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.844138581120956e-10
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.422069290560478e-10
EarlyStopping counter: 20 out of 100
Updating learning rate to 7.11034645280239e-11
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.555173226401195e-11
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.7775866132005974e-11
EarlyStopping counter: 23 out of 100
Updating learning rate to 8.887933066002987e-12
EarlyStopping counter: 24 out of 100
Updating learning rate to 4.4439665330014935e-12
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.2219832665007467e-12
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.1109916332503734e-12
Validation loss decreased (0.036826 --> 0.036694).  Saving model ...
Updating learning rate to 5.554958166251867e-13
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7774790831259334e-13
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3887395415629667e-13
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.943697707814834e-14
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.471848853907417e-14
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.7359244269537084e-14
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.679622134768542e-15
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.339811067384271e-15
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.1699055336921355e-15
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.0849527668460677e-15
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.424763834230339e-16
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7123819171151694e-16
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.3561909585575847e-16
EarlyStopping counter: 13 out of 100
Updating learning rate to 6.780954792787923e-17
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.3904773963939617e-17
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.6952386981969808e-17
EarlyStopping counter: 16 out of 100
Updating learning rate to 8.476193490984904e-18
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.238096745492452e-18
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.119048372746226e-18
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.059524186373113e-18
EarlyStopping counter: 20 out of 100
Updating learning rate to 5.297620931865565e-19
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.6488104659327826e-19
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.3244052329663913e-19
EarlyStopping counter: 23 out of 100
Updating learning rate to 6.622026164831956e-20
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.311013082415978e-20
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.655506541207989e-20
EarlyStopping counter: 26 out of 100
Updating learning rate to 8.277532706039946e-21
EarlyStopping counter: 27 out of 100
Updating learning rate to 4.138766353019973e-21
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.0693831765099864e-21
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.0346915882549932e-21
EarlyStopping counter: 30 out of 100
Updating learning rate to 5.173457941274966e-22
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.586728970637483e-22
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.2933644853187415e-22
EarlyStopping counter: 33 out of 100
Updating learning rate to 6.466822426593707e-23
EarlyStopping counter: 34 out of 100
Updating learning rate to 3.233411213296854e-23
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.616705606648427e-23
EarlyStopping counter: 36 out of 100
Updating learning rate to 8.083528033242134e-24
EarlyStopping counter: 37 out of 100
Updating learning rate to 4.041764016621067e-24
EarlyStopping counter: 38 out of 100
Updating learning rate to 2.0208820083105336e-24
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.0104410041552668e-24
EarlyStopping counter: 40 out of 100
Updating learning rate to 5.052205020776334e-25
EarlyStopping counter: 41 out of 100
Updating learning rate to 2.526102510388167e-25
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.2630512551940835e-25
EarlyStopping counter: 43 out of 100
Updating learning rate to 6.315256275970417e-26
EarlyStopping counter: 44 out of 100
Updating learning rate to 3.157628137985209e-26
EarlyStopping counter: 45 out of 100
Updating learning rate to 1.5788140689926044e-26
EarlyStopping counter: 46 out of 100
Updating learning rate to 7.894070344963022e-27
EarlyStopping counter: 47 out of 100
Updating learning rate to 3.947035172481511e-27
EarlyStopping counter: 48 out of 100
Updating learning rate to 1.9735175862407554e-27
EarlyStopping counter: 49 out of 100
Updating learning rate to 9.867587931203777e-28
EarlyStopping counter: 50 out of 100
Updating learning rate to 4.933793965601889e-28
EarlyStopping counter: 51 out of 100
Updating learning rate to 2.4668969828009443e-28
EarlyStopping counter: 52 out of 100
Updating learning rate to 1.2334484914004722e-28
EarlyStopping counter: 53 out of 100
Updating learning rate to 6.167242457002361e-29
EarlyStopping counter: 54 out of 100
Updating learning rate to 3.0836212285011804e-29
EarlyStopping counter: 55 out of 100
Updating learning rate to 1.5418106142505902e-29
EarlyStopping counter: 56 out of 100
Updating learning rate to 7.709053071252951e-30
EarlyStopping counter: 57 out of 100
Updating learning rate to 3.8545265356264755e-30
EarlyStopping counter: 58 out of 100
Updating learning rate to 1.9272632678132377e-30
EarlyStopping counter: 59 out of 100
Updating learning rate to 9.636316339066189e-31
EarlyStopping counter: 60 out of 100
Updating learning rate to 4.818158169533094e-31
EarlyStopping counter: 61 out of 100
Updating learning rate to 2.409079084766547e-31
EarlyStopping counter: 62 out of 100
Updating learning rate to 1.2045395423832736e-31
EarlyStopping counter: 63 out of 100
Updating learning rate to 6.022697711916368e-32
EarlyStopping counter: 64 out of 100
Updating learning rate to 3.011348855958184e-32
EarlyStopping counter: 65 out of 100
Updating learning rate to 1.505674427979092e-32
EarlyStopping counter: 66 out of 100
Updating learning rate to 7.52837213989546e-33
EarlyStopping counter: 67 out of 100
Updating learning rate to 3.76418606994773e-33
EarlyStopping counter: 68 out of 100
Updating learning rate to 1.882093034973865e-33
EarlyStopping counter: 69 out of 100
Updating learning rate to 9.410465174869325e-34
>>>>>> Testing on validation set: trial_28 >>>>>>
test 232
test shape: (232, 30, 5) (232, 30, 5)
test shape: (232, 30, 5) (232, 30, 5)


	mse:0.0715087503194809, mae:0.11164356023073196, dtw:Not calculated


                                                                                        [I 2025-10-17 05:13:35,886] Trial 28 finished with value: 0.11164356023073196 and parameters: {'seq_len': 48, 'pred_len': 30, 'expand': 2, 'd_model': 32, 'n_heads': 8, 'e_layers': 2, 'd_layers': 1, 'batch_size': 16, 'learning_rate': 0.0005964590913674975, 'dropout': 0.06925698097319331}. Best is trial 5 with value: 0.07396138459444046.
Best trial: 5. Best value: 0.0739614:  56%|█████▌    | 28/50 [1:21:31<56:16, 153.48s/it]Best trial: 5. Best value: 0.0739614:  56%|█████▌    | 28/50 [1:21:32<56:16, 153.48s/it]Best trial: 5. Best value: 0.0739614:  58%|█████▊    | 29/50 [1:21:32<1:05:03, 185.87s/it]
============================================================
Trial 29
============================================================
seq_len: 48, pred_len: 14
d_model: 32, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 64, lr: 0.000396
dropout: 0.0025942817848493838
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 32, expand: 1
>>>>>> Start training: trial_29 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 14
============================================================
train 4612
val 246
test 248
Validation loss decreased (inf --> 0.039635).  Saving model ...
Updating learning rate to 0.00039551379268442706
Validation loss decreased (0.039635 --> 0.039325).  Saving model ...
Updating learning rate to 0.00019775689634221353
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.887844817110676e-05
Validation loss decreased (0.039325 --> 0.039147).  Saving model ...
Updating learning rate to 4.943922408555338e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.471961204277669e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2359806021388345e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.179903010694173e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.0899515053470864e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.5449757526735432e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.724878763367716e-07
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.862439381683858e-07
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.931219690841929e-07
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.656098454209645e-08
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.8280492271048225e-08
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.4140246135524112e-08
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.2070123067762056e-08
EarlyStopping counter: 13 out of 100
Updating learning rate to 6.035061533881028e-09
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.017530766940514e-09
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.508765383470257e-09
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.543826917351285e-10
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.7719134586756425e-10
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.8859567293378213e-10
EarlyStopping counter: 19 out of 100
Updating learning rate to 9.429783646689106e-11
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.714891823344553e-11
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.3574459116722766e-11
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.1787229558361383e-11
EarlyStopping counter: 23 out of 100
Updating learning rate to 5.8936147791806915e-12
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.9468073895903457e-12
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.4734036947951729e-12
EarlyStopping counter: 26 out of 100
Updating learning rate to 7.367018473975864e-13
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.683509236987932e-13
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.841754618493966e-13
EarlyStopping counter: 29 out of 100
Updating learning rate to 9.20877309246983e-14
EarlyStopping counter: 30 out of 100
Updating learning rate to 4.604386546234915e-14
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.3021932731174576e-14
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.1510966365587288e-14
EarlyStopping counter: 33 out of 100
Updating learning rate to 5.755483182793644e-15
EarlyStopping counter: 34 out of 100
Updating learning rate to 2.877741591396822e-15
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.438870795698411e-15
EarlyStopping counter: 36 out of 100
Updating learning rate to 7.194353978492055e-16
EarlyStopping counter: 37 out of 100
Updating learning rate to 3.5971769892460275e-16
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.7985884946230138e-16
EarlyStopping counter: 39 out of 100
Updating learning rate to 8.992942473115069e-17
EarlyStopping counter: 40 out of 100
Updating learning rate to 4.4964712365575344e-17
EarlyStopping counter: 41 out of 100
Updating learning rate to 2.2482356182787672e-17
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.1241178091393836e-17
EarlyStopping counter: 43 out of 100
Updating learning rate to 5.620589045696918e-18
EarlyStopping counter: 44 out of 100
Updating learning rate to 2.810294522848459e-18
EarlyStopping counter: 45 out of 100
Updating learning rate to 1.4051472614242295e-18
EarlyStopping counter: 46 out of 100
Updating learning rate to 7.0257363071211475e-19
EarlyStopping counter: 47 out of 100
Updating learning rate to 3.5128681535605737e-19
EarlyStopping counter: 48 out of 100
Updating learning rate to 1.7564340767802869e-19
EarlyStopping counter: 49 out of 100
Updating learning rate to 8.782170383901434e-20
EarlyStopping counter: 50 out of 100
Updating learning rate to 4.391085191950717e-20
EarlyStopping counter: 51 out of 100
Updating learning rate to 2.1955425959753586e-20
EarlyStopping counter: 52 out of 100
Updating learning rate to 1.0977712979876793e-20
EarlyStopping counter: 53 out of 100
Updating learning rate to 5.4888564899383965e-21
EarlyStopping counter: 54 out of 100
Updating learning rate to 2.7444282449691982e-21
EarlyStopping counter: 55 out of 100
Updating learning rate to 1.3722141224845991e-21
EarlyStopping counter: 56 out of 100
Updating learning rate to 6.861070612422996e-22
EarlyStopping counter: 57 out of 100
Updating learning rate to 3.430535306211498e-22
EarlyStopping counter: 58 out of 100
Updating learning rate to 1.715267653105749e-22
EarlyStopping counter: 59 out of 100
Updating learning rate to 8.576338265528744e-23
EarlyStopping counter: 60 out of 100
Updating learning rate to 4.288169132764372e-23
EarlyStopping counter: 61 out of 100
Updating learning rate to 2.144084566382186e-23
EarlyStopping counter: 62 out of 100
Updating learning rate to 1.072042283191093e-23
EarlyStopping counter: 63 out of 100
Updating learning rate to 5.360211415955465e-24
EarlyStopping counter: 64 out of 100
Updating learning rate to 2.6801057079777327e-24
EarlyStopping counter: 65 out of 100
Updating learning rate to 1.3400528539888663e-24
EarlyStopping counter: 66 out of 100
Updating learning rate to 6.700264269944332e-25
EarlyStopping counter: 67 out of 100
Updating learning rate to 3.350132134972166e-25
EarlyStopping counter: 68 out of 100
Updating learning rate to 1.675066067486083e-25
EarlyStopping counter: 69 out of 100
Updating learning rate to 8.375330337430415e-26
EarlyStopping counter: 70 out of 100
Updating learning rate to 4.187665168715207e-26
EarlyStopping counter: 71 out of 100
Updating learning rate to 2.0938325843576036e-26
EarlyStopping counter: 72 out of 100
Updating learning rate to 1.0469162921788018e-26
EarlyStopping counter: 73 out of 100
Updating learning rate to 5.234581460894009e-27
EarlyStopping counter: 74 out of 100
Updating learning rate to 2.6172907304470045e-27
EarlyStopping counter: 75 out of 100
Updating learning rate to 1.3086453652235023e-27
EarlyStopping counter: 76 out of 100
Updating learning rate to 6.543226826117511e-28
EarlyStopping counter: 77 out of 100
Updating learning rate to 3.2716134130587557e-28
EarlyStopping counter: 78 out of 100
Updating learning rate to 1.6358067065293778e-28
EarlyStopping counter: 79 out of 100
Updating learning rate to 8.179033532646889e-29
EarlyStopping counter: 80 out of 100
Updating learning rate to 4.0895167663234446e-29
EarlyStopping counter: 81 out of 100
Updating learning rate to 2.0447583831617223e-29
EarlyStopping counter: 82 out of 100
Updating learning rate to 1.0223791915808611e-29
EarlyStopping counter: 83 out of 100
Updating learning rate to 5.111895957904306e-30
EarlyStopping counter: 84 out of 100
Updating learning rate to 2.555947978952153e-30
EarlyStopping counter: 85 out of 100
Updating learning rate to 1.2779739894760764e-30
EarlyStopping counter: 86 out of 100
Updating learning rate to 6.389869947380382e-31
EarlyStopping counter: 87 out of 100
Updating learning rate to 3.194934973690191e-31
EarlyStopping counter: 88 out of 100
Updating learning rate to 1.5974674868450955e-31
EarlyStopping counter: 89 out of 100
Updating learning rate to 7.987337434225478e-32
EarlyStopping counter: 90 out of 100
Updating learning rate to 3.993668717112739e-32
EarlyStopping counter: 91 out of 100
Updating learning rate to 1.9968343585563694e-32
EarlyStopping counter: 92 out of 100
Updating learning rate to 9.984171792781847e-33
EarlyStopping counter: 93 out of 100
Updating learning rate to 4.9920858963909236e-33
EarlyStopping counter: 94 out of 100
Updating learning rate to 2.4960429481954618e-33
EarlyStopping counter: 95 out of 100
Updating learning rate to 1.2480214740977309e-33
EarlyStopping counter: 96 out of 100
Updating learning rate to 6.2401073704886545e-34
>>>>>> Testing on validation set: trial_29 >>>>>>
test 248
test shape: (248, 14, 5) (248, 14, 5)
test shape: (248, 14, 5) (248, 14, 5)


	mse:0.06696499139070511, mae:0.10123718529939651, dtw:Not calculated


                                                                                          [I 2025-10-17 05:14:43,696] Trial 29 finished with value: 0.10123718529939651 and parameters: {'seq_len': 48, 'pred_len': 14, 'expand': 1, 'd_model': 32, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 64, 'learning_rate': 0.00039551379268442706, 'dropout': 0.0025942817848493838}. Best is trial 5 with value: 0.07396138459444046.
Best trial: 5. Best value: 0.0739614:  58%|█████▊    | 29/50 [1:22:39<1:05:03, 185.87s/it]Best trial: 5. Best value: 0.0739614:  58%|█████▊    | 29/50 [1:22:39<1:05:03, 185.87s/it]Best trial: 5. Best value: 0.0739614:  60%|██████    | 30/50 [1:22:39<50:08, 150.45s/it]  
============================================================
Trial 30
============================================================
seq_len: 48, pred_len: 1
d_model: 32, n_heads: 8
e_layers: 2, d_layers: 1
batch_size: 16, lr: 0.000010
dropout: 0.13878654392985712
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 64, expand: 2
>>>>>> Start training: trial_30 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.033738).  Saving model ...
Updating learning rate to 1.0381900532794156e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.190950266397078e-06
Validation loss decreased (0.033738 --> 0.032846).  Saving model ...
Updating learning rate to 2.595475133198539e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2977375665992694e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.488687832996347e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.2443439164981736e-07
Validation loss decreased (0.032846 --> 0.032753).  Saving model ...
Updating learning rate to 1.6221719582490868e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.110859791245434e-08
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.055429895622717e-08
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0277149478113585e-08
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0138574739056793e-08
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.069287369528396e-09
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.534643684764198e-09
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.267321842382099e-09
Validation loss decreased (0.032753 --> 0.032727).  Saving model ...
Updating learning rate to 6.336609211910495e-10
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.1683046059552477e-10
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5841523029776238e-10
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.920761514888119e-11
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.9603807574440596e-11
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.9801903787220298e-11
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.900951893610149e-12
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.9504759468050745e-12
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.4752379734025372e-12
Validation loss decreased (0.032727 --> 0.032716).  Saving model ...
Updating learning rate to 1.2376189867012686e-12
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.188094933506343e-13
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.0940474667531715e-13
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5470237333765858e-13
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.735118666882929e-14
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.8675593334414644e-14
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.9337796667207322e-14
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.668898333603661e-15
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.8344491668018305e-15
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.4172245834009153e-15
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.2086122917004576e-15
Validation loss decreased (0.032716 --> 0.032690).  Saving model ...
Updating learning rate to 6.043061458502288e-16
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.021530729251144e-16
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.510765364625572e-16
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.55382682312786e-17
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.77691341156393e-17
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.888456705781965e-17
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.442283528909825e-18
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.721141764454913e-18
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.3605708822274563e-18
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.1802854411137282e-18
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.901427205568641e-19
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.9507136027843204e-19
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.4753568013921602e-19
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.376784006960801e-20
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.6883920034804005e-20
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.8441960017402002e-20
EarlyStopping counter: 16 out of 100
Updating learning rate to 9.220980008701001e-21
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.6104900043505006e-21
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.3052450021752503e-21
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.1526225010876252e-21
EarlyStopping counter: 20 out of 100
Updating learning rate to 5.763112505438126e-22
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.881556252719063e-22
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.4407781263595314e-22
EarlyStopping counter: 23 out of 100
Updating learning rate to 7.203890631797657e-23
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.6019453158988286e-23
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.8009726579494143e-23
EarlyStopping counter: 26 out of 100
Updating learning rate to 9.004863289747072e-24
EarlyStopping counter: 27 out of 100
Updating learning rate to 4.502431644873536e-24
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.251215822436768e-24
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.125607911218384e-24
EarlyStopping counter: 30 out of 100
Updating learning rate to 5.62803955609192e-25
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.81401977804596e-25
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.40700988902298e-25
EarlyStopping counter: 33 out of 100
Updating learning rate to 7.0350494451149e-26
EarlyStopping counter: 34 out of 100
Updating learning rate to 3.51752472255745e-26
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.758762361278725e-26
EarlyStopping counter: 36 out of 100
Updating learning rate to 8.793811806393625e-27
EarlyStopping counter: 37 out of 100
Updating learning rate to 4.396905903196812e-27
EarlyStopping counter: 38 out of 100
Updating learning rate to 2.198452951598406e-27
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.099226475799203e-27
EarlyStopping counter: 40 out of 100
Updating learning rate to 5.496132378996015e-28
EarlyStopping counter: 41 out of 100
Updating learning rate to 2.7480661894980077e-28
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.3740330947490038e-28
EarlyStopping counter: 43 out of 100
Updating learning rate to 6.870165473745019e-29
EarlyStopping counter: 44 out of 100
Updating learning rate to 3.4350827368725096e-29
EarlyStopping counter: 45 out of 100
Updating learning rate to 1.7175413684362548e-29
EarlyStopping counter: 46 out of 100
Updating learning rate to 8.587706842181274e-30
EarlyStopping counter: 47 out of 100
Updating learning rate to 4.293853421090637e-30
EarlyStopping counter: 48 out of 100
Updating learning rate to 2.1469267105453185e-30
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.0734633552726592e-30
Validation loss decreased (0.032690 --> 0.032656).  Saving model ...
Updating learning rate to 5.367316776363296e-31
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.683658388181648e-31
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.341829194090824e-31
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.70914597045412e-32
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.35457298522706e-32
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.67728649261353e-32
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.38643246306765e-33
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.193216231533825e-33
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0966081157669126e-33
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.0483040578834563e-33
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.2415202894172815e-34
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.6207601447086407e-34
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.3103800723543204e-34
EarlyStopping counter: 13 out of 100
Updating learning rate to 6.551900361771602e-35
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.275950180885801e-35
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.6379750904429005e-35
>>>>>> Testing on validation set: trial_30 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.06050746515393257, mae:0.0936061218380928, dtw:Not calculated


                                                                                        [I 2025-10-17 05:19:07,141] Trial 30 finished with value: 0.0936061218380928 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 2, 'd_model': 32, 'n_heads': 8, 'e_layers': 2, 'd_layers': 1, 'batch_size': 16, 'learning_rate': 1.0381900532794156e-05, 'dropout': 0.13878654392985712}. Best is trial 5 with value: 0.07396138459444046.
Best trial: 5. Best value: 0.0739614:  60%|██████    | 30/50 [1:27:03<50:08, 150.45s/it]Best trial: 5. Best value: 0.0739614:  60%|██████    | 30/50 [1:27:03<50:08, 150.45s/it]Best trial: 5. Best value: 0.0739614:  62%|██████▏   | 31/50 [1:27:03<58:22, 184.35s/it]
============================================================
Trial 31
============================================================
seq_len: 48, pred_len: 1
d_model: 32, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000704
dropout: 0.09578363653995765
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 32, expand: 1
>>>>>> Start training: trial_31 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.027427).  Saving model ...
Updating learning rate to 0.0007037655356597963
Validation loss decreased (0.027427 --> 0.024732).  Saving model ...
Updating learning rate to 0.00035188276782989816
Validation loss decreased (0.024732 --> 0.023510).  Saving model ...
Updating learning rate to 0.00017594138391494908
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.797069195747454e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.398534597873727e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.1992672989368635e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0996336494684318e-05
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.498168247342159e-06
Validation loss decreased (0.023510 --> 0.023144).  Saving model ...
Updating learning rate to 2.7490841236710794e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3745420618355397e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.872710309177698e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.436355154588849e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.7181775772944246e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.590887886472123e-08
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.2954439432360616e-08
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.1477219716180308e-08
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.0738609858090154e-08
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.369304929045077e-09
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.6846524645225385e-09
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.3423262322612692e-09
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.711631161306346e-10
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.355815580653173e-10
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.6779077903265865e-10
Validation loss decreased (0.023144 --> 0.023096).  Saving model ...
Updating learning rate to 8.389538951632933e-11
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.1947694758164664e-11
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0973847379082332e-11
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0486923689541166e-11
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.243461844770583e-12
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.6217309223852915e-12
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3108654611926457e-12
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.554327305963229e-13
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.2771636529816144e-13
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.6385818264908072e-13
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.192909132454036e-14
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.096454566227018e-14
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.048227283113509e-14
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.0241136415567545e-14
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.1205682077837724e-15
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.5602841038918862e-15
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.2801420519459431e-15
EarlyStopping counter: 17 out of 100
Updating learning rate to 6.400710259729716e-16
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.200355129864858e-16
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.600177564932429e-16
EarlyStopping counter: 20 out of 100
Updating learning rate to 8.000887824662144e-17
EarlyStopping counter: 21 out of 100
Updating learning rate to 4.000443912331072e-17
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.000221956165536e-17
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.000110978082768e-17
EarlyStopping counter: 24 out of 100
Updating learning rate to 5.00055489041384e-18
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.50027744520692e-18
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.25013872260346e-18
EarlyStopping counter: 27 out of 100
Updating learning rate to 6.2506936130173e-19
EarlyStopping counter: 28 out of 100
Updating learning rate to 3.12534680650865e-19
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.562673403254325e-19
EarlyStopping counter: 30 out of 100
Updating learning rate to 7.813367016271625e-20
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.906683508135813e-20
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.9533417540679064e-20
EarlyStopping counter: 33 out of 100
Updating learning rate to 9.766708770339532e-21
EarlyStopping counter: 34 out of 100
Updating learning rate to 4.883354385169766e-21
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.441677192584883e-21
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.2208385962924415e-21
EarlyStopping counter: 37 out of 100
Updating learning rate to 6.104192981462207e-22
EarlyStopping counter: 38 out of 100
Updating learning rate to 3.0520964907311037e-22
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.5260482453655518e-22
EarlyStopping counter: 40 out of 100
Updating learning rate to 7.630241226827759e-23
EarlyStopping counter: 41 out of 100
Updating learning rate to 3.8151206134138796e-23
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.9075603067069398e-23
EarlyStopping counter: 43 out of 100
Updating learning rate to 9.537801533534699e-24
EarlyStopping counter: 44 out of 100
Updating learning rate to 4.7689007667673495e-24
EarlyStopping counter: 45 out of 100
Updating learning rate to 2.3844503833836747e-24
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.1922251916918374e-24
EarlyStopping counter: 47 out of 100
Updating learning rate to 5.961125958459187e-25
EarlyStopping counter: 48 out of 100
Updating learning rate to 2.9805629792295934e-25
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.4902814896147967e-25
Validation loss decreased (0.023096 --> 0.023060).  Saving model ...
Updating learning rate to 7.451407448073984e-26
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.725703724036992e-26
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.862851862018496e-26
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.31425931009248e-27
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.65712965504624e-27
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.32856482752312e-27
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.16428241376156e-27
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.8214120688078e-28
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.9107060344039e-28
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.45535301720195e-28
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.27676508600975e-29
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.638382543004875e-29
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.8191912715024374e-29
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.095956357512187e-30
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.5479781787560935e-30
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.2739890893780467e-30
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.1369945446890234e-30
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.684972723445117e-31
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.8424863617225584e-31
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.4212431808612792e-31
EarlyStopping counter: 20 out of 100
Updating learning rate to 7.106215904306396e-32
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.553107952153198e-32
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.776553976076599e-32
EarlyStopping counter: 23 out of 100
Updating learning rate to 8.882769880382995e-33
EarlyStopping counter: 24 out of 100
Updating learning rate to 4.4413849401914975e-33
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.2206924700957488e-33
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.1103462350478744e-33
>>>>>> Testing on validation set: trial_31 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.04910025745630264, mae:0.07231102883815765, dtw:Not calculated


                                                                                        [I 2025-10-17 05:21:21,065] Trial 31 finished with value: 0.07231102883815765 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 1, 'd_model': 32, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0007037655356597963, 'dropout': 0.09578363653995765}. Best is trial 31 with value: 0.07231102883815765.
Best trial: 5. Best value: 0.0739614:  62%|██████▏   | 31/50 [1:29:17<58:22, 184.35s/it]Best trial: 31. Best value: 0.072311:  62%|██████▏   | 31/50 [1:29:17<58:22, 184.35s/it]Best trial: 31. Best value: 0.072311:  64%|██████▍   | 32/50 [1:29:17<50:45, 169.22s/it]
============================================================
Trial 32
============================================================
seq_len: 48, pred_len: 1
d_model: 32, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000705
dropout: 0.0860346746438784
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 32, expand: 1
>>>>>> Start training: trial_32 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.027838).  Saving model ...
Updating learning rate to 0.0007048413368465464
Validation loss decreased (0.027838 --> 0.025287).  Saving model ...
Updating learning rate to 0.0003524206684232732
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0001762103342116366
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.81051671058183e-05
Validation loss decreased (0.025287 --> 0.024951).  Saving model ...
Updating learning rate to 4.405258355290915e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2026291776454576e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1013145888227288e-05
Validation loss decreased (0.024951 --> 0.024850).  Saving model ...
Updating learning rate to 5.506572944113644e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.753286472056822e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.376643236028411e-06
Validation loss decreased (0.024850 --> 0.024395).  Saving model ...
Updating learning rate to 6.883216180142055e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4416080900710274e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.7208040450355137e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.604020225177569e-08
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.302010112588784e-08
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.151005056294392e-08
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.075502528147196e-08
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.37751264073598e-09
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.68875632036799e-09
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.344378160183995e-09
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.721890800919975e-10
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.3609454004599877e-10
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.6804727002299939e-10
EarlyStopping counter: 13 out of 100
Updating learning rate to 8.402363501149969e-11
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.2011817505749847e-11
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.1005908752874923e-11
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.0502954376437462e-11
Validation loss decreased (0.024395 --> 0.024264).  Saving model ...
Updating learning rate to 5.251477188218731e-12
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.6257385941093654e-12
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3128692970546827e-12
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.564346485273414e-13
Validation loss decreased (0.024264 --> 0.024239).  Saving model ...
Updating learning rate to 3.282173242636707e-13
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6410866213183534e-13
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.205433106591767e-14
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.1027165532958835e-14
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0513582766479417e-14
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0256791383239709e-14
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.128395691619854e-15
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.564197845809927e-15
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.2820989229049636e-15
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.410494614524818e-16
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.205247307262409e-16
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.6026236536312045e-16
EarlyStopping counter: 12 out of 100
Updating learning rate to 8.013118268156022e-17
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.006559134078011e-17
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.0032795670390056e-17
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.0016397835195028e-17
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.008198917597514e-18
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.504099458798757e-18
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.2520497293993785e-18
EarlyStopping counter: 19 out of 100
Updating learning rate to 6.2602486469968925e-19
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.1301243234984462e-19
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.5650621617492231e-19
EarlyStopping counter: 22 out of 100
Updating learning rate to 7.825310808746116e-20
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.912655404373058e-20
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.956327702186529e-20
EarlyStopping counter: 25 out of 100
Updating learning rate to 9.781638510932645e-21
EarlyStopping counter: 26 out of 100
Updating learning rate to 4.890819255466322e-21
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.445409627733161e-21
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.2227048138665806e-21
EarlyStopping counter: 29 out of 100
Updating learning rate to 6.113524069332903e-22
EarlyStopping counter: 30 out of 100
Updating learning rate to 3.0567620346664514e-22
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.5283810173332257e-22
EarlyStopping counter: 32 out of 100
Updating learning rate to 7.641905086666129e-23
EarlyStopping counter: 33 out of 100
Updating learning rate to 3.820952543333064e-23
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.910476271666532e-23
EarlyStopping counter: 35 out of 100
Updating learning rate to 9.55238135833266e-24
EarlyStopping counter: 36 out of 100
Updating learning rate to 4.77619067916633e-24
EarlyStopping counter: 37 out of 100
Updating learning rate to 2.388095339583165e-24
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.1940476697915826e-24
EarlyStopping counter: 39 out of 100
Updating learning rate to 5.970238348957913e-25
EarlyStopping counter: 40 out of 100
Updating learning rate to 2.9851191744789565e-25
EarlyStopping counter: 41 out of 100
Updating learning rate to 1.4925595872394782e-25
EarlyStopping counter: 42 out of 100
Updating learning rate to 7.462797936197391e-26
EarlyStopping counter: 43 out of 100
Updating learning rate to 3.7313989680986956e-26
EarlyStopping counter: 44 out of 100
Updating learning rate to 1.8656994840493478e-26
EarlyStopping counter: 45 out of 100
Updating learning rate to 9.328497420246739e-27
EarlyStopping counter: 46 out of 100
Updating learning rate to 4.6642487101233695e-27
EarlyStopping counter: 47 out of 100
Updating learning rate to 2.3321243550616847e-27
EarlyStopping counter: 48 out of 100
Updating learning rate to 1.1660621775308424e-27
EarlyStopping counter: 49 out of 100
Updating learning rate to 5.830310887654212e-28
EarlyStopping counter: 50 out of 100
Updating learning rate to 2.915155443827106e-28
EarlyStopping counter: 51 out of 100
Updating learning rate to 1.457577721913553e-28
Validation loss decreased (0.024239 --> 0.023997).  Saving model ...
Updating learning rate to 7.287888609567765e-29
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.6439443047838824e-29
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8219721523919412e-29
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.109860761959706e-30
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.554930380979853e-30
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2774651904899265e-30
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1387325952449632e-30
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.693662976224816e-31
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.846831488112408e-31
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.423415744056204e-31
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.11707872028102e-32
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.55853936014051e-32
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.779269680070255e-32
EarlyStopping counter: 13 out of 100
Updating learning rate to 8.896348400351275e-33
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.448174200175638e-33
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.224087100087819e-33
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.1120435500439094e-33
>>>>>> Testing on validation set: trial_32 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.053284741938114166, mae:0.0784730389714241, dtw:Not calculated


                                                                                        [I 2025-10-17 05:23:34,693] Trial 32 finished with value: 0.0784730389714241 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 1, 'd_model': 32, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0007048413368465464, 'dropout': 0.0860346746438784}. Best is trial 31 with value: 0.07231102883815765.
Best trial: 31. Best value: 0.072311:  64%|██████▍   | 32/50 [1:31:30<50:45, 169.22s/it]Best trial: 31. Best value: 0.072311:  64%|██████▍   | 32/50 [1:31:30<50:45, 169.22s/it]Best trial: 31. Best value: 0.072311:  66%|██████▌   | 33/50 [1:31:30<44:55, 158.55s/it]
============================================================
Trial 33
============================================================
seq_len: 48, pred_len: 1
d_model: 32, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000285
dropout: 0.05951221907938415
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 32, expand: 1
>>>>>> Start training: trial_33 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.027094).  Saving model ...
Updating learning rate to 0.00028520986000049917
Validation loss decreased (0.027094 --> 0.026530).  Saving model ...
Updating learning rate to 0.00014260493000024959
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.130246500012479e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.5651232500062397e-05
Validation loss decreased (0.026530 --> 0.025239).  Saving model ...
Updating learning rate to 1.7825616250031198e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.912808125015599e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.4564040625077996e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2282020312538998e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1141010156269499e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.570505078134749e-07
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7852525390673747e-07
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3926262695336874e-07
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.963131347668437e-08
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.4815656738342184e-08
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.7407828369171092e-08
Validation loss decreased (0.025239 --> 0.025172).  Saving model ...
Updating learning rate to 8.703914184585546e-09
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.351957092292773e-09
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.1759785461463865e-09
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0879892730731933e-09
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.439946365365966e-10
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.719973182682983e-10
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3599865913414916e-10
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.799932956707458e-11
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.399966478353729e-11
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.6999832391768645e-11
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.499916195884322e-12
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.249958097942161e-12
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.1249790489710806e-12
Validation loss decreased (0.025172 --> 0.024763).  Saving model ...
Updating learning rate to 1.0624895244855403e-12
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.312447622427701e-13
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.6562238112138507e-13
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3281119056069254e-13
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.640559528034627e-14
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.3202797640173134e-14
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6601398820086567e-14
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.300699410043283e-15
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.150349705021642e-15
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.075174852510821e-15
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.0375874262554104e-15
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.187937131277052e-16
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.593968565638526e-16
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.296984282819263e-16
EarlyStopping counter: 14 out of 100
Updating learning rate to 6.484921414096315e-17
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.2424607070481576e-17
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.6212303535240788e-17
EarlyStopping counter: 17 out of 100
Updating learning rate to 8.106151767620394e-18
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.053075883810197e-18
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.0265379419050985e-18
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.0132689709525493e-18
EarlyStopping counter: 21 out of 100
Updating learning rate to 5.066344854762746e-19
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.533172427381373e-19
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.2665862136906866e-19
EarlyStopping counter: 24 out of 100
Updating learning rate to 6.332931068453433e-20
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.1664655342267164e-20
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.5832327671133582e-20
EarlyStopping counter: 27 out of 100
Updating learning rate to 7.916163835566791e-21
EarlyStopping counter: 28 out of 100
Updating learning rate to 3.9580819177833955e-21
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.9790409588916978e-21
EarlyStopping counter: 30 out of 100
Updating learning rate to 9.895204794458489e-22
EarlyStopping counter: 31 out of 100
Updating learning rate to 4.947602397229244e-22
EarlyStopping counter: 32 out of 100
Updating learning rate to 2.473801198614622e-22
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.236900599307311e-22
EarlyStopping counter: 34 out of 100
Updating learning rate to 6.184502996536556e-23
EarlyStopping counter: 35 out of 100
Updating learning rate to 3.092251498268278e-23
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.546125749134139e-23
EarlyStopping counter: 37 out of 100
Updating learning rate to 7.730628745670694e-24
EarlyStopping counter: 38 out of 100
Updating learning rate to 3.865314372835347e-24
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.9326571864176736e-24
EarlyStopping counter: 40 out of 100
Updating learning rate to 9.663285932088368e-25
EarlyStopping counter: 41 out of 100
Updating learning rate to 4.831642966044184e-25
EarlyStopping counter: 42 out of 100
Updating learning rate to 2.415821483022092e-25
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.207910741511046e-25
EarlyStopping counter: 44 out of 100
Updating learning rate to 6.03955370755523e-26
EarlyStopping counter: 45 out of 100
Updating learning rate to 3.019776853777615e-26
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.5098884268888075e-26
EarlyStopping counter: 47 out of 100
Updating learning rate to 7.549442134444037e-27
Validation loss decreased (0.024763 --> 0.024710).  Saving model ...
Updating learning rate to 3.774721067222019e-27
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8873605336110094e-27
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.436802668055047e-28
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.718401334027523e-28
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.3592006670137617e-28
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1796003335068809e-28
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.898001667534404e-29
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.949000833767202e-29
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.474500416883601e-29
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.372502084418005e-30
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.686251042209003e-30
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.8431255211045013e-30
EarlyStopping counter: 12 out of 100
Updating learning rate to 9.215627605522507e-31
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.607813802761253e-31
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.3039069013806267e-31
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.1519534506903133e-31
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.759767253451567e-32
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.8798836267257833e-32
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.4399418133628917e-32
EarlyStopping counter: 19 out of 100
Updating learning rate to 7.199709066814458e-33
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.599854533407229e-33
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.7999272667036146e-33
EarlyStopping counter: 22 out of 100
Updating learning rate to 8.999636333518073e-34
EarlyStopping counter: 23 out of 100
Updating learning rate to 4.4998181667590365e-34
>>>>>> Testing on validation set: trial_33 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.0505778044462204, mae:0.08009828627109528, dtw:Not calculated


                                                                                        [I 2025-10-17 05:25:48,290] Trial 33 finished with value: 0.08009828627109528 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 1, 'd_model': 32, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.00028520986000049917, 'dropout': 0.05951221907938415}. Best is trial 31 with value: 0.07231102883815765.
Best trial: 31. Best value: 0.072311:  66%|██████▌   | 33/50 [1:33:44<44:55, 158.55s/it]Best trial: 31. Best value: 0.072311:  66%|██████▌   | 33/50 [1:33:44<44:55, 158.55s/it]Best trial: 31. Best value: 0.072311:  68%|██████▊   | 34/50 [1:33:44<40:16, 151.06s/it]
============================================================
Trial 34
============================================================
seq_len: 96, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000585
dropout: 0.1078576754627623
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_34 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 1
============================================================
train 4577
val 259
test 261
Validation loss decreased (inf --> 0.030440).  Saving model ...
Updating learning rate to 0.0005852045265552543
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00029260226327762717
Validation loss decreased (0.030440 --> 0.024070).  Saving model ...
Updating learning rate to 0.00014630113163881359
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.315056581940679e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.6575282909703397e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8287641454851698e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.143820727425849e-06
Validation loss decreased (0.024070 --> 0.024049).  Saving model ...
Updating learning rate to 4.5719103637129246e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2859551818564623e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1429775909282311e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.714887954641156e-07
Validation loss decreased (0.024049 --> 0.023967).  Saving model ...
Updating learning rate to 2.857443977320578e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.428721988660289e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.143609943301445e-08
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.571804971650722e-08
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.785902485825361e-08
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.929512429126806e-09
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.464756214563403e-09
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2323781072817014e-09
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.1161890536408507e-09
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.580945268204254e-10
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.790472634102127e-10
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.3952363170510634e-10
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.976181585255317e-11
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.4880907926276585e-11
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.7440453963138293e-11
EarlyStopping counter: 15 out of 100
Updating learning rate to 8.720226981569146e-12
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.360113490784573e-12
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.1800567453922866e-12
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.0900283726961433e-12
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.450141863480716e-13
Validation loss decreased (0.023967 --> 0.023961).  Saving model ...
Updating learning rate to 2.725070931740358e-13
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.362535465870179e-13
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.812677329350896e-14
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.406338664675448e-14
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.703169332337724e-14
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.51584666168862e-15
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.25792333084431e-15
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.128961665422155e-15
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.0644808327110774e-15
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.322404163555387e-16
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.6612020817776936e-16
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.3306010408888468e-16
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.653005204444234e-17
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.326502602222117e-17
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.6632513011110585e-17
EarlyStopping counter: 15 out of 100
Updating learning rate to 8.316256505555292e-18
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.158128252777646e-18
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.079064126388823e-18
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.0395320631944115e-18
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.197660315972058e-19
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.598830157986029e-19
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.2994150789930144e-19
EarlyStopping counter: 22 out of 100
Updating learning rate to 6.497075394965072e-20
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.248537697482536e-20
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.624268848741268e-20
EarlyStopping counter: 25 out of 100
Updating learning rate to 8.12134424370634e-21
EarlyStopping counter: 26 out of 100
Updating learning rate to 4.06067212185317e-21
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.030336060926585e-21
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.0151680304632925e-21
EarlyStopping counter: 29 out of 100
Updating learning rate to 5.075840152316463e-22
EarlyStopping counter: 30 out of 100
Updating learning rate to 2.5379200761582313e-22
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.2689600380791157e-22
EarlyStopping counter: 32 out of 100
Updating learning rate to 6.344800190395578e-23
EarlyStopping counter: 33 out of 100
Updating learning rate to 3.172400095197789e-23
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.5862000475988946e-23
EarlyStopping counter: 35 out of 100
Updating learning rate to 7.931000237994473e-24
EarlyStopping counter: 36 out of 100
Updating learning rate to 3.9655001189972364e-24
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.9827500594986182e-24
EarlyStopping counter: 38 out of 100
Updating learning rate to 9.913750297493091e-25
EarlyStopping counter: 39 out of 100
Updating learning rate to 4.956875148746546e-25
EarlyStopping counter: 40 out of 100
Updating learning rate to 2.478437574373273e-25
EarlyStopping counter: 41 out of 100
Updating learning rate to 1.2392187871866364e-25
EarlyStopping counter: 42 out of 100
Updating learning rate to 6.196093935933182e-26
EarlyStopping counter: 43 out of 100
Updating learning rate to 3.098046967966591e-26
EarlyStopping counter: 44 out of 100
Updating learning rate to 1.5490234839832955e-26
EarlyStopping counter: 45 out of 100
Updating learning rate to 7.745117419916477e-27
EarlyStopping counter: 46 out of 100
Updating learning rate to 3.872558709958239e-27
EarlyStopping counter: 47 out of 100
Updating learning rate to 1.9362793549791194e-27
EarlyStopping counter: 48 out of 100
Updating learning rate to 9.681396774895597e-28
EarlyStopping counter: 49 out of 100
Updating learning rate to 4.840698387447798e-28
EarlyStopping counter: 50 out of 100
Updating learning rate to 2.420349193723899e-28
EarlyStopping counter: 51 out of 100
Updating learning rate to 1.2101745968619496e-28
EarlyStopping counter: 52 out of 100
Updating learning rate to 6.050872984309748e-29
EarlyStopping counter: 53 out of 100
Updating learning rate to 3.025436492154874e-29
EarlyStopping counter: 54 out of 100
Updating learning rate to 1.512718246077437e-29
EarlyStopping counter: 55 out of 100
Updating learning rate to 7.563591230387185e-30
EarlyStopping counter: 56 out of 100
Updating learning rate to 3.7817956151935925e-30
EarlyStopping counter: 57 out of 100
Updating learning rate to 1.8908978075967962e-30
EarlyStopping counter: 58 out of 100
Updating learning rate to 9.454489037983981e-31
EarlyStopping counter: 59 out of 100
Updating learning rate to 4.727244518991991e-31
EarlyStopping counter: 60 out of 100
Updating learning rate to 2.3636222594959953e-31
EarlyStopping counter: 61 out of 100
Updating learning rate to 1.1818111297479977e-31
EarlyStopping counter: 62 out of 100
Updating learning rate to 5.909055648739988e-32
EarlyStopping counter: 63 out of 100
Updating learning rate to 2.954527824369994e-32
EarlyStopping counter: 64 out of 100
Updating learning rate to 1.477263912184997e-32
EarlyStopping counter: 65 out of 100
Updating learning rate to 7.386319560924985e-33
EarlyStopping counter: 66 out of 100
Updating learning rate to 3.693159780462493e-33
EarlyStopping counter: 67 out of 100
Updating learning rate to 1.8465798902312463e-33
EarlyStopping counter: 68 out of 100
Updating learning rate to 9.232899451156232e-34
>>>>>> Testing on validation set: trial_34 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.05086661875247955, mae:0.0760212391614914, dtw:Not calculated


                                                                                        [I 2025-10-17 05:28:01,913] Trial 34 finished with value: 0.0760212391614914 and parameters: {'seq_len': 96, 'pred_len': 1, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0005852045265552543, 'dropout': 0.1078576754627623}. Best is trial 31 with value: 0.07231102883815765.
Best trial: 31. Best value: 0.072311:  68%|██████▊   | 34/50 [1:35:58<40:16, 151.06s/it]Best trial: 31. Best value: 0.072311:  68%|██████▊   | 34/50 [1:35:58<40:16, 151.06s/it]Best trial: 31. Best value: 0.072311:  70%|███████   | 35/50 [1:35:58<36:27, 145.83s/it]
============================================================
Trial 35
============================================================
seq_len: 48, pred_len: 1
d_model: 32, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 64, lr: 0.000428
dropout: 0.20291738782134247
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 32, expand: 1
>>>>>> Start training: trial_35 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.031675).  Saving model ...
Updating learning rate to 0.0004275873486883841
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00021379367434419205
Validation loss decreased (0.031675 --> 0.029712).  Saving model ...
Updating learning rate to 0.00010689683717209602
Validation loss decreased (0.029712 --> 0.028491).  Saving model ...
Updating learning rate to 5.344841858604801e-05
Validation loss decreased (0.028491 --> 0.025502).  Saving model ...
Updating learning rate to 2.6724209293024006e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3362104646512003e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.6810523232560015e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.3405261616280008e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6702630808140004e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.351315404070002e-07
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.175657702035001e-07
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.0878288510175005e-07
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.0439144255087502e-07
Validation loss decreased (0.025502 --> 0.023861).  Saving model ...
Updating learning rate to 5.219572127543751e-08
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.6097860637718756e-08
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3048930318859378e-08
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.524465159429689e-09
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.2622325797148445e-09
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6311162898574223e-09
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.155581449287111e-10
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.0777907246435556e-10
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0388953623217778e-10
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.0194476811608889e-10
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.0972384058044445e-11
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.5486192029022223e-11
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.2743096014511111e-11
EarlyStopping counter: 13 out of 100
Updating learning rate to 6.371548007255556e-12
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.185774003627778e-12
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.592887001813889e-12
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.964435009069445e-13
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.9822175045347223e-13
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.9911087522673611e-13
EarlyStopping counter: 19 out of 100
Updating learning rate to 9.955543761336806e-14
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.977771880668403e-14
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.4888859403342014e-14
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.2444429701671007e-14
EarlyStopping counter: 23 out of 100
Updating learning rate to 6.2222148508355036e-15
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.1111074254177518e-15
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.5555537127088759e-15
EarlyStopping counter: 26 out of 100
Updating learning rate to 7.777768563544379e-16
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.8888842817721897e-16
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.9444421408860949e-16
EarlyStopping counter: 29 out of 100
Updating learning rate to 9.722210704430474e-17
EarlyStopping counter: 30 out of 100
Updating learning rate to 4.861105352215237e-17
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.4305526761076186e-17
Validation loss decreased (0.023861 --> 0.023797).  Saving model ...
Updating learning rate to 1.2152763380538093e-17
Validation loss decreased (0.023797 --> 0.023656).  Saving model ...
Updating learning rate to 6.0763816902690465e-18
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.0381908451345232e-18
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5190954225672616e-18
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.595477112836308e-19
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.797738556418154e-19
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.898869278209077e-19
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.494346391045385e-20
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.7471731955226926e-20
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.3735865977613463e-20
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.1867932988806731e-20
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.933966494403366e-21
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.966983247201683e-21
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.4834916236008414e-21
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.417458118004207e-22
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.7087290590021036e-22
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.8543645295010518e-22
EarlyStopping counter: 16 out of 100
Updating learning rate to 9.271822647505259e-23
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.6359113237526295e-23
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.3179556618763147e-23
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.1589778309381574e-23
EarlyStopping counter: 20 out of 100
Updating learning rate to 5.794889154690787e-24
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.8974445773453934e-24
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.4487222886726967e-24
EarlyStopping counter: 23 out of 100
Updating learning rate to 7.2436114433634835e-25
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.6218057216817418e-25
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.8109028608408709e-25
EarlyStopping counter: 26 out of 100
Updating learning rate to 9.054514304204354e-26
EarlyStopping counter: 27 out of 100
Updating learning rate to 4.527257152102177e-26
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.2636285760510886e-26
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.1318142880255443e-26
EarlyStopping counter: 30 out of 100
Updating learning rate to 5.6590714401277215e-27
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.8295357200638607e-27
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.4147678600319304e-27
Validation loss decreased (0.023656 --> 0.023620).  Saving model ...
Updating learning rate to 7.073839300159652e-28
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.536919650079826e-28
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.768459825039913e-28
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.842299125199565e-29
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.4211495625997824e-29
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2105747812998912e-29
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1052873906499456e-29
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.526436953249728e-30
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.763218476624864e-30
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.381609238312432e-30
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.90804619156216e-31
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.45402309578108e-31
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.72701154789054e-31
EarlyStopping counter: 13 out of 100
Updating learning rate to 8.6350577394527e-32
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.31752886972635e-32
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.158764434863175e-32
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.0793822174315875e-32
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.3969110871579375e-33
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.6984555435789688e-33
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.3492277717894844e-33
EarlyStopping counter: 20 out of 100
Updating learning rate to 6.746138858947422e-34
>>>>>> Testing on validation set: trial_35 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.053559787571430206, mae:0.08340591192245483, dtw:Not calculated


                                                                                        [I 2025-10-17 05:29:10,258] Trial 35 finished with value: 0.08340591192245483 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 1, 'd_model': 32, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 64, 'learning_rate': 0.0004275873486883841, 'dropout': 0.20291738782134247}. Best is trial 31 with value: 0.07231102883815765.
Best trial: 31. Best value: 0.072311:  70%|███████   | 35/50 [1:37:06<36:27, 145.83s/it]Best trial: 31. Best value: 0.072311:  70%|███████   | 35/50 [1:37:06<36:27, 145.83s/it]Best trial: 31. Best value: 0.072311:  72%|███████▏  | 36/50 [1:37:06<28:36, 122.58s/it]
============================================================
Trial 36
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000780
dropout: 0.05336147077129423
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_36 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.027183).  Saving model ...
Updating learning rate to 0.0007798105706884909
Validation loss decreased (0.027183 --> 0.025889).  Saving model ...
Updating learning rate to 0.0003899052853442454
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0001949526426721227
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.747632133606136e-05
Validation loss decreased (0.025889 --> 0.025309).  Saving model ...
Updating learning rate to 4.873816066803068e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.436908033401534e-05
Validation loss decreased (0.025309 --> 0.023802).  Saving model ...
Updating learning rate to 1.218454016700767e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.092270083503835e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.0461350417519174e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5230675208759587e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.615337604379793e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.807668802189897e-07
Validation loss decreased (0.023802 --> 0.023745).  Saving model ...
Updating learning rate to 1.9038344010949484e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.519172005474742e-08
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.759586002737371e-08
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.3797930013686855e-08
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1898965006843427e-08
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.949482503421714e-09
Validation loss decreased (0.023745 --> 0.023689).  Saving model ...
Updating learning rate to 2.974741251710857e-09
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4873706258554284e-09
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.436853129277142e-10
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.718426564638571e-10
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8592132823192855e-10
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.296066411596428e-11
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.648033205798214e-11
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.324016602899107e-11
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.1620083014495534e-11
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.810041507247767e-12
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.9050207536238836e-12
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.4525103768119418e-12
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.262551884059709e-13
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.6312759420298545e-13
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.8156379710149273e-13
EarlyStopping counter: 15 out of 100
Updating learning rate to 9.078189855074636e-14
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.539094927537318e-14
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.269547463768659e-14
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.1347737318843295e-14
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.673868659421648e-15
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.836934329710824e-15
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.418467164855412e-15
EarlyStopping counter: 22 out of 100
Updating learning rate to 7.09233582427706e-16
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.54616791213853e-16
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.773083956069265e-16
EarlyStopping counter: 25 out of 100
Updating learning rate to 8.865419780346325e-17
EarlyStopping counter: 26 out of 100
Updating learning rate to 4.432709890173162e-17
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.216354945086581e-17
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.1081774725432906e-17
EarlyStopping counter: 29 out of 100
Updating learning rate to 5.540887362716453e-18
EarlyStopping counter: 30 out of 100
Updating learning rate to 2.7704436813582264e-18
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.3852218406791132e-18
EarlyStopping counter: 32 out of 100
Updating learning rate to 6.926109203395566e-19
EarlyStopping counter: 33 out of 100
Updating learning rate to 3.463054601697783e-19
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.7315273008488915e-19
EarlyStopping counter: 35 out of 100
Updating learning rate to 8.657636504244458e-20
EarlyStopping counter: 36 out of 100
Updating learning rate to 4.328818252122229e-20
EarlyStopping counter: 37 out of 100
Updating learning rate to 2.1644091260611144e-20
Validation loss decreased (0.023689 --> 0.023597).  Saving model ...
Updating learning rate to 1.0822045630305572e-20
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.411022815152786e-21
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.705511407576393e-21
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3527557037881965e-21
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.763778518940982e-22
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.381889259470491e-22
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6909446297352456e-22
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.454723148676228e-23
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.227361574338114e-23
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.113680787169057e-23
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.0568403935845285e-23
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.2842019679226425e-24
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.6421009839613213e-24
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.3210504919806606e-24
EarlyStopping counter: 14 out of 100
Updating learning rate to 6.605252459903303e-25
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.3026262299516516e-25
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.6513131149758258e-25
EarlyStopping counter: 17 out of 100
Updating learning rate to 8.256565574879129e-26
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.1282827874395645e-26
Validation loss decreased (0.023597 --> 0.023552).  Saving model ...
Updating learning rate to 2.0641413937197822e-26
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0320706968598911e-26
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.1603534842994556e-27
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.5801767421497278e-27
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2900883710748639e-27
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4504418553743195e-28
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.2252209276871598e-28
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.6126104638435799e-28
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.063052319217899e-29
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.0315261596089497e-29
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.0157630798044748e-29
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.0078815399022374e-29
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.039407699511187e-30
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.5197038497555936e-30
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.2598519248777968e-30
EarlyStopping counter: 15 out of 100
Updating learning rate to 6.299259624388984e-31
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.149629812194492e-31
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.574814906097246e-31
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.87407453048623e-32
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.937037265243115e-32
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.9685186326215575e-32
EarlyStopping counter: 21 out of 100
Updating learning rate to 9.842593163107787e-33
EarlyStopping counter: 22 out of 100
Updating learning rate to 4.921296581553894e-33
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.460648290776947e-33
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.2303241453884734e-33
>>>>>> Testing on validation set: trial_36 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.05022056773304939, mae:0.07200154662132263, dtw:Not calculated


                                                                                        [I 2025-10-17 05:31:24,381] Trial 36 finished with value: 0.07200154662132263 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0007798105706884909, 'dropout': 0.05336147077129423}. Best is trial 36 with value: 0.07200154662132263.
Best trial: 31. Best value: 0.072311:  72%|███████▏  | 36/50 [1:39:20<28:36, 122.58s/it]Best trial: 36. Best value: 0.0720015:  72%|███████▏  | 36/50 [1:39:20<28:36, 122.58s/it]Best trial: 36. Best value: 0.0720015:  74%|███████▍  | 37/50 [1:39:20<27:18, 126.04s/it]
============================================================
Trial 37
============================================================
seq_len: 96, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 2, d_layers: 2
batch_size: 16, lr: 0.000080
dropout: 0.037445973110866074
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_37 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 1
============================================================
train 4577
val 259
test 261
Validation loss decreased (inf --> 0.032063).  Saving model ...
Updating learning rate to 8.043199475190581e-05
Validation loss decreased (0.032063 --> 0.027791).  Saving model ...
Updating learning rate to 4.0215997375952905e-05
Validation loss decreased (0.027791 --> 0.026992).  Saving model ...
Updating learning rate to 2.0107998687976452e-05
Validation loss decreased (0.026992 --> 0.026800).  Saving model ...
Updating learning rate to 1.0053999343988226e-05
Validation loss decreased (0.026800 --> 0.026745).  Saving model ...
Updating learning rate to 5.026999671994113e-06
Validation loss decreased (0.026745 --> 0.026351).  Saving model ...
Updating learning rate to 2.5134998359970565e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2567499179985283e-06
Validation loss decreased (0.026351 --> 0.026218).  Saving model ...
Updating learning rate to 6.283749589992641e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.1418747949963207e-07
Validation loss decreased (0.026218 --> 0.026102).  Saving model ...
Updating learning rate to 1.5709373974981603e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.854686987490802e-08
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.927343493745401e-08
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.9636717468727004e-08
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.818358734363502e-09
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.909179367181751e-09
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.4545896835908755e-09
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.2272948417954378e-09
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.136474208977189e-10
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.0682371044885944e-10
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.5341185522442972e-10
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.670592761221486e-11
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.835296380610743e-11
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.9176481903053715e-11
EarlyStopping counter: 14 out of 100
Updating learning rate to 9.588240951526858e-12
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.794120475763429e-12
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.3970602378817144e-12
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.1985301189408572e-12
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.992650594704286e-13
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.996325297352143e-13
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.4981626486760715e-13
EarlyStopping counter: 21 out of 100
Updating learning rate to 7.490813243380357e-14
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.745406621690179e-14
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.8727033108450894e-14
EarlyStopping counter: 24 out of 100
Updating learning rate to 9.363516554225447e-15
EarlyStopping counter: 25 out of 100
Updating learning rate to 4.6817582771127234e-15
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.3408791385563617e-15
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.1704395692781809e-15
EarlyStopping counter: 28 out of 100
Updating learning rate to 5.852197846390904e-16
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.926098923195452e-16
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.463049461597726e-16
EarlyStopping counter: 31 out of 100
Updating learning rate to 7.31524730798863e-17
EarlyStopping counter: 32 out of 100
Updating learning rate to 3.657623653994315e-17
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.8288118269971576e-17
EarlyStopping counter: 34 out of 100
Updating learning rate to 9.144059134985788e-18
EarlyStopping counter: 35 out of 100
Updating learning rate to 4.572029567492894e-18
EarlyStopping counter: 36 out of 100
Updating learning rate to 2.286014783746447e-18
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.1430073918732235e-18
EarlyStopping counter: 38 out of 100
Updating learning rate to 5.715036959366117e-19
EarlyStopping counter: 39 out of 100
Updating learning rate to 2.8575184796830587e-19
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.4287592398415294e-19
EarlyStopping counter: 41 out of 100
Updating learning rate to 7.143796199207647e-20
EarlyStopping counter: 42 out of 100
Updating learning rate to 3.5718980996038234e-20
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.7859490498019117e-20
EarlyStopping counter: 44 out of 100
Updating learning rate to 8.929745249009559e-21
EarlyStopping counter: 45 out of 100
Updating learning rate to 4.464872624504779e-21
EarlyStopping counter: 46 out of 100
Updating learning rate to 2.2324363122523896e-21
EarlyStopping counter: 47 out of 100
Updating learning rate to 1.1162181561261948e-21
EarlyStopping counter: 48 out of 100
Updating learning rate to 5.581090780630974e-22
EarlyStopping counter: 49 out of 100
Updating learning rate to 2.790545390315487e-22
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.3952726951577435e-22
EarlyStopping counter: 51 out of 100
Updating learning rate to 6.976363475788718e-23
EarlyStopping counter: 52 out of 100
Updating learning rate to 3.488181737894359e-23
EarlyStopping counter: 53 out of 100
Updating learning rate to 1.7440908689471794e-23
EarlyStopping counter: 54 out of 100
Updating learning rate to 8.720454344735897e-24
EarlyStopping counter: 55 out of 100
Updating learning rate to 4.3602271723679485e-24
EarlyStopping counter: 56 out of 100
Updating learning rate to 2.1801135861839742e-24
EarlyStopping counter: 57 out of 100
Updating learning rate to 1.0900567930919871e-24
EarlyStopping counter: 58 out of 100
Updating learning rate to 5.450283965459936e-25
EarlyStopping counter: 59 out of 100
Updating learning rate to 2.725141982729968e-25
EarlyStopping counter: 60 out of 100
Updating learning rate to 1.362570991364984e-25
EarlyStopping counter: 61 out of 100
Updating learning rate to 6.81285495682492e-26
EarlyStopping counter: 62 out of 100
Updating learning rate to 3.40642747841246e-26
EarlyStopping counter: 63 out of 100
Updating learning rate to 1.70321373920623e-26
EarlyStopping counter: 64 out of 100
Updating learning rate to 8.51606869603115e-27
EarlyStopping counter: 65 out of 100
Updating learning rate to 4.258034348015575e-27
EarlyStopping counter: 66 out of 100
Updating learning rate to 2.1290171740077874e-27
EarlyStopping counter: 67 out of 100
Updating learning rate to 1.0645085870038937e-27
EarlyStopping counter: 68 out of 100
Updating learning rate to 5.322542935019468e-28
EarlyStopping counter: 69 out of 100
Updating learning rate to 2.661271467509734e-28
EarlyStopping counter: 70 out of 100
Updating learning rate to 1.330635733754867e-28
EarlyStopping counter: 71 out of 100
Updating learning rate to 6.653178668774335e-29
EarlyStopping counter: 72 out of 100
Updating learning rate to 3.326589334387168e-29
EarlyStopping counter: 73 out of 100
Updating learning rate to 1.663294667193584e-29
EarlyStopping counter: 74 out of 100
Updating learning rate to 8.31647333596792e-30
EarlyStopping counter: 75 out of 100
Updating learning rate to 4.15823666798396e-30
EarlyStopping counter: 76 out of 100
Updating learning rate to 2.07911833399198e-30
EarlyStopping counter: 77 out of 100
Updating learning rate to 1.03955916699599e-30
EarlyStopping counter: 78 out of 100
Updating learning rate to 5.19779583497995e-31
EarlyStopping counter: 79 out of 100
Updating learning rate to 2.598897917489975e-31
EarlyStopping counter: 80 out of 100
Updating learning rate to 1.2994489587449874e-31
EarlyStopping counter: 81 out of 100
Updating learning rate to 6.497244793724937e-32
EarlyStopping counter: 82 out of 100
Updating learning rate to 3.2486223968624685e-32
EarlyStopping counter: 83 out of 100
Updating learning rate to 1.6243111984312342e-32
EarlyStopping counter: 84 out of 100
Updating learning rate to 8.121555992156171e-33
EarlyStopping counter: 85 out of 100
Updating learning rate to 4.0607779960780856e-33
EarlyStopping counter: 86 out of 100
Updating learning rate to 2.0303889980390428e-33
EarlyStopping counter: 87 out of 100
Updating learning rate to 1.0151944990195214e-33
EarlyStopping counter: 88 out of 100
Updating learning rate to 5.075972495097607e-34
EarlyStopping counter: 89 out of 100
Updating learning rate to 2.5379862475488035e-34
EarlyStopping counter: 90 out of 100
Updating learning rate to 1.2689931237744018e-34
>>>>>> Testing on validation set: trial_37 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.051223549991846085, mae:0.08068186044692993, dtw:Not calculated


                                                                                         [I 2025-10-17 05:35:46,141] Trial 37 finished with value: 0.08068186044692993 and parameters: {'seq_len': 96, 'pred_len': 1, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 2, 'd_layers': 2, 'batch_size': 16, 'learning_rate': 8.043199475190581e-05, 'dropout': 0.037445973110866074}. Best is trial 36 with value: 0.07200154662132263.
Best trial: 36. Best value: 0.0720015:  74%|███████▍  | 37/50 [1:43:42<27:18, 126.04s/it]Best trial: 36. Best value: 0.0720015:  74%|███████▍  | 37/50 [1:43:42<27:18, 126.04s/it]Best trial: 36. Best value: 0.0720015:  76%|███████▌  | 38/50 [1:43:42<33:21, 166.76s/it]
============================================================
Trial 38
============================================================
seq_len: 48, pred_len: 30
d_model: 64, n_heads: 4
e_layers: 1, d_layers: 2
batch_size: 64, lr: 0.000761
dropout: 0.015365900011998848
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_38 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 30
============================================================
train 4596
val 230
test 232
Validation loss decreased (inf --> 0.037431).  Saving model ...
Updating learning rate to 0.0007609489063211125
Validation loss decreased (0.037431 --> 0.036978).  Saving model ...
Updating learning rate to 0.00038047445316055623
Validation loss decreased (0.036978 --> 0.036465).  Saving model ...
Updating learning rate to 0.00019023722658027811
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.511861329013906e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.755930664506953e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.3779653322534764e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1889826661267382e-05
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.944913330633691e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.9724566653168455e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4862283326584228e-06
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.431141663292114e-07
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.715570831646057e-07
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.8577854158230285e-07
EarlyStopping counter: 11 out of 100
Updating learning rate to 9.288927079115142e-08
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.644463539557571e-08
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.3222317697787856e-08
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.1611158848893928e-08
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.805579424446964e-09
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.902789712223482e-09
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.451394856111741e-09
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.256974280558705e-10
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.6284871402793525e-10
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.8142435701396762e-10
EarlyStopping counter: 21 out of 100
Updating learning rate to 9.071217850698381e-11
EarlyStopping counter: 22 out of 100
Updating learning rate to 4.5356089253491906e-11
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.2678044626745953e-11
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.1339022313372976e-11
EarlyStopping counter: 25 out of 100
Updating learning rate to 5.669511156686488e-12
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.834755578343244e-12
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.417377789171622e-12
EarlyStopping counter: 28 out of 100
Updating learning rate to 7.08688894585811e-13
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.543444472929055e-13
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.7717222364645276e-13
EarlyStopping counter: 31 out of 100
Updating learning rate to 8.858611182322638e-14
EarlyStopping counter: 32 out of 100
Updating learning rate to 4.429305591161319e-14
EarlyStopping counter: 33 out of 100
Updating learning rate to 2.2146527955806595e-14
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.1073263977903297e-14
EarlyStopping counter: 35 out of 100
Updating learning rate to 5.536631988951649e-15
EarlyStopping counter: 36 out of 100
Updating learning rate to 2.7683159944758243e-15
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.3841579972379122e-15
EarlyStopping counter: 38 out of 100
Updating learning rate to 6.920789986189561e-16
EarlyStopping counter: 39 out of 100
Updating learning rate to 3.4603949930947804e-16
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.7301974965473902e-16
EarlyStopping counter: 41 out of 100
Updating learning rate to 8.650987482736951e-17
EarlyStopping counter: 42 out of 100
Updating learning rate to 4.3254937413684755e-17
EarlyStopping counter: 43 out of 100
Updating learning rate to 2.1627468706842378e-17
EarlyStopping counter: 44 out of 100
Updating learning rate to 1.0813734353421189e-17
EarlyStopping counter: 45 out of 100
Updating learning rate to 5.4068671767105944e-18
EarlyStopping counter: 46 out of 100
Updating learning rate to 2.7034335883552972e-18
EarlyStopping counter: 47 out of 100
Updating learning rate to 1.3517167941776486e-18
EarlyStopping counter: 48 out of 100
Updating learning rate to 6.758583970888243e-19
EarlyStopping counter: 49 out of 100
Updating learning rate to 3.3792919854441215e-19
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.6896459927220607e-19
EarlyStopping counter: 51 out of 100
Updating learning rate to 8.448229963610304e-20
EarlyStopping counter: 52 out of 100
Updating learning rate to 4.224114981805152e-20
EarlyStopping counter: 53 out of 100
Updating learning rate to 2.112057490902576e-20
EarlyStopping counter: 54 out of 100
Updating learning rate to 1.056028745451288e-20
EarlyStopping counter: 55 out of 100
Updating learning rate to 5.28014372725644e-21
EarlyStopping counter: 56 out of 100
Updating learning rate to 2.64007186362822e-21
EarlyStopping counter: 57 out of 100
Updating learning rate to 1.32003593181411e-21
EarlyStopping counter: 58 out of 100
Updating learning rate to 6.60017965907055e-22
EarlyStopping counter: 59 out of 100
Updating learning rate to 3.300089829535275e-22
EarlyStopping counter: 60 out of 100
Updating learning rate to 1.6500449147676374e-22
EarlyStopping counter: 61 out of 100
Updating learning rate to 8.250224573838187e-23
EarlyStopping counter: 62 out of 100
Updating learning rate to 4.1251122869190936e-23
EarlyStopping counter: 63 out of 100
Updating learning rate to 2.0625561434595468e-23
EarlyStopping counter: 64 out of 100
Updating learning rate to 1.0312780717297734e-23
EarlyStopping counter: 65 out of 100
Updating learning rate to 5.156390358648867e-24
EarlyStopping counter: 66 out of 100
Updating learning rate to 2.5781951793244335e-24
EarlyStopping counter: 67 out of 100
Updating learning rate to 1.2890975896622168e-24
EarlyStopping counter: 68 out of 100
Updating learning rate to 6.445487948311084e-25
EarlyStopping counter: 69 out of 100
Updating learning rate to 3.222743974155542e-25
EarlyStopping counter: 70 out of 100
Updating learning rate to 1.611371987077771e-25
EarlyStopping counter: 71 out of 100
Updating learning rate to 8.056859935388855e-26
EarlyStopping counter: 72 out of 100
Updating learning rate to 4.0284299676944274e-26
EarlyStopping counter: 73 out of 100
Updating learning rate to 2.0142149838472137e-26
EarlyStopping counter: 74 out of 100
Updating learning rate to 1.0071074919236068e-26
EarlyStopping counter: 75 out of 100
Updating learning rate to 5.035537459618034e-27
EarlyStopping counter: 76 out of 100
Updating learning rate to 2.517768729809017e-27
EarlyStopping counter: 77 out of 100
Updating learning rate to 1.2588843649045086e-27
EarlyStopping counter: 78 out of 100
Updating learning rate to 6.294421824522543e-28
EarlyStopping counter: 79 out of 100
Updating learning rate to 3.1472109122612714e-28
EarlyStopping counter: 80 out of 100
Updating learning rate to 1.5736054561306357e-28
EarlyStopping counter: 81 out of 100
Updating learning rate to 7.868027280653178e-29
EarlyStopping counter: 82 out of 100
Updating learning rate to 3.934013640326589e-29
EarlyStopping counter: 83 out of 100
Updating learning rate to 1.9670068201632946e-29
EarlyStopping counter: 84 out of 100
Updating learning rate to 9.835034100816473e-30
EarlyStopping counter: 85 out of 100
Updating learning rate to 4.9175170504082365e-30
EarlyStopping counter: 86 out of 100
Updating learning rate to 2.4587585252041183e-30
EarlyStopping counter: 87 out of 100
Updating learning rate to 1.2293792626020591e-30
EarlyStopping counter: 88 out of 100
Updating learning rate to 6.146896313010296e-31
EarlyStopping counter: 89 out of 100
Updating learning rate to 3.073448156505148e-31
EarlyStopping counter: 90 out of 100
Updating learning rate to 1.536724078252574e-31
EarlyStopping counter: 91 out of 100
Updating learning rate to 7.68362039126287e-32
EarlyStopping counter: 92 out of 100
Updating learning rate to 3.841810195631435e-32
EarlyStopping counter: 93 out of 100
Updating learning rate to 1.9209050978157174e-32
EarlyStopping counter: 94 out of 100
Updating learning rate to 9.604525489078587e-33
EarlyStopping counter: 95 out of 100
Updating learning rate to 4.8022627445392935e-33
EarlyStopping counter: 96 out of 100
Updating learning rate to 2.4011313722696467e-33
EarlyStopping counter: 97 out of 100
Updating learning rate to 1.2005656861348234e-33
>>>>>> Testing on validation set: trial_38 >>>>>>
test 232
test shape: (232, 30, 5) (232, 30, 5)
test shape: (232, 30, 5) (232, 30, 5)


	mse:0.07941487431526184, mae:0.11329126358032227, dtw:Not calculated


                                                                                         [I 2025-10-17 05:36:54,402] Trial 38 finished with value: 0.11329126358032227 and parameters: {'seq_len': 48, 'pred_len': 30, 'expand': 2, 'd_model': 64, 'n_heads': 4, 'e_layers': 1, 'd_layers': 2, 'batch_size': 64, 'learning_rate': 0.0007609489063211125, 'dropout': 0.015365900011998848}. Best is trial 36 with value: 0.07200154662132263.
Best trial: 36. Best value: 0.0720015:  76%|███████▌  | 38/50 [1:44:50<33:21, 166.76s/it]Best trial: 36. Best value: 0.0720015:  76%|███████▌  | 38/50 [1:44:50<33:21, 166.76s/it]Best trial: 36. Best value: 0.0720015:  78%|███████▊  | 39/50 [1:44:50<25:09, 137.21s/it]
============================================================
Trial 39
============================================================
seq_len: 96, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 2, d_layers: 2
batch_size: 32, lr: 0.000028
dropout: 0.05342085562395922
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_39 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 1
============================================================
train 4577
val 259
test 261
Validation loss decreased (inf --> 0.032189).  Saving model ...
Updating learning rate to 2.7939248786763202e-05
Validation loss decreased (0.032189 --> 0.029674).  Saving model ...
Updating learning rate to 1.3969624393381601e-05
Validation loss decreased (0.029674 --> 0.028686).  Saving model ...
Updating learning rate to 6.9848121966908005e-06
Validation loss decreased (0.028686 --> 0.028115).  Saving model ...
Updating learning rate to 3.4924060983454002e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.7462030491727001e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.731015245863501e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.3655076229317503e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.1827538114658752e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0913769057329376e-07
Validation loss decreased (0.028115 --> 0.027859).  Saving model ...
Updating learning rate to 5.456884528664688e-08
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.728442264332344e-08
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.364221132166172e-08
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.82110566083086e-09
Validation loss decreased (0.027859 --> 0.027803).  Saving model ...
Updating learning rate to 3.41055283041543e-09
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.705276415207715e-09
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.526382076038575e-10
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.2631910380192874e-10
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.1315955190096437e-10
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0657977595048219e-10
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.328988797524109e-11
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.6644943987620546e-11
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3322471993810273e-11
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.6612359969051366e-12
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.3306179984525683e-12
Validation loss decreased (0.027803 --> 0.027626).  Saving model ...
Updating learning rate to 1.6653089992262841e-12
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.326544996131421e-13
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.1632724980657104e-13
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0816362490328552e-13
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0408181245164276e-13
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.204090622582138e-14
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.602045311291069e-14
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3010226556455345e-14
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.5051132782276724e-15
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.2525566391138362e-15
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.6262783195569181e-15
EarlyStopping counter: 11 out of 100
Updating learning rate to 8.131391597784591e-16
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.0656957988922953e-16
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.0328478994461476e-16
Validation loss decreased (0.027626 --> 0.027318).  Saving model ...
Updating learning rate to 1.0164239497230738e-16
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.082119748615369e-17
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.5410598743076845e-17
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2705299371538423e-17
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.352649685769211e-18
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.1763248428846057e-18
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.5881624214423028e-18
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.940812107211514e-19
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.970406053605757e-19
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.9852030268028785e-19
EarlyStopping counter: 10 out of 100
Updating learning rate to 9.926015134014393e-20
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.9630075670071964e-20
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.4815037835035982e-20
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.2407518917517991e-20
EarlyStopping counter: 14 out of 100
Updating learning rate to 6.2037594587589955e-21
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.1018797293794977e-21
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.5509398646897489e-21
EarlyStopping counter: 17 out of 100
Updating learning rate to 7.754699323448744e-22
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.877349661724372e-22
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.938674830862186e-22
EarlyStopping counter: 20 out of 100
Updating learning rate to 9.69337415431093e-23
EarlyStopping counter: 21 out of 100
Updating learning rate to 4.846687077155465e-23
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.4233435385777326e-23
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.2116717692888663e-23
EarlyStopping counter: 24 out of 100
Updating learning rate to 6.0583588464443315e-24
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.0291794232221658e-24
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.5145897116110829e-24
EarlyStopping counter: 27 out of 100
Updating learning rate to 7.572948558055414e-25
EarlyStopping counter: 28 out of 100
Updating learning rate to 3.786474279027707e-25
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.8932371395138536e-25
EarlyStopping counter: 30 out of 100
Updating learning rate to 9.466185697569268e-26
EarlyStopping counter: 31 out of 100
Updating learning rate to 4.733092848784634e-26
EarlyStopping counter: 32 out of 100
Updating learning rate to 2.366546424392317e-26
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.1832732121961585e-26
EarlyStopping counter: 34 out of 100
Updating learning rate to 5.9163660609807925e-27
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.9581830304903962e-27
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.4790915152451981e-27
EarlyStopping counter: 37 out of 100
Updating learning rate to 7.395457576225991e-28
EarlyStopping counter: 38 out of 100
Updating learning rate to 3.6977287881129953e-28
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.8488643940564977e-28
EarlyStopping counter: 40 out of 100
Updating learning rate to 9.244321970282488e-29
EarlyStopping counter: 41 out of 100
Updating learning rate to 4.622160985141244e-29
EarlyStopping counter: 42 out of 100
Updating learning rate to 2.311080492570622e-29
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.155540246285311e-29
EarlyStopping counter: 44 out of 100
Updating learning rate to 5.777701231426555e-30
EarlyStopping counter: 45 out of 100
Updating learning rate to 2.8888506157132776e-30
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.4444253078566388e-30
EarlyStopping counter: 47 out of 100
Updating learning rate to 7.222126539283194e-31
EarlyStopping counter: 48 out of 100
Updating learning rate to 3.611063269641597e-31
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.8055316348207985e-31
EarlyStopping counter: 50 out of 100
Updating learning rate to 9.027658174103992e-32
EarlyStopping counter: 51 out of 100
Updating learning rate to 4.513829087051996e-32
EarlyStopping counter: 52 out of 100
Updating learning rate to 2.256914543525998e-32
EarlyStopping counter: 53 out of 100
Updating learning rate to 1.128457271762999e-32
EarlyStopping counter: 54 out of 100
Updating learning rate to 5.642286358814995e-33
EarlyStopping counter: 55 out of 100
Updating learning rate to 2.8211431794074976e-33
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.4105715897037488e-33
EarlyStopping counter: 57 out of 100
Updating learning rate to 7.052857948518744e-34
EarlyStopping counter: 58 out of 100
Updating learning rate to 3.526428974259372e-34
EarlyStopping counter: 59 out of 100
Updating learning rate to 1.763214487129686e-34
EarlyStopping counter: 60 out of 100
Updating learning rate to 8.81607243564843e-35
EarlyStopping counter: 61 out of 100
Updating learning rate to 4.408036217824215e-35
>>>>>> Testing on validation set: trial_39 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.0575849749147892, mae:0.10252642631530762, dtw:Not calculated


                                                                                         [I 2025-10-17 05:39:07,746] Trial 39 finished with value: 0.10252642631530762 and parameters: {'seq_len': 96, 'pred_len': 1, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 2, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 2.7939248786763202e-05, 'dropout': 0.05342085562395922}. Best is trial 36 with value: 0.07200154662132263.
Best trial: 36. Best value: 0.0720015:  78%|███████▊  | 39/50 [1:47:03<25:09, 137.21s/it]Best trial: 36. Best value: 0.0720015:  78%|███████▊  | 39/50 [1:47:03<25:09, 137.21s/it]Best trial: 36. Best value: 0.0720015:  80%|████████  | 40/50 [1:47:03<22:40, 136.05s/it]
============================================================
Trial 40
============================================================
seq_len: 48, pred_len: 14
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 1
batch_size: 16, lr: 0.000958
dropout: 0.07397785403079836
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_40 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 14
============================================================
train 4612
val 246
test 248
Validation loss decreased (inf --> 0.043011).  Saving model ...
Updating learning rate to 0.0009576978260964602
Validation loss decreased (0.043011 --> 0.040324).  Saving model ...
Updating learning rate to 0.0004788489130482301
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00023942445652411505
Validation loss decreased (0.040324 --> 0.038076).  Saving model ...
Updating learning rate to 0.00011971222826205753
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.985611413102876e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.992805706551438e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.496402853275719e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.482014266378595e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.7410071331892977e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.8705035665946488e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.352517832973244e-07
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.676258916486622e-07
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.338129458243311e-07
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.1690647291216555e-07
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.8453236456082776e-08
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.9226618228041388e-08
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.4613309114020694e-08
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.306654557010347e-09
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.6533272785051735e-09
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.8266636392525868e-09
EarlyStopping counter: 17 out of 100
Updating learning rate to 9.133318196262934e-10
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.566659098131467e-10
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.2833295490657334e-10
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.1416647745328667e-10
EarlyStopping counter: 21 out of 100
Updating learning rate to 5.7083238726643336e-11
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.8541619363321668e-11
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.4270809681660834e-11
EarlyStopping counter: 24 out of 100
Updating learning rate to 7.135404840830417e-12
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.5677024204152085e-12
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.7838512102076042e-12
EarlyStopping counter: 27 out of 100
Updating learning rate to 8.919256051038021e-13
EarlyStopping counter: 28 out of 100
Updating learning rate to 4.4596280255190106e-13
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.2298140127595053e-13
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.1149070063797527e-13
EarlyStopping counter: 31 out of 100
Updating learning rate to 5.574535031898763e-14
EarlyStopping counter: 32 out of 100
Updating learning rate to 2.7872675159493816e-14
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.3936337579746908e-14
EarlyStopping counter: 34 out of 100
Updating learning rate to 6.968168789873454e-15
EarlyStopping counter: 35 out of 100
Updating learning rate to 3.484084394936727e-15
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.7420421974683635e-15
EarlyStopping counter: 37 out of 100
Updating learning rate to 8.710210987341818e-16
EarlyStopping counter: 38 out of 100
Updating learning rate to 4.355105493670909e-16
EarlyStopping counter: 39 out of 100
Updating learning rate to 2.1775527468354544e-16
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.0887763734177272e-16
EarlyStopping counter: 41 out of 100
Updating learning rate to 5.443881867088636e-17
EarlyStopping counter: 42 out of 100
Updating learning rate to 2.721940933544318e-17
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.360970466772159e-17
EarlyStopping counter: 44 out of 100
Updating learning rate to 6.804852333860795e-18
EarlyStopping counter: 45 out of 100
Updating learning rate to 3.4024261669303975e-18
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.7012130834651988e-18
EarlyStopping counter: 47 out of 100
Updating learning rate to 8.506065417325994e-19
EarlyStopping counter: 48 out of 100
Updating learning rate to 4.253032708662997e-19
EarlyStopping counter: 49 out of 100
Updating learning rate to 2.1265163543314984e-19
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.0632581771657492e-19
EarlyStopping counter: 51 out of 100
Updating learning rate to 5.316290885828746e-20
EarlyStopping counter: 52 out of 100
Updating learning rate to 2.658145442914373e-20
EarlyStopping counter: 53 out of 100
Updating learning rate to 1.3290727214571865e-20
EarlyStopping counter: 54 out of 100
Updating learning rate to 6.645363607285933e-21
EarlyStopping counter: 55 out of 100
Updating learning rate to 3.3226818036429663e-21
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.6613409018214832e-21
EarlyStopping counter: 57 out of 100
Updating learning rate to 8.306704509107416e-22
EarlyStopping counter: 58 out of 100
Updating learning rate to 4.153352254553708e-22
EarlyStopping counter: 59 out of 100
Updating learning rate to 2.076676127276854e-22
EarlyStopping counter: 60 out of 100
Updating learning rate to 1.038338063638427e-22
EarlyStopping counter: 61 out of 100
Updating learning rate to 5.191690318192135e-23
EarlyStopping counter: 62 out of 100
Updating learning rate to 2.5958451590960674e-23
EarlyStopping counter: 63 out of 100
Updating learning rate to 1.2979225795480337e-23
EarlyStopping counter: 64 out of 100
Updating learning rate to 6.4896128977401686e-24
EarlyStopping counter: 65 out of 100
Updating learning rate to 3.2448064488700843e-24
EarlyStopping counter: 66 out of 100
Updating learning rate to 1.6224032244350421e-24
EarlyStopping counter: 67 out of 100
Updating learning rate to 8.112016122175211e-25
EarlyStopping counter: 68 out of 100
Updating learning rate to 4.0560080610876054e-25
EarlyStopping counter: 69 out of 100
Updating learning rate to 2.0280040305438027e-25
EarlyStopping counter: 70 out of 100
Updating learning rate to 1.0140020152719013e-25
EarlyStopping counter: 71 out of 100
Updating learning rate to 5.0700100763595067e-26
EarlyStopping counter: 72 out of 100
Updating learning rate to 2.5350050381797534e-26
EarlyStopping counter: 73 out of 100
Updating learning rate to 1.2675025190898767e-26
EarlyStopping counter: 74 out of 100
Updating learning rate to 6.3375125954493834e-27
EarlyStopping counter: 75 out of 100
Updating learning rate to 3.1687562977246917e-27
EarlyStopping counter: 76 out of 100
Updating learning rate to 1.5843781488623458e-27
EarlyStopping counter: 77 out of 100
Updating learning rate to 7.921890744311729e-28
EarlyStopping counter: 78 out of 100
Updating learning rate to 3.9609453721558646e-28
EarlyStopping counter: 79 out of 100
Updating learning rate to 1.9804726860779323e-28
EarlyStopping counter: 80 out of 100
Updating learning rate to 9.902363430389662e-29
EarlyStopping counter: 81 out of 100
Updating learning rate to 4.951181715194831e-29
EarlyStopping counter: 82 out of 100
Updating learning rate to 2.4755908575974154e-29
EarlyStopping counter: 83 out of 100
Updating learning rate to 1.2377954287987077e-29
EarlyStopping counter: 84 out of 100
Updating learning rate to 6.1889771439935385e-30
EarlyStopping counter: 85 out of 100
Updating learning rate to 3.0944885719967692e-30
EarlyStopping counter: 86 out of 100
Updating learning rate to 1.5472442859983846e-30
EarlyStopping counter: 87 out of 100
Updating learning rate to 7.736221429991923e-31
EarlyStopping counter: 88 out of 100
Updating learning rate to 3.8681107149959615e-31
EarlyStopping counter: 89 out of 100
Updating learning rate to 1.9340553574979808e-31
EarlyStopping counter: 90 out of 100
Updating learning rate to 9.670276787489904e-32
EarlyStopping counter: 91 out of 100
Updating learning rate to 4.835138393744952e-32
EarlyStopping counter: 92 out of 100
Updating learning rate to 2.417569196872476e-32
EarlyStopping counter: 93 out of 100
Updating learning rate to 1.208784598436238e-32
EarlyStopping counter: 94 out of 100
Updating learning rate to 6.04392299218119e-33
EarlyStopping counter: 95 out of 100
Updating learning rate to 3.021961496090595e-33
EarlyStopping counter: 96 out of 100
Updating learning rate to 1.5109807480452975e-33
>>>>>> Testing on validation set: trial_40 >>>>>>
test 248
test shape: (248, 14, 5) (248, 14, 5)
test shape: (248, 14, 5) (248, 14, 5)


	mse:0.06823312491178513, mae:0.1038815975189209, dtw:Not calculated


                                                                                         [I 2025-10-17 05:43:30,461] Trial 40 finished with value: 0.1038815975189209 and parameters: {'seq_len': 48, 'pred_len': 14, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 1, 'batch_size': 16, 'learning_rate': 0.0009576978260964602, 'dropout': 0.07397785403079836}. Best is trial 36 with value: 0.07200154662132263.
Best trial: 36. Best value: 0.0720015:  80%|████████  | 40/50 [1:51:26<22:40, 136.05s/it]Best trial: 36. Best value: 0.0720015:  80%|████████  | 40/50 [1:51:26<22:40, 136.05s/it]Best trial: 36. Best value: 0.0720015:  82%|████████▏ | 41/50 [1:51:26<26:06, 174.05s/it]
============================================================
Trial 41
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000566
dropout: 0.11393897437212927
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_41 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.027885).  Saving model ...
Updating learning rate to 0.0005657678928352853
Validation loss decreased (0.027885 --> 0.025768).  Saving model ...
Updating learning rate to 0.00028288394641764266
Validation loss decreased (0.025768 --> 0.024598).  Saving model ...
Updating learning rate to 0.00014144197320882133
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.072098660441066e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.536049330220533e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.7680246651102666e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.840123325551333e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.4200616627756665e-06
Validation loss decreased (0.024598 --> 0.024542).  Saving model ...
Updating learning rate to 2.2100308313878332e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1050154156939166e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.525077078469583e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7625385392347916e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3812692696173958e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.906346348086979e-08
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.4531731740434894e-08
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.7265865870217447e-08
Validation loss decreased (0.024542 --> 0.024012).  Saving model ...
Updating learning rate to 8.632932935108724e-09
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.316466467554362e-09
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.158233233777181e-09
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0791166168885905e-09
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.395583084442952e-10
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.697791542221476e-10
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.348895771110738e-10
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.74447885555369e-11
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.372239427776845e-11
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.6861197138884226e-11
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.430598569442113e-12
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.2152992847210565e-12
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.1076496423605282e-12
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.0538248211802641e-12
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.269124105901321e-13
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.6345620529506603e-13
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.3172810264753301e-13
EarlyStopping counter: 17 out of 100
Updating learning rate to 6.586405132376651e-14
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.2932025661883254e-14
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.6466012830941627e-14
EarlyStopping counter: 20 out of 100
Updating learning rate to 8.233006415470813e-15
Validation loss decreased (0.024012 --> 0.023875).  Saving model ...
Updating learning rate to 4.116503207735407e-15
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0582516038677033e-15
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0291258019338517e-15
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.145629009669258e-16
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.572814504834629e-16
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2864072524173146e-16
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.432036262086573e-17
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.2160181310432865e-17
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6080090655216432e-17
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.040045327608216e-18
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.020022663804108e-18
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.010011331902054e-18
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.005005665951027e-18
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.025028329755135e-19
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.5125141648775676e-19
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.2562570824387838e-19
EarlyStopping counter: 16 out of 100
Updating learning rate to 6.281285412193919e-20
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.1406427060969595e-20
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.5703213530484797e-20
EarlyStopping counter: 19 out of 100
Updating learning rate to 7.851606765242399e-21
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.925803382621199e-21
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.9629016913105997e-21
EarlyStopping counter: 22 out of 100
Updating learning rate to 9.814508456552998e-22
EarlyStopping counter: 23 out of 100
Updating learning rate to 4.907254228276499e-22
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.4536271141382496e-22
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.2268135570691248e-22
EarlyStopping counter: 26 out of 100
Updating learning rate to 6.134067785345624e-23
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.067033892672812e-23
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.533516946336406e-23
EarlyStopping counter: 29 out of 100
Updating learning rate to 7.66758473168203e-24
EarlyStopping counter: 30 out of 100
Updating learning rate to 3.833792365841015e-24
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.9168961829205075e-24
EarlyStopping counter: 32 out of 100
Updating learning rate to 9.584480914602537e-25
EarlyStopping counter: 33 out of 100
Updating learning rate to 4.792240457301269e-25
EarlyStopping counter: 34 out of 100
Updating learning rate to 2.3961202286506343e-25
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.1980601143253172e-25
EarlyStopping counter: 36 out of 100
Updating learning rate to 5.990300571626586e-26
EarlyStopping counter: 37 out of 100
Updating learning rate to 2.995150285813293e-26
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.4975751429066465e-26
EarlyStopping counter: 39 out of 100
Updating learning rate to 7.487875714533232e-27
EarlyStopping counter: 40 out of 100
Updating learning rate to 3.743937857266616e-27
EarlyStopping counter: 41 out of 100
Updating learning rate to 1.871968928633308e-27
EarlyStopping counter: 42 out of 100
Updating learning rate to 9.35984464316654e-28
EarlyStopping counter: 43 out of 100
Updating learning rate to 4.67992232158327e-28
EarlyStopping counter: 44 out of 100
Updating learning rate to 2.339961160791635e-28
EarlyStopping counter: 45 out of 100
Updating learning rate to 1.1699805803958176e-28
EarlyStopping counter: 46 out of 100
Updating learning rate to 5.849902901979088e-29
EarlyStopping counter: 47 out of 100
Updating learning rate to 2.924951450989544e-29
EarlyStopping counter: 48 out of 100
Updating learning rate to 1.462475725494772e-29
EarlyStopping counter: 49 out of 100
Updating learning rate to 7.31237862747386e-30
EarlyStopping counter: 50 out of 100
Updating learning rate to 3.65618931373693e-30
EarlyStopping counter: 51 out of 100
Updating learning rate to 1.828094656868465e-30
EarlyStopping counter: 52 out of 100
Updating learning rate to 9.140473284342325e-31
EarlyStopping counter: 53 out of 100
Updating learning rate to 4.570236642171162e-31
EarlyStopping counter: 54 out of 100
Updating learning rate to 2.285118321085581e-31
EarlyStopping counter: 55 out of 100
Updating learning rate to 1.1425591605427906e-31
EarlyStopping counter: 56 out of 100
Updating learning rate to 5.712795802713953e-32
EarlyStopping counter: 57 out of 100
Updating learning rate to 2.8563979013569764e-32
EarlyStopping counter: 58 out of 100
Updating learning rate to 1.4281989506784882e-32
EarlyStopping counter: 59 out of 100
Updating learning rate to 7.140994753392441e-33
EarlyStopping counter: 60 out of 100
Updating learning rate to 3.5704973766962206e-33
EarlyStopping counter: 61 out of 100
Updating learning rate to 1.7852486883481103e-33
EarlyStopping counter: 62 out of 100
Updating learning rate to 8.926243441740551e-34
>>>>>> Testing on validation set: trial_41 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.050215255469083786, mae:0.07271167635917664, dtw:Not calculated


                                                                                         [I 2025-10-17 05:45:44,879] Trial 41 finished with value: 0.07271167635917664 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0005657678928352853, 'dropout': 0.11393897437212927}. Best is trial 36 with value: 0.07200154662132263.
Best trial: 36. Best value: 0.0720015:  82%|████████▏ | 41/50 [1:53:40<26:06, 174.05s/it]Best trial: 36. Best value: 0.0720015:  82%|████████▏ | 41/50 [1:53:41<26:06, 174.05s/it]Best trial: 36. Best value: 0.0720015:  84%|████████▍ | 42/50 [1:53:41<21:37, 162.16s/it]
============================================================
Trial 42
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000749
dropout: 0.052532094756536585
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_42 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.032037).  Saving model ...
Updating learning rate to 0.0007488847868195232
Validation loss decreased (0.032037 --> 0.025383).  Saving model ...
Updating learning rate to 0.0003744423934097616
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0001872211967048808
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.36105983524404e-05
Validation loss decreased (0.025383 --> 0.025091).  Saving model ...
Updating learning rate to 4.68052991762202e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.34026495881101e-05
Validation loss decreased (0.025091 --> 0.024732).  Saving model ...
Updating learning rate to 1.170132479405505e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.850662397027525e-06
Validation loss decreased (0.024732 --> 0.024673).  Saving model ...
Updating learning rate to 2.9253311985137624e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4626655992568812e-06
Validation loss decreased (0.024673 --> 0.024661).  Saving model ...
Updating learning rate to 7.313327996284406e-07
Validation loss decreased (0.024661 --> 0.024475).  Saving model ...
Updating learning rate to 3.656663998142203e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8283319990711015e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.141659995355507e-08
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.570829997677754e-08
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.285414998838877e-08
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1427074994194384e-08
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.713537497097192e-09
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.856768748548596e-09
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.428384374274298e-09
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.14192187137149e-10
Validation loss decreased (0.024475 --> 0.024452).  Saving model ...
Updating learning rate to 3.570960935685745e-10
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.7854804678428726e-10
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.927402339214363e-11
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.4637011696071814e-11
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2318505848035907e-11
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1159252924017953e-11
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.579626462008977e-12
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7898132310044884e-12
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3949066155022442e-12
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.974533077511221e-13
Validation loss decreased (0.024452 --> 0.023940).  Saving model ...
Updating learning rate to 3.4872665387556105e-13
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.7436332693778052e-13
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.718166346889026e-14
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.359083173444513e-14
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.1795415867222565e-14
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0897707933611283e-14
Validation loss decreased (0.023940 --> 0.023927).  Saving model ...
Updating learning rate to 5.448853966805641e-15
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7244269834028207e-15
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3622134917014103e-15
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.811067458507052e-16
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.405533729253526e-16
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.702766864626763e-16
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.513834323133815e-17
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.256917161566907e-17
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.1284585807834536e-17
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.0642292903917268e-17
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.321146451958634e-18
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.660573225979317e-18
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.3302866129896585e-18
EarlyStopping counter: 13 out of 100
Updating learning rate to 6.651433064948293e-19
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.3257165324741463e-19
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.6628582662370732e-19
EarlyStopping counter: 16 out of 100
Updating learning rate to 8.314291331185366e-20
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.157145665592683e-20
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.0785728327963415e-20
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.0392864163981707e-20
EarlyStopping counter: 20 out of 100
Updating learning rate to 5.196432081990854e-21
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.598216040995427e-21
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.2991080204977134e-21
EarlyStopping counter: 23 out of 100
Updating learning rate to 6.495540102488567e-22
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.2477700512442835e-22
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.6238850256221418e-22
EarlyStopping counter: 26 out of 100
Updating learning rate to 8.119425128110709e-23
EarlyStopping counter: 27 out of 100
Updating learning rate to 4.0597125640553544e-23
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.0298562820276772e-23
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.0149281410138386e-23
EarlyStopping counter: 30 out of 100
Updating learning rate to 5.074640705069193e-24
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.5373203525345965e-24
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.2686601762672982e-24
EarlyStopping counter: 33 out of 100
Updating learning rate to 6.343300881336491e-25
EarlyStopping counter: 34 out of 100
Updating learning rate to 3.1716504406682456e-25
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.5858252203341228e-25
EarlyStopping counter: 36 out of 100
Updating learning rate to 7.929126101670614e-26
EarlyStopping counter: 37 out of 100
Updating learning rate to 3.964563050835307e-26
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.9822815254176535e-26
EarlyStopping counter: 39 out of 100
Updating learning rate to 9.911407627088268e-27
EarlyStopping counter: 40 out of 100
Updating learning rate to 4.955703813544134e-27
Validation loss decreased (0.023927 --> 0.023919).  Saving model ...
Updating learning rate to 2.477851906772067e-27
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2389259533860334e-27
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.194629766930167e-28
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.0973148834650836e-28
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5486574417325418e-28
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.743287208662709e-29
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.8716436043313545e-29
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.9358218021656773e-29
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.679109010828386e-30
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.839554505414193e-30
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.4197772527070966e-30
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.2098886263535483e-30
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.049443131767741e-31
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.0247215658838707e-31
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.5123607829419354e-31
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.561803914709677e-32
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.7809019573548384e-32
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.8904509786774192e-32
EarlyStopping counter: 18 out of 100
Updating learning rate to 9.452254893387096e-33
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.726127446693548e-33
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.363063723346774e-33
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.181531861673387e-33
>>>>>> Testing on validation set: trial_42 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.0498863123357296, mae:0.07200629264116287, dtw:Not calculated


                                                                                         [I 2025-10-17 05:47:59,034] Trial 42 finished with value: 0.07200629264116287 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0007488847868195232, 'dropout': 0.052532094756536585}. Best is trial 36 with value: 0.07200154662132263.
Best trial: 36. Best value: 0.0720015:  84%|████████▍ | 42/50 [1:55:55<21:37, 162.16s/it]Best trial: 36. Best value: 0.0720015:  84%|████████▍ | 42/50 [1:55:55<21:37, 162.16s/it]Best trial: 36. Best value: 0.0720015:  86%|████████▌ | 43/50 [1:55:55<17:56, 153.76s/it]
============================================================
Trial 43
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000786
dropout: 0.04821831969861692
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_43 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.025933).  Saving model ...
Updating learning rate to 0.0007855852654248487
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0003927926327124243
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.00019639631635621216
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.819815817810608e-05
Validation loss decreased (0.025933 --> 0.023802).  Saving model ...
Updating learning rate to 4.909907908905304e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.454953954452652e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.227476977226326e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.13738488613163e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.068692443065815e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.5343462215329075e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.671731107664538e-07
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.835865553832269e-07
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.9179327769161344e-07
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.589663884580672e-08
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.794831942290336e-08
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.397415971145168e-08
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.198707985572584e-08
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.99353992786292e-09
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.99676996393146e-09
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.49838498196573e-09
Validation loss decreased (0.023802 --> 0.023735).  Saving model ...
Updating learning rate to 7.49192490982865e-10
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.745962454914325e-10
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8729812274571625e-10
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.364906137285813e-11
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.682453068642906e-11
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.341226534321453e-11
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1706132671607266e-11
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.853066335803633e-12
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.9265331679018164e-12
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4632665839509082e-12
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.316332919754541e-13
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.6581664598772705e-13
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.8290832299386353e-13
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.145416149693176e-14
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.572708074846588e-14
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.286354037423294e-14
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.143177018711647e-14
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.715885093558235e-15
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.8579425467791176e-15
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.4289712733895588e-15
EarlyStopping counter: 20 out of 100
Updating learning rate to 7.144856366947794e-16
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.572428183473897e-16
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.7862140917369485e-16
EarlyStopping counter: 23 out of 100
Updating learning rate to 8.931070458684742e-17
EarlyStopping counter: 24 out of 100
Updating learning rate to 4.465535229342371e-17
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.2327676146711856e-17
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.1163838073355928e-17
EarlyStopping counter: 27 out of 100
Updating learning rate to 5.581919036677964e-18
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.790959518338982e-18
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.395479759169491e-18
EarlyStopping counter: 30 out of 100
Updating learning rate to 6.977398795847455e-19
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.4886993979237275e-19
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.7443496989618638e-19
EarlyStopping counter: 33 out of 100
Updating learning rate to 8.721748494809319e-20
EarlyStopping counter: 34 out of 100
Updating learning rate to 4.3608742474046594e-20
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.1804371237023297e-20
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.0902185618511649e-20
EarlyStopping counter: 37 out of 100
Updating learning rate to 5.451092809255824e-21
EarlyStopping counter: 38 out of 100
Updating learning rate to 2.725546404627912e-21
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.362773202313956e-21
EarlyStopping counter: 40 out of 100
Updating learning rate to 6.81386601156978e-22
EarlyStopping counter: 41 out of 100
Updating learning rate to 3.40693300578489e-22
Validation loss decreased (0.023735 --> 0.023701).  Saving model ...
Updating learning rate to 1.703466502892445e-22
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.517332514462225e-23
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.258666257231113e-23
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.1293331286155564e-23
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0646665643077782e-23
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.323332821538891e-24
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.6616664107694454e-24
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3308332053847227e-24
Validation loss decreased (0.023701 --> 0.023667).  Saving model ...
Updating learning rate to 6.654166026923614e-25
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.327083013461807e-25
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6635415067309034e-25
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.317707533654517e-26
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.1588537668272585e-26
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0794268834136293e-26
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.0397134417068146e-26
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.198567208534073e-27
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.5992836042670366e-27
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.2996418021335183e-27
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.498209010667591e-28
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.2491045053337957e-28
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.6245522526668979e-28
EarlyStopping counter: 13 out of 100
Updating learning rate to 8.122761263334489e-29
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.0613806316672446e-29
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.0306903158336223e-29
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.0153451579168112e-29
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.076725789584056e-30
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.538362894792028e-30
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.269181447396014e-30
EarlyStopping counter: 20 out of 100
Updating learning rate to 6.34590723698007e-31
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.172953618490035e-31
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.5864768092450174e-31
EarlyStopping counter: 23 out of 100
Updating learning rate to 7.932384046225087e-32
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.9661920231125436e-32
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.9830960115562718e-32
EarlyStopping counter: 26 out of 100
Updating learning rate to 9.915480057781359e-33
EarlyStopping counter: 27 out of 100
Updating learning rate to 4.9577400288906795e-33
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.4788700144453397e-33
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.2394350072226699e-33
>>>>>> Testing on validation set: trial_43 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.04922722652554512, mae:0.07364322990179062, dtw:Not calculated


                                                                                         [I 2025-10-17 05:50:13,269] Trial 43 finished with value: 0.07364322990179062 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0007855852654248487, 'dropout': 0.04821831969861692}. Best is trial 36 with value: 0.07200154662132263.
Best trial: 36. Best value: 0.0720015:  86%|████████▌ | 43/50 [1:58:09<17:56, 153.76s/it]Best trial: 36. Best value: 0.0720015:  86%|████████▌ | 43/50 [1:58:09<17:56, 153.76s/it]Best trial: 36. Best value: 0.0720015:  88%|████████▊ | 44/50 [1:58:09<14:47, 147.90s/it]
============================================================
Trial 44
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000765
dropout: 0.023880531025445084
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_44 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.037797).  Saving model ...
Updating learning rate to 0.0007649202111138429
Validation loss decreased (0.037797 --> 0.026249).  Saving model ...
Updating learning rate to 0.00038246010555692143
Validation loss decreased (0.026249 --> 0.024218).  Saving model ...
Updating learning rate to 0.00019123005277846072
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.561502638923036e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.780751319461518e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.390375659730759e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1951878298653795e-05
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.975939149326897e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.9879695746634487e-06
Validation loss decreased (0.024218 --> 0.023910).  Saving model ...
Updating learning rate to 1.4939847873317243e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.469923936658622e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.734961968329311e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8674809841646554e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.337404920823277e-08
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.6687024604116386e-08
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.3343512302058193e-08
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1671756151029096e-08
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.835878075514548e-09
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.917939037757274e-09
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.458969518878637e-09
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.294847594393185e-10
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.6474237971965926e-10
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.8237118985982963e-10
EarlyStopping counter: 14 out of 100
Updating learning rate to 9.118559492991482e-11
Validation loss decreased (0.023910 --> 0.023774).  Saving model ...
Updating learning rate to 4.559279746495741e-11
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2796398732478704e-11
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1398199366239352e-11
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.699099683119676e-12
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.849549841559838e-12
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.424774920779919e-12
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.123874603899595e-13
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.5619373019497975e-13
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.7809686509748988e-13
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.904843254874494e-14
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.452421627437247e-14
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.2262108137186234e-14
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.1131054068593117e-14
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.565527034296559e-15
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.7827635171482793e-15
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.3913817585741397e-15
EarlyStopping counter: 16 out of 100
Updating learning rate to 6.956908792870698e-16
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.478454396435349e-16
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.7392271982176746e-16
EarlyStopping counter: 19 out of 100
Updating learning rate to 8.696135991088373e-17
Validation loss decreased (0.023774 --> 0.023632).  Saving model ...
Updating learning rate to 4.3480679955441864e-17
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.1740339977720932e-17
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0870169988860466e-17
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.435084994430233e-18
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7175424972151165e-18
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3587712486075583e-18
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.793856243037791e-19
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.3969281215188956e-19
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6984640607594478e-19
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.492320303797239e-20
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.2461601518986195e-20
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.1230800759493098e-20
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.0615400379746549e-20
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.3077001898732744e-21
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.6538500949366372e-21
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.3269250474683186e-21
EarlyStopping counter: 16 out of 100
Updating learning rate to 6.634625237341593e-22
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.3173126186707965e-22
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.6586563093353983e-22
EarlyStopping counter: 19 out of 100
Updating learning rate to 8.293281546676991e-23
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.1466407733384956e-23
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.0733203866692478e-23
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.0366601933346239e-23
EarlyStopping counter: 23 out of 100
Updating learning rate to 5.1833009666731196e-24
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.5916504833365598e-24
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.2958252416682799e-24
EarlyStopping counter: 26 out of 100
Updating learning rate to 6.479126208341399e-25
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.2395631041706997e-25
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.6197815520853499e-25
EarlyStopping counter: 29 out of 100
Updating learning rate to 8.098907760426749e-26
EarlyStopping counter: 30 out of 100
Updating learning rate to 4.0494538802133747e-26
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.0247269401066873e-26
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.0123634700533437e-26
EarlyStopping counter: 33 out of 100
Updating learning rate to 5.061817350266718e-27
EarlyStopping counter: 34 out of 100
Updating learning rate to 2.530908675133359e-27
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.2654543375666796e-27
EarlyStopping counter: 36 out of 100
Updating learning rate to 6.327271687833398e-28
EarlyStopping counter: 37 out of 100
Updating learning rate to 3.163635843916699e-28
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.5818179219583495e-28
EarlyStopping counter: 39 out of 100
Updating learning rate to 7.909089609791747e-29
EarlyStopping counter: 40 out of 100
Updating learning rate to 3.9545448048958737e-29
EarlyStopping counter: 41 out of 100
Updating learning rate to 1.9772724024479368e-29
EarlyStopping counter: 42 out of 100
Updating learning rate to 9.886362012239684e-30
EarlyStopping counter: 43 out of 100
Updating learning rate to 4.943181006119842e-30
EarlyStopping counter: 44 out of 100
Updating learning rate to 2.471590503059921e-30
EarlyStopping counter: 45 out of 100
Updating learning rate to 1.2357952515299605e-30
EarlyStopping counter: 46 out of 100
Updating learning rate to 6.178976257649803e-31
EarlyStopping counter: 47 out of 100
Updating learning rate to 3.0894881288249013e-31
EarlyStopping counter: 48 out of 100
Updating learning rate to 1.5447440644124507e-31
EarlyStopping counter: 49 out of 100
Updating learning rate to 7.723720322062253e-32
EarlyStopping counter: 50 out of 100
Updating learning rate to 3.8618601610311266e-32
EarlyStopping counter: 51 out of 100
Updating learning rate to 1.9309300805155633e-32
EarlyStopping counter: 52 out of 100
Updating learning rate to 9.654650402577817e-33
EarlyStopping counter: 53 out of 100
Updating learning rate to 4.827325201288908e-33
EarlyStopping counter: 54 out of 100
Updating learning rate to 2.413662600644454e-33
EarlyStopping counter: 55 out of 100
Updating learning rate to 1.206831300322227e-33
>>>>>> Testing on validation set: trial_44 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.049806147813797, mae:0.0720595121383667, dtw:Not calculated


                                                                                         [I 2025-10-17 05:52:27,502] Trial 44 finished with value: 0.0720595121383667 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0007649202111138429, 'dropout': 0.023880531025445084}. Best is trial 36 with value: 0.07200154662132263.
Best trial: 36. Best value: 0.0720015:  88%|████████▊ | 44/50 [2:00:23<14:47, 147.90s/it]Best trial: 36. Best value: 0.0720015:  88%|████████▊ | 44/50 [2:00:23<14:47, 147.90s/it]Best trial: 36. Best value: 0.0720015:  90%|█████████ | 45/50 [2:00:23<11:59, 143.80s/it]
============================================================
Trial 45
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000806
dropout: 0.023643188465636792
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_45 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.025999).  Saving model ...
Updating learning rate to 0.000806227862527709
Validation loss decreased (0.025999 --> 0.025652).  Saving model ...
Updating learning rate to 0.0004031139312638545
Validation loss decreased (0.025652 --> 0.024299).  Saving model ...
Updating learning rate to 0.00020155696563192726
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00010077848281596363
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.0389241407981816e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.5194620703990908e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2597310351995454e-05
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.298655175997727e-06
Validation loss decreased (0.024299 --> 0.024257).  Saving model ...
Updating learning rate to 3.1493275879988635e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5746637939994317e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.873318969997159e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.9366594849985793e-07
Validation loss decreased (0.024257 --> 0.024173).  Saving model ...
Updating learning rate to 1.9683297424992897e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.841648712496448e-08
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.920824356248224e-08
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.460412178124112e-08
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.230206089062056e-08
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.15103044531028e-09
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.07551522265514e-09
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.53775761132757e-09
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.68878805663785e-10
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.844394028318925e-10
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.9221970141594626e-10
EarlyStopping counter: 11 out of 100
Updating learning rate to 9.610985070797313e-11
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.8054925353986564e-11
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.4027462676993282e-11
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.2013731338496641e-11
EarlyStopping counter: 15 out of 100
Updating learning rate to 6.0068656692483205e-12
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.0034328346241603e-12
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.5017164173120801e-12
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.508582086560401e-13
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.7542910432802003e-13
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.8771455216401002e-13
EarlyStopping counter: 21 out of 100
Updating learning rate to 9.385727608200501e-14
EarlyStopping counter: 22 out of 100
Updating learning rate to 4.6928638041002504e-14
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.3464319020501252e-14
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.1732159510250626e-14
EarlyStopping counter: 25 out of 100
Updating learning rate to 5.866079755125313e-15
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.9330398775626565e-15
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.4665199387813283e-15
EarlyStopping counter: 28 out of 100
Updating learning rate to 7.332599693906641e-16
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.6662998469533206e-16
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.8331499234766603e-16
EarlyStopping counter: 31 out of 100
Updating learning rate to 9.165749617383302e-17
EarlyStopping counter: 32 out of 100
Updating learning rate to 4.582874808691651e-17
EarlyStopping counter: 33 out of 100
Updating learning rate to 2.2914374043458254e-17
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.1457187021729127e-17
EarlyStopping counter: 35 out of 100
Updating learning rate to 5.7285935108645635e-18
EarlyStopping counter: 36 out of 100
Updating learning rate to 2.8642967554322817e-18
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.4321483777161409e-18
Validation loss decreased (0.024173 --> 0.023995).  Saving model ...
Updating learning rate to 7.160741888580704e-19
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.580370944290352e-19
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.790185472145176e-19
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.95092736072588e-20
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.47546368036294e-20
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.23773184018147e-20
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.118865920090735e-20
Validation loss decreased (0.023995 --> 0.023920).  Saving model ...
Updating learning rate to 5.594329600453675e-21
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7971648002268376e-21
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3985824001134188e-21
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.992912000567094e-22
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.496456000283547e-22
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.7482280001417735e-22
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.741140000708868e-23
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.370570000354434e-23
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.185285000177217e-23
Validation loss decreased (0.023920 --> 0.023845).  Saving model ...
Updating learning rate to 1.0926425000886085e-23
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.463212500443042e-24
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.731606250221521e-24
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3658031251107606e-24
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.829015625553803e-25
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4145078127769014e-25
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.7072539063884507e-25
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.536269531942254e-26
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.268134765971127e-26
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.1340673829855634e-26
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.0670336914927817e-26
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.3351684574639085e-27
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.6675842287319542e-27
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.3337921143659771e-27
EarlyStopping counter: 14 out of 100
Updating learning rate to 6.668960571829886e-28
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.334480285914943e-28
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.6672401429574714e-28
EarlyStopping counter: 17 out of 100
Updating learning rate to 8.336200714787357e-29
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.1681003573936785e-29
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.0840501786968392e-29
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.0420250893484196e-29
EarlyStopping counter: 21 out of 100
Updating learning rate to 5.210125446742098e-30
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.605062723371049e-30
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.3025313616855245e-30
EarlyStopping counter: 24 out of 100
Updating learning rate to 6.512656808427623e-31
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.2563284042138113e-31
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.6281642021069057e-31
EarlyStopping counter: 27 out of 100
Updating learning rate to 8.140821010534528e-32
EarlyStopping counter: 28 out of 100
Updating learning rate to 4.070410505267264e-32
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.035205252633632e-32
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.017602626316816e-32
EarlyStopping counter: 31 out of 100
Updating learning rate to 5.08801313158408e-33
EarlyStopping counter: 32 out of 100
Updating learning rate to 2.54400656579204e-33
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.27200328289602e-33
>>>>>> Testing on validation set: trial_45 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.05008937790989876, mae:0.07274121046066284, dtw:Not calculated


                                                                                         [I 2025-10-17 05:54:41,866] Trial 45 finished with value: 0.07274121046066284 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.000806227862527709, 'dropout': 0.023643188465636792}. Best is trial 36 with value: 0.07200154662132263.
Best trial: 36. Best value: 0.0720015:  90%|█████████ | 45/50 [2:02:37<11:59, 143.80s/it]Best trial: 36. Best value: 0.0720015:  90%|█████████ | 45/50 [2:02:37<11:59, 143.80s/it]Best trial: 36. Best value: 0.0720015:  92%|█████████▏| 46/50 [2:02:37<09:23, 140.97s/it]
============================================================
Trial 46
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000390
dropout: 0.03529947216000261
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_46 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.030054).  Saving model ...
Updating learning rate to 0.0003902899719302192
Validation loss decreased (0.030054 --> 0.025014).  Saving model ...
Updating learning rate to 0.0001951449859651096
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.75724929825548e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.87862464912774e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.43931232456387e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.219656162281935e-05
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.098280811409675e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.0491404057048374e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.5245702028524187e-06
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.622851014262093e-07
Validation loss decreased (0.025014 --> 0.024453).  Saving model ...
Updating learning rate to 3.8114255071310467e-07
Validation loss decreased (0.024453 --> 0.023879).  Saving model ...
Updating learning rate to 1.9057127535655234e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.528563767827617e-08
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.7642818839138084e-08
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.3821409419569042e-08
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1910704709784521e-08
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.9553523548922605e-09
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.9776761774461303e-09
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4888380887230651e-09
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.444190443615326e-10
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.722095221807663e-10
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.8610476109038314e-10
EarlyStopping counter: 11 out of 100
Updating learning rate to 9.305238054519157e-11
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.6526190272595785e-11
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.3263095136297893e-11
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.1631547568148946e-11
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.815773784074473e-12
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.9078868920372366e-12
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.4539434460186183e-12
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.269717230093091e-13
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.6348586150465457e-13
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.8174293075232729e-13
EarlyStopping counter: 21 out of 100
Updating learning rate to 9.087146537616364e-14
EarlyStopping counter: 22 out of 100
Updating learning rate to 4.543573268808182e-14
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.271786634404091e-14
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.1358933172020455e-14
EarlyStopping counter: 25 out of 100
Updating learning rate to 5.679466586010228e-15
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.839733293005114e-15
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.419866646502557e-15
EarlyStopping counter: 28 out of 100
Updating learning rate to 7.099333232512785e-16
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.5496666162563923e-16
Validation loss decreased (0.023879 --> 0.023618).  Saving model ...
Updating learning rate to 1.7748333081281962e-16
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.874166540640981e-17
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.4370832703204904e-17
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2185416351602452e-17
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1092708175801226e-17
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.546354087900613e-18
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7731770439503065e-18
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3865885219751532e-18
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.932942609875766e-19
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.466471304937883e-19
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.7332356524689416e-19
EarlyStopping counter: 11 out of 100
Updating learning rate to 8.666178262344708e-20
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.333089131172354e-20
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.166544565586177e-20
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.0832722827930885e-20
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.416361413965442e-21
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.708180706982721e-21
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.3540903534913606e-21
EarlyStopping counter: 18 out of 100
Updating learning rate to 6.770451767456803e-22
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.3852258837284015e-22
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.6926129418642007e-22
EarlyStopping counter: 21 out of 100
Updating learning rate to 8.463064709321004e-23
EarlyStopping counter: 22 out of 100
Updating learning rate to 4.231532354660502e-23
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.115766177330251e-23
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.0578830886651255e-23
EarlyStopping counter: 25 out of 100
Updating learning rate to 5.289415443325627e-24
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.6447077216628137e-24
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.3223538608314068e-24
EarlyStopping counter: 28 out of 100
Updating learning rate to 6.611769304157034e-25
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.305884652078517e-25
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.6529423260392585e-25
EarlyStopping counter: 31 out of 100
Updating learning rate to 8.264711630196293e-26
EarlyStopping counter: 32 out of 100
Updating learning rate to 4.1323558150981463e-26
EarlyStopping counter: 33 out of 100
Updating learning rate to 2.0661779075490732e-26
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.0330889537745366e-26
EarlyStopping counter: 35 out of 100
Updating learning rate to 5.165444768872683e-27
EarlyStopping counter: 36 out of 100
Updating learning rate to 2.5827223844363415e-27
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.2913611922181707e-27
EarlyStopping counter: 38 out of 100
Updating learning rate to 6.456805961090854e-28
EarlyStopping counter: 39 out of 100
Updating learning rate to 3.228402980545427e-28
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.6142014902727134e-28
EarlyStopping counter: 41 out of 100
Updating learning rate to 8.071007451363567e-29
EarlyStopping counter: 42 out of 100
Updating learning rate to 4.0355037256817835e-29
EarlyStopping counter: 43 out of 100
Updating learning rate to 2.0177518628408918e-29
EarlyStopping counter: 44 out of 100
Updating learning rate to 1.0088759314204459e-29
EarlyStopping counter: 45 out of 100
Updating learning rate to 5.0443796571022294e-30
EarlyStopping counter: 46 out of 100
Updating learning rate to 2.5221898285511147e-30
EarlyStopping counter: 47 out of 100
Updating learning rate to 1.2610949142755574e-30
EarlyStopping counter: 48 out of 100
Updating learning rate to 6.305474571377787e-31
EarlyStopping counter: 49 out of 100
Updating learning rate to 3.1527372856888934e-31
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.5763686428444467e-31
EarlyStopping counter: 51 out of 100
Updating learning rate to 7.881843214222233e-32
EarlyStopping counter: 52 out of 100
Updating learning rate to 3.940921607111117e-32
EarlyStopping counter: 53 out of 100
Updating learning rate to 1.9704608035555584e-32
EarlyStopping counter: 54 out of 100
Updating learning rate to 9.852304017777792e-33
EarlyStopping counter: 55 out of 100
Updating learning rate to 4.926152008888896e-33
EarlyStopping counter: 56 out of 100
Updating learning rate to 2.463076004444448e-33
EarlyStopping counter: 57 out of 100
Updating learning rate to 1.231538002222224e-33
EarlyStopping counter: 58 out of 100
Updating learning rate to 6.15769001111112e-34
>>>>>> Testing on validation set: trial_46 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.05009860172867775, mae:0.0735270157456398, dtw:Not calculated


                                                                                         [I 2025-10-17 05:56:55,809] Trial 46 finished with value: 0.0735270157456398 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0003902899719302192, 'dropout': 0.03529947216000261}. Best is trial 36 with value: 0.07200154662132263.
Best trial: 36. Best value: 0.0720015:  92%|█████████▏| 46/50 [2:04:51<09:23, 140.97s/it]Best trial: 36. Best value: 0.0720015:  92%|█████████▏| 46/50 [2:04:51<09:23, 140.97s/it]Best trial: 36. Best value: 0.0720015:  94%|█████████▍| 47/50 [2:04:51<06:56, 138.86s/it]
============================================================
Trial 47
============================================================
seq_len: 48, pred_len: 7
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000955
dropout: 0.0013176939117243852
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_47 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 7
============================================================
train 4619
val 253
test 255
Validation loss decreased (inf --> 0.038144).  Saving model ...
Updating learning rate to 0.0009549078236421692
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0004774539118210846
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.0002387269559105423
EarlyStopping counter: 3 out of 100
Updating learning rate to 0.00011936347795527115
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.9681738977635574e-05
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.9840869488817787e-05
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.4920434744408893e-05
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.460217372204447e-06
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.7301086861022234e-06
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.8650543430511117e-06
EarlyStopping counter: 10 out of 100
Updating learning rate to 9.325271715255558e-07
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.662635857627779e-07
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.3313179288138896e-07
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.1656589644069448e-07
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.828294822034724e-08
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.914147411017362e-08
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.457073705508681e-08
EarlyStopping counter: 17 out of 100
Updating learning rate to 7.285368527543405e-09
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.6426842637717025e-09
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.8213421318858513e-09
EarlyStopping counter: 20 out of 100
Updating learning rate to 9.106710659429256e-10
EarlyStopping counter: 21 out of 100
Updating learning rate to 4.553355329714628e-10
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.276677664857314e-10
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.138338832428657e-10
EarlyStopping counter: 24 out of 100
Updating learning rate to 5.691694162143285e-11
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.8458470810716426e-11
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.4229235405358213e-11
EarlyStopping counter: 27 out of 100
Updating learning rate to 7.1146177026791065e-12
EarlyStopping counter: 28 out of 100
Updating learning rate to 3.5573088513395532e-12
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.7786544256697766e-12
EarlyStopping counter: 30 out of 100
Updating learning rate to 8.893272128348883e-13
EarlyStopping counter: 31 out of 100
Updating learning rate to 4.4466360641744415e-13
EarlyStopping counter: 32 out of 100
Updating learning rate to 2.2233180320872208e-13
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.1116590160436104e-13
EarlyStopping counter: 34 out of 100
Updating learning rate to 5.558295080218052e-14
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.779147540109026e-14
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.389573770054513e-14
EarlyStopping counter: 37 out of 100
Updating learning rate to 6.947868850272565e-15
EarlyStopping counter: 38 out of 100
Updating learning rate to 3.4739344251362824e-15
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.7369672125681412e-15
EarlyStopping counter: 40 out of 100
Updating learning rate to 8.684836062840706e-16
EarlyStopping counter: 41 out of 100
Updating learning rate to 4.342418031420353e-16
EarlyStopping counter: 42 out of 100
Updating learning rate to 2.1712090157101765e-16
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.0856045078550883e-16
EarlyStopping counter: 44 out of 100
Updating learning rate to 5.4280225392754413e-17
EarlyStopping counter: 45 out of 100
Updating learning rate to 2.7140112696377207e-17
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.3570056348188603e-17
EarlyStopping counter: 47 out of 100
Updating learning rate to 6.785028174094302e-18
EarlyStopping counter: 48 out of 100
Updating learning rate to 3.392514087047151e-18
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.6962570435235754e-18
EarlyStopping counter: 50 out of 100
Updating learning rate to 8.481285217617877e-19
EarlyStopping counter: 51 out of 100
Updating learning rate to 4.2406426088089385e-19
EarlyStopping counter: 52 out of 100
Updating learning rate to 2.1203213044044693e-19
EarlyStopping counter: 53 out of 100
Updating learning rate to 1.0601606522022346e-19
EarlyStopping counter: 54 out of 100
Updating learning rate to 5.300803261011173e-20
EarlyStopping counter: 55 out of 100
Updating learning rate to 2.6504016305055866e-20
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.3252008152527933e-20
EarlyStopping counter: 57 out of 100
Updating learning rate to 6.6260040762639665e-21
EarlyStopping counter: 58 out of 100
Updating learning rate to 3.3130020381319832e-21
EarlyStopping counter: 59 out of 100
Updating learning rate to 1.6565010190659916e-21
EarlyStopping counter: 60 out of 100
Updating learning rate to 8.282505095329958e-22
EarlyStopping counter: 61 out of 100
Updating learning rate to 4.141252547664979e-22
EarlyStopping counter: 62 out of 100
Updating learning rate to 2.0706262738324895e-22
EarlyStopping counter: 63 out of 100
Updating learning rate to 1.0353131369162448e-22
EarlyStopping counter: 64 out of 100
Updating learning rate to 5.176565684581224e-23
EarlyStopping counter: 65 out of 100
Updating learning rate to 2.588282842290612e-23
EarlyStopping counter: 66 out of 100
Updating learning rate to 1.294141421145306e-23
EarlyStopping counter: 67 out of 100
Updating learning rate to 6.47070710572653e-24
EarlyStopping counter: 68 out of 100
Updating learning rate to 3.235353552863265e-24
EarlyStopping counter: 69 out of 100
Updating learning rate to 1.6176767764316324e-24
EarlyStopping counter: 70 out of 100
Updating learning rate to 8.088383882158162e-25
EarlyStopping counter: 71 out of 100
Updating learning rate to 4.044191941079081e-25
EarlyStopping counter: 72 out of 100
Updating learning rate to 2.0220959705395405e-25
EarlyStopping counter: 73 out of 100
Updating learning rate to 1.0110479852697703e-25
EarlyStopping counter: 74 out of 100
Updating learning rate to 5.0552399263488514e-26
EarlyStopping counter: 75 out of 100
Updating learning rate to 2.5276199631744257e-26
EarlyStopping counter: 76 out of 100
Updating learning rate to 1.2638099815872128e-26
EarlyStopping counter: 77 out of 100
Updating learning rate to 6.319049907936064e-27
EarlyStopping counter: 78 out of 100
Updating learning rate to 3.159524953968032e-27
EarlyStopping counter: 79 out of 100
Updating learning rate to 1.579762476984016e-27
EarlyStopping counter: 80 out of 100
Updating learning rate to 7.89881238492008e-28
EarlyStopping counter: 81 out of 100
Updating learning rate to 3.94940619246004e-28
EarlyStopping counter: 82 out of 100
Updating learning rate to 1.97470309623002e-28
EarlyStopping counter: 83 out of 100
Updating learning rate to 9.8735154811501e-29
EarlyStopping counter: 84 out of 100
Updating learning rate to 4.93675774057505e-29
EarlyStopping counter: 85 out of 100
Updating learning rate to 2.468378870287525e-29
EarlyStopping counter: 86 out of 100
Updating learning rate to 1.2341894351437625e-29
EarlyStopping counter: 87 out of 100
Updating learning rate to 6.170947175718813e-30
EarlyStopping counter: 88 out of 100
Updating learning rate to 3.0854735878594063e-30
EarlyStopping counter: 89 out of 100
Updating learning rate to 1.5427367939297032e-30
EarlyStopping counter: 90 out of 100
Updating learning rate to 7.713683969648516e-31
EarlyStopping counter: 91 out of 100
Updating learning rate to 3.856841984824258e-31
EarlyStopping counter: 92 out of 100
Updating learning rate to 1.928420992412129e-31
EarlyStopping counter: 93 out of 100
Updating learning rate to 9.642104962060645e-32
EarlyStopping counter: 94 out of 100
Updating learning rate to 4.8210524810303224e-32
EarlyStopping counter: 95 out of 100
Updating learning rate to 2.4105262405151612e-32
EarlyStopping counter: 96 out of 100
Updating learning rate to 1.2052631202575806e-32
EarlyStopping counter: 97 out of 100
Updating learning rate to 6.026315601287903e-33
EarlyStopping counter: 98 out of 100
Updating learning rate to 3.0131578006439515e-33
EarlyStopping counter: 99 out of 100
Updating learning rate to 1.5065789003219758e-33
>>>>>> Testing on validation set: trial_47 >>>>>>
test 255
test shape: (255, 7, 5) (255, 7, 5)
test shape: (255, 7, 5) (255, 7, 5)


	mse:0.06439220160245895, mae:0.09712158888578415, dtw:Not calculated


                                                                                         [I 2025-10-17 05:59:09,260] Trial 47 finished with value: 0.09712158888578415 and parameters: {'seq_len': 48, 'pred_len': 7, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0009549078236421692, 'dropout': 0.0013176939117243852}. Best is trial 36 with value: 0.07200154662132263.
Best trial: 36. Best value: 0.0720015:  94%|█████████▍| 47/50 [2:07:05<06:56, 138.86s/it]Best trial: 36. Best value: 0.0720015:  94%|█████████▍| 47/50 [2:07:05<06:56, 138.86s/it]Best trial: 36. Best value: 0.0720015:  96%|█████████▌| 48/50 [2:07:05<04:34, 137.24s/it]
============================================================
Trial 48
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 4
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000053
dropout: 0.019546304137815614
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_48 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.047921).  Saving model ...
Updating learning rate to 5.290454156389225e-05
Validation loss decreased (0.047921 --> 0.037064).  Saving model ...
Updating learning rate to 2.6452270781946125e-05
Validation loss decreased (0.037064 --> 0.028727).  Saving model ...
Updating learning rate to 1.3226135390973062e-05
Validation loss decreased (0.028727 --> 0.026798).  Saving model ...
Updating learning rate to 6.613067695486531e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.3065338477432656e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6532669238716328e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.266334619358164e-07
Validation loss decreased (0.026798 --> 0.026467).  Saving model ...
Updating learning rate to 4.133167309679082e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.066583654839541e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0332918274197705e-07
Validation loss decreased (0.026467 --> 0.026460).  Saving model ...
Updating learning rate to 5.1664591370988525e-08
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.5832295685494262e-08
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2916147842747131e-08
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4580739213735656e-09
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.2290369606867828e-09
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6145184803433914e-09
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.072592401716957e-10
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.0362962008584785e-10
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0181481004292392e-10
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.0090740502146196e-10
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.045370251073098e-11
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.522685125536549e-11
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.2613425627682745e-11
EarlyStopping counter: 13 out of 100
Updating learning rate to 6.306712813841373e-12
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.1533564069206863e-12
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.5766782034603432e-12
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.883391017301716e-13
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.941695508650858e-13
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.970847754325429e-13
EarlyStopping counter: 19 out of 100
Updating learning rate to 9.854238771627145e-14
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.9271193858135724e-14
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.4635596929067862e-14
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.2317798464533931e-14
EarlyStopping counter: 23 out of 100
Updating learning rate to 6.1588992322669655e-15
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.0794496161334827e-15
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.5397248080667414e-15
EarlyStopping counter: 26 out of 100
Updating learning rate to 7.698624040333707e-16
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.8493120201668534e-16
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.9246560100834267e-16
EarlyStopping counter: 29 out of 100
Updating learning rate to 9.623280050417134e-17
EarlyStopping counter: 30 out of 100
Updating learning rate to 4.811640025208567e-17
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.4058200126042834e-17
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.2029100063021417e-17
EarlyStopping counter: 33 out of 100
Updating learning rate to 6.0145500315107084e-18
EarlyStopping counter: 34 out of 100
Updating learning rate to 3.0072750157553542e-18
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.5036375078776771e-18
EarlyStopping counter: 36 out of 100
Updating learning rate to 7.518187539388386e-19
EarlyStopping counter: 37 out of 100
Updating learning rate to 3.759093769694193e-19
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.8795468848470964e-19
EarlyStopping counter: 39 out of 100
Updating learning rate to 9.397734424235482e-20
EarlyStopping counter: 40 out of 100
Updating learning rate to 4.698867212117741e-20
EarlyStopping counter: 41 out of 100
Updating learning rate to 2.3494336060588705e-20
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.1747168030294352e-20
EarlyStopping counter: 43 out of 100
Updating learning rate to 5.873584015147176e-21
EarlyStopping counter: 44 out of 100
Updating learning rate to 2.936792007573588e-21
EarlyStopping counter: 45 out of 100
Updating learning rate to 1.468396003786794e-21
EarlyStopping counter: 46 out of 100
Updating learning rate to 7.34198001893397e-22
EarlyStopping counter: 47 out of 100
Updating learning rate to 3.670990009466985e-22
EarlyStopping counter: 48 out of 100
Updating learning rate to 1.8354950047334926e-22
Validation loss decreased (0.026460 --> 0.026386).  Saving model ...
Updating learning rate to 9.177475023667463e-23
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.5887375118337314e-23
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2943687559168657e-23
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1471843779584329e-23
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.735921889792164e-24
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.867960944896082e-24
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.433980472448041e-24
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.169902362240205e-25
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.5849511811201027e-25
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.7924755905600513e-25
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.962377952800257e-26
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.4811889764001283e-26
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.2405944882000642e-26
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.1202972441000321e-26
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.6014862205001604e-27
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.8007431102500802e-27
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.4003715551250401e-27
EarlyStopping counter: 17 out of 100
Updating learning rate to 7.0018577756252005e-28
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.5009288878126003e-28
Validation loss decreased (0.026386 --> 0.026369).  Saving model ...
Updating learning rate to 1.7504644439063001e-28
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.752322219531501e-29
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.3761611097657503e-29
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.1880805548828752e-29
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0940402774414376e-29
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.470201387207188e-30
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.735100693603594e-30
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.367550346801797e-30
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.837751734008985e-31
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.4188758670044924e-31
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.7094379335022462e-31
EarlyStopping counter: 11 out of 100
Updating learning rate to 8.547189667511231e-32
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.2735948337556156e-32
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.1367974168778078e-32
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.0683987084389039e-32
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.3419935421945194e-33
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.6709967710972597e-33
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.3354983855486299e-33
EarlyStopping counter: 18 out of 100
Updating learning rate to 6.677491927743149e-34
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.3387459638715747e-34
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.6693729819357873e-34
EarlyStopping counter: 21 out of 100
Updating learning rate to 8.346864909678937e-35
>>>>>> Testing on validation set: trial_48 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.05587936192750931, mae:0.08641813695430756, dtw:Not calculated


                                                                                         [I 2025-10-17 06:01:23,522] Trial 48 finished with value: 0.08641813695430756 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 1, 'd_model': 64, 'n_heads': 4, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 5.290454156389225e-05, 'dropout': 0.019546304137815614}. Best is trial 36 with value: 0.07200154662132263.
Best trial: 36. Best value: 0.0720015:  96%|█████████▌| 48/50 [2:09:19<04:34, 137.24s/it]Best trial: 36. Best value: 0.0720015:  96%|█████████▌| 48/50 [2:09:19<04:34, 137.24s/it]Best trial: 36. Best value: 0.0720015:  98%|█████████▊| 49/50 [2:09:19<02:16, 136.35s/it]
============================================================
Trial 49
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000275
dropout: 0.065225731409939
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_49 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.026685).  Saving model ...
Updating learning rate to 0.00027518804202163476
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00013759402101081738
Validation loss decreased (0.026685 --> 0.024620).  Saving model ...
Updating learning rate to 6.879701050540869e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4398505252704345e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.7199252626352172e-05
Validation loss decreased (0.024620 --> 0.023879).  Saving model ...
Updating learning rate to 8.599626313176086e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.299813156588043e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.1499065782940215e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0749532891470108e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.374766445735054e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.687383222867527e-07
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3436916114337635e-07
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.718458057168817e-08
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.3592290285844086e-08
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.6796145142922043e-08
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.398072571461022e-09
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.199036285730511e-09
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.0995181428652554e-09
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.0497590714326277e-09
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.248795357163139e-10
Validation loss decreased (0.023879 --> 0.023722).  Saving model ...
Updating learning rate to 2.624397678581569e-10
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3121988392907846e-10
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.560994196453923e-11
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.2804970982269616e-11
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6402485491134808e-11
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.201242745567404e-12
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.100621372783702e-12
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.050310686391851e-12
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.0251553431959255e-12
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.125776715979627e-13
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.5628883579898137e-13
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.2814441789949069e-13
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.407220894974534e-14
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.203610447487267e-14
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.6018052237436336e-14
EarlyStopping counter: 15 out of 100
Updating learning rate to 8.009026118718168e-15
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.004513059359084e-15
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.002256529679542e-15
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.001128264839771e-15
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.005641324198855e-16
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.5028206620994275e-16
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.2514103310497137e-16
EarlyStopping counter: 22 out of 100
Updating learning rate to 6.257051655248569e-17
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.1285258276242843e-17
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.5642629138121422e-17
EarlyStopping counter: 25 out of 100
Updating learning rate to 7.821314569060711e-18
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.9106572845303554e-18
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.9553286422651777e-18
EarlyStopping counter: 28 out of 100
Updating learning rate to 9.776643211325889e-19
EarlyStopping counter: 29 out of 100
Updating learning rate to 4.888321605662944e-19
EarlyStopping counter: 30 out of 100
Updating learning rate to 2.444160802831472e-19
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.222080401415736e-19
EarlyStopping counter: 32 out of 100
Updating learning rate to 6.11040200707868e-20
EarlyStopping counter: 33 out of 100
Updating learning rate to 3.05520100353934e-20
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.52760050176967e-20
EarlyStopping counter: 35 out of 100
Updating learning rate to 7.63800250884835e-21
EarlyStopping counter: 36 out of 100
Updating learning rate to 3.819001254424175e-21
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.9095006272120876e-21
EarlyStopping counter: 38 out of 100
Updating learning rate to 9.547503136060438e-22
EarlyStopping counter: 39 out of 100
Updating learning rate to 4.773751568030219e-22
EarlyStopping counter: 40 out of 100
Updating learning rate to 2.3868757840151095e-22
EarlyStopping counter: 41 out of 100
Updating learning rate to 1.1934378920075548e-22
EarlyStopping counter: 42 out of 100
Updating learning rate to 5.967189460037774e-23
EarlyStopping counter: 43 out of 100
Updating learning rate to 2.983594730018887e-23
EarlyStopping counter: 44 out of 100
Updating learning rate to 1.4917973650094434e-23
Validation loss decreased (0.023722 --> 0.023674).  Saving model ...
Updating learning rate to 7.458986825047217e-24
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.7294934125236086e-24
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8647467062618043e-24
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.323733531309022e-25
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.661866765654511e-25
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.3309333828272554e-25
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1654666914136277e-25
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.827333457068138e-26
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.913666728534069e-26
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4568333642670346e-26
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.284166821335173e-27
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.6420834106675865e-27
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.8210417053337933e-27
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.105208526668966e-28
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.552604263334483e-28
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.2763021316672416e-28
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.1381510658336208e-28
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.690755329168104e-29
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.845377664584052e-29
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.422688832292026e-29
EarlyStopping counter: 20 out of 100
Updating learning rate to 7.11344416146013e-30
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.556722080730065e-30
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.7783610403650325e-30
EarlyStopping counter: 23 out of 100
Updating learning rate to 8.891805201825162e-31
EarlyStopping counter: 24 out of 100
Updating learning rate to 4.445902600912581e-31
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.2229513004562906e-31
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.1114756502281453e-31
EarlyStopping counter: 27 out of 100
Updating learning rate to 5.557378251140727e-32
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.778689125570363e-32
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.3893445627851816e-32
EarlyStopping counter: 30 out of 100
Updating learning rate to 6.946722813925908e-33
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.473361406962954e-33
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.736680703481477e-33
EarlyStopping counter: 33 out of 100
Updating learning rate to 8.683403517407385e-34
EarlyStopping counter: 34 out of 100
Updating learning rate to 4.341701758703693e-34
>>>>>> Testing on validation set: trial_49 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.05049359053373337, mae:0.07634136825799942, dtw:Not calculated


                                                                                         [I 2025-10-17 06:03:37,554] Trial 49 finished with value: 0.07634136825799942 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.00027518804202163476, 'dropout': 0.065225731409939}. Best is trial 36 with value: 0.07200154662132263.
Best trial: 36. Best value: 0.0720015:  98%|█████████▊| 49/50 [2:11:33<02:16, 136.35s/it]Best trial: 36. Best value: 0.0720015:  98%|█████████▊| 49/50 [2:11:33<02:16, 136.35s/it]Best trial: 36. Best value: 0.0720015: 100%|██████████| 50/50 [2:11:33<00:00, 135.66s/it]Best trial: 36. Best value: 0.0720015: 100%|██████████| 50/50 [2:11:33<00:00, 157.87s/it]

======================================================================
Optimization Complete!
======================================================================
Number of finished trials: 50

Best trial:
  Value (MSE): 0.072002

Best hyperparameters:
  seq_len: 48
  pred_len: 1
  expand: 1
  d_model: 64
  n_heads: 8
  e_layers: 1
  d_layers: 2
  batch_size: 32
  learning_rate: 0.0007798105706884909
  dropout: 0.05336147077129423
======================================================================

✅ Best parameters saved to: ./optuna_results/Mamba_Exchange_14_best_params.json
✅ Visualizations saved to ./optuna_results/

======================================================================
✅ Hyperparameter tuning complete!
✅ Best parameters saved to: ./optuna_results/Mamba_Exchange_14_best_params.json
======================================================================

Next steps:
  1. Review visualizations in optuna_results/ folder
  2. Train final model:
     python train_best_model.py --model Mamba --train_epochs 100
======================================================================
[I 2025-10-17 06:03:50,683] A new study created in RDB with name: Mamba_Exchange_30

======================================================================
Starting Optuna Hyperparameter Optimization
======================================================================
Model: Mamba
Dataset: custom
Number of trials: 50
Study name: Mamba_Exchange_30
Storage: sqlite:///optuna_study.db
======================================================================

  0%|          | 0/50 [00:00<?, ?it/s]
============================================================
Trial 0
============================================================
seq_len: 48, pred_len: 7
d_model: 32, n_heads: 8
e_layers: 2, d_layers: 2
batch_size: 64, lr: 0.000029
dropout: 0.10065772357723764
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 32, expand: 1
>>>>>> Start training: trial_0 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 7
============================================================
train 4619
val 253
test 255
Validation loss decreased (inf --> 0.037085).  Saving model ...
Updating learning rate to 2.8760992638164613e-05
Validation loss decreased (0.037085 --> 0.037062).  Saving model ...
Updating learning rate to 1.4380496319082307e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.190248159541153e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.5951240797705767e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.7975620398852883e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.987810199426442e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.493905099713221e-07
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.2469525498566104e-07
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1234762749283052e-07
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.617381374641526e-08
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.808690687320763e-08
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.4043453436603815e-08
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.0217267183019076e-09
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.5108633591509538e-09
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.7554316795754769e-09
EarlyStopping counter: 14 out of 100
Updating learning rate to 8.777158397877384e-10
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.388579198938692e-10
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.194289599469346e-10
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.097144799734673e-10
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.485723998673365e-11
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.7428619993366826e-11
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.3714309996683413e-11
EarlyStopping counter: 21 out of 100
Updating learning rate to 6.857154998341707e-12
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.4285774991708533e-12
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.7142887495854267e-12
EarlyStopping counter: 24 out of 100
Updating learning rate to 8.571443747927133e-13
EarlyStopping counter: 25 out of 100
Updating learning rate to 4.2857218739635666e-13
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.1428609369817833e-13
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.0714304684908917e-13
EarlyStopping counter: 28 out of 100
Updating learning rate to 5.357152342454458e-14
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.678576171227229e-14
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.3392880856136146e-14
EarlyStopping counter: 31 out of 100
Updating learning rate to 6.696440428068073e-15
EarlyStopping counter: 32 out of 100
Updating learning rate to 3.3482202140340364e-15
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.6741101070170182e-15
EarlyStopping counter: 34 out of 100
Updating learning rate to 8.370550535085091e-16
EarlyStopping counter: 35 out of 100
Updating learning rate to 4.1852752675425455e-16
EarlyStopping counter: 36 out of 100
Updating learning rate to 2.0926376337712728e-16
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.0463188168856364e-16
EarlyStopping counter: 38 out of 100
Updating learning rate to 5.231594084428182e-17
EarlyStopping counter: 39 out of 100
Updating learning rate to 2.615797042214091e-17
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.3078985211070455e-17
EarlyStopping counter: 41 out of 100
Updating learning rate to 6.5394926055352274e-18
EarlyStopping counter: 42 out of 100
Updating learning rate to 3.2697463027676137e-18
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.6348731513838069e-18
EarlyStopping counter: 44 out of 100
Updating learning rate to 8.174365756919034e-19
EarlyStopping counter: 45 out of 100
Updating learning rate to 4.087182878459517e-19
EarlyStopping counter: 46 out of 100
Updating learning rate to 2.0435914392297586e-19
EarlyStopping counter: 47 out of 100
Updating learning rate to 1.0217957196148793e-19
EarlyStopping counter: 48 out of 100
Updating learning rate to 5.1089785980743964e-20
EarlyStopping counter: 49 out of 100
Updating learning rate to 2.5544892990371982e-20
Validation loss decreased (0.037062 --> 0.037056).  Saving model ...
Updating learning rate to 1.2772446495185991e-20
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.3862232475929955e-21
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.1931116237964978e-21
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5965558118982489e-21
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.982779059491244e-22
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.991389529745622e-22
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.995694764872811e-22
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.978473824364055e-23
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.989236912182028e-23
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.494618456091014e-23
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.247309228045507e-23
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.236546140227535e-24
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.1182730701137673e-24
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.5591365350568837e-24
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.795682675284418e-25
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.897841337642209e-25
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.9489206688211046e-25
EarlyStopping counter: 17 out of 100
Updating learning rate to 9.744603344105523e-26
Validation loss decreased (0.037056 --> 0.037048).  Saving model ...
Updating learning rate to 4.8723016720527615e-26
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.4361508360263807e-26
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2180754180131904e-26
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.090377090065952e-27
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.045188545032976e-27
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.522594272516488e-27
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.61297136258244e-28
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.80648568129122e-28
Validation loss decreased (0.037048 --> 0.037040).  Saving model ...
Updating learning rate to 1.90324284064561e-28
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.51621420322805e-29
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.758107101614025e-29
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.3790535508070124e-29
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1895267754035062e-29
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.947633877017531e-30
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.9738169385087655e-30
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4869084692543828e-30
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.434542346271914e-31
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.717271173135957e-31
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.8586355865679785e-31
EarlyStopping counter: 11 out of 100
Updating learning rate to 9.293177932839892e-32
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.646588966419946e-32
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.323294483209973e-32
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.1616472416049865e-32
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.808236208024933e-33
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.9041181040124664e-33
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.4520590520062332e-33
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.260295260031166e-34
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.630147630015583e-34
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.8150738150077915e-34
EarlyStopping counter: 21 out of 100
Updating learning rate to 9.075369075038957e-35
EarlyStopping counter: 22 out of 100
Updating learning rate to 4.5376845375194787e-35
>>>>>> Testing on validation set: trial_0 >>>>>>
test 255
test shape: (255, 7, 5) (255, 7, 5)
test shape: (255, 7, 5) (255, 7, 5)


	mse:0.06395329535007477, mae:0.09803444892168045, dtw:Not calculated


                                      [I 2025-10-17 06:05:00,832] Trial 0 finished with value: 0.09803444892168045 and parameters: {'seq_len': 48, 'pred_len': 7, 'expand': 1, 'd_model': 32, 'n_heads': 8, 'e_layers': 2, 'd_layers': 2, 'batch_size': 64, 'learning_rate': 2.8760992638164613e-05, 'dropout': 0.10065772357723764}. Best is trial 0 with value: 0.09803444892168045.
  0%|          | 0/50 [01:10<?, ?it/s]Best trial: 0. Best value: 0.0980344:   0%|          | 0/50 [01:10<?, ?it/s]Best trial: 0. Best value: 0.0980344:   2%|▏         | 1/50 [01:10<57:18, 70.17s/it]
============================================================
Trial 1
============================================================
seq_len: 48, pred_len: 1
d_model: 32, n_heads: 8
e_layers: 2, d_layers: 1
batch_size: 64, lr: 0.000102
dropout: 0.04484797940833044
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 64, expand: 2
>>>>>> Start training: trial_1 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.037198).  Saving model ...
Updating learning rate to 0.00010168189317730682
Validation loss decreased (0.037198 --> 0.028518).  Saving model ...
Updating learning rate to 5.084094658865341e-05
Validation loss decreased (0.028518 --> 0.026140).  Saving model ...
Updating learning rate to 2.5420473294326705e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2710236647163352e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.355118323581676e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.177559161790838e-06
Validation loss decreased (0.026140 --> 0.026010).  Saving model ...
Updating learning rate to 1.588779580895419e-06
Validation loss decreased (0.026010 --> 0.025403).  Saving model ...
Updating learning rate to 7.943897904477095e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.9719489522385476e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.9859744761192738e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.929872380596369e-08
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.9649361902981845e-08
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.4824680951490923e-08
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.2412340475745461e-08
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.206170237872731e-09
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.1030851189363653e-09
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.5515425594681827e-09
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.757712797340913e-10
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.8788563986704567e-10
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.9394281993352283e-10
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.697140996676142e-11
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.848570498338071e-11
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.4242852491690354e-11
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.2121426245845177e-11
EarlyStopping counter: 17 out of 100
Updating learning rate to 6.0607131229225885e-12
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.0303565614612943e-12
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.5151782807306471e-12
EarlyStopping counter: 20 out of 100
Updating learning rate to 7.575891403653236e-13
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.787945701826618e-13
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.893972850913309e-13
EarlyStopping counter: 23 out of 100
Updating learning rate to 9.469864254566545e-14
EarlyStopping counter: 24 out of 100
Updating learning rate to 4.734932127283272e-14
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.367466063641636e-14
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.183733031820818e-14
Validation loss decreased (0.025403 --> 0.025281).  Saving model ...
Updating learning rate to 5.91866515910409e-15
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.959332579552045e-15
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4796662897760226e-15
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.398331448880113e-16
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.6991657244400565e-16
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8495828622200282e-16
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.247914311100141e-17
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.6239571555500706e-17
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.3119785777750353e-17
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.1559892888875176e-17
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.779946444437588e-18
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.889973222218794e-18
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.444986611109397e-18
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.224933055546985e-19
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.6124665277734926e-19
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.8062332638867463e-19
EarlyStopping counter: 16 out of 100
Updating learning rate to 9.031166319433732e-20
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.515583159716866e-20
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.257791579858433e-20
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.1288957899292165e-20
EarlyStopping counter: 20 out of 100
Updating learning rate to 5.644478949646082e-21
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.822239474823041e-21
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.4111197374115206e-21
EarlyStopping counter: 23 out of 100
Updating learning rate to 7.055598687057603e-22
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.5277993435288014e-22
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.7638996717644007e-22
EarlyStopping counter: 26 out of 100
Updating learning rate to 8.819498358822004e-23
EarlyStopping counter: 27 out of 100
Updating learning rate to 4.409749179411002e-23
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.204874589705501e-23
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.1024372948527504e-23
EarlyStopping counter: 30 out of 100
Updating learning rate to 5.512186474263752e-24
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.756093237131876e-24
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.378046618565938e-24
EarlyStopping counter: 33 out of 100
Updating learning rate to 6.89023309282969e-25
EarlyStopping counter: 34 out of 100
Updating learning rate to 3.445116546414845e-25
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.7225582732074226e-25
EarlyStopping counter: 36 out of 100
Updating learning rate to 8.612791366037113e-26
Validation loss decreased (0.025281 --> 0.025271).  Saving model ...
Updating learning rate to 4.3063956830185564e-26
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.1531978415092782e-26
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0765989207546391e-26
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.3829946037731955e-27
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.6914973018865978e-27
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3457486509432989e-27
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.728743254716494e-28
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.364371627358247e-28
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6821858136791236e-28
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.410929068395618e-29
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.205464534197809e-29
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.1027322670989045e-29
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.0513661335494522e-29
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.256830667747261e-30
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.6284153338736306e-30
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.3142076669368153e-30
EarlyStopping counter: 16 out of 100
Updating learning rate to 6.5710383346840766e-31
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.2855191673420383e-31
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.6427595836710191e-31
EarlyStopping counter: 19 out of 100
Updating learning rate to 8.213797918355096e-32
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.106898959177548e-32
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.053449479588774e-32
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.026724739794387e-32
EarlyStopping counter: 23 out of 100
Updating learning rate to 5.133623698971935e-33
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.5668118494859674e-33
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.2834059247429837e-33
EarlyStopping counter: 26 out of 100
Updating learning rate to 6.4170296237149185e-34
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.2085148118574593e-34
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.6042574059287296e-34
>>>>>> Testing on validation set: trial_1 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.05826561525464058, mae:0.09058274328708649, dtw:Not calculated


                                                                                    [I 2025-10-17 06:06:09,168] Trial 1 finished with value: 0.09058274328708649 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 2, 'd_model': 32, 'n_heads': 8, 'e_layers': 2, 'd_layers': 1, 'batch_size': 64, 'learning_rate': 0.00010168189317730682, 'dropout': 0.04484797940833044}. Best is trial 1 with value: 0.09058274328708649.
Best trial: 0. Best value: 0.0980344:   2%|▏         | 1/50 [02:18<57:18, 70.17s/it]Best trial: 1. Best value: 0.0905827:   2%|▏         | 1/50 [02:18<57:18, 70.17s/it]Best trial: 1. Best value: 0.0905827:   4%|▍         | 2/50 [02:18<55:16, 69.09s/it]
============================================================
Trial 2
============================================================
seq_len: 48, pred_len: 30
d_model: 32, n_heads: 4
e_layers: 2, d_layers: 2
batch_size: 16, lr: 0.000017
dropout: 0.017081967215252347
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 32, expand: 1
>>>>>> Start training: trial_2 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 30
============================================================
train 4596
val 230
test 232
Validation loss decreased (inf --> 0.038206).  Saving model ...
Updating learning rate to 1.7215850550555135e-05
Validation loss decreased (0.038206 --> 0.037805).  Saving model ...
Updating learning rate to 8.607925275277567e-06
Validation loss decreased (0.037805 --> 0.037713).  Saving model ...
Updating learning rate to 4.303962637638784e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.151981318819392e-06
Validation loss decreased (0.037713 --> 0.037298).  Saving model ...
Updating learning rate to 1.075990659409696e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.37995329704848e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.68997664852424e-07
Validation loss decreased (0.037298 --> 0.037200).  Saving model ...
Updating learning rate to 1.34498832426212e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.7249416213106e-08
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.3624708106553e-08
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.68123540532765e-08
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.40617702663825e-09
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.203088513319125e-09
Validation loss decreased (0.037200 --> 0.037185).  Saving model ...
Updating learning rate to 2.1015442566595623e-09
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0507721283297812e-09
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.253860641648906e-10
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.626930320824453e-10
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3134651604122265e-10
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.567325802061132e-11
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.283662901030566e-11
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.641831450515283e-11
Validation loss decreased (0.037185 --> 0.037116).  Saving model ...
Updating learning rate to 8.209157252576415e-12
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.104578626288208e-12
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.052289313144104e-12
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.026144656572052e-12
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.13072328286026e-13
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.56536164143013e-13
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.282680820715065e-13
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.413404103575324e-14
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.206702051787662e-14
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.603351025893831e-14
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.016755129469156e-15
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.008377564734578e-15
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.004188782367289e-15
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.0020943911836444e-15
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.010471955918222e-16
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.505235977959111e-16
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.2526179889795556e-16
EarlyStopping counter: 17 out of 100
Updating learning rate to 6.263089944897778e-17
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.131544972448889e-17
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.5657724862244445e-17
EarlyStopping counter: 20 out of 100
Updating learning rate to 7.828862431122222e-18
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.914431215561111e-18
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.9572156077805556e-18
EarlyStopping counter: 23 out of 100
Updating learning rate to 9.786078038902778e-19
EarlyStopping counter: 24 out of 100
Updating learning rate to 4.893039019451389e-19
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.4465195097256945e-19
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.2232597548628472e-19
EarlyStopping counter: 27 out of 100
Updating learning rate to 6.116298774314236e-20
EarlyStopping counter: 28 out of 100
Updating learning rate to 3.058149387157118e-20
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.529074693578559e-20
EarlyStopping counter: 30 out of 100
Updating learning rate to 7.645373467892795e-21
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.8226867339463976e-21
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.9113433669731988e-21
EarlyStopping counter: 33 out of 100
Updating learning rate to 9.556716834865994e-22
EarlyStopping counter: 34 out of 100
Updating learning rate to 4.778358417432997e-22
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.3891792087164985e-22
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.1945896043582492e-22
EarlyStopping counter: 37 out of 100
Updating learning rate to 5.972948021791246e-23
EarlyStopping counter: 38 out of 100
Updating learning rate to 2.986474010895623e-23
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.4932370054478116e-23
EarlyStopping counter: 40 out of 100
Updating learning rate to 7.466185027239058e-24
EarlyStopping counter: 41 out of 100
Updating learning rate to 3.733092513619529e-24
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.8665462568097644e-24
EarlyStopping counter: 43 out of 100
Updating learning rate to 9.332731284048822e-25
EarlyStopping counter: 44 out of 100
Updating learning rate to 4.666365642024411e-25
EarlyStopping counter: 45 out of 100
Updating learning rate to 2.3331828210122056e-25
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.1665914105061028e-25
EarlyStopping counter: 47 out of 100
Updating learning rate to 5.832957052530514e-26
EarlyStopping counter: 48 out of 100
Updating learning rate to 2.916478526265257e-26
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.4582392631326285e-26
EarlyStopping counter: 50 out of 100
Updating learning rate to 7.291196315663142e-27
EarlyStopping counter: 51 out of 100
Updating learning rate to 3.645598157831571e-27
EarlyStopping counter: 52 out of 100
Updating learning rate to 1.8227990789157856e-27
EarlyStopping counter: 53 out of 100
Updating learning rate to 9.113995394578928e-28
Validation loss decreased (0.037116 --> 0.036998).  Saving model ...
Updating learning rate to 4.556997697289464e-28
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.278498848644732e-28
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.139249424322366e-28
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.69624712161183e-29
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.848123560805915e-29
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4240617804029575e-29
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.120308902014787e-30
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.560154451007394e-30
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.780077225503697e-30
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.900386127518484e-31
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.450193063759242e-31
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.225096531879621e-31
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.1125482659398105e-31
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.562741329699053e-32
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.7813706648495264e-32
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.3906853324247632e-32
EarlyStopping counter: 16 out of 100
Updating learning rate to 6.953426662123816e-33
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.476713331061908e-33
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.738356665530954e-33
EarlyStopping counter: 19 out of 100
Updating learning rate to 8.69178332765477e-34
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.345891663827385e-34
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.1729458319136925e-34
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.0864729159568462e-34
EarlyStopping counter: 23 out of 100
Updating learning rate to 5.432364579784231e-35
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.7161822898921156e-35
>>>>>> Testing on validation set: trial_2 >>>>>>
test 232
test shape: (232, 30, 5) (232, 30, 5)
test shape: (232, 30, 5) (232, 30, 5)


	mse:0.06595481932163239, mae:0.10397341847419739, dtw:Not calculated


                                                                                    [I 2025-10-17 06:10:28,273] Trial 2 finished with value: 0.10397341847419739 and parameters: {'seq_len': 48, 'pred_len': 30, 'expand': 1, 'd_model': 32, 'n_heads': 4, 'e_layers': 2, 'd_layers': 2, 'batch_size': 16, 'learning_rate': 1.7215850550555135e-05, 'dropout': 0.017081967215252347}. Best is trial 1 with value: 0.09058274328708649.
Best trial: 1. Best value: 0.0905827:   4%|▍         | 2/50 [06:37<55:16, 69.09s/it]Best trial: 1. Best value: 0.0905827:   4%|▍         | 2/50 [06:37<55:16, 69.09s/it]Best trial: 1. Best value: 0.0905827:   6%|▌         | 3/50 [06:37<2:02:06, 155.88s/it]
============================================================
Trial 3
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 4
e_layers: 1, d_layers: 2
batch_size: 16, lr: 0.000016
dropout: 0.05425027761336288
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_3 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.034684).  Saving model ...
Updating learning rate to 1.5643220654619114e-05
Validation loss decreased (0.034684 --> 0.033092).  Saving model ...
Updating learning rate to 7.821610327309557e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.910805163654779e-06
Validation loss decreased (0.033092 --> 0.031248).  Saving model ...
Updating learning rate to 1.9554025818273893e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.777012909136946e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.888506454568473e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.4442532272842366e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2221266136421183e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.110633068210592e-08
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.055316534105296e-08
Validation loss decreased (0.031248 --> 0.030982).  Saving model ...
Updating learning rate to 1.527658267052648e-08
Validation loss decreased (0.030982 --> 0.030797).  Saving model ...
Updating learning rate to 7.63829133526324e-09
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.81914566763162e-09
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.90957283381581e-09
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.54786416907905e-10
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.773932084539525e-10
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.3869660422697623e-10
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1934830211348812e-10
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.967415105674406e-11
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.983707552837203e-11
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4918537764186014e-11
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.459268882093007e-12
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.729634441046504e-12
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.864817220523252e-12
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.32408610261626e-13
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.66204305130813e-13
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.331021525654065e-13
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.1655107628270324e-13
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.827553814135162e-14
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.913776907067581e-14
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.4568884535337905e-14
EarlyStopping counter: 20 out of 100
Updating learning rate to 7.284442267668952e-15
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.642221133834476e-15
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.821110566917238e-15
EarlyStopping counter: 23 out of 100
Updating learning rate to 9.10555283458619e-16
EarlyStopping counter: 24 out of 100
Updating learning rate to 4.552776417293095e-16
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.2763882086465476e-16
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.1381941043232738e-16
EarlyStopping counter: 27 out of 100
Updating learning rate to 5.690970521616369e-17
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.8454852608081845e-17
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.4227426304040923e-17
EarlyStopping counter: 30 out of 100
Updating learning rate to 7.113713152020461e-18
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.556856576010231e-18
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.7784282880051153e-18
EarlyStopping counter: 33 out of 100
Updating learning rate to 8.892141440025577e-19
EarlyStopping counter: 34 out of 100
Updating learning rate to 4.446070720012788e-19
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.223035360006394e-19
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.111517680003197e-19
EarlyStopping counter: 37 out of 100
Updating learning rate to 5.557588400015985e-20
EarlyStopping counter: 38 out of 100
Updating learning rate to 2.778794200007993e-20
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.3893971000039964e-20
EarlyStopping counter: 40 out of 100
Updating learning rate to 6.946985500019982e-21
EarlyStopping counter: 41 out of 100
Updating learning rate to 3.473492750009991e-21
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.7367463750049954e-21
EarlyStopping counter: 43 out of 100
Updating learning rate to 8.683731875024977e-22
EarlyStopping counter: 44 out of 100
Updating learning rate to 4.341865937512489e-22
EarlyStopping counter: 45 out of 100
Updating learning rate to 2.1709329687562443e-22
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.0854664843781221e-22
EarlyStopping counter: 47 out of 100
Updating learning rate to 5.427332421890611e-23
EarlyStopping counter: 48 out of 100
Updating learning rate to 2.7136662109453054e-23
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.3568331054726527e-23
EarlyStopping counter: 50 out of 100
Updating learning rate to 6.784165527363263e-24
EarlyStopping counter: 51 out of 100
Updating learning rate to 3.392082763681632e-24
EarlyStopping counter: 52 out of 100
Updating learning rate to 1.696041381840816e-24
EarlyStopping counter: 53 out of 100
Updating learning rate to 8.48020690920408e-25
EarlyStopping counter: 54 out of 100
Updating learning rate to 4.24010345460204e-25
EarlyStopping counter: 55 out of 100
Updating learning rate to 2.12005172730102e-25
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.06002586365051e-25
EarlyStopping counter: 57 out of 100
Updating learning rate to 5.30012931825255e-26
EarlyStopping counter: 58 out of 100
Updating learning rate to 2.650064659126275e-26
EarlyStopping counter: 59 out of 100
Updating learning rate to 1.3250323295631374e-26
EarlyStopping counter: 60 out of 100
Updating learning rate to 6.625161647815687e-27
EarlyStopping counter: 61 out of 100
Updating learning rate to 3.3125808239078435e-27
EarlyStopping counter: 62 out of 100
Updating learning rate to 1.6562904119539217e-27
EarlyStopping counter: 63 out of 100
Updating learning rate to 8.281452059769609e-28
EarlyStopping counter: 64 out of 100
Updating learning rate to 4.140726029884804e-28
EarlyStopping counter: 65 out of 100
Updating learning rate to 2.070363014942402e-28
EarlyStopping counter: 66 out of 100
Updating learning rate to 1.035181507471201e-28
EarlyStopping counter: 67 out of 100
Updating learning rate to 5.175907537356005e-29
EarlyStopping counter: 68 out of 100
Updating learning rate to 2.5879537686780027e-29
EarlyStopping counter: 69 out of 100
Updating learning rate to 1.2939768843390014e-29
EarlyStopping counter: 70 out of 100
Updating learning rate to 6.469884421695007e-30
EarlyStopping counter: 71 out of 100
Updating learning rate to 3.2349422108475034e-30
EarlyStopping counter: 72 out of 100
Updating learning rate to 1.6174711054237517e-30
EarlyStopping counter: 73 out of 100
Updating learning rate to 8.087355527118758e-31
EarlyStopping counter: 74 out of 100
Updating learning rate to 4.043677763559379e-31
EarlyStopping counter: 75 out of 100
Updating learning rate to 2.0218388817796896e-31
EarlyStopping counter: 76 out of 100
Updating learning rate to 1.0109194408898448e-31
EarlyStopping counter: 77 out of 100
Updating learning rate to 5.054597204449224e-32
EarlyStopping counter: 78 out of 100
Updating learning rate to 2.527298602224612e-32
EarlyStopping counter: 79 out of 100
Updating learning rate to 1.263649301112306e-32
EarlyStopping counter: 80 out of 100
Updating learning rate to 6.31824650556153e-33
EarlyStopping counter: 81 out of 100
Updating learning rate to 3.159123252780765e-33
EarlyStopping counter: 82 out of 100
Updating learning rate to 1.5795616263903825e-33
EarlyStopping counter: 83 out of 100
Updating learning rate to 7.897808131951913e-34
EarlyStopping counter: 84 out of 100
Updating learning rate to 3.948904065975956e-34
EarlyStopping counter: 85 out of 100
Updating learning rate to 1.974452032987978e-34
EarlyStopping counter: 86 out of 100
Updating learning rate to 9.87226016493989e-35
EarlyStopping counter: 87 out of 100
Updating learning rate to 4.936130082469945e-35
EarlyStopping counter: 88 out of 100
Updating learning rate to 2.4680650412349727e-35
>>>>>> Testing on validation set: trial_3 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.0567198172211647, mae:0.09160391241312027, dtw:Not calculated


                                                                                       [I 2025-10-17 06:14:51,532] Trial 3 finished with value: 0.09160391241312027 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 2, 'd_model': 64, 'n_heads': 4, 'e_layers': 1, 'd_layers': 2, 'batch_size': 16, 'learning_rate': 1.5643220654619114e-05, 'dropout': 0.05425027761336288}. Best is trial 1 with value: 0.09058274328708649.
Best trial: 1. Best value: 0.0905827:   6%|▌         | 3/50 [11:00<2:02:06, 155.88s/it]Best trial: 1. Best value: 0.0905827:   6%|▌         | 3/50 [11:00<2:02:06, 155.88s/it]Best trial: 1. Best value: 0.0905827:   8%|▊         | 4/50 [11:00<2:31:59, 198.26s/it]
============================================================
Trial 4
============================================================
seq_len: 48, pred_len: 1
d_model: 32, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 16, lr: 0.000025
dropout: 0.03600684596565893
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 32, expand: 1
>>>>>> Start training: trial_4 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.035052).  Saving model ...
Updating learning rate to 2.5278807817587905e-05
Validation loss decreased (0.035052 --> 0.033656).  Saving model ...
Updating learning rate to 1.2639403908793953e-05
Validation loss decreased (0.033656 --> 0.032546).  Saving model ...
Updating learning rate to 6.319701954396976e-06
Validation loss decreased (0.032546 --> 0.032491).  Saving model ...
Updating learning rate to 3.159850977198488e-06
Validation loss decreased (0.032491 --> 0.032288).  Saving model ...
Updating learning rate to 1.579925488599244e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.89962744299622e-07
Validation loss decreased (0.032288 --> 0.032164).  Saving model ...
Updating learning rate to 3.94981372149811e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.974906860749055e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.874534303745275e-08
Validation loss decreased (0.032164 --> 0.032130).  Saving model ...
Updating learning rate to 4.937267151872638e-08
Validation loss decreased (0.032130 --> 0.032063).  Saving model ...
Updating learning rate to 2.468633575936319e-08
Validation loss decreased (0.032063 --> 0.031823).  Saving model ...
Updating learning rate to 1.2343167879681594e-08
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.171583939840797e-09
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.0857919699203986e-09
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5428959849601993e-09
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.714479924800996e-10
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.857239962400498e-10
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.928619981200249e-10
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.643099906001246e-11
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.821549953000623e-11
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.4107749765003114e-11
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.2053874882501557e-11
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.0269374412507785e-12
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.0134687206253892e-12
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.5067343603126946e-12
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.533671801563473e-13
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.7668359007817366e-13
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.8834179503908683e-13
EarlyStopping counter: 17 out of 100
Updating learning rate to 9.417089751954341e-14
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.708544875977171e-14
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.3542724379885853e-14
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.1771362189942927e-14
EarlyStopping counter: 21 out of 100
Updating learning rate to 5.885681094971463e-15
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.9428405474857317e-15
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.4714202737428658e-15
EarlyStopping counter: 24 out of 100
Updating learning rate to 7.357101368714329e-16
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.6785506843571646e-16
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.8392753421785823e-16
EarlyStopping counter: 27 out of 100
Updating learning rate to 9.196376710892912e-17
EarlyStopping counter: 28 out of 100
Updating learning rate to 4.598188355446456e-17
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.299094177723228e-17
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.149547088861614e-17
EarlyStopping counter: 31 out of 100
Updating learning rate to 5.74773544430807e-18
EarlyStopping counter: 32 out of 100
Updating learning rate to 2.873867722154035e-18
Validation loss decreased (0.031823 --> 0.031806).  Saving model ...
Updating learning rate to 1.4369338610770174e-18
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.184669305385087e-19
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.5923346526925436e-19
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.7961673263462718e-19
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.980836631731359e-20
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.4904183158656795e-20
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.2452091579328397e-20
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1226045789664199e-20
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.613022894832099e-21
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.8065114474160497e-21
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.4032557237080248e-21
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.016278618540124e-22
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.508139309270062e-22
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.754069654635031e-22
EarlyStopping counter: 14 out of 100
Updating learning rate to 8.770348273175155e-23
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.3851741365875776e-23
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.1925870682937888e-23
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.0962935341468944e-23
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.481467670734472e-24
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.740733835367236e-24
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.370366917683618e-24
EarlyStopping counter: 21 out of 100
Updating learning rate to 6.85183458841809e-25
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.425917294209045e-25
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.7129586471045225e-25
EarlyStopping counter: 24 out of 100
Updating learning rate to 8.564793235522612e-26
EarlyStopping counter: 25 out of 100
Updating learning rate to 4.282396617761306e-26
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.141198308880653e-26
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.0705991544403266e-26
EarlyStopping counter: 28 out of 100
Updating learning rate to 5.352995772201633e-27
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.6764978861008164e-27
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.3382489430504082e-27
EarlyStopping counter: 31 out of 100
Updating learning rate to 6.691244715252041e-28
EarlyStopping counter: 32 out of 100
Updating learning rate to 3.3456223576260205e-28
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.6728111788130103e-28
EarlyStopping counter: 34 out of 100
Updating learning rate to 8.364055894065051e-29
EarlyStopping counter: 35 out of 100
Updating learning rate to 4.1820279470325256e-29
EarlyStopping counter: 36 out of 100
Updating learning rate to 2.0910139735162628e-29
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.0455069867581314e-29
EarlyStopping counter: 38 out of 100
Updating learning rate to 5.227534933790657e-30
EarlyStopping counter: 39 out of 100
Updating learning rate to 2.6137674668953285e-30
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.3068837334476643e-30
EarlyStopping counter: 41 out of 100
Updating learning rate to 6.534418667238321e-31
EarlyStopping counter: 42 out of 100
Updating learning rate to 3.2672093336191606e-31
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.6336046668095803e-31
EarlyStopping counter: 44 out of 100
Updating learning rate to 8.168023334047902e-32
EarlyStopping counter: 45 out of 100
Updating learning rate to 4.084011667023951e-32
Validation loss decreased (0.031806 --> 0.031798).  Saving model ...
Updating learning rate to 2.0420058335119754e-32
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0210029167559877e-32
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.1050145837799385e-33
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.5525072918899693e-33
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2762536459449846e-33
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.381268229724923e-34
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.1906341148624616e-34
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.5953170574312308e-34
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.976585287156154e-35
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.988292643578077e-35
>>>>>> Testing on validation set: trial_4 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.059255532920360565, mae:0.0938514918088913, dtw:Not calculated


                                                                                       [I 2025-10-17 06:19:13,018] Trial 4 finished with value: 0.0938514918088913 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 1, 'd_model': 32, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 16, 'learning_rate': 2.5278807817587905e-05, 'dropout': 0.03600684596565893}. Best is trial 1 with value: 0.09058274328708649.
Best trial: 1. Best value: 0.0905827:   8%|▊         | 4/50 [15:22<2:31:59, 198.26s/it]Best trial: 1. Best value: 0.0905827:   8%|▊         | 4/50 [15:22<2:31:59, 198.26s/it]Best trial: 1. Best value: 0.0905827:  10%|█         | 5/50 [15:22<2:45:47, 221.05s/it]
============================================================
Trial 5
============================================================
seq_len: 48, pred_len: 7
d_model: 64, n_heads: 8
e_layers: 2, d_layers: 1
batch_size: 32, lr: 0.000643
dropout: 0.03170941756944675
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_5 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 7
============================================================
train 4619
val 253
test 255
Validation loss decreased (inf --> 0.038791).  Saving model ...
Updating learning rate to 0.000643319359509932
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.000321659679754966
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.000160829839877483
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.04149199387415e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.020745996937075e-05
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0103729984685374e-05
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.0051864992342687e-05
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.0259324961713435e-06
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.5129662480856717e-06
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.2564831240428359e-06
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.282415620214179e-07
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.1412078101070897e-07
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.5706039050535448e-07
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.853019525267724e-08
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.926509762633862e-08
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.963254881316931e-08
EarlyStopping counter: 16 out of 100
Updating learning rate to 9.816274406584655e-09
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.908137203292328e-09
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.454068601646164e-09
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.227034300823082e-09
EarlyStopping counter: 20 out of 100
Updating learning rate to 6.13517150411541e-10
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.067585752057705e-10
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.5337928760288524e-10
EarlyStopping counter: 23 out of 100
Updating learning rate to 7.668964380144262e-11
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.834482190072131e-11
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.9172410950360655e-11
EarlyStopping counter: 26 out of 100
Updating learning rate to 9.586205475180327e-12
EarlyStopping counter: 27 out of 100
Updating learning rate to 4.793102737590164e-12
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.396551368795082e-12
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.198275684397541e-12
EarlyStopping counter: 30 out of 100
Updating learning rate to 5.991378421987705e-13
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.9956892109938523e-13
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.4978446054969262e-13
EarlyStopping counter: 33 out of 100
Updating learning rate to 7.489223027484631e-14
EarlyStopping counter: 34 out of 100
Updating learning rate to 3.7446115137423154e-14
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.8723057568711577e-14
EarlyStopping counter: 36 out of 100
Updating learning rate to 9.361528784355788e-15
EarlyStopping counter: 37 out of 100
Updating learning rate to 4.680764392177894e-15
EarlyStopping counter: 38 out of 100
Updating learning rate to 2.340382196088947e-15
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.1701910980444736e-15
EarlyStopping counter: 40 out of 100
Updating learning rate to 5.850955490222368e-16
EarlyStopping counter: 41 out of 100
Updating learning rate to 2.925477745111184e-16
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.462738872555592e-16
EarlyStopping counter: 43 out of 100
Updating learning rate to 7.31369436277796e-17
EarlyStopping counter: 44 out of 100
Updating learning rate to 3.65684718138898e-17
EarlyStopping counter: 45 out of 100
Updating learning rate to 1.82842359069449e-17
EarlyStopping counter: 46 out of 100
Updating learning rate to 9.14211795347245e-18
EarlyStopping counter: 47 out of 100
Updating learning rate to 4.571058976736225e-18
EarlyStopping counter: 48 out of 100
Updating learning rate to 2.2855294883681124e-18
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.1427647441840562e-18
EarlyStopping counter: 50 out of 100
Updating learning rate to 5.713823720920281e-19
EarlyStopping counter: 51 out of 100
Updating learning rate to 2.8569118604601405e-19
EarlyStopping counter: 52 out of 100
Updating learning rate to 1.4284559302300703e-19
EarlyStopping counter: 53 out of 100
Updating learning rate to 7.142279651150351e-20
EarlyStopping counter: 54 out of 100
Updating learning rate to 3.5711398255751757e-20
EarlyStopping counter: 55 out of 100
Updating learning rate to 1.7855699127875878e-20
EarlyStopping counter: 56 out of 100
Updating learning rate to 8.927849563937939e-21
EarlyStopping counter: 57 out of 100
Updating learning rate to 4.4639247819689696e-21
EarlyStopping counter: 58 out of 100
Updating learning rate to 2.2319623909844848e-21
EarlyStopping counter: 59 out of 100
Updating learning rate to 1.1159811954922424e-21
EarlyStopping counter: 60 out of 100
Updating learning rate to 5.579905977461212e-22
EarlyStopping counter: 61 out of 100
Updating learning rate to 2.789952988730606e-22
EarlyStopping counter: 62 out of 100
Updating learning rate to 1.394976494365303e-22
EarlyStopping counter: 63 out of 100
Updating learning rate to 6.974882471826515e-23
EarlyStopping counter: 64 out of 100
Updating learning rate to 3.4874412359132575e-23
EarlyStopping counter: 65 out of 100
Updating learning rate to 1.7437206179566287e-23
EarlyStopping counter: 66 out of 100
Updating learning rate to 8.718603089783144e-24
EarlyStopping counter: 67 out of 100
Updating learning rate to 4.359301544891572e-24
EarlyStopping counter: 68 out of 100
Updating learning rate to 2.179650772445786e-24
EarlyStopping counter: 69 out of 100
Updating learning rate to 1.089825386222893e-24
EarlyStopping counter: 70 out of 100
Updating learning rate to 5.449126931114465e-25
EarlyStopping counter: 71 out of 100
Updating learning rate to 2.7245634655572324e-25
EarlyStopping counter: 72 out of 100
Updating learning rate to 1.3622817327786162e-25
EarlyStopping counter: 73 out of 100
Updating learning rate to 6.811408663893081e-26
EarlyStopping counter: 74 out of 100
Updating learning rate to 3.4057043319465405e-26
EarlyStopping counter: 75 out of 100
Updating learning rate to 1.7028521659732703e-26
EarlyStopping counter: 76 out of 100
Updating learning rate to 8.514260829866351e-27
EarlyStopping counter: 77 out of 100
Updating learning rate to 4.2571304149331756e-27
EarlyStopping counter: 78 out of 100
Updating learning rate to 2.1285652074665878e-27
EarlyStopping counter: 79 out of 100
Updating learning rate to 1.0642826037332939e-27
EarlyStopping counter: 80 out of 100
Updating learning rate to 5.3214130186664695e-28
EarlyStopping counter: 81 out of 100
Updating learning rate to 2.6607065093332348e-28
EarlyStopping counter: 82 out of 100
Updating learning rate to 1.3303532546666174e-28
EarlyStopping counter: 83 out of 100
Updating learning rate to 6.651766273333087e-29
EarlyStopping counter: 84 out of 100
Updating learning rate to 3.3258831366665435e-29
EarlyStopping counter: 85 out of 100
Updating learning rate to 1.6629415683332717e-29
EarlyStopping counter: 86 out of 100
Updating learning rate to 8.314707841666359e-30
EarlyStopping counter: 87 out of 100
Updating learning rate to 4.157353920833179e-30
EarlyStopping counter: 88 out of 100
Updating learning rate to 2.0786769604165897e-30
EarlyStopping counter: 89 out of 100
Updating learning rate to 1.0393384802082948e-30
EarlyStopping counter: 90 out of 100
Updating learning rate to 5.196692401041474e-31
EarlyStopping counter: 91 out of 100
Updating learning rate to 2.598346200520737e-31
EarlyStopping counter: 92 out of 100
Updating learning rate to 1.2991731002603685e-31
EarlyStopping counter: 93 out of 100
Updating learning rate to 6.495865501301843e-32
EarlyStopping counter: 94 out of 100
Updating learning rate to 3.2479327506509214e-32
EarlyStopping counter: 95 out of 100
Updating learning rate to 1.6239663753254607e-32
EarlyStopping counter: 96 out of 100
Updating learning rate to 8.119831876627303e-33
EarlyStopping counter: 97 out of 100
Updating learning rate to 4.059915938313652e-33
EarlyStopping counter: 98 out of 100
Updating learning rate to 2.029957969156826e-33
EarlyStopping counter: 99 out of 100
Updating learning rate to 1.014978984578413e-33
>>>>>> Testing on validation set: trial_5 >>>>>>
test 255
test shape: (255, 7, 5) (255, 7, 5)
test shape: (255, 7, 5) (255, 7, 5)


	mse:0.07032336294651031, mae:0.10262738168239594, dtw:Not calculated


                                                                                       [I 2025-10-17 06:21:26,568] Trial 5 finished with value: 0.10262738168239594 and parameters: {'seq_len': 48, 'pred_len': 7, 'expand': 2, 'd_model': 64, 'n_heads': 8, 'e_layers': 2, 'd_layers': 1, 'batch_size': 32, 'learning_rate': 0.000643319359509932, 'dropout': 0.03170941756944675}. Best is trial 1 with value: 0.09058274328708649.
Best trial: 1. Best value: 0.0905827:  10%|█         | 5/50 [17:35<2:45:47, 221.05s/it]Best trial: 1. Best value: 0.0905827:  10%|█         | 5/50 [17:35<2:45:47, 221.05s/it]Best trial: 1. Best value: 0.0905827:  12%|█▏        | 6/50 [17:35<2:20:17, 191.30s/it]
============================================================
Trial 6
============================================================
seq_len: 48, pred_len: 1
d_model: 32, n_heads: 4
e_layers: 1, d_layers: 1
batch_size: 16, lr: 0.000043
dropout: 0.11207280855671857
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 64, expand: 2
>>>>>> Start training: trial_6 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.035520).  Saving model ...
Updating learning rate to 4.3389060382965366e-05
Validation loss decreased (0.035520 --> 0.033709).  Saving model ...
Updating learning rate to 2.1694530191482683e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0847265095741341e-05
Validation loss decreased (0.033709 --> 0.032748).  Saving model ...
Updating learning rate to 5.423632547870671e-06
Validation loss decreased (0.032748 --> 0.032159).  Saving model ...
Updating learning rate to 2.7118162739353354e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3559081369676677e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.779540684838338e-07
Validation loss decreased (0.032159 --> 0.031103).  Saving model ...
Updating learning rate to 3.389770342419169e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6948851712095846e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.474425856047923e-08
Validation loss decreased (0.031103 --> 0.031073).  Saving model ...
Updating learning rate to 4.2372129280239615e-08
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.1186064640119808e-08
Validation loss decreased (0.031073 --> 0.030892).  Saving model ...
Updating learning rate to 1.0593032320059904e-08
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.296516160029952e-09
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.648258080014976e-09
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.324129040007488e-09
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.62064520003744e-10
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.31032260001872e-10
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.65516130000936e-10
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.2758065000468e-11
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.1379032500234e-11
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.0689516250117e-11
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.03447581250585e-11
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.17237906252925e-12
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.586189531264625e-12
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.2930947656323125e-12
Validation loss decreased (0.030892 --> 0.030855).  Saving model ...
Updating learning rate to 6.465473828161562e-13
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.232736914080781e-13
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6163684570403906e-13
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.081842285201953e-14
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.0409211426009765e-14
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0204605713004882e-14
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.0102302856502441e-14
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.0511514282512206e-15
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.5255757141256103e-15
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.2627878570628051e-15
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.313939285314026e-16
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.156969642657013e-16
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.5784848213285064e-16
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.892424106642532e-17
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.946212053321266e-17
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.973106026660633e-17
EarlyStopping counter: 16 out of 100
Updating learning rate to 9.865530133303165e-18
Validation loss decreased (0.030855 --> 0.030764).  Saving model ...
Updating learning rate to 4.9327650666515826e-18
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.4663825333257913e-18
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2331912666628957e-18
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.165956333314478e-19
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.082978166657239e-19
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.5414890833286196e-19
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.707445416643098e-20
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.853722708321549e-20
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.9268613541607745e-20
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.634306770803872e-21
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.817153385401936e-21
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.408576692700968e-21
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.204288346350484e-21
EarlyStopping counter: 13 out of 100
Updating learning rate to 6.02144173175242e-22
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.01072086587621e-22
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.505360432938105e-22
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.526802164690525e-23
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.7634010823452626e-23
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.8817005411726313e-23
EarlyStopping counter: 19 out of 100
Updating learning rate to 9.408502705863157e-24
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.704251352931578e-24
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.352125676465789e-24
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.1760628382328946e-24
EarlyStopping counter: 23 out of 100
Updating learning rate to 5.880314191164473e-25
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.9401570955822364e-25
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.4700785477911182e-25
EarlyStopping counter: 26 out of 100
Updating learning rate to 7.350392738955591e-26
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.6751963694777955e-26
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.8375981847388978e-26
EarlyStopping counter: 29 out of 100
Updating learning rate to 9.187990923694489e-27
EarlyStopping counter: 30 out of 100
Updating learning rate to 4.5939954618472444e-27
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.2969977309236222e-27
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.1484988654618111e-27
EarlyStopping counter: 33 out of 100
Updating learning rate to 5.7424943273090555e-28
EarlyStopping counter: 34 out of 100
Updating learning rate to 2.8712471636545277e-28
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.4356235818272639e-28
EarlyStopping counter: 36 out of 100
Updating learning rate to 7.178117909136319e-29
EarlyStopping counter: 37 out of 100
Updating learning rate to 3.5890589545681597e-29
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.7945294772840798e-29
EarlyStopping counter: 39 out of 100
Updating learning rate to 8.972647386420399e-30
EarlyStopping counter: 40 out of 100
Updating learning rate to 4.4863236932101996e-30
EarlyStopping counter: 41 out of 100
Updating learning rate to 2.2431618466050998e-30
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.1215809233025499e-30
EarlyStopping counter: 43 out of 100
Updating learning rate to 5.6079046165127495e-31
EarlyStopping counter: 44 out of 100
Updating learning rate to 2.8039523082563748e-31
EarlyStopping counter: 45 out of 100
Updating learning rate to 1.4019761541281874e-31
EarlyStopping counter: 46 out of 100
Updating learning rate to 7.009880770640937e-32
EarlyStopping counter: 47 out of 100
Updating learning rate to 3.5049403853204684e-32
EarlyStopping counter: 48 out of 100
Updating learning rate to 1.7524701926602342e-32
EarlyStopping counter: 49 out of 100
Updating learning rate to 8.762350963301171e-33
EarlyStopping counter: 50 out of 100
Updating learning rate to 4.3811754816505856e-33
Validation loss decreased (0.030764 --> 0.030743).  Saving model ...
Updating learning rate to 2.1905877408252928e-33
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0952938704126464e-33
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.476469352063232e-34
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.738234676031616e-34
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.369117338015808e-34
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.84558669007904e-35
>>>>>> Testing on validation set: trial_6 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.05773654580116272, mae:0.09164708852767944, dtw:Not calculated


                                                                                       [I 2025-10-17 06:25:47,965] Trial 6 finished with value: 0.09164708852767944 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 2, 'd_model': 32, 'n_heads': 4, 'e_layers': 1, 'd_layers': 1, 'batch_size': 16, 'learning_rate': 4.3389060382965366e-05, 'dropout': 0.11207280855671857}. Best is trial 1 with value: 0.09058274328708649.
Best trial: 1. Best value: 0.0905827:  12%|█▏        | 6/50 [21:57<2:20:17, 191.30s/it]Best trial: 1. Best value: 0.0905827:  12%|█▏        | 6/50 [21:57<2:20:17, 191.30s/it]Best trial: 1. Best value: 0.0905827:  14%|█▍        | 7/50 [21:57<2:33:31, 214.22s/it]
============================================================
Trial 7
============================================================
seq_len: 48, pred_len: 1
d_model: 32, n_heads: 4
e_layers: 2, d_layers: 2
batch_size: 32, lr: 0.000011
dropout: 0.12011388329124006
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 64, expand: 2
>>>>>> Start training: trial_7 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.031580).  Saving model ...
Updating learning rate to 1.0709873047007737e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.354936523503868e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.677468261751934e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.338734130875967e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.693670654379835e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.3468353271899177e-07
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6734176635949589e-07
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.367088317974794e-08
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.183544158987397e-08
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.0917720794936986e-08
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.0458860397468493e-08
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.2294301987342464e-09
Validation loss decreased (0.031580 --> 0.031315).  Saving model ...
Updating learning rate to 2.6147150993671232e-09
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3073575496835616e-09
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.536787748417808e-10
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.268393874208904e-10
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.634196937104452e-10
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.17098468552226e-11
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.08549234276113e-11
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.042746171380565e-11
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.0213730856902825e-11
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.1068654284514125e-12
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.5534327142257063e-12
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.2767163571128531e-12
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.383581785564266e-13
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.191790892782133e-13
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.5958954463910664e-13
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.979477231955332e-14
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.989738615977666e-14
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.994869307988833e-14
EarlyStopping counter: 18 out of 100
Updating learning rate to 9.974346539944165e-15
Validation loss decreased (0.031315 --> 0.031251).  Saving model ...
Updating learning rate to 4.9871732699720826e-15
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.4935866349860413e-15
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2467933174930206e-15
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.233966587465103e-16
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.1169832937325516e-16
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.5584916468662758e-16
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.792458234331379e-17
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.8962291171656895e-17
Validation loss decreased (0.031251 --> 0.031021).  Saving model ...
Updating learning rate to 1.9481145585828447e-17
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.740572792914224e-18
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.870286396457112e-18
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.435143198228556e-18
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.217571599114278e-18
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.08785799557139e-19
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.043928997785695e-19
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.5219644988928475e-19
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.609822494464237e-20
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.8049112472321186e-20
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.9024556236160593e-20
EarlyStopping counter: 11 out of 100
Updating learning rate to 9.512278118080297e-21
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.756139059040148e-21
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.378069529520074e-21
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.189034764760037e-21
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.945173823800185e-22
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.9725869119000927e-22
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.4862934559500463e-22
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.431467279750232e-23
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.715733639875116e-23
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.857866819937558e-23
EarlyStopping counter: 21 out of 100
Updating learning rate to 9.28933409968779e-24
EarlyStopping counter: 22 out of 100
Updating learning rate to 4.644667049843895e-24
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.3223335249219474e-24
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.1611667624609737e-24
EarlyStopping counter: 25 out of 100
Updating learning rate to 5.8058338123048685e-25
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.9029169061524343e-25
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.4514584530762171e-25
EarlyStopping counter: 28 out of 100
Updating learning rate to 7.257292265381086e-26
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.628646132690543e-26
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.8143230663452714e-26
EarlyStopping counter: 31 out of 100
Updating learning rate to 9.071615331726357e-27
EarlyStopping counter: 32 out of 100
Updating learning rate to 4.5358076658631785e-27
EarlyStopping counter: 33 out of 100
Updating learning rate to 2.2679038329315893e-27
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.1339519164657946e-27
EarlyStopping counter: 35 out of 100
Updating learning rate to 5.669759582328973e-28
EarlyStopping counter: 36 out of 100
Updating learning rate to 2.8348797911644866e-28
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.4174398955822433e-28
EarlyStopping counter: 38 out of 100
Updating learning rate to 7.087199477911216e-29
EarlyStopping counter: 39 out of 100
Updating learning rate to 3.543599738955608e-29
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.771799869477804e-29
EarlyStopping counter: 41 out of 100
Updating learning rate to 8.85899934738902e-30
EarlyStopping counter: 42 out of 100
Updating learning rate to 4.42949967369451e-30
EarlyStopping counter: 43 out of 100
Updating learning rate to 2.214749836847255e-30
EarlyStopping counter: 44 out of 100
Updating learning rate to 1.1073749184236276e-30
EarlyStopping counter: 45 out of 100
Updating learning rate to 5.536874592118138e-31
EarlyStopping counter: 46 out of 100
Updating learning rate to 2.768437296059069e-31
EarlyStopping counter: 47 out of 100
Updating learning rate to 1.3842186480295345e-31
EarlyStopping counter: 48 out of 100
Updating learning rate to 6.921093240147672e-32
EarlyStopping counter: 49 out of 100
Updating learning rate to 3.460546620073836e-32
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.730273310036918e-32
EarlyStopping counter: 51 out of 100
Updating learning rate to 8.65136655018459e-33
EarlyStopping counter: 52 out of 100
Updating learning rate to 4.325683275092295e-33
EarlyStopping counter: 53 out of 100
Updating learning rate to 2.1628416375461476e-33
EarlyStopping counter: 54 out of 100
Updating learning rate to 1.0814208187730738e-33
EarlyStopping counter: 55 out of 100
Updating learning rate to 5.407104093865369e-34
EarlyStopping counter: 56 out of 100
Updating learning rate to 2.7035520469326845e-34
EarlyStopping counter: 57 out of 100
Updating learning rate to 1.3517760234663423e-34
EarlyStopping counter: 58 out of 100
Updating learning rate to 6.758880117331711e-35
EarlyStopping counter: 59 out of 100
Updating learning rate to 3.3794400586658556e-35
EarlyStopping counter: 60 out of 100
Updating learning rate to 1.6897200293329278e-35
>>>>>> Testing on validation set: trial_7 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.06093538925051689, mae:0.09414182603359222, dtw:Not calculated


                                                                                       [I 2025-10-17 06:28:00,812] Trial 7 finished with value: 0.09414182603359222 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 2, 'd_model': 32, 'n_heads': 4, 'e_layers': 2, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 1.0709873047007737e-05, 'dropout': 0.12011388329124006}. Best is trial 1 with value: 0.09058274328708649.
Best trial: 1. Best value: 0.0905827:  14%|█▍        | 7/50 [24:10<2:33:31, 214.22s/it]Best trial: 1. Best value: 0.0905827:  14%|█▍        | 7/50 [24:10<2:33:31, 214.22s/it]Best trial: 1. Best value: 0.0905827:  16%|█▌        | 8/50 [24:10<2:11:49, 188.31s/it]
============================================================
Trial 8
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 4
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000030
dropout: 0.19513272811210544
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_8 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.029955).  Saving model ...
Updating learning rate to 2.9897918419384755e-05
Validation loss decreased (0.029955 --> 0.029894).  Saving model ...
Updating learning rate to 1.4948959209692378e-05
Validation loss decreased (0.029894 --> 0.028341).  Saving model ...
Updating learning rate to 7.474479604846189e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.7372398024230944e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8686199012115472e-06
Validation loss decreased (0.028341 --> 0.027221).  Saving model ...
Updating learning rate to 9.343099506057736e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.671549753028868e-07
Validation loss decreased (0.027221 --> 0.026998).  Saving model ...
Updating learning rate to 2.335774876514434e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.167887438257217e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.839437191286085e-08
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.9197185956430425e-08
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4598592978215212e-08
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.299296489107606e-09
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.649648244553803e-09
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8248241222769016e-09
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.124120611384508e-10
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.562060305692254e-10
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.281030152846127e-10
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.1405150764230635e-10
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.7025753821153174e-11
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.8512876910576587e-11
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.4256438455288293e-11
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.128219227644147e-12
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.5641096138220733e-12
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.7820548069110367e-12
EarlyStopping counter: 18 out of 100
Updating learning rate to 8.910274034555183e-13
Validation loss decreased (0.026998 --> 0.026986).  Saving model ...
Updating learning rate to 4.4551370172775917e-13
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2275685086387958e-13
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1137842543193979e-13
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.5689212715969896e-14
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7844606357984948e-14
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3922303178992474e-14
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.961151589496237e-15
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.4805757947481185e-15
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.7402878973740593e-15
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.701439486870296e-16
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.350719743435148e-16
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.175359871717574e-16
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.087679935858787e-16
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.438399679293935e-17
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.7191998396469676e-17
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.3595999198234838e-17
EarlyStopping counter: 16 out of 100
Updating learning rate to 6.797999599117419e-18
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.3989997995587095e-18
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.6994998997793547e-18
EarlyStopping counter: 19 out of 100
Updating learning rate to 8.497499498896774e-19
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.248749749448387e-19
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.1243748747241934e-19
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.0621874373620967e-19
EarlyStopping counter: 23 out of 100
Updating learning rate to 5.3109371868104836e-20
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.6554685934052418e-20
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.3277342967026209e-20
EarlyStopping counter: 26 out of 100
Updating learning rate to 6.6386714835131044e-21
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.3193357417565522e-21
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.6596678708782761e-21
EarlyStopping counter: 29 out of 100
Updating learning rate to 8.298339354391381e-22
EarlyStopping counter: 30 out of 100
Updating learning rate to 4.1491696771956903e-22
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.0745848385978451e-22
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.0372924192989226e-22
EarlyStopping counter: 33 out of 100
Updating learning rate to 5.186462096494613e-23
EarlyStopping counter: 34 out of 100
Updating learning rate to 2.5932310482473064e-23
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.2966155241236532e-23
EarlyStopping counter: 36 out of 100
Updating learning rate to 6.483077620618266e-24
EarlyStopping counter: 37 out of 100
Updating learning rate to 3.241538810309133e-24
Validation loss decreased (0.026986 --> 0.026952).  Saving model ...
Updating learning rate to 1.6207694051545665e-24
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.103847025772833e-25
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.0519235128864163e-25
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0259617564432081e-25
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0129808782216041e-25
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.0649043911080204e-26
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.5324521955540102e-26
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.2662260977770051e-26
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.3311304888850254e-27
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.1655652444425127e-27
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.5827826222212564e-27
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.913913111106282e-28
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.956956555553141e-28
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.9784782777765705e-28
EarlyStopping counter: 14 out of 100
Updating learning rate to 9.892391388882852e-29
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.946195694441426e-29
Validation loss decreased (0.026952 --> 0.026796).  Saving model ...
Updating learning rate to 2.473097847220713e-29
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2365489236103565e-29
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.182744618051783e-30
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.0913723090258913e-30
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5456861545129457e-30
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.728430772564728e-31
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.864215386282364e-31
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.932107693141182e-31
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.66053846570591e-32
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.830269232852955e-32
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.4151346164264776e-32
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.2075673082132388e-32
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.037836541066194e-33
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.018918270533097e-33
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.5094591352665485e-33
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.5472956763327425e-34
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.7736478381663713e-34
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.8868239190831856e-34
EarlyStopping counter: 18 out of 100
Updating learning rate to 9.434119595415928e-35
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.717059797707964e-35
>>>>>> Testing on validation set: trial_8 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.056380413472652435, mae:0.08846942335367203, dtw:Not calculated


                                                                                       [I 2025-10-17 06:30:15,004] Trial 8 finished with value: 0.08846942335367203 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 2, 'd_model': 64, 'n_heads': 4, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 2.9897918419384755e-05, 'dropout': 0.19513272811210544}. Best is trial 8 with value: 0.08846942335367203.
Best trial: 1. Best value: 0.0905827:  16%|█▌        | 8/50 [26:24<2:11:49, 188.31s/it]Best trial: 8. Best value: 0.0884694:  16%|█▌        | 8/50 [26:24<2:11:49, 188.31s/it]Best trial: 8. Best value: 0.0884694:  18%|█▊        | 9/50 [26:24<1:57:07, 171.39s/it]
============================================================
Trial 9
============================================================
seq_len: 48, pred_len: 7
d_model: 64, n_heads: 8
e_layers: 2, d_layers: 2
batch_size: 16, lr: 0.000366
dropout: 0.02220464345584758
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_9 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 7
============================================================
train 4619
val 253
test 255
Validation loss decreased (inf --> 0.038192).  Saving model ...
Updating learning rate to 0.00036566016469027207
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00018283008234513604
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.141504117256802e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.570752058628401e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2853760293142005e-05
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1426880146571002e-05
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.713440073285501e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.8567200366427506e-06
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.4283600183213753e-06
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.141800091606876e-07
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.570900045803438e-07
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.785450022901719e-07
EarlyStopping counter: 12 out of 100
Updating learning rate to 8.927250114508596e-08
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.463625057254298e-08
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.231812528627149e-08
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.1159062643135744e-08
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.579531321567872e-09
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.789765660783936e-09
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.394882830391968e-09
EarlyStopping counter: 19 out of 100
Updating learning rate to 6.97441415195984e-10
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.48720707597992e-10
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.74360353798996e-10
EarlyStopping counter: 22 out of 100
Updating learning rate to 8.7180176899498e-11
EarlyStopping counter: 23 out of 100
Updating learning rate to 4.3590088449749e-11
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.17950442248745e-11
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.089752211243725e-11
EarlyStopping counter: 26 out of 100
Updating learning rate to 5.448761056218625e-12
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.7243805281093126e-12
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.3621902640546563e-12
EarlyStopping counter: 29 out of 100
Updating learning rate to 6.810951320273281e-13
EarlyStopping counter: 30 out of 100
Updating learning rate to 3.405475660136641e-13
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.7027378300683204e-13
EarlyStopping counter: 32 out of 100
Updating learning rate to 8.513689150341602e-14
EarlyStopping counter: 33 out of 100
Updating learning rate to 4.256844575170801e-14
EarlyStopping counter: 34 out of 100
Updating learning rate to 2.1284222875854005e-14
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.0642111437927002e-14
EarlyStopping counter: 36 out of 100
Updating learning rate to 5.321055718963501e-15
EarlyStopping counter: 37 out of 100
Updating learning rate to 2.6605278594817506e-15
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.3302639297408753e-15
EarlyStopping counter: 39 out of 100
Updating learning rate to 6.651319648704376e-16
EarlyStopping counter: 40 out of 100
Updating learning rate to 3.325659824352188e-16
EarlyStopping counter: 41 out of 100
Updating learning rate to 1.662829912176094e-16
EarlyStopping counter: 42 out of 100
Updating learning rate to 8.31414956088047e-17
EarlyStopping counter: 43 out of 100
Updating learning rate to 4.157074780440235e-17
EarlyStopping counter: 44 out of 100
Updating learning rate to 2.0785373902201176e-17
EarlyStopping counter: 45 out of 100
Updating learning rate to 1.0392686951100588e-17
EarlyStopping counter: 46 out of 100
Updating learning rate to 5.196343475550294e-18
EarlyStopping counter: 47 out of 100
Updating learning rate to 2.598171737775147e-18
EarlyStopping counter: 48 out of 100
Updating learning rate to 1.2990858688875735e-18
EarlyStopping counter: 49 out of 100
Updating learning rate to 6.495429344437868e-19
EarlyStopping counter: 50 out of 100
Updating learning rate to 3.247714672218934e-19
EarlyStopping counter: 51 out of 100
Updating learning rate to 1.623857336109467e-19
EarlyStopping counter: 52 out of 100
Updating learning rate to 8.119286680547335e-20
EarlyStopping counter: 53 out of 100
Updating learning rate to 4.059643340273667e-20
EarlyStopping counter: 54 out of 100
Updating learning rate to 2.0298216701368336e-20
EarlyStopping counter: 55 out of 100
Updating learning rate to 1.0149108350684168e-20
EarlyStopping counter: 56 out of 100
Updating learning rate to 5.074554175342084e-21
EarlyStopping counter: 57 out of 100
Updating learning rate to 2.537277087671042e-21
EarlyStopping counter: 58 out of 100
Updating learning rate to 1.268638543835521e-21
EarlyStopping counter: 59 out of 100
Updating learning rate to 6.343192719177605e-22
EarlyStopping counter: 60 out of 100
Updating learning rate to 3.1715963595888026e-22
EarlyStopping counter: 61 out of 100
Updating learning rate to 1.5857981797944013e-22
EarlyStopping counter: 62 out of 100
Updating learning rate to 7.928990898972006e-23
EarlyStopping counter: 63 out of 100
Updating learning rate to 3.964495449486003e-23
EarlyStopping counter: 64 out of 100
Updating learning rate to 1.9822477247430016e-23
EarlyStopping counter: 65 out of 100
Updating learning rate to 9.911238623715008e-24
EarlyStopping counter: 66 out of 100
Updating learning rate to 4.955619311857504e-24
EarlyStopping counter: 67 out of 100
Updating learning rate to 2.477809655928752e-24
EarlyStopping counter: 68 out of 100
Updating learning rate to 1.238904827964376e-24
EarlyStopping counter: 69 out of 100
Updating learning rate to 6.19452413982188e-25
EarlyStopping counter: 70 out of 100
Updating learning rate to 3.09726206991094e-25
EarlyStopping counter: 71 out of 100
Updating learning rate to 1.54863103495547e-25
EarlyStopping counter: 72 out of 100
Updating learning rate to 7.74315517477735e-26
EarlyStopping counter: 73 out of 100
Updating learning rate to 3.871577587388675e-26
EarlyStopping counter: 74 out of 100
Updating learning rate to 1.9357887936943375e-26
EarlyStopping counter: 75 out of 100
Updating learning rate to 9.678943968471687e-27
EarlyStopping counter: 76 out of 100
Updating learning rate to 4.839471984235844e-27
EarlyStopping counter: 77 out of 100
Updating learning rate to 2.419735992117922e-27
EarlyStopping counter: 78 out of 100
Updating learning rate to 1.209867996058961e-27
EarlyStopping counter: 79 out of 100
Updating learning rate to 6.049339980294805e-28
EarlyStopping counter: 80 out of 100
Updating learning rate to 3.0246699901474023e-28
EarlyStopping counter: 81 out of 100
Updating learning rate to 1.5123349950737012e-28
EarlyStopping counter: 82 out of 100
Updating learning rate to 7.561674975368506e-29
EarlyStopping counter: 83 out of 100
Updating learning rate to 3.780837487684253e-29
EarlyStopping counter: 84 out of 100
Updating learning rate to 1.8904187438421265e-29
EarlyStopping counter: 85 out of 100
Updating learning rate to 9.452093719210632e-30
EarlyStopping counter: 86 out of 100
Updating learning rate to 4.726046859605316e-30
EarlyStopping counter: 87 out of 100
Updating learning rate to 2.363023429802658e-30
EarlyStopping counter: 88 out of 100
Updating learning rate to 1.181511714901329e-30
EarlyStopping counter: 89 out of 100
Updating learning rate to 5.907558574506645e-31
EarlyStopping counter: 90 out of 100
Updating learning rate to 2.9537792872533226e-31
EarlyStopping counter: 91 out of 100
Updating learning rate to 1.4768896436266613e-31
EarlyStopping counter: 92 out of 100
Updating learning rate to 7.384448218133307e-32
EarlyStopping counter: 93 out of 100
Updating learning rate to 3.692224109066653e-32
EarlyStopping counter: 94 out of 100
Updating learning rate to 1.8461120545333266e-32
EarlyStopping counter: 95 out of 100
Updating learning rate to 9.230560272666633e-33
EarlyStopping counter: 96 out of 100
Updating learning rate to 4.6152801363333166e-33
EarlyStopping counter: 97 out of 100
Updating learning rate to 2.3076400681666583e-33
EarlyStopping counter: 98 out of 100
Updating learning rate to 1.1538200340833291e-33
EarlyStopping counter: 99 out of 100
Updating learning rate to 5.769100170416646e-34
>>>>>> Testing on validation set: trial_9 >>>>>>
test 255
test shape: (255, 7, 5) (255, 7, 5)
test shape: (255, 7, 5) (255, 7, 5)


	mse:0.06692091375589371, mae:0.09861995279788971, dtw:Not calculated


                                                                                       [I 2025-10-17 06:34:37,096] Trial 9 finished with value: 0.09861995279788971 and parameters: {'seq_len': 48, 'pred_len': 7, 'expand': 2, 'd_model': 64, 'n_heads': 8, 'e_layers': 2, 'd_layers': 2, 'batch_size': 16, 'learning_rate': 0.00036566016469027207, 'dropout': 0.02220464345584758}. Best is trial 8 with value: 0.08846942335367203.
Best trial: 8. Best value: 0.0884694:  18%|█▊        | 9/50 [30:46<1:57:07, 171.39s/it]Best trial: 8. Best value: 0.0884694:  18%|█▊        | 9/50 [30:46<1:57:07, 171.39s/it]Best trial: 8. Best value: 0.0884694:  20%|██        | 10/50 [30:46<2:12:55, 199.39s/it]
============================================================
Trial 10
============================================================
seq_len: 96, pred_len: 14
d_model: 64, n_heads: 4
e_layers: 1, d_layers: 1
batch_size: 32, lr: 0.000099
dropout: 0.2494023646266489
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_10 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 14
============================================================
train 4564
val 246
test 248
Validation loss decreased (inf --> 0.040410).  Saving model ...
Updating learning rate to 9.889360702828318e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.944680351414159e-05
Validation loss decreased (0.040410 --> 0.040323).  Saving model ...
Updating learning rate to 2.4723401757070795e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2361700878535397e-05
Validation loss decreased (0.040323 --> 0.039671).  Saving model ...
Updating learning rate to 6.180850439267699e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.0904252196338494e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5452126098169247e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.726063049084623e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.8630315245423117e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.9315157622711558e-07
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.657578811355779e-08
Validation loss decreased (0.039671 --> 0.039517).  Saving model ...
Updating learning rate to 4.8287894056778896e-08
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.4143947028389448e-08
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2071973514194724e-08
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.035986757097362e-09
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.017993378548681e-09
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.5089966892743405e-09
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.544983446371703e-10
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.7724917231858513e-10
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.8862458615929256e-10
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.431229307964628e-11
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.715614653982314e-11
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.357807326991157e-11
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.1789036634955785e-11
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.894518317477893e-12
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.9472591587389463e-12
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.4736295793694731e-12
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.368147896847366e-13
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.684073948423683e-13
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.8420369742118414e-13
EarlyStopping counter: 19 out of 100
Updating learning rate to 9.210184871059207e-14
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.6050924355296036e-14
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.3025462177648018e-14
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.1512731088824009e-14
EarlyStopping counter: 23 out of 100
Updating learning rate to 5.7563655444120045e-15
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.8781827722060022e-15
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.4390913861030011e-15
EarlyStopping counter: 26 out of 100
Updating learning rate to 7.195456930515006e-16
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.597728465257503e-16
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.7988642326287514e-16
EarlyStopping counter: 29 out of 100
Updating learning rate to 8.994321163143757e-17
EarlyStopping counter: 30 out of 100
Updating learning rate to 4.4971605815718785e-17
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.2485802907859393e-17
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.1242901453929696e-17
EarlyStopping counter: 33 out of 100
Updating learning rate to 5.621450726964848e-18
EarlyStopping counter: 34 out of 100
Updating learning rate to 2.810725363482424e-18
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.405362681741212e-18
EarlyStopping counter: 36 out of 100
Updating learning rate to 7.02681340870606e-19
EarlyStopping counter: 37 out of 100
Updating learning rate to 3.51340670435303e-19
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.756703352176515e-19
EarlyStopping counter: 39 out of 100
Updating learning rate to 8.783516760882575e-20
EarlyStopping counter: 40 out of 100
Updating learning rate to 4.3917583804412876e-20
EarlyStopping counter: 41 out of 100
Updating learning rate to 2.1958791902206438e-20
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.0979395951103219e-20
EarlyStopping counter: 43 out of 100
Updating learning rate to 5.4896979755516095e-21
EarlyStopping counter: 44 out of 100
Updating learning rate to 2.7448489877758048e-21
EarlyStopping counter: 45 out of 100
Updating learning rate to 1.3724244938879024e-21
EarlyStopping counter: 46 out of 100
Updating learning rate to 6.862122469439512e-22
EarlyStopping counter: 47 out of 100
Updating learning rate to 3.431061234719756e-22
EarlyStopping counter: 48 out of 100
Updating learning rate to 1.715530617359878e-22
EarlyStopping counter: 49 out of 100
Updating learning rate to 8.57765308679939e-23
EarlyStopping counter: 50 out of 100
Updating learning rate to 4.288826543399695e-23
EarlyStopping counter: 51 out of 100
Updating learning rate to 2.1444132716998475e-23
EarlyStopping counter: 52 out of 100
Updating learning rate to 1.0722066358499237e-23
EarlyStopping counter: 53 out of 100
Updating learning rate to 5.361033179249619e-24
EarlyStopping counter: 54 out of 100
Updating learning rate to 2.6805165896248093e-24
EarlyStopping counter: 55 out of 100
Updating learning rate to 1.3402582948124047e-24
EarlyStopping counter: 56 out of 100
Updating learning rate to 6.701291474062023e-25
EarlyStopping counter: 57 out of 100
Updating learning rate to 3.3506457370310117e-25
EarlyStopping counter: 58 out of 100
Updating learning rate to 1.6753228685155058e-25
EarlyStopping counter: 59 out of 100
Updating learning rate to 8.376614342577529e-26
EarlyStopping counter: 60 out of 100
Updating learning rate to 4.1883071712887646e-26
EarlyStopping counter: 61 out of 100
Updating learning rate to 2.0941535856443823e-26
EarlyStopping counter: 62 out of 100
Updating learning rate to 1.0470767928221911e-26
EarlyStopping counter: 63 out of 100
Updating learning rate to 5.235383964110956e-27
EarlyStopping counter: 64 out of 100
Updating learning rate to 2.617691982055478e-27
EarlyStopping counter: 65 out of 100
Updating learning rate to 1.308845991027739e-27
EarlyStopping counter: 66 out of 100
Updating learning rate to 6.544229955138695e-28
EarlyStopping counter: 67 out of 100
Updating learning rate to 3.2721149775693473e-28
EarlyStopping counter: 68 out of 100
Updating learning rate to 1.6360574887846737e-28
EarlyStopping counter: 69 out of 100
Updating learning rate to 8.180287443923368e-29
EarlyStopping counter: 70 out of 100
Updating learning rate to 4.090143721961684e-29
EarlyStopping counter: 71 out of 100
Updating learning rate to 2.045071860980842e-29
EarlyStopping counter: 72 out of 100
Updating learning rate to 1.022535930490421e-29
EarlyStopping counter: 73 out of 100
Updating learning rate to 5.112679652452105e-30
EarlyStopping counter: 74 out of 100
Updating learning rate to 2.5563398262260526e-30
EarlyStopping counter: 75 out of 100
Updating learning rate to 1.2781699131130263e-30
EarlyStopping counter: 76 out of 100
Updating learning rate to 6.3908495655651315e-31
EarlyStopping counter: 77 out of 100
Updating learning rate to 3.1954247827825657e-31
EarlyStopping counter: 78 out of 100
Updating learning rate to 1.5977123913912829e-31
EarlyStopping counter: 79 out of 100
Updating learning rate to 7.988561956956414e-32
EarlyStopping counter: 80 out of 100
Updating learning rate to 3.994280978478207e-32
EarlyStopping counter: 81 out of 100
Updating learning rate to 1.9971404892391036e-32
EarlyStopping counter: 82 out of 100
Updating learning rate to 9.985702446195518e-33
EarlyStopping counter: 83 out of 100
Updating learning rate to 4.992851223097759e-33
EarlyStopping counter: 84 out of 100
Updating learning rate to 2.4964256115488795e-33
EarlyStopping counter: 85 out of 100
Updating learning rate to 1.2482128057744397e-33
EarlyStopping counter: 86 out of 100
Updating learning rate to 6.241064028872199e-34
EarlyStopping counter: 87 out of 100
Updating learning rate to 3.1205320144360994e-34
EarlyStopping counter: 88 out of 100
Updating learning rate to 1.5602660072180497e-34
>>>>>> Testing on validation set: trial_10 >>>>>>
test 248
test shape: (248, 14, 5) (248, 14, 5)
test shape: (248, 14, 5) (248, 14, 5)


	mse:0.07076089829206467, mae:0.11116859316825867, dtw:Not calculated


                                                                                        [I 2025-10-17 06:36:48,389] Trial 10 finished with value: 0.11116859316825867 and parameters: {'seq_len': 96, 'pred_len': 14, 'expand': 1, 'd_model': 64, 'n_heads': 4, 'e_layers': 1, 'd_layers': 1, 'batch_size': 32, 'learning_rate': 9.889360702828318e-05, 'dropout': 0.2494023646266489}. Best is trial 8 with value: 0.08846942335367203.
Best trial: 8. Best value: 0.0884694:  20%|██        | 10/50 [32:57<2:12:55, 199.39s/it]Best trial: 8. Best value: 0.0884694:  20%|██        | 10/50 [32:57<2:12:55, 199.39s/it]Best trial: 8. Best value: 0.0884694:  22%|██▏       | 11/50 [32:57<1:56:03, 178.55s/it]
============================================================
Trial 11
============================================================
seq_len: 96, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 1
batch_size: 64, lr: 0.000106
dropout: 0.2114893801003059
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_11 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 1
============================================================
train 4577
val 259
test 261
Validation loss decreased (inf --> 0.045074).  Saving model ...
Updating learning rate to 0.00010602902307210331
Validation loss decreased (0.045074 --> 0.029727).  Saving model ...
Updating learning rate to 5.3014511536051654e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.6507255768025827e-05
Validation loss decreased (0.029727 --> 0.024341).  Saving model ...
Updating learning rate to 1.3253627884012913e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.626813942006457e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.3134069710032284e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6567034855016142e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.283517427508071e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.1417587137540354e-07
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0708793568770177e-07
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.0354396784385089e-07
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.177198392192544e-08
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.588599196096272e-08
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.294299598048136e-08
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.47149799024068e-09
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.23574899512034e-09
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.61787449756017e-09
EarlyStopping counter: 14 out of 100
Updating learning rate to 8.08937248780085e-10
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.044686243900425e-10
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.0223431219502126e-10
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.0111715609751063e-10
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.0558578048755315e-11
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.5279289024377658e-11
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.2639644512188829e-11
EarlyStopping counter: 21 out of 100
Updating learning rate to 6.3198222560944144e-12
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.1599111280472072e-12
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.5799555640236036e-12
EarlyStopping counter: 24 out of 100
Updating learning rate to 7.899777820118018e-13
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.949888910059009e-13
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.9749444550295045e-13
EarlyStopping counter: 27 out of 100
Updating learning rate to 9.874722275147523e-14
EarlyStopping counter: 28 out of 100
Updating learning rate to 4.937361137573761e-14
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.4686805687868806e-14
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.2343402843934403e-14
EarlyStopping counter: 31 out of 100
Updating learning rate to 6.1717014219672016e-15
EarlyStopping counter: 32 out of 100
Updating learning rate to 3.0858507109836008e-15
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.5429253554918004e-15
EarlyStopping counter: 34 out of 100
Updating learning rate to 7.714626777459002e-16
EarlyStopping counter: 35 out of 100
Updating learning rate to 3.857313388729501e-16
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.9286566943647505e-16
EarlyStopping counter: 37 out of 100
Updating learning rate to 9.643283471823752e-17
EarlyStopping counter: 38 out of 100
Updating learning rate to 4.821641735911876e-17
EarlyStopping counter: 39 out of 100
Updating learning rate to 2.410820867955938e-17
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.205410433977969e-17
EarlyStopping counter: 41 out of 100
Updating learning rate to 6.027052169889845e-18
EarlyStopping counter: 42 out of 100
Updating learning rate to 3.0135260849449227e-18
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.5067630424724613e-18
EarlyStopping counter: 44 out of 100
Updating learning rate to 7.533815212362307e-19
EarlyStopping counter: 45 out of 100
Updating learning rate to 3.7669076061811533e-19
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.8834538030905767e-19
EarlyStopping counter: 47 out of 100
Updating learning rate to 9.417269015452883e-20
EarlyStopping counter: 48 out of 100
Updating learning rate to 4.7086345077264416e-20
EarlyStopping counter: 49 out of 100
Updating learning rate to 2.3543172538632208e-20
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.1771586269316104e-20
EarlyStopping counter: 51 out of 100
Updating learning rate to 5.885793134658052e-21
EarlyStopping counter: 52 out of 100
Updating learning rate to 2.942896567329026e-21
EarlyStopping counter: 53 out of 100
Updating learning rate to 1.471448283664513e-21
EarlyStopping counter: 54 out of 100
Updating learning rate to 7.357241418322565e-22
EarlyStopping counter: 55 out of 100
Updating learning rate to 3.6786207091612825e-22
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.8393103545806413e-22
EarlyStopping counter: 57 out of 100
Updating learning rate to 9.196551772903206e-23
EarlyStopping counter: 58 out of 100
Updating learning rate to 4.598275886451603e-23
EarlyStopping counter: 59 out of 100
Updating learning rate to 2.2991379432258016e-23
EarlyStopping counter: 60 out of 100
Updating learning rate to 1.1495689716129008e-23
EarlyStopping counter: 61 out of 100
Updating learning rate to 5.747844858064504e-24
EarlyStopping counter: 62 out of 100
Updating learning rate to 2.873922429032252e-24
EarlyStopping counter: 63 out of 100
Updating learning rate to 1.436961214516126e-24
EarlyStopping counter: 64 out of 100
Updating learning rate to 7.18480607258063e-25
EarlyStopping counter: 65 out of 100
Updating learning rate to 3.592403036290315e-25
EarlyStopping counter: 66 out of 100
Updating learning rate to 1.7962015181451575e-25
EarlyStopping counter: 67 out of 100
Updating learning rate to 8.981007590725787e-26
EarlyStopping counter: 68 out of 100
Updating learning rate to 4.490503795362894e-26
EarlyStopping counter: 69 out of 100
Updating learning rate to 2.245251897681447e-26
EarlyStopping counter: 70 out of 100
Updating learning rate to 1.1226259488407234e-26
EarlyStopping counter: 71 out of 100
Updating learning rate to 5.613129744203617e-27
EarlyStopping counter: 72 out of 100
Updating learning rate to 2.8065648721018086e-27
EarlyStopping counter: 73 out of 100
Updating learning rate to 1.4032824360509043e-27
EarlyStopping counter: 74 out of 100
Updating learning rate to 7.016412180254521e-28
EarlyStopping counter: 75 out of 100
Updating learning rate to 3.5082060901272607e-28
EarlyStopping counter: 76 out of 100
Updating learning rate to 1.7541030450636304e-28
EarlyStopping counter: 77 out of 100
Updating learning rate to 8.770515225318152e-29
Validation loss decreased (0.024341 --> 0.024254).  Saving model ...
Updating learning rate to 4.385257612659076e-29
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.192628806329538e-29
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.096314403164769e-29
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.481572015823845e-30
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7407860079119224e-30
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3703930039559612e-30
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.851965019779806e-31
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.425982509889903e-31
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.7129912549449515e-31
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.564956274724758e-32
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.282478137362379e-32
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.1412390686811894e-32
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.0706195343405947e-32
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.3530976717029735e-33
Validation loss decreased (0.024254 --> 0.024029).  Saving model ...
Updating learning rate to 2.6765488358514868e-33
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3382744179257434e-33
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.691372089628717e-34
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.3456860448143584e-34
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6728430224071792e-34
>>>>>> Testing on validation set: trial_11 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.053131476044654846, mae:0.08646968007087708, dtw:Not calculated


                                                                                        [I 2025-10-17 06:37:56,754] Trial 11 finished with value: 0.08646968007087708 and parameters: {'seq_len': 96, 'pred_len': 1, 'expand': 2, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 1, 'batch_size': 64, 'learning_rate': 0.00010602902307210331, 'dropout': 0.2114893801003059}. Best is trial 11 with value: 0.08646968007087708.
Best trial: 8. Best value: 0.0884694:  22%|██▏       | 11/50 [34:06<1:56:03, 178.55s/it]Best trial: 11. Best value: 0.0864697:  22%|██▏       | 11/50 [34:06<1:56:03, 178.55s/it]Best trial: 11. Best value: 0.0864697:  24%|██▍       | 12/50 [34:06<1:31:51, 145.03s/it]
============================================================
Trial 12
============================================================
seq_len: 96, pred_len: 14
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 1
batch_size: 64, lr: 0.000076
dropout: 0.21963459254310183
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_12 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 14
============================================================
train 4564
val 246
test 248
Validation loss decreased (inf --> 0.038775).  Saving model ...
Updating learning rate to 7.592782304801826e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.796391152400913e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8981955762004564e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.490977881002282e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.745488940501141e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.3727444702505705e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1863722351252852e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.931861175626426e-07
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.965930587813213e-07
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4829652939066065e-07
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.414826469533033e-08
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.7074132347665164e-08
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.8537066173832582e-08
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.268533086916291e-09
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.6342665434581454e-09
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.3171332717290727e-09
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.1585666358645364e-09
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.792833179322682e-10
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.896416589661341e-10
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.4482082948306705e-10
EarlyStopping counter: 20 out of 100
Updating learning rate to 7.241041474153352e-11
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.620520737076676e-11
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.810260368538338e-11
EarlyStopping counter: 23 out of 100
Updating learning rate to 9.05130184269169e-12
EarlyStopping counter: 24 out of 100
Updating learning rate to 4.525650921345845e-12
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.2628254606729226e-12
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.1314127303364613e-12
EarlyStopping counter: 27 out of 100
Updating learning rate to 5.657063651682306e-13
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.828531825841153e-13
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.4142659129205766e-13
EarlyStopping counter: 30 out of 100
Updating learning rate to 7.071329564602883e-14
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.5356647823014415e-14
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.7678323911507208e-14
EarlyStopping counter: 33 out of 100
Updating learning rate to 8.839161955753604e-15
EarlyStopping counter: 34 out of 100
Updating learning rate to 4.419580977876802e-15
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.209790488938401e-15
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.1048952444692005e-15
EarlyStopping counter: 37 out of 100
Updating learning rate to 5.524476222346002e-16
EarlyStopping counter: 38 out of 100
Updating learning rate to 2.762238111173001e-16
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.3811190555865006e-16
EarlyStopping counter: 40 out of 100
Updating learning rate to 6.905595277932503e-17
EarlyStopping counter: 41 out of 100
Updating learning rate to 3.4527976389662515e-17
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.7263988194831257e-17
EarlyStopping counter: 43 out of 100
Updating learning rate to 8.631994097415629e-18
EarlyStopping counter: 44 out of 100
Updating learning rate to 4.315997048707814e-18
EarlyStopping counter: 45 out of 100
Updating learning rate to 2.157998524353907e-18
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.0789992621769536e-18
EarlyStopping counter: 47 out of 100
Updating learning rate to 5.394996310884768e-19
EarlyStopping counter: 48 out of 100
Updating learning rate to 2.697498155442384e-19
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.348749077721192e-19
EarlyStopping counter: 50 out of 100
Updating learning rate to 6.74374538860596e-20
EarlyStopping counter: 51 out of 100
Updating learning rate to 3.37187269430298e-20
EarlyStopping counter: 52 out of 100
Updating learning rate to 1.68593634715149e-20
EarlyStopping counter: 53 out of 100
Updating learning rate to 8.42968173575745e-21
EarlyStopping counter: 54 out of 100
Updating learning rate to 4.214840867878725e-21
EarlyStopping counter: 55 out of 100
Updating learning rate to 2.1074204339393625e-21
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.0537102169696812e-21
EarlyStopping counter: 57 out of 100
Updating learning rate to 5.268551084848406e-22
EarlyStopping counter: 58 out of 100
Updating learning rate to 2.634275542424203e-22
EarlyStopping counter: 59 out of 100
Updating learning rate to 1.3171377712121016e-22
EarlyStopping counter: 60 out of 100
Updating learning rate to 6.585688856060508e-23
EarlyStopping counter: 61 out of 100
Updating learning rate to 3.292844428030254e-23
EarlyStopping counter: 62 out of 100
Updating learning rate to 1.646422214015127e-23
EarlyStopping counter: 63 out of 100
Updating learning rate to 8.232111070075635e-24
EarlyStopping counter: 64 out of 100
Updating learning rate to 4.116055535037817e-24
EarlyStopping counter: 65 out of 100
Updating learning rate to 2.0580277675189087e-24
EarlyStopping counter: 66 out of 100
Updating learning rate to 1.0290138837594543e-24
EarlyStopping counter: 67 out of 100
Updating learning rate to 5.145069418797272e-25
EarlyStopping counter: 68 out of 100
Updating learning rate to 2.572534709398636e-25
EarlyStopping counter: 69 out of 100
Updating learning rate to 1.286267354699318e-25
EarlyStopping counter: 70 out of 100
Updating learning rate to 6.43133677349659e-26
EarlyStopping counter: 71 out of 100
Updating learning rate to 3.215668386748295e-26
EarlyStopping counter: 72 out of 100
Updating learning rate to 1.6078341933741474e-26
EarlyStopping counter: 73 out of 100
Updating learning rate to 8.039170966870737e-27
EarlyStopping counter: 74 out of 100
Updating learning rate to 4.0195854834353685e-27
EarlyStopping counter: 75 out of 100
Updating learning rate to 2.0097927417176843e-27
EarlyStopping counter: 76 out of 100
Updating learning rate to 1.0048963708588421e-27
EarlyStopping counter: 77 out of 100
Updating learning rate to 5.024481854294211e-28
EarlyStopping counter: 78 out of 100
Updating learning rate to 2.5122409271471053e-28
EarlyStopping counter: 79 out of 100
Updating learning rate to 1.2561204635735527e-28
EarlyStopping counter: 80 out of 100
Updating learning rate to 6.280602317867763e-29
EarlyStopping counter: 81 out of 100
Updating learning rate to 3.1403011589338817e-29
EarlyStopping counter: 82 out of 100
Updating learning rate to 1.5701505794669408e-29
EarlyStopping counter: 83 out of 100
Updating learning rate to 7.850752897334704e-30
EarlyStopping counter: 84 out of 100
Updating learning rate to 3.925376448667352e-30
EarlyStopping counter: 85 out of 100
Updating learning rate to 1.962688224333676e-30
EarlyStopping counter: 86 out of 100
Updating learning rate to 9.81344112166838e-31
EarlyStopping counter: 87 out of 100
Updating learning rate to 4.90672056083419e-31
EarlyStopping counter: 88 out of 100
Updating learning rate to 2.453360280417095e-31
EarlyStopping counter: 89 out of 100
Updating learning rate to 1.2266801402085475e-31
EarlyStopping counter: 90 out of 100
Updating learning rate to 6.133400701042738e-32
EarlyStopping counter: 91 out of 100
Updating learning rate to 3.066700350521369e-32
EarlyStopping counter: 92 out of 100
Updating learning rate to 1.5333501752606844e-32
EarlyStopping counter: 93 out of 100
Updating learning rate to 7.666750876303422e-33
EarlyStopping counter: 94 out of 100
Updating learning rate to 3.833375438151711e-33
EarlyStopping counter: 95 out of 100
Updating learning rate to 1.9166877190758555e-33
EarlyStopping counter: 96 out of 100
Updating learning rate to 9.583438595379278e-34
EarlyStopping counter: 97 out of 100
Updating learning rate to 4.791719297689639e-34
EarlyStopping counter: 98 out of 100
Updating learning rate to 2.3958596488448194e-34
EarlyStopping counter: 99 out of 100
Updating learning rate to 1.1979298244224097e-34
>>>>>> Testing on validation set: trial_12 >>>>>>
test 248
test shape: (248, 14, 5) (248, 14, 5)
test shape: (248, 14, 5) (248, 14, 5)


	mse:0.06873536109924316, mae:0.11623750627040863, dtw:Not calculated


                                                                                         [I 2025-10-17 06:39:04,346] Trial 12 finished with value: 0.11623750627040863 and parameters: {'seq_len': 96, 'pred_len': 14, 'expand': 2, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 1, 'batch_size': 64, 'learning_rate': 7.592782304801826e-05, 'dropout': 0.21963459254310183}. Best is trial 11 with value: 0.08646968007087708.
Best trial: 11. Best value: 0.0864697:  24%|██▍       | 12/50 [35:13<1:31:51, 145.03s/it]Best trial: 11. Best value: 0.0864697:  24%|██▍       | 12/50 [35:13<1:31:51, 145.03s/it]Best trial: 11. Best value: 0.0864697:  26%|██▌       | 13/50 [35:13<1:14:58, 121.57s/it]
============================================================
Trial 13
============================================================
seq_len: 96, pred_len: 30
d_model: 64, n_heads: 4
e_layers: 1, d_layers: 1
batch_size: 32, lr: 0.000221
dropout: 0.18878584046060412
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_13 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 30
============================================================
train 4548
val 230
test 232
Validation loss decreased (inf --> 0.034610).  Saving model ...
Updating learning rate to 0.00022127482800457268
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00011063741400228634
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.531870700114317e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7659353500571586e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3829676750285793e-05
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.914838375142896e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.457419187571448e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.728709593785724e-06
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.64354796892862e-07
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.32177398446431e-07
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.160886992232155e-07
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.0804434961160776e-07
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.402217480580388e-08
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.701108740290194e-08
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.350554370145097e-08
EarlyStopping counter: 15 out of 100
Updating learning rate to 6.752771850725485e-09
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.3763859253627424e-09
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.6881929626813712e-09
EarlyStopping counter: 18 out of 100
Updating learning rate to 8.440964813406856e-10
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.220482406703428e-10
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.110241203351714e-10
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.055120601675857e-10
EarlyStopping counter: 22 out of 100
Updating learning rate to 5.275603008379285e-11
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.6378015041896425e-11
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.3189007520948212e-11
EarlyStopping counter: 25 out of 100
Updating learning rate to 6.594503760474106e-12
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.297251880237053e-12
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.6486259401185266e-12
EarlyStopping counter: 28 out of 100
Updating learning rate to 8.243129700592633e-13
EarlyStopping counter: 29 out of 100
Updating learning rate to 4.1215648502963164e-13
EarlyStopping counter: 30 out of 100
Updating learning rate to 2.0607824251481582e-13
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.0303912125740791e-13
EarlyStopping counter: 32 out of 100
Updating learning rate to 5.1519560628703955e-14
EarlyStopping counter: 33 out of 100
Updating learning rate to 2.5759780314351977e-14
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.2879890157175989e-14
EarlyStopping counter: 35 out of 100
Updating learning rate to 6.439945078587994e-15
EarlyStopping counter: 36 out of 100
Updating learning rate to 3.219972539293997e-15
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.6099862696469986e-15
EarlyStopping counter: 38 out of 100
Updating learning rate to 8.049931348234993e-16
EarlyStopping counter: 39 out of 100
Updating learning rate to 4.0249656741174965e-16
EarlyStopping counter: 40 out of 100
Updating learning rate to 2.0124828370587482e-16
EarlyStopping counter: 41 out of 100
Updating learning rate to 1.0062414185293741e-16
EarlyStopping counter: 42 out of 100
Updating learning rate to 5.0312070926468706e-17
EarlyStopping counter: 43 out of 100
Updating learning rate to 2.5156035463234353e-17
EarlyStopping counter: 44 out of 100
Updating learning rate to 1.2578017731617176e-17
EarlyStopping counter: 45 out of 100
Updating learning rate to 6.289008865808588e-18
EarlyStopping counter: 46 out of 100
Updating learning rate to 3.144504432904294e-18
EarlyStopping counter: 47 out of 100
Updating learning rate to 1.572252216452147e-18
EarlyStopping counter: 48 out of 100
Updating learning rate to 7.861261082260735e-19
EarlyStopping counter: 49 out of 100
Updating learning rate to 3.9306305411303676e-19
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.9653152705651838e-19
EarlyStopping counter: 51 out of 100
Updating learning rate to 9.826576352825919e-20
EarlyStopping counter: 52 out of 100
Updating learning rate to 4.9132881764129596e-20
EarlyStopping counter: 53 out of 100
Updating learning rate to 2.4566440882064798e-20
EarlyStopping counter: 54 out of 100
Updating learning rate to 1.2283220441032399e-20
EarlyStopping counter: 55 out of 100
Updating learning rate to 6.1416102205161994e-21
EarlyStopping counter: 56 out of 100
Updating learning rate to 3.0708051102580997e-21
EarlyStopping counter: 57 out of 100
Updating learning rate to 1.5354025551290499e-21
EarlyStopping counter: 58 out of 100
Updating learning rate to 7.677012775645249e-22
EarlyStopping counter: 59 out of 100
Updating learning rate to 3.8385063878226247e-22
EarlyStopping counter: 60 out of 100
Updating learning rate to 1.9192531939113123e-22
EarlyStopping counter: 61 out of 100
Updating learning rate to 9.596265969556562e-23
EarlyStopping counter: 62 out of 100
Updating learning rate to 4.798132984778281e-23
EarlyStopping counter: 63 out of 100
Updating learning rate to 2.3990664923891404e-23
EarlyStopping counter: 64 out of 100
Updating learning rate to 1.1995332461945702e-23
EarlyStopping counter: 65 out of 100
Updating learning rate to 5.997666230972851e-24
EarlyStopping counter: 66 out of 100
Updating learning rate to 2.9988331154864255e-24
EarlyStopping counter: 67 out of 100
Updating learning rate to 1.4994165577432128e-24
EarlyStopping counter: 68 out of 100
Updating learning rate to 7.497082788716064e-25
EarlyStopping counter: 69 out of 100
Updating learning rate to 3.748541394358032e-25
EarlyStopping counter: 70 out of 100
Updating learning rate to 1.874270697179016e-25
EarlyStopping counter: 71 out of 100
Updating learning rate to 9.37135348589508e-26
EarlyStopping counter: 72 out of 100
Updating learning rate to 4.68567674294754e-26
EarlyStopping counter: 73 out of 100
Updating learning rate to 2.34283837147377e-26
EarlyStopping counter: 74 out of 100
Updating learning rate to 1.171419185736885e-26
EarlyStopping counter: 75 out of 100
Updating learning rate to 5.857095928684425e-27
EarlyStopping counter: 76 out of 100
Updating learning rate to 2.9285479643422124e-27
EarlyStopping counter: 77 out of 100
Updating learning rate to 1.4642739821711062e-27
EarlyStopping counter: 78 out of 100
Updating learning rate to 7.321369910855531e-28
EarlyStopping counter: 79 out of 100
Updating learning rate to 3.6606849554277655e-28
EarlyStopping counter: 80 out of 100
Updating learning rate to 1.8303424777138828e-28
EarlyStopping counter: 81 out of 100
Updating learning rate to 9.151712388569414e-29
EarlyStopping counter: 82 out of 100
Updating learning rate to 4.575856194284707e-29
EarlyStopping counter: 83 out of 100
Updating learning rate to 2.2879280971423534e-29
EarlyStopping counter: 84 out of 100
Updating learning rate to 1.1439640485711767e-29
EarlyStopping counter: 85 out of 100
Updating learning rate to 5.7198202428558836e-30
EarlyStopping counter: 86 out of 100
Updating learning rate to 2.8599101214279418e-30
EarlyStopping counter: 87 out of 100
Updating learning rate to 1.4299550607139709e-30
EarlyStopping counter: 88 out of 100
Updating learning rate to 7.1497753035698545e-31
EarlyStopping counter: 89 out of 100
Updating learning rate to 3.5748876517849273e-31
EarlyStopping counter: 90 out of 100
Updating learning rate to 1.7874438258924636e-31
EarlyStopping counter: 91 out of 100
Updating learning rate to 8.937219129462318e-32
EarlyStopping counter: 92 out of 100
Updating learning rate to 4.468609564731159e-32
EarlyStopping counter: 93 out of 100
Updating learning rate to 2.2343047823655795e-32
EarlyStopping counter: 94 out of 100
Updating learning rate to 1.1171523911827898e-32
EarlyStopping counter: 95 out of 100
Updating learning rate to 5.585761955913949e-33
EarlyStopping counter: 96 out of 100
Updating learning rate to 2.7928809779569744e-33
EarlyStopping counter: 97 out of 100
Updating learning rate to 1.3964404889784872e-33
EarlyStopping counter: 98 out of 100
Updating learning rate to 6.982202444892436e-34
EarlyStopping counter: 99 out of 100
Updating learning rate to 3.491101222446218e-34
>>>>>> Testing on validation set: trial_13 >>>>>>
test 232
test shape: (232, 30, 5) (232, 30, 5)
test shape: (232, 30, 5) (232, 30, 5)


	mse:0.07234898209571838, mae:0.1129513829946518, dtw:Not calculated


                                                                                         [I 2025-10-17 06:41:16,656] Trial 13 finished with value: 0.1129513829946518 and parameters: {'seq_len': 96, 'pred_len': 30, 'expand': 2, 'd_model': 64, 'n_heads': 4, 'e_layers': 1, 'd_layers': 1, 'batch_size': 32, 'learning_rate': 0.00022127482800457268, 'dropout': 0.18878584046060412}. Best is trial 11 with value: 0.08646968007087708.
Best trial: 11. Best value: 0.0864697:  26%|██▌       | 13/50 [37:25<1:14:58, 121.57s/it]Best trial: 11. Best value: 0.0864697:  26%|██▌       | 13/50 [37:25<1:14:58, 121.57s/it]Best trial: 11. Best value: 0.0864697:  28%|██▊       | 14/50 [37:25<1:14:53, 124.82s/it]
============================================================
Trial 14
============================================================
seq_len: 96, pred_len: 1
d_model: 64, n_heads: 4
e_layers: 1, d_layers: 1
batch_size: 64, lr: 0.000204
dropout: 0.2777564906387199
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_14 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 1
============================================================
train 4577
val 259
test 261
Validation loss decreased (inf --> 0.032653).  Saving model ...
Updating learning rate to 0.00020438941666989205
Validation loss decreased (0.032653 --> 0.025537).  Saving model ...
Updating learning rate to 0.00010219470833494603
Validation loss decreased (0.025537 --> 0.024014).  Saving model ...
Updating learning rate to 5.1097354167473014e-05
Validation loss decreased (0.024014 --> 0.022266).  Saving model ...
Updating learning rate to 2.5548677083736507e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2774338541868253e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.387169270934127e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.1935846354670634e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5967923177335317e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.983961588667658e-07
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.991980794333829e-07
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.9959903971669146e-07
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.979951985834573e-08
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.9899759929172865e-08
Validation loss decreased (0.022266 --> 0.022255).  Saving model ...
Updating learning rate to 2.4949879964586432e-08
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2474939982293216e-08
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.237469991146608e-09
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.118734995573304e-09
Validation loss decreased (0.022255 --> 0.021990).  Saving model ...
Updating learning rate to 1.559367497786652e-09
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.79683748893326e-10
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.89841874446663e-10
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.949209372233315e-10
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.746046861166575e-11
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.8730234305832876e-11
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.4365117152916438e-11
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.2182558576458219e-11
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.0912792882291095e-12
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.0456396441145547e-12
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.5228198220572774e-12
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.614099110286387e-13
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.8070495551431934e-13
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.9035247775715967e-13
EarlyStopping counter: 14 out of 100
Updating learning rate to 9.517623887857984e-14
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.758811943928992e-14
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.379405971964496e-14
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.189702985982248e-14
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.94851492991124e-15
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.97425746495562e-15
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.48712873247781e-15
EarlyStopping counter: 21 out of 100
Updating learning rate to 7.43564366238905e-16
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.717821831194525e-16
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.8589109155972624e-16
EarlyStopping counter: 24 out of 100
Updating learning rate to 9.294554577986312e-17
EarlyStopping counter: 25 out of 100
Updating learning rate to 4.647277288993156e-17
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.323638644496578e-17
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.161819322248289e-17
EarlyStopping counter: 28 out of 100
Updating learning rate to 5.809096611241445e-18
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.9045483056207225e-18
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.4522741528103613e-18
EarlyStopping counter: 31 out of 100
Updating learning rate to 7.261370764051806e-19
EarlyStopping counter: 32 out of 100
Updating learning rate to 3.630685382025903e-19
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.8153426910129516e-19
EarlyStopping counter: 34 out of 100
Updating learning rate to 9.076713455064758e-20
EarlyStopping counter: 35 out of 100
Updating learning rate to 4.538356727532379e-20
EarlyStopping counter: 36 out of 100
Updating learning rate to 2.2691783637661895e-20
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.1345891818830947e-20
EarlyStopping counter: 38 out of 100
Updating learning rate to 5.672945909415474e-21
EarlyStopping counter: 39 out of 100
Updating learning rate to 2.836472954707737e-21
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.4182364773538684e-21
EarlyStopping counter: 41 out of 100
Updating learning rate to 7.091182386769342e-22
EarlyStopping counter: 42 out of 100
Updating learning rate to 3.545591193384671e-22
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.7727955966923355e-22
EarlyStopping counter: 44 out of 100
Updating learning rate to 8.863977983461678e-23
EarlyStopping counter: 45 out of 100
Updating learning rate to 4.431988991730839e-23
EarlyStopping counter: 46 out of 100
Updating learning rate to 2.2159944958654194e-23
EarlyStopping counter: 47 out of 100
Updating learning rate to 1.1079972479327097e-23
EarlyStopping counter: 48 out of 100
Updating learning rate to 5.5399862396635485e-24
EarlyStopping counter: 49 out of 100
Updating learning rate to 2.7699931198317743e-24
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.3849965599158871e-24
EarlyStopping counter: 51 out of 100
Updating learning rate to 6.924982799579436e-25
EarlyStopping counter: 52 out of 100
Updating learning rate to 3.462491399789718e-25
EarlyStopping counter: 53 out of 100
Updating learning rate to 1.731245699894859e-25
EarlyStopping counter: 54 out of 100
Updating learning rate to 8.656228499474295e-26
EarlyStopping counter: 55 out of 100
Updating learning rate to 4.328114249737147e-26
EarlyStopping counter: 56 out of 100
Updating learning rate to 2.1640571248685736e-26
EarlyStopping counter: 57 out of 100
Updating learning rate to 1.0820285624342868e-26
EarlyStopping counter: 58 out of 100
Updating learning rate to 5.410142812171434e-27
EarlyStopping counter: 59 out of 100
Updating learning rate to 2.705071406085717e-27
EarlyStopping counter: 60 out of 100
Updating learning rate to 1.3525357030428585e-27
EarlyStopping counter: 61 out of 100
Updating learning rate to 6.762678515214293e-28
EarlyStopping counter: 62 out of 100
Updating learning rate to 3.3813392576071463e-28
EarlyStopping counter: 63 out of 100
Updating learning rate to 1.6906696288035732e-28
EarlyStopping counter: 64 out of 100
Updating learning rate to 8.453348144017866e-29
EarlyStopping counter: 65 out of 100
Updating learning rate to 4.226674072008933e-29
EarlyStopping counter: 66 out of 100
Updating learning rate to 2.1133370360044664e-29
EarlyStopping counter: 67 out of 100
Updating learning rate to 1.0566685180022332e-29
EarlyStopping counter: 68 out of 100
Updating learning rate to 5.283342590011166e-30
EarlyStopping counter: 69 out of 100
Updating learning rate to 2.641671295005583e-30
EarlyStopping counter: 70 out of 100
Updating learning rate to 1.3208356475027915e-30
EarlyStopping counter: 71 out of 100
Updating learning rate to 6.604178237513958e-31
EarlyStopping counter: 72 out of 100
Updating learning rate to 3.302089118756979e-31
EarlyStopping counter: 73 out of 100
Updating learning rate to 1.6510445593784894e-31
EarlyStopping counter: 74 out of 100
Updating learning rate to 8.255222796892447e-32
EarlyStopping counter: 75 out of 100
Updating learning rate to 4.1276113984462235e-32
EarlyStopping counter: 76 out of 100
Updating learning rate to 2.0638056992231118e-32
EarlyStopping counter: 77 out of 100
Updating learning rate to 1.0319028496115559e-32
Validation loss decreased (0.021990 --> 0.021931).  Saving model ...
Updating learning rate to 5.1595142480577794e-33
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.5797571240288897e-33
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2898785620144449e-33
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.449392810072224e-34
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.224696405036112e-34
>>>>>> Testing on validation set: trial_14 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.050408609211444855, mae:0.08154867589473724, dtw:Not calculated


                                                                                         [I 2025-10-17 06:42:24,926] Trial 14 finished with value: 0.08154867589473724 and parameters: {'seq_len': 96, 'pred_len': 1, 'expand': 2, 'd_model': 64, 'n_heads': 4, 'e_layers': 1, 'd_layers': 1, 'batch_size': 64, 'learning_rate': 0.00020438941666989205, 'dropout': 0.2777564906387199}. Best is trial 14 with value: 0.08154867589473724.
Best trial: 11. Best value: 0.0864697:  28%|██▊       | 14/50 [38:34<1:14:53, 124.82s/it]Best trial: 14. Best value: 0.0815487:  28%|██▊       | 14/50 [38:34<1:14:53, 124.82s/it]Best trial: 14. Best value: 0.0815487:  30%|███       | 15/50 [38:34<1:02:51, 107.77s/it]
============================================================
Trial 15
============================================================
seq_len: 96, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 1
batch_size: 64, lr: 0.000188
dropout: 0.2999615829618213
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_15 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 1
============================================================
train 4577
val 259
test 261
Validation loss decreased (inf --> 0.026434).  Saving model ...
Updating learning rate to 0.00018784624544347973
Validation loss decreased (0.026434 --> 0.024742).  Saving model ...
Updating learning rate to 9.392312272173986e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.696156136086993e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.3480780680434966e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1740390340217483e-05
Validation loss decreased (0.024742 --> 0.024459).  Saving model ...
Updating learning rate to 5.8701951701087414e-06
Validation loss decreased (0.024459 --> 0.023055).  Saving model ...
Updating learning rate to 2.9350975850543707e-06
Validation loss decreased (0.023055 --> 0.022314).  Saving model ...
Updating learning rate to 1.4675487925271854e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.337743962635927e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.6688719813179634e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8344359906589817e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.172179953294908e-08
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.586089976647454e-08
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.293044988323727e-08
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1465224941618636e-08
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.732612470809318e-09
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.866306235404659e-09
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.4331531177023295e-09
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.165765588511647e-10
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.5828827942558236e-10
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.7914413971279118e-10
EarlyStopping counter: 14 out of 100
Updating learning rate to 8.957206985639559e-11
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.4786034928197795e-11
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.2393017464098898e-11
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.1196508732049449e-11
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.5982543660247244e-12
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.7991271830123622e-12
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.3995635915061811e-12
EarlyStopping counter: 21 out of 100
Updating learning rate to 6.997817957530906e-13
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.498908978765453e-13
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.7494544893827264e-13
EarlyStopping counter: 24 out of 100
Updating learning rate to 8.747272446913632e-14
EarlyStopping counter: 25 out of 100
Updating learning rate to 4.373636223456816e-14
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.186818111728408e-14
Validation loss decreased (0.022314 --> 0.022240).  Saving model ...
Updating learning rate to 1.093409055864204e-14
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.46704527932102e-15
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.73352263966051e-15
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.366761319830255e-15
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.833806599151275e-16
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4169032995756375e-16
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.7084516497878187e-16
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.542258248939094e-17
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.271129124469547e-17
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.1355645622347734e-17
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.0677822811173867e-17
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.3389114055869335e-18
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.6694557027934668e-18
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.3347278513967334e-18
EarlyStopping counter: 14 out of 100
Updating learning rate to 6.673639256983667e-19
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.3368196284918335e-19
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.6684098142459167e-19
EarlyStopping counter: 17 out of 100
Updating learning rate to 8.342049071229584e-20
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.171024535614792e-20
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.085512267807396e-20
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.042756133903698e-20
EarlyStopping counter: 21 out of 100
Updating learning rate to 5.21378066951849e-21
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.606890334759245e-21
Validation loss decreased (0.022240 --> 0.022094).  Saving model ...
Updating learning rate to 1.3034451673796224e-21
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.517225836898112e-22
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.258612918449056e-22
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.629306459224528e-22
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.14653229612264e-23
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.07326614806132e-23
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.03663307403066e-23
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.01831653701533e-23
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.09158268507665e-24
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.545791342538325e-24
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.2728956712691625e-24
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.364478356345813e-25
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.1822391781729064e-25
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.5911195890864532e-25
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.955597945432266e-26
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.977798972716133e-26
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.9888994863580665e-26
EarlyStopping counter: 17 out of 100
Updating learning rate to 9.944497431790332e-27
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.972248715895166e-27
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.486124357947583e-27
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.2430621789737915e-27
EarlyStopping counter: 21 out of 100
Updating learning rate to 6.215310894868958e-28
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.107655447434479e-28
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.5538277237172394e-28
EarlyStopping counter: 24 out of 100
Updating learning rate to 7.769138618586197e-29
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.8845693092930986e-29
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.9422846546465493e-29
EarlyStopping counter: 27 out of 100
Updating learning rate to 9.711423273232746e-30
EarlyStopping counter: 28 out of 100
Updating learning rate to 4.855711636616373e-30
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.4278558183081866e-30
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.2139279091540933e-30
EarlyStopping counter: 31 out of 100
Updating learning rate to 6.0696395457704665e-31
EarlyStopping counter: 32 out of 100
Updating learning rate to 3.0348197728852333e-31
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.5174098864426166e-31
EarlyStopping counter: 34 out of 100
Updating learning rate to 7.587049432213083e-32
EarlyStopping counter: 35 out of 100
Updating learning rate to 3.7935247161065416e-32
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.8967623580532708e-32
EarlyStopping counter: 37 out of 100
Updating learning rate to 9.483811790266354e-33
EarlyStopping counter: 38 out of 100
Updating learning rate to 4.741905895133177e-33
EarlyStopping counter: 39 out of 100
Updating learning rate to 2.3709529475665885e-33
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.1854764737832942e-33
EarlyStopping counter: 41 out of 100
Updating learning rate to 5.927382368916471e-34
EarlyStopping counter: 42 out of 100
Updating learning rate to 2.9636911844582356e-34
>>>>>> Testing on validation set: trial_15 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.05027829483151436, mae:0.07893785834312439, dtw:Not calculated


                                                                                         [I 2025-10-17 06:43:32,937] Trial 15 finished with value: 0.07893785834312439 and parameters: {'seq_len': 96, 'pred_len': 1, 'expand': 2, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 1, 'batch_size': 64, 'learning_rate': 0.00018784624544347973, 'dropout': 0.2999615829618213}. Best is trial 15 with value: 0.07893785834312439.
Best trial: 14. Best value: 0.0815487:  30%|███       | 15/50 [39:42<1:02:51, 107.77s/it]Best trial: 15. Best value: 0.0789379:  30%|███       | 15/50 [39:42<1:02:51, 107.77s/it]Best trial: 15. Best value: 0.0789379:  32%|███▏      | 16/50 [39:42<54:17, 95.80s/it]   
============================================================
Trial 16
============================================================
seq_len: 96, pred_len: 1
d_model: 64, n_heads: 4
e_layers: 1, d_layers: 1
batch_size: 64, lr: 0.000214
dropout: 0.290144498694231
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_16 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 1
============================================================
train 4577
val 259
test 261
Validation loss decreased (inf --> 0.030826).  Saving model ...
Updating learning rate to 0.0002137397779615794
Validation loss decreased (0.030826 --> 0.028173).  Saving model ...
Updating learning rate to 0.0001068698889807897
Validation loss decreased (0.028173 --> 0.023552).  Saving model ...
Updating learning rate to 5.343494449039485e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.6717472245197423e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3358736122598712e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.679368061299356e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.339684030649678e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.669842015324839e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.349210076624195e-07
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.1746050383120974e-07
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0873025191560487e-07
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.0436512595780244e-07
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.218256297890122e-08
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.609128148945061e-08
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.3045640744725304e-08
EarlyStopping counter: 13 out of 100
Updating learning rate to 6.522820372362652e-09
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.261410186181326e-09
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.630705093090663e-09
Validation loss decreased (0.023552 --> 0.022661).  Saving model ...
Updating learning rate to 8.153525465453315e-10
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.0767627327266576e-10
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0383813663633288e-10
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0191906831816644e-10
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.095953415908322e-11
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.547976707954161e-11
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.2739883539770805e-11
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.3699417698854026e-12
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.1849708849427013e-12
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.5924854424713506e-12
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.962427212356753e-13
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.9812136061783766e-13
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.9906068030891883e-13
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.953034015445941e-14
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.976517007722971e-14
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.4882585038614854e-14
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.2441292519307427e-14
EarlyStopping counter: 17 out of 100
Updating learning rate to 6.2206462596537134e-15
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.1103231298268567e-15
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.5551615649134284e-15
EarlyStopping counter: 20 out of 100
Updating learning rate to 7.775807824567142e-16
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.887903912283571e-16
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.9439519561417854e-16
EarlyStopping counter: 23 out of 100
Updating learning rate to 9.719759780708927e-17
EarlyStopping counter: 24 out of 100
Updating learning rate to 4.8598798903544636e-17
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.4299399451772318e-17
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.2149699725886159e-17
EarlyStopping counter: 27 out of 100
Updating learning rate to 6.0748498629430795e-18
EarlyStopping counter: 28 out of 100
Updating learning rate to 3.0374249314715398e-18
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.5187124657357699e-18
EarlyStopping counter: 30 out of 100
Updating learning rate to 7.593562328678849e-19
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.7967811643394247e-19
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.8983905821697124e-19
EarlyStopping counter: 33 out of 100
Updating learning rate to 9.491952910848562e-20
EarlyStopping counter: 34 out of 100
Updating learning rate to 4.745976455424281e-20
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.3729882277121404e-20
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.1864941138560702e-20
EarlyStopping counter: 37 out of 100
Updating learning rate to 5.932470569280351e-21
EarlyStopping counter: 38 out of 100
Updating learning rate to 2.9662352846401755e-21
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.4831176423200878e-21
EarlyStopping counter: 40 out of 100
Updating learning rate to 7.415588211600439e-22
EarlyStopping counter: 41 out of 100
Updating learning rate to 3.7077941058002194e-22
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.8538970529001097e-22
EarlyStopping counter: 43 out of 100
Updating learning rate to 9.269485264500549e-23
EarlyStopping counter: 44 out of 100
Updating learning rate to 4.6347426322502743e-23
EarlyStopping counter: 45 out of 100
Updating learning rate to 2.3173713161251371e-23
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.1586856580625686e-23
EarlyStopping counter: 47 out of 100
Updating learning rate to 5.793428290312843e-24
EarlyStopping counter: 48 out of 100
Updating learning rate to 2.8967141451564214e-24
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.4483570725782107e-24
EarlyStopping counter: 50 out of 100
Updating learning rate to 7.241785362891054e-25
EarlyStopping counter: 51 out of 100
Updating learning rate to 3.620892681445527e-25
EarlyStopping counter: 52 out of 100
Updating learning rate to 1.8104463407227634e-25
EarlyStopping counter: 53 out of 100
Updating learning rate to 9.052231703613817e-26
EarlyStopping counter: 54 out of 100
Updating learning rate to 4.5261158518069085e-26
EarlyStopping counter: 55 out of 100
Updating learning rate to 2.2630579259034542e-26
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.1315289629517271e-26
EarlyStopping counter: 57 out of 100
Updating learning rate to 5.6576448147586356e-27
EarlyStopping counter: 58 out of 100
Updating learning rate to 2.8288224073793178e-27
EarlyStopping counter: 59 out of 100
Updating learning rate to 1.4144112036896589e-27
EarlyStopping counter: 60 out of 100
Updating learning rate to 7.0720560184482945e-28
EarlyStopping counter: 61 out of 100
Updating learning rate to 3.5360280092241473e-28
EarlyStopping counter: 62 out of 100
Updating learning rate to 1.7680140046120736e-28
EarlyStopping counter: 63 out of 100
Updating learning rate to 8.840070023060368e-29
EarlyStopping counter: 64 out of 100
Updating learning rate to 4.420035011530184e-29
EarlyStopping counter: 65 out of 100
Updating learning rate to 2.210017505765092e-29
EarlyStopping counter: 66 out of 100
Updating learning rate to 1.105008752882546e-29
EarlyStopping counter: 67 out of 100
Updating learning rate to 5.52504376441273e-30
EarlyStopping counter: 68 out of 100
Updating learning rate to 2.762521882206365e-30
EarlyStopping counter: 69 out of 100
Updating learning rate to 1.3812609411031825e-30
EarlyStopping counter: 70 out of 100
Updating learning rate to 6.906304705515913e-31
EarlyStopping counter: 71 out of 100
Updating learning rate to 3.4531523527579563e-31
EarlyStopping counter: 72 out of 100
Updating learning rate to 1.7265761763789782e-31
EarlyStopping counter: 73 out of 100
Updating learning rate to 8.632880881894891e-32
EarlyStopping counter: 74 out of 100
Updating learning rate to 4.3164404409474454e-32
EarlyStopping counter: 75 out of 100
Updating learning rate to 2.1582202204737227e-32
EarlyStopping counter: 76 out of 100
Updating learning rate to 1.0791101102368613e-32
EarlyStopping counter: 77 out of 100
Updating learning rate to 5.395550551184307e-33
EarlyStopping counter: 78 out of 100
Updating learning rate to 2.6977752755921534e-33
EarlyStopping counter: 79 out of 100
Updating learning rate to 1.3488876377960767e-33
EarlyStopping counter: 80 out of 100
Updating learning rate to 6.744438188980383e-34
EarlyStopping counter: 81 out of 100
Updating learning rate to 3.3722190944901917e-34
>>>>>> Testing on validation set: trial_16 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.050736796110868454, mae:0.07937892526388168, dtw:Not calculated


                                                                                      [I 2025-10-17 06:44:41,120] Trial 16 finished with value: 0.07937892526388168 and parameters: {'seq_len': 96, 'pred_len': 1, 'expand': 2, 'd_model': 64, 'n_heads': 4, 'e_layers': 1, 'd_layers': 1, 'batch_size': 64, 'learning_rate': 0.0002137397779615794, 'dropout': 0.290144498694231}. Best is trial 15 with value: 0.07893785834312439.
Best trial: 15. Best value: 0.0789379:  32%|███▏      | 16/50 [40:50<54:17, 95.80s/it]Best trial: 15. Best value: 0.0789379:  32%|███▏      | 16/50 [40:50<54:17, 95.80s/it]Best trial: 15. Best value: 0.0789379:  34%|███▍      | 17/50 [40:50<48:07, 87.50s/it]
============================================================
Trial 17
============================================================
seq_len: 96, pred_len: 30
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 1
batch_size: 64, lr: 0.000529
dropout: 0.2912786925877807
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_17 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 30
============================================================
train 4548
val 230
test 232
Validation loss decreased (inf --> 0.036481).  Saving model ...
Updating learning rate to 0.0005292628571532474
Validation loss decreased (0.036481 --> 0.036254).  Saving model ...
Updating learning rate to 0.0002646314285766237
Validation loss decreased (0.036254 --> 0.035696).  Saving model ...
Updating learning rate to 0.00013231571428831186
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.615785714415593e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.3078928572077964e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6539464286038982e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.269732143019491e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.1348660715097455e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0674330357548728e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.0337165178774364e-06
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.168582589387182e-07
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.584291294693591e-07
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.2921456473467955e-07
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.460728236733977e-08
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.230364118366989e-08
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.6151820591834944e-08
EarlyStopping counter: 14 out of 100
Updating learning rate to 8.075910295917472e-09
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.037955147958736e-09
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.018977573979368e-09
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.009488786989684e-09
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.04744393494842e-10
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.52372196747421e-10
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.261860983737105e-10
Validation loss decreased (0.035696 --> 0.035570).  Saving model ...
Updating learning rate to 6.309304918685525e-11
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.1546524593427624e-11
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5773262296713812e-11
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.886631148356906e-12
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.943315574178453e-12
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.9716577870892265e-12
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.858288935446133e-13
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.929144467723066e-13
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.464572233861533e-13
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.2322861169307666e-13
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.161430584653833e-14
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.0807152923269164e-14
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.5403576461634582e-14
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.701788230817291e-15
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.8508941154086455e-15
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.9254470577043228e-15
EarlyStopping counter: 16 out of 100
Updating learning rate to 9.627235288521614e-16
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.813617644260807e-16
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.4068088221304035e-16
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.2034044110652017e-16
EarlyStopping counter: 20 out of 100
Updating learning rate to 6.017022055326009e-17
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.0085110276630043e-17
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.5042555138315022e-17
EarlyStopping counter: 23 out of 100
Updating learning rate to 7.521277569157511e-18
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.7606387845787554e-18
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.8803193922893777e-18
Validation loss decreased (0.035570 --> 0.035504).  Saving model ...
Updating learning rate to 9.401596961446888e-19
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.700798480723444e-19
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.350399240361722e-19
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.175199620180861e-19
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.875998100904305e-20
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.9379990504521527e-20
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.4689995252260763e-20
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.344997626130382e-21
Validation loss decreased (0.035504 --> 0.035402).  Saving model ...
Updating learning rate to 3.672498813065191e-21
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8362494065325954e-21
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.181247032662977e-22
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.5906235163314885e-22
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2953117581657443e-22
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1476558790828721e-22
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.738279395414361e-23
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.8691396977071803e-23
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.4345698488535902e-23
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.172849244267951e-24
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.5864246221339754e-24
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.7932123110669877e-24
EarlyStopping counter: 12 out of 100
Updating learning rate to 8.966061555334939e-25
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.483030777667469e-25
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.2415153888337346e-25
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.1207576944168673e-25
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.603788472084337e-26
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.801894236042168e-26
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.400947118021084e-26
EarlyStopping counter: 19 out of 100
Updating learning rate to 7.00473559010542e-27
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.50236779505271e-27
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.751183897526355e-27
EarlyStopping counter: 22 out of 100
Updating learning rate to 8.755919487631776e-28
EarlyStopping counter: 23 out of 100
Updating learning rate to 4.377959743815888e-28
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.188979871907944e-28
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.094489935953972e-28
EarlyStopping counter: 26 out of 100
Updating learning rate to 5.47244967976986e-29
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.73622483988493e-29
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.368112419942465e-29
EarlyStopping counter: 29 out of 100
Updating learning rate to 6.840562099712325e-30
EarlyStopping counter: 30 out of 100
Updating learning rate to 3.4202810498561625e-30
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.7101405249280812e-30
EarlyStopping counter: 32 out of 100
Updating learning rate to 8.550702624640406e-31
EarlyStopping counter: 33 out of 100
Updating learning rate to 4.275351312320203e-31
EarlyStopping counter: 34 out of 100
Updating learning rate to 2.1376756561601015e-31
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.0688378280800508e-31
EarlyStopping counter: 36 out of 100
Updating learning rate to 5.344189140400254e-32
EarlyStopping counter: 37 out of 100
Updating learning rate to 2.672094570200127e-32
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.3360472851000635e-32
EarlyStopping counter: 39 out of 100
Updating learning rate to 6.680236425500317e-33
EarlyStopping counter: 40 out of 100
Updating learning rate to 3.3401182127501586e-33
EarlyStopping counter: 41 out of 100
Updating learning rate to 1.6700591063750793e-33
EarlyStopping counter: 42 out of 100
Updating learning rate to 8.350295531875397e-34
>>>>>> Testing on validation set: trial_17 >>>>>>
test 232
test shape: (232, 30, 5) (232, 30, 5)
test shape: (232, 30, 5) (232, 30, 5)


	mse:0.07130668312311172, mae:0.1130756065249443, dtw:Not calculated


                                                                                      [I 2025-10-17 06:45:48,706] Trial 17 finished with value: 0.1130756065249443 and parameters: {'seq_len': 96, 'pred_len': 30, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 1, 'batch_size': 64, 'learning_rate': 0.0005292628571532474, 'dropout': 0.2912786925877807}. Best is trial 15 with value: 0.07893785834312439.
Best trial: 15. Best value: 0.0789379:  34%|███▍      | 17/50 [41:58<48:07, 87.50s/it]Best trial: 15. Best value: 0.0789379:  34%|███▍      | 17/50 [41:58<48:07, 87.50s/it]Best trial: 15. Best value: 0.0789379:  36%|███▌      | 18/50 [41:58<43:28, 81.51s/it]
============================================================
Trial 18
============================================================
seq_len: 96, pred_len: 14
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 1
batch_size: 64, lr: 0.000218
dropout: 0.2562951343992566
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_18 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 14
============================================================
train 4564
val 246
test 248
Validation loss decreased (inf --> 0.040487).  Saving model ...
Updating learning rate to 0.00021781073660848233
Validation loss decreased (0.040487 --> 0.039008).  Saving model ...
Updating learning rate to 0.00010890536830424116
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.445268415212058e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.722634207606029e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3613171038030146e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.806585519015073e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4032927595075364e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.7016463797537682e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.508231898768841e-07
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.2541159493844205e-07
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.1270579746922103e-07
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.0635289873461051e-07
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.3176449367305256e-08
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.6588224683652628e-08
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.3294112341826314e-08
EarlyStopping counter: 14 out of 100
Updating learning rate to 6.647056170913157e-09
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.3235280854565785e-09
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.6617640427282893e-09
EarlyStopping counter: 17 out of 100
Updating learning rate to 8.308820213641446e-10
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.154410106820723e-10
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.0772050534103616e-10
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.0386025267051808e-10
EarlyStopping counter: 21 out of 100
Updating learning rate to 5.193012633525904e-11
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.596506316762952e-11
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.298253158381476e-11
EarlyStopping counter: 24 out of 100
Updating learning rate to 6.49126579190738e-12
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.24563289595369e-12
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.622816447976845e-12
EarlyStopping counter: 27 out of 100
Updating learning rate to 8.114082239884225e-13
EarlyStopping counter: 28 out of 100
Updating learning rate to 4.0570411199421125e-13
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.0285205599710562e-13
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.0142602799855281e-13
EarlyStopping counter: 31 out of 100
Updating learning rate to 5.0713013999276406e-14
EarlyStopping counter: 32 out of 100
Updating learning rate to 2.5356506999638203e-14
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.2678253499819101e-14
EarlyStopping counter: 34 out of 100
Updating learning rate to 6.339126749909551e-15
EarlyStopping counter: 35 out of 100
Updating learning rate to 3.1695633749547754e-15
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.5847816874773877e-15
EarlyStopping counter: 37 out of 100
Updating learning rate to 7.923908437386938e-16
EarlyStopping counter: 38 out of 100
Updating learning rate to 3.961954218693469e-16
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.9809771093467346e-16
EarlyStopping counter: 40 out of 100
Updating learning rate to 9.904885546733673e-17
EarlyStopping counter: 41 out of 100
Updating learning rate to 4.9524427733668365e-17
EarlyStopping counter: 42 out of 100
Updating learning rate to 2.4762213866834182e-17
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.2381106933417091e-17
EarlyStopping counter: 44 out of 100
Updating learning rate to 6.1905534667085456e-18
EarlyStopping counter: 45 out of 100
Updating learning rate to 3.0952767333542728e-18
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.5476383666771364e-18
EarlyStopping counter: 47 out of 100
Updating learning rate to 7.738191833385682e-19
EarlyStopping counter: 48 out of 100
Updating learning rate to 3.869095916692841e-19
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.9345479583464205e-19
EarlyStopping counter: 50 out of 100
Updating learning rate to 9.672739791732103e-20
EarlyStopping counter: 51 out of 100
Updating learning rate to 4.836369895866051e-20
EarlyStopping counter: 52 out of 100
Updating learning rate to 2.4181849479330256e-20
EarlyStopping counter: 53 out of 100
Updating learning rate to 1.2090924739665128e-20
EarlyStopping counter: 54 out of 100
Updating learning rate to 6.045462369832564e-21
EarlyStopping counter: 55 out of 100
Updating learning rate to 3.022731184916282e-21
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.511365592458141e-21
EarlyStopping counter: 57 out of 100
Updating learning rate to 7.556827962290705e-22
EarlyStopping counter: 58 out of 100
Updating learning rate to 3.7784139811453525e-22
EarlyStopping counter: 59 out of 100
Updating learning rate to 1.8892069905726763e-22
EarlyStopping counter: 60 out of 100
Updating learning rate to 9.446034952863381e-23
EarlyStopping counter: 61 out of 100
Updating learning rate to 4.7230174764316907e-23
EarlyStopping counter: 62 out of 100
Updating learning rate to 2.3615087382158453e-23
EarlyStopping counter: 63 out of 100
Updating learning rate to 1.1807543691079227e-23
EarlyStopping counter: 64 out of 100
Updating learning rate to 5.903771845539613e-24
EarlyStopping counter: 65 out of 100
Updating learning rate to 2.9518859227698067e-24
EarlyStopping counter: 66 out of 100
Updating learning rate to 1.4759429613849033e-24
EarlyStopping counter: 67 out of 100
Updating learning rate to 7.379714806924517e-25
EarlyStopping counter: 68 out of 100
Updating learning rate to 3.6898574034622583e-25
EarlyStopping counter: 69 out of 100
Updating learning rate to 1.8449287017311292e-25
EarlyStopping counter: 70 out of 100
Updating learning rate to 9.224643508655646e-26
EarlyStopping counter: 71 out of 100
Updating learning rate to 4.612321754327823e-26
EarlyStopping counter: 72 out of 100
Updating learning rate to 2.3061608771639115e-26
EarlyStopping counter: 73 out of 100
Updating learning rate to 1.1530804385819557e-26
EarlyStopping counter: 74 out of 100
Updating learning rate to 5.765402192909779e-27
EarlyStopping counter: 75 out of 100
Updating learning rate to 2.8827010964548893e-27
EarlyStopping counter: 76 out of 100
Updating learning rate to 1.4413505482274447e-27
EarlyStopping counter: 77 out of 100
Updating learning rate to 7.206752741137223e-28
EarlyStopping counter: 78 out of 100
Updating learning rate to 3.6033763705686117e-28
EarlyStopping counter: 79 out of 100
Updating learning rate to 1.8016881852843058e-28
EarlyStopping counter: 80 out of 100
Updating learning rate to 9.008440926421529e-29
EarlyStopping counter: 81 out of 100
Updating learning rate to 4.5042204632107646e-29
EarlyStopping counter: 82 out of 100
Updating learning rate to 2.2521102316053823e-29
EarlyStopping counter: 83 out of 100
Updating learning rate to 1.1260551158026911e-29
EarlyStopping counter: 84 out of 100
Updating learning rate to 5.630275579013456e-30
EarlyStopping counter: 85 out of 100
Updating learning rate to 2.815137789506728e-30
EarlyStopping counter: 86 out of 100
Updating learning rate to 1.407568894753364e-30
EarlyStopping counter: 87 out of 100
Updating learning rate to 7.03784447376682e-31
EarlyStopping counter: 88 out of 100
Updating learning rate to 3.51892223688341e-31
EarlyStopping counter: 89 out of 100
Updating learning rate to 1.759461118441705e-31
EarlyStopping counter: 90 out of 100
Updating learning rate to 8.797305592208525e-32
EarlyStopping counter: 91 out of 100
Updating learning rate to 4.3986527961042623e-32
EarlyStopping counter: 92 out of 100
Updating learning rate to 2.1993263980521311e-32
EarlyStopping counter: 93 out of 100
Updating learning rate to 1.0996631990260656e-32
EarlyStopping counter: 94 out of 100
Updating learning rate to 5.498315995130328e-33
EarlyStopping counter: 95 out of 100
Updating learning rate to 2.749157997565164e-33
EarlyStopping counter: 96 out of 100
Updating learning rate to 1.374578998782582e-33
EarlyStopping counter: 97 out of 100
Updating learning rate to 6.87289499391291e-34
EarlyStopping counter: 98 out of 100
Updating learning rate to 3.436447496956455e-34
>>>>>> Testing on validation set: trial_18 >>>>>>
test 248
test shape: (248, 14, 5) (248, 14, 5)
test shape: (248, 14, 5) (248, 14, 5)


	mse:0.07358182966709137, mae:0.10886348783969879, dtw:Not calculated


                                                                                      [I 2025-10-17 06:46:56,469] Trial 18 finished with value: 0.10886348783969879 and parameters: {'seq_len': 96, 'pred_len': 14, 'expand': 2, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 1, 'batch_size': 64, 'learning_rate': 0.00021781073660848233, 'dropout': 0.2562951343992566}. Best is trial 15 with value: 0.07893785834312439.
Best trial: 15. Best value: 0.0789379:  36%|███▌      | 18/50 [43:05<43:28, 81.51s/it]Best trial: 15. Best value: 0.0789379:  36%|███▌      | 18/50 [43:05<43:28, 81.51s/it]Best trial: 15. Best value: 0.0789379:  38%|███▊      | 19/50 [43:05<39:58, 77.38s/it]
============================================================
Trial 19
============================================================
seq_len: 96, pred_len: 1
d_model: 64, n_heads: 4
e_layers: 1, d_layers: 1
batch_size: 64, lr: 0.000859
dropout: 0.29946168779289123
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 128, expand: 2
>>>>>> Start training: trial_19 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 1
============================================================
train 4577
val 259
test 261
Validation loss decreased (inf --> 0.025183).  Saving model ...
Updating learning rate to 0.0008588694821541037
Validation loss decreased (0.025183 --> 0.024485).  Saving model ...
Updating learning rate to 0.00042943474107705185
Validation loss decreased (0.024485 --> 0.023216).  Saving model ...
Updating learning rate to 0.00021471737053852593
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00010735868526926296
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.367934263463148e-05
Validation loss decreased (0.023216 --> 0.021553).  Saving model ...
Updating learning rate to 2.683967131731574e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.341983565865787e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.709917829328935e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.3549589146644676e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6774794573322338e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.387397286661169e-07
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.1936986433305845e-07
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.0968493216652922e-07
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.0484246608326461e-07
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.2421233041632306e-08
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.6210616520816153e-08
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.3105308260408077e-08
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.552654130204038e-09
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.276327065102019e-09
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.6381635325510096e-09
EarlyStopping counter: 15 out of 100
Updating learning rate to 8.190817662755048e-10
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.095408831377524e-10
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.047704415688762e-10
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.023852207844381e-10
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.119261039221905e-11
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.5596305196109524e-11
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.2798152598054762e-11
EarlyStopping counter: 22 out of 100
Updating learning rate to 6.399076299027381e-12
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.1995381495136906e-12
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.5997690747568453e-12
EarlyStopping counter: 25 out of 100
Updating learning rate to 7.998845373784226e-13
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.999422686892113e-13
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.9997113434460566e-13
EarlyStopping counter: 28 out of 100
Updating learning rate to 9.998556717230283e-14
EarlyStopping counter: 29 out of 100
Updating learning rate to 4.9992783586151415e-14
EarlyStopping counter: 30 out of 100
Updating learning rate to 2.4996391793075708e-14
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.2498195896537854e-14
EarlyStopping counter: 32 out of 100
Updating learning rate to 6.249097948268927e-15
EarlyStopping counter: 33 out of 100
Updating learning rate to 3.1245489741344634e-15
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.5622744870672317e-15
EarlyStopping counter: 35 out of 100
Updating learning rate to 7.811372435336159e-16
EarlyStopping counter: 36 out of 100
Updating learning rate to 3.9056862176680793e-16
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.9528431088340396e-16
EarlyStopping counter: 38 out of 100
Updating learning rate to 9.764215544170198e-17
EarlyStopping counter: 39 out of 100
Updating learning rate to 4.882107772085099e-17
EarlyStopping counter: 40 out of 100
Updating learning rate to 2.4410538860425496e-17
EarlyStopping counter: 41 out of 100
Updating learning rate to 1.2205269430212748e-17
EarlyStopping counter: 42 out of 100
Updating learning rate to 6.102634715106374e-18
EarlyStopping counter: 43 out of 100
Updating learning rate to 3.051317357553187e-18
EarlyStopping counter: 44 out of 100
Updating learning rate to 1.5256586787765935e-18
EarlyStopping counter: 45 out of 100
Updating learning rate to 7.628293393882967e-19
EarlyStopping counter: 46 out of 100
Updating learning rate to 3.8141466969414837e-19
EarlyStopping counter: 47 out of 100
Updating learning rate to 1.9070733484707418e-19
EarlyStopping counter: 48 out of 100
Updating learning rate to 9.535366742353709e-20
EarlyStopping counter: 49 out of 100
Updating learning rate to 4.7676833711768546e-20
EarlyStopping counter: 50 out of 100
Updating learning rate to 2.3838416855884273e-20
EarlyStopping counter: 51 out of 100
Updating learning rate to 1.1919208427942137e-20
EarlyStopping counter: 52 out of 100
Updating learning rate to 5.959604213971068e-21
EarlyStopping counter: 53 out of 100
Updating learning rate to 2.979802106985534e-21
EarlyStopping counter: 54 out of 100
Updating learning rate to 1.489901053492767e-21
EarlyStopping counter: 55 out of 100
Updating learning rate to 7.449505267463835e-22
EarlyStopping counter: 56 out of 100
Updating learning rate to 3.7247526337319177e-22
EarlyStopping counter: 57 out of 100
Updating learning rate to 1.8623763168659588e-22
EarlyStopping counter: 58 out of 100
Updating learning rate to 9.311881584329794e-23
EarlyStopping counter: 59 out of 100
Updating learning rate to 4.655940792164897e-23
EarlyStopping counter: 60 out of 100
Updating learning rate to 2.3279703960824485e-23
EarlyStopping counter: 61 out of 100
Updating learning rate to 1.1639851980412243e-23
EarlyStopping counter: 62 out of 100
Updating learning rate to 5.819925990206121e-24
EarlyStopping counter: 63 out of 100
Updating learning rate to 2.9099629951030607e-24
EarlyStopping counter: 64 out of 100
Updating learning rate to 1.4549814975515303e-24
EarlyStopping counter: 65 out of 100
Updating learning rate to 7.274907487757652e-25
EarlyStopping counter: 66 out of 100
Updating learning rate to 3.637453743878826e-25
EarlyStopping counter: 67 out of 100
Updating learning rate to 1.818726871939413e-25
EarlyStopping counter: 68 out of 100
Updating learning rate to 9.093634359697065e-26
EarlyStopping counter: 69 out of 100
Updating learning rate to 4.5468171798485323e-26
EarlyStopping counter: 70 out of 100
Updating learning rate to 2.2734085899242662e-26
EarlyStopping counter: 71 out of 100
Updating learning rate to 1.1367042949621331e-26
EarlyStopping counter: 72 out of 100
Updating learning rate to 5.6835214748106654e-27
EarlyStopping counter: 73 out of 100
Updating learning rate to 2.8417607374053327e-27
EarlyStopping counter: 74 out of 100
Updating learning rate to 1.4208803687026663e-27
EarlyStopping counter: 75 out of 100
Updating learning rate to 7.104401843513332e-28
EarlyStopping counter: 76 out of 100
Updating learning rate to 3.552200921756666e-28
EarlyStopping counter: 77 out of 100
Updating learning rate to 1.776100460878333e-28
EarlyStopping counter: 78 out of 100
Updating learning rate to 8.880502304391665e-29
EarlyStopping counter: 79 out of 100
Updating learning rate to 4.4402511521958323e-29
EarlyStopping counter: 80 out of 100
Updating learning rate to 2.2201255760979162e-29
EarlyStopping counter: 81 out of 100
Updating learning rate to 1.1100627880489581e-29
EarlyStopping counter: 82 out of 100
Updating learning rate to 5.5503139402447904e-30
EarlyStopping counter: 83 out of 100
Updating learning rate to 2.7751569701223952e-30
EarlyStopping counter: 84 out of 100
Updating learning rate to 1.3875784850611976e-30
EarlyStopping counter: 85 out of 100
Updating learning rate to 6.937892425305988e-31
EarlyStopping counter: 86 out of 100
Updating learning rate to 3.468946212652994e-31
EarlyStopping counter: 87 out of 100
Updating learning rate to 1.734473106326497e-31
EarlyStopping counter: 88 out of 100
Updating learning rate to 8.672365531632485e-32
EarlyStopping counter: 89 out of 100
Updating learning rate to 4.3361827658162425e-32
EarlyStopping counter: 90 out of 100
Updating learning rate to 2.1680913829081213e-32
EarlyStopping counter: 91 out of 100
Updating learning rate to 1.0840456914540606e-32
EarlyStopping counter: 92 out of 100
Updating learning rate to 5.420228457270303e-33
EarlyStopping counter: 93 out of 100
Updating learning rate to 2.7101142286351516e-33
EarlyStopping counter: 94 out of 100
Updating learning rate to 1.3550571143175758e-33
>>>>>> Testing on validation set: trial_19 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.04931623116135597, mae:0.07496212422847748, dtw:Not calculated


                                                                                      [I 2025-10-17 06:48:04,767] Trial 19 finished with value: 0.07496212422847748 and parameters: {'seq_len': 96, 'pred_len': 1, 'expand': 2, 'd_model': 64, 'n_heads': 4, 'e_layers': 1, 'd_layers': 1, 'batch_size': 64, 'learning_rate': 0.0008588694821541037, 'dropout': 0.29946168779289123}. Best is trial 19 with value: 0.07496212422847748.
Best trial: 15. Best value: 0.0789379:  38%|███▊      | 19/50 [44:14<39:58, 77.38s/it]Best trial: 19. Best value: 0.0749621:  38%|███▊      | 19/50 [44:14<39:58, 77.38s/it]Best trial: 19. Best value: 0.0749621:  40%|████      | 20/50 [44:14<37:19, 74.66s/it]
============================================================
Trial 20
============================================================
seq_len: 96, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 1
batch_size: 64, lr: 0.000815
dropout: 0.15818957366667288
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_20 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 1
============================================================
train 4577
val 259
test 261
Validation loss decreased (inf --> 0.024676).  Saving model ...
Updating learning rate to 0.0008154626856700347
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00040773134283501736
Validation loss decreased (0.024676 --> 0.023139).  Saving model ...
Updating learning rate to 0.00020386567141750868
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00010193283570875434
Validation loss decreased (0.023139 --> 0.022100).  Saving model ...
Updating learning rate to 5.096641785437717e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.5483208927188585e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2741604463594293e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.370802231797146e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.185401115898573e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.5927005579492866e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.963502789746433e-07
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.9817513948732164e-07
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.9908756974366082e-07
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.954378487183041e-08
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.9771892435915206e-08
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.4885946217957603e-08
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.2442973108978801e-08
EarlyStopping counter: 13 out of 100
Updating learning rate to 6.221486554489401e-09
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.1107432772447003e-09
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.5553716386223502e-09
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.776858193111751e-10
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.8884290965558754e-10
Validation loss decreased (0.022100 --> 0.021914).  Saving model ...
Updating learning rate to 1.9442145482779377e-10
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.721072741389689e-11
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.860536370694844e-11
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.430268185347422e-11
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.215134092673711e-11
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.075670463368555e-12
Validation loss decreased (0.021914 --> 0.021658).  Saving model ...
Updating learning rate to 3.0378352316842777e-12
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5189176158421388e-12
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.594588079210694e-13
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.797294039605347e-13
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8986470198026735e-13
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.493235099013368e-14
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.746617549506684e-14
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.373308774753342e-14
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.186654387376671e-14
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.933271936883355e-15
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.9666359684416774e-15
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.4833179842208387e-15
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.416589921104194e-16
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.708294960552097e-16
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.8541474802760484e-16
EarlyStopping counter: 15 out of 100
Updating learning rate to 9.270737401380242e-17
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.635368700690121e-17
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.3176843503450605e-17
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.1588421751725302e-17
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.794210875862651e-18
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.8971054379313256e-18
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.4485527189656628e-18
EarlyStopping counter: 22 out of 100
Updating learning rate to 7.242763594828314e-19
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.621381797414157e-19
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.8106908987070785e-19
EarlyStopping counter: 25 out of 100
Updating learning rate to 9.053454493535393e-20
EarlyStopping counter: 26 out of 100
Updating learning rate to 4.526727246767696e-20
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.263363623383848e-20
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.131681811691924e-20
EarlyStopping counter: 29 out of 100
Updating learning rate to 5.65840905845962e-21
EarlyStopping counter: 30 out of 100
Updating learning rate to 2.82920452922981e-21
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.414602264614905e-21
EarlyStopping counter: 32 out of 100
Updating learning rate to 7.073011323074525e-22
EarlyStopping counter: 33 out of 100
Updating learning rate to 3.5365056615372627e-22
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.7682528307686314e-22
EarlyStopping counter: 35 out of 100
Updating learning rate to 8.841264153843157e-23
EarlyStopping counter: 36 out of 100
Updating learning rate to 4.4206320769215784e-23
EarlyStopping counter: 37 out of 100
Updating learning rate to 2.2103160384607892e-23
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.1051580192303946e-23
EarlyStopping counter: 39 out of 100
Updating learning rate to 5.525790096151973e-24
EarlyStopping counter: 40 out of 100
Updating learning rate to 2.7628950480759865e-24
EarlyStopping counter: 41 out of 100
Updating learning rate to 1.3814475240379932e-24
EarlyStopping counter: 42 out of 100
Updating learning rate to 6.907237620189966e-25
EarlyStopping counter: 43 out of 100
Updating learning rate to 3.453618810094983e-25
EarlyStopping counter: 44 out of 100
Updating learning rate to 1.7268094050474916e-25
EarlyStopping counter: 45 out of 100
Updating learning rate to 8.634047025237458e-26
EarlyStopping counter: 46 out of 100
Updating learning rate to 4.317023512618729e-26
EarlyStopping counter: 47 out of 100
Updating learning rate to 2.1585117563093644e-26
EarlyStopping counter: 48 out of 100
Updating learning rate to 1.0792558781546822e-26
EarlyStopping counter: 49 out of 100
Updating learning rate to 5.396279390773411e-27
EarlyStopping counter: 50 out of 100
Updating learning rate to 2.6981396953867056e-27
EarlyStopping counter: 51 out of 100
Updating learning rate to 1.3490698476933528e-27
EarlyStopping counter: 52 out of 100
Updating learning rate to 6.745349238466764e-28
EarlyStopping counter: 53 out of 100
Updating learning rate to 3.372674619233382e-28
EarlyStopping counter: 54 out of 100
Updating learning rate to 1.686337309616691e-28
EarlyStopping counter: 55 out of 100
Updating learning rate to 8.431686548083455e-29
EarlyStopping counter: 56 out of 100
Updating learning rate to 4.2158432740417274e-29
EarlyStopping counter: 57 out of 100
Updating learning rate to 2.1079216370208637e-29
EarlyStopping counter: 58 out of 100
Updating learning rate to 1.0539608185104319e-29
EarlyStopping counter: 59 out of 100
Updating learning rate to 5.269804092552159e-30
EarlyStopping counter: 60 out of 100
Updating learning rate to 2.6349020462760796e-30
EarlyStopping counter: 61 out of 100
Updating learning rate to 1.3174510231380398e-30
EarlyStopping counter: 62 out of 100
Updating learning rate to 6.587255115690199e-31
EarlyStopping counter: 63 out of 100
Updating learning rate to 3.2936275578450996e-31
EarlyStopping counter: 64 out of 100
Updating learning rate to 1.6468137789225498e-31
EarlyStopping counter: 65 out of 100
Updating learning rate to 8.234068894612749e-32
EarlyStopping counter: 66 out of 100
Updating learning rate to 4.1170344473063744e-32
EarlyStopping counter: 67 out of 100
Updating learning rate to 2.0585172236531872e-32
EarlyStopping counter: 68 out of 100
Updating learning rate to 1.0292586118265936e-32
EarlyStopping counter: 69 out of 100
Updating learning rate to 5.146293059132968e-33
EarlyStopping counter: 70 out of 100
Updating learning rate to 2.573146529566484e-33
EarlyStopping counter: 71 out of 100
Updating learning rate to 1.286573264783242e-33
>>>>>> Testing on validation set: trial_20 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.0503358468413353, mae:0.0748719573020935, dtw:Not calculated


                                                                                      [I 2025-10-17 06:49:12,163] Trial 20 finished with value: 0.0748719573020935 and parameters: {'seq_len': 96, 'pred_len': 1, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 1, 'batch_size': 64, 'learning_rate': 0.0008154626856700347, 'dropout': 0.15818957366667288}. Best is trial 20 with value: 0.0748719573020935.
Best trial: 19. Best value: 0.0749621:  40%|████      | 20/50 [45:21<37:19, 74.66s/it]Best trial: 20. Best value: 0.074872:  40%|████      | 20/50 [45:21<37:19, 74.66s/it] Best trial: 20. Best value: 0.074872:  42%|████▏     | 21/50 [45:21<35:01, 72.48s/it]
============================================================
Trial 21
============================================================
seq_len: 96, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 1
batch_size: 64, lr: 0.000936
dropout: 0.16215554390838016
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_21 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 1
============================================================
train 4577
val 259
test 261
Validation loss decreased (inf --> 0.031991).  Saving model ...
Updating learning rate to 0.0009362832675248367
Validation loss decreased (0.031991 --> 0.028983).  Saving model ...
Updating learning rate to 0.00046814163376241835
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00023407081688120917
Validation loss decreased (0.028983 --> 0.022892).  Saving model ...
Updating learning rate to 0.00011703540844060459
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8517704220302293e-05
Validation loss decreased (0.022892 --> 0.021631).  Saving model ...
Updating learning rate to 2.9258852110151147e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4629426055075573e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.314713027537787e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.6573565137688933e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8286782568844467e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.143391284422233e-07
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.5716956422111167e-07
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2858478211055583e-07
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.1429239105527792e-07
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.714619552763896e-08
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.857309776381948e-08
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.428654888190974e-08
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.14327444095487e-09
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.571637220477435e-09
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.7858186102387175e-09
EarlyStopping counter: 15 out of 100
Updating learning rate to 8.929093051193587e-10
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.4645465255967936e-10
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.2322732627983968e-10
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.1161366313991984e-10
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.580683156995992e-11
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.790341578497996e-11
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.395170789248998e-11
EarlyStopping counter: 22 out of 100
Updating learning rate to 6.97585394624499e-12
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.487926973122495e-12
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.7439634865612475e-12
EarlyStopping counter: 25 out of 100
Updating learning rate to 8.719817432806238e-13
EarlyStopping counter: 26 out of 100
Updating learning rate to 4.359908716403119e-13
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.1799543582015594e-13
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.0899771791007797e-13
EarlyStopping counter: 29 out of 100
Updating learning rate to 5.4498858955038985e-14
EarlyStopping counter: 30 out of 100
Updating learning rate to 2.7249429477519492e-14
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.3624714738759746e-14
EarlyStopping counter: 32 out of 100
Updating learning rate to 6.812357369379873e-15
EarlyStopping counter: 33 out of 100
Updating learning rate to 3.4061786846899365e-15
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.7030893423449683e-15
EarlyStopping counter: 35 out of 100
Updating learning rate to 8.515446711724841e-16
EarlyStopping counter: 36 out of 100
Updating learning rate to 4.2577233558624207e-16
EarlyStopping counter: 37 out of 100
Updating learning rate to 2.1288616779312103e-16
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.0644308389656052e-16
EarlyStopping counter: 39 out of 100
Updating learning rate to 5.322154194828026e-17
EarlyStopping counter: 40 out of 100
Updating learning rate to 2.661077097414013e-17
EarlyStopping counter: 41 out of 100
Updating learning rate to 1.3305385487070065e-17
EarlyStopping counter: 42 out of 100
Updating learning rate to 6.652692743535032e-18
EarlyStopping counter: 43 out of 100
Updating learning rate to 3.326346371767516e-18
EarlyStopping counter: 44 out of 100
Updating learning rate to 1.663173185883758e-18
EarlyStopping counter: 45 out of 100
Updating learning rate to 8.31586592941879e-19
EarlyStopping counter: 46 out of 100
Updating learning rate to 4.157932964709395e-19
EarlyStopping counter: 47 out of 100
Updating learning rate to 2.0789664823546976e-19
EarlyStopping counter: 48 out of 100
Updating learning rate to 1.0394832411773488e-19
EarlyStopping counter: 49 out of 100
Updating learning rate to 5.197416205886744e-20
EarlyStopping counter: 50 out of 100
Updating learning rate to 2.598708102943372e-20
EarlyStopping counter: 51 out of 100
Updating learning rate to 1.299354051471686e-20
EarlyStopping counter: 52 out of 100
Updating learning rate to 6.49677025735843e-21
EarlyStopping counter: 53 out of 100
Updating learning rate to 3.248385128679215e-21
EarlyStopping counter: 54 out of 100
Updating learning rate to 1.6241925643396075e-21
EarlyStopping counter: 55 out of 100
Updating learning rate to 8.1209628216980375e-22
EarlyStopping counter: 56 out of 100
Updating learning rate to 4.0604814108490187e-22
EarlyStopping counter: 57 out of 100
Updating learning rate to 2.0302407054245094e-22
EarlyStopping counter: 58 out of 100
Updating learning rate to 1.0151203527122547e-22
EarlyStopping counter: 59 out of 100
Updating learning rate to 5.0756017635612734e-23
EarlyStopping counter: 60 out of 100
Updating learning rate to 2.5378008817806367e-23
EarlyStopping counter: 61 out of 100
Updating learning rate to 1.2689004408903184e-23
Validation loss decreased (0.021631 --> 0.021437).  Saving model ...
Updating learning rate to 6.344502204451592e-24
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.172251102225796e-24
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.586125551112898e-24
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.93062775556449e-25
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.965313877782245e-25
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.9826569388911224e-25
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.913284694455612e-26
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.956642347227806e-26
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.478321173613903e-26
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.2391605868069515e-26
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.1958029340347576e-27
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.0979014670173788e-27
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.5489507335086894e-27
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.744753667543447e-28
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.8723768337717235e-28
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.9361884168858618e-28
EarlyStopping counter: 16 out of 100
Updating learning rate to 9.680942084429309e-29
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.8404710422146544e-29
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.4202355211073272e-29
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.2101177605536636e-29
EarlyStopping counter: 20 out of 100
Updating learning rate to 6.050588802768318e-30
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.025294401384159e-30
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.5126472006920795e-30
EarlyStopping counter: 23 out of 100
Updating learning rate to 7.5632360034603975e-31
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.7816180017301987e-31
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.8908090008650994e-31
EarlyStopping counter: 26 out of 100
Updating learning rate to 9.454045004325497e-32
EarlyStopping counter: 27 out of 100
Updating learning rate to 4.7270225021627484e-32
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.3635112510813742e-32
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.1817556255406871e-32
EarlyStopping counter: 30 out of 100
Updating learning rate to 5.9087781277034355e-33
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.9543890638517178e-33
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.4771945319258589e-33
>>>>>> Testing on validation set: trial_21 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.050113290548324585, mae:0.0764995738863945, dtw:Not calculated


                                                                                     [I 2025-10-17 06:50:20,008] Trial 21 finished with value: 0.0764995738863945 and parameters: {'seq_len': 96, 'pred_len': 1, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 1, 'batch_size': 64, 'learning_rate': 0.0009362832675248367, 'dropout': 0.16215554390838016}. Best is trial 20 with value: 0.0748719573020935.
Best trial: 20. Best value: 0.074872:  42%|████▏     | 21/50 [46:29<35:01, 72.48s/it]Best trial: 20. Best value: 0.074872:  42%|████▏     | 21/50 [46:29<35:01, 72.48s/it]Best trial: 20. Best value: 0.074872:  44%|████▍     | 22/50 [46:29<33:10, 71.09s/it]
============================================================
Trial 22
============================================================
seq_len: 96, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 1
batch_size: 64, lr: 0.000900
dropout: 0.15810221202890362
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_22 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 1
============================================================
train 4577
val 259
test 261
Validation loss decreased (inf --> 0.023867).  Saving model ...
Updating learning rate to 0.0008995462324841792
Validation loss decreased (0.023867 --> 0.022477).  Saving model ...
Updating learning rate to 0.0004497731162420896
Validation loss decreased (0.022477 --> 0.021620).  Saving model ...
Updating learning rate to 0.0002248865581210448
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0001124432790605224
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.62216395302612e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.81108197651306e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.40554098825653e-05
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.02770494128265e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.513852470641325e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.7569262353206626e-06
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.784631176603313e-07
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.3923155883016565e-07
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.1961577941508282e-07
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.0980788970754141e-07
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.4903944853770706e-08
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.7451972426885353e-08
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.3725986213442676e-08
Validation loss decreased (0.021620 --> 0.021372).  Saving model ...
Updating learning rate to 6.862993106721338e-09
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.431496553360669e-09
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.7157482766803346e-09
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.578741383401673e-10
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.2893706917008364e-10
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.1446853458504182e-10
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.0723426729252091e-10
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.3617133646260455e-11
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.6808566823130227e-11
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.3404283411565114e-11
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.702141705782557e-12
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.3510708528912784e-12
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.6755354264456392e-12
EarlyStopping counter: 13 out of 100
Updating learning rate to 8.377677132228196e-13
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.188838566114098e-13
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.094419283057049e-13
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.0472096415285245e-13
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.2360482076426225e-14
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.6180241038213113e-14
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.3090120519106556e-14
EarlyStopping counter: 20 out of 100
Updating learning rate to 6.545060259553278e-15
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.272530129776639e-15
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.6362650648883195e-15
EarlyStopping counter: 23 out of 100
Updating learning rate to 8.181325324441598e-16
EarlyStopping counter: 24 out of 100
Updating learning rate to 4.090662662220799e-16
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.0453313311103994e-16
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.0226656655551997e-16
EarlyStopping counter: 27 out of 100
Updating learning rate to 5.1133283277759986e-17
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.5566641638879993e-17
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.2783320819439996e-17
EarlyStopping counter: 30 out of 100
Updating learning rate to 6.391660409719998e-18
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.195830204859999e-18
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.5979151024299996e-18
EarlyStopping counter: 33 out of 100
Updating learning rate to 7.989575512149998e-19
EarlyStopping counter: 34 out of 100
Updating learning rate to 3.994787756074999e-19
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.9973938780374994e-19
EarlyStopping counter: 36 out of 100
Updating learning rate to 9.986969390187497e-20
EarlyStopping counter: 37 out of 100
Updating learning rate to 4.9934846950937486e-20
EarlyStopping counter: 38 out of 100
Updating learning rate to 2.4967423475468743e-20
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.2483711737734372e-20
EarlyStopping counter: 40 out of 100
Updating learning rate to 6.241855868867186e-21
EarlyStopping counter: 41 out of 100
Updating learning rate to 3.120927934433593e-21
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.5604639672167964e-21
EarlyStopping counter: 43 out of 100
Updating learning rate to 7.802319836083982e-22
EarlyStopping counter: 44 out of 100
Updating learning rate to 3.901159918041991e-22
EarlyStopping counter: 45 out of 100
Updating learning rate to 1.9505799590209956e-22
EarlyStopping counter: 46 out of 100
Updating learning rate to 9.752899795104978e-23
EarlyStopping counter: 47 out of 100
Updating learning rate to 4.876449897552489e-23
EarlyStopping counter: 48 out of 100
Updating learning rate to 2.4382249487762444e-23
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.2191124743881222e-23
EarlyStopping counter: 50 out of 100
Updating learning rate to 6.095562371940611e-24
EarlyStopping counter: 51 out of 100
Updating learning rate to 3.0477811859703055e-24
EarlyStopping counter: 52 out of 100
Updating learning rate to 1.5238905929851528e-24
EarlyStopping counter: 53 out of 100
Updating learning rate to 7.619452964925764e-25
EarlyStopping counter: 54 out of 100
Updating learning rate to 3.809726482462882e-25
EarlyStopping counter: 55 out of 100
Updating learning rate to 1.904863241231441e-25
EarlyStopping counter: 56 out of 100
Updating learning rate to 9.524316206157205e-26
EarlyStopping counter: 57 out of 100
Updating learning rate to 4.7621581030786024e-26
EarlyStopping counter: 58 out of 100
Updating learning rate to 2.3810790515393012e-26
EarlyStopping counter: 59 out of 100
Updating learning rate to 1.1905395257696506e-26
EarlyStopping counter: 60 out of 100
Updating learning rate to 5.952697628848253e-27
EarlyStopping counter: 61 out of 100
Updating learning rate to 2.9763488144241265e-27
EarlyStopping counter: 62 out of 100
Updating learning rate to 1.4881744072120633e-27
EarlyStopping counter: 63 out of 100
Updating learning rate to 7.440872036060316e-28
Validation loss decreased (0.021372 --> 0.021055).  Saving model ...
Updating learning rate to 3.720436018030158e-28
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.860218009015079e-28
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.301090045075395e-29
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.6505450225376977e-29
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.3252725112688488e-29
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1626362556344244e-29
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.813181278172122e-30
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.906590639086061e-30
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.4532953195430305e-30
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.266476597715153e-31
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.6332382988575763e-31
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.8166191494287882e-31
EarlyStopping counter: 12 out of 100
Updating learning rate to 9.083095747143941e-32
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.5415478735719704e-32
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.2707739367859852e-32
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.1353869683929926e-32
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.676934841964963e-33
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.8384674209824815e-33
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.4192337104912407e-33
>>>>>> Testing on validation set: trial_22 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.05047953501343727, mae:0.0751902237534523, dtw:Not calculated


                                                                                     [I 2025-10-17 06:51:28,003] Trial 22 finished with value: 0.0751902237534523 and parameters: {'seq_len': 96, 'pred_len': 1, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 1, 'batch_size': 64, 'learning_rate': 0.0008995462324841792, 'dropout': 0.15810221202890362}. Best is trial 20 with value: 0.0748719573020935.
Best trial: 20. Best value: 0.074872:  44%|████▍     | 22/50 [47:37<33:10, 71.09s/it]Best trial: 20. Best value: 0.074872:  44%|████▍     | 22/50 [47:37<33:10, 71.09s/it]Best trial: 20. Best value: 0.074872:  46%|████▌     | 23/50 [47:37<31:34, 70.16s/it]
============================================================
Trial 23
============================================================
seq_len: 96, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 1
batch_size: 64, lr: 0.000898
dropout: 0.1547245377713262
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_23 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 1
============================================================
train 4577
val 259
test 261
Validation loss decreased (inf --> 0.022922).  Saving model ...
Updating learning rate to 0.0008984717490914971
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00044923587454574857
Validation loss decreased (0.022922 --> 0.022191).  Saving model ...
Updating learning rate to 0.00022461793727287428
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00011230896863643714
Validation loss decreased (0.022191 --> 0.021646).  Saving model ...
Updating learning rate to 5.615448431821857e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.8077242159109285e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4038621079554643e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.019310539777321e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.5096552698886607e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.7548276349443303e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.774138174721652e-07
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.387069087360826e-07
Validation loss decreased (0.021646 --> 0.021353).  Saving model ...
Updating learning rate to 2.193534543680413e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0967672718402065e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.483836359201032e-08
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.741918179600516e-08
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.370959089800258e-08
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.85479544900129e-09
Validation loss decreased (0.021353 --> 0.021189).  Saving model ...
Updating learning rate to 3.427397724500645e-09
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.7136988622503226e-09
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.568494311251613e-10
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.2842471556258065e-10
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.1421235778129033e-10
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0710617889064516e-10
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.355308944532258e-11
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.677654472266129e-11
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3388272361330645e-11
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.694136180665323e-12
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.3470680903326613e-12
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.6735340451663307e-12
Validation loss decreased (0.021189 --> 0.021167).  Saving model ...
Updating learning rate to 8.367670225831653e-13
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.1838351129158267e-13
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0919175564579133e-13
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0459587782289567e-13
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.2297938911447833e-14
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.6148969455723917e-14
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3074484727861958e-14
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.537242363930979e-15
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.2686211819654896e-15
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.6343105909827448e-15
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.171552954913724e-16
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.085776477456862e-16
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.042888238728431e-16
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.0214441193642155e-16
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.1072205968210775e-17
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.5536102984105387e-17
Validation loss decreased (0.021167 --> 0.021080).  Saving model ...
Updating learning rate to 1.2768051492052694e-17
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.384025746026347e-18
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.1920128730131734e-18
Validation loss decreased (0.021080 --> 0.020931).  Saving model ...
Updating learning rate to 1.5960064365065867e-18
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.980032182532934e-19
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.990016091266467e-19
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.9950080456332334e-19
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.975040228166167e-20
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.9875201140830835e-20
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.4937600570415417e-20
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.2468800285207709e-20
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.234400142603854e-21
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.117200071301927e-21
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.5586000356509636e-21
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.793000178254818e-22
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.896500089127409e-22
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.9482500445637045e-22
EarlyStopping counter: 14 out of 100
Updating learning rate to 9.741250222818522e-23
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.870625111409261e-23
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.4353125557046306e-23
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.2176562778523153e-23
EarlyStopping counter: 18 out of 100
Updating learning rate to 6.0882813892615765e-24
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.0441406946307882e-24
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.5220703473153941e-24
EarlyStopping counter: 21 out of 100
Updating learning rate to 7.610351736576971e-25
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.8051758682884853e-25
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.9025879341442427e-25
EarlyStopping counter: 24 out of 100
Updating learning rate to 9.512939670721213e-26
EarlyStopping counter: 25 out of 100
Updating learning rate to 4.7564698353606066e-26
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.3782349176803033e-26
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.1891174588401517e-26
EarlyStopping counter: 28 out of 100
Updating learning rate to 5.945587294200758e-27
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.972793647100379e-27
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.4863968235501896e-27
EarlyStopping counter: 31 out of 100
Updating learning rate to 7.431984117750948e-28
EarlyStopping counter: 32 out of 100
Updating learning rate to 3.715992058875474e-28
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.857996029437737e-28
EarlyStopping counter: 34 out of 100
Updating learning rate to 9.289980147188685e-29
EarlyStopping counter: 35 out of 100
Updating learning rate to 4.6449900735943424e-29
EarlyStopping counter: 36 out of 100
Updating learning rate to 2.3224950367971712e-29
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.1612475183985856e-29
EarlyStopping counter: 38 out of 100
Updating learning rate to 5.806237591992928e-30
EarlyStopping counter: 39 out of 100
Updating learning rate to 2.903118795996464e-30
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.451559397998232e-30
EarlyStopping counter: 41 out of 100
Updating learning rate to 7.25779698999116e-31
EarlyStopping counter: 42 out of 100
Updating learning rate to 3.62889849499558e-31
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.81444924749779e-31
EarlyStopping counter: 44 out of 100
Updating learning rate to 9.07224623748895e-32
EarlyStopping counter: 45 out of 100
Updating learning rate to 4.536123118744475e-32
EarlyStopping counter: 46 out of 100
Updating learning rate to 2.2680615593722375e-32
EarlyStopping counter: 47 out of 100
Updating learning rate to 1.1340307796861188e-32
EarlyStopping counter: 48 out of 100
Updating learning rate to 5.670153898430594e-33
EarlyStopping counter: 49 out of 100
Updating learning rate to 2.835076949215297e-33
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.4175384746076484e-33
>>>>>> Testing on validation set: trial_23 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.04998317360877991, mae:0.07454614341259003, dtw:Not calculated


                                                                                     [I 2025-10-17 06:52:35,879] Trial 23 finished with value: 0.07454614341259003 and parameters: {'seq_len': 96, 'pred_len': 1, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 1, 'batch_size': 64, 'learning_rate': 0.0008984717490914971, 'dropout': 0.1547245377713262}. Best is trial 23 with value: 0.07454614341259003.
Best trial: 20. Best value: 0.074872:  46%|████▌     | 23/50 [48:45<31:34, 70.16s/it]Best trial: 23. Best value: 0.0745461:  46%|████▌     | 23/50 [48:45<31:34, 70.16s/it]Best trial: 23. Best value: 0.0745461:  48%|████▊     | 24/50 [48:45<30:06, 69.47s/it]
============================================================
Trial 24
============================================================
seq_len: 96, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 1
batch_size: 64, lr: 0.000429
dropout: 0.08356670916470856
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_24 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 1
============================================================
train 4577
val 259
test 261
Validation loss decreased (inf --> 0.026642).  Saving model ...
Updating learning rate to 0.0004285900129756922
Validation loss decreased (0.026642 --> 0.024800).  Saving model ...
Updating learning rate to 0.0002142950064878461
Validation loss decreased (0.024800 --> 0.022052).  Saving model ...
Updating learning rate to 0.00010714750324392305
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3573751621961526e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.6786875810980763e-05
Validation loss decreased (0.022052 --> 0.021862).  Saving model ...
Updating learning rate to 1.3393437905490381e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.696718952745191e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.3483594763725953e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6741797381862977e-06
Validation loss decreased (0.021862 --> 0.021531).  Saving model ...
Updating learning rate to 8.370898690931488e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.185449345465744e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.092724672732872e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.046362336366436e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.23181168183218e-08
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.61590584091609e-08
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.307952920458045e-08
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.539764602290225e-09
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.2698823011451126e-09
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.6349411505725563e-09
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.174705752862782e-10
Validation loss decreased (0.021531 --> 0.021422).  Saving model ...
Updating learning rate to 4.087352876431391e-10
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0436764382156954e-10
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0218382191078477e-10
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.1091910955392385e-11
Validation loss decreased (0.021422 --> 0.021341).  Saving model ...
Updating learning rate to 2.5545955477696193e-11
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2772977738848096e-11
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.386488869424048e-12
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.193244434712024e-12
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.596622217356012e-12
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.98311108678006e-13
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.99155554339003e-13
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.995777771695015e-13
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.978888858475075e-14
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.9894444292375376e-14
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.4947222146187688e-14
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.2473611073093844e-14
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.236805536546922e-15
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.118402768273461e-15
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.5592013841367305e-15
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.7960069206836525e-16
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.8980034603418263e-16
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.9490017301709131e-16
EarlyStopping counter: 18 out of 100
Updating learning rate to 9.745008650854566e-17
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.872504325427283e-17
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.4362521627136414e-17
Validation loss decreased (0.021341 --> 0.021302).  Saving model ...
Updating learning rate to 1.2181260813568207e-17
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.0906304067841035e-18
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.0453152033920518e-18
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5226576016960259e-18
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.613288008480129e-19
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.8066440042400647e-19
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.9033220021200323e-19
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.516610010600162e-20
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.758305005300081e-20
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.3791525026500404e-20
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.1895762513250202e-20
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.947881256625101e-21
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.9739406283125505e-21
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.4869703141562753e-21
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.434851570781376e-22
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.717425785390688e-22
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.858712892695344e-22
EarlyStopping counter: 17 out of 100
Updating learning rate to 9.29356446347672e-23
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.64678223173836e-23
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.32339111586918e-23
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.16169555793459e-23
EarlyStopping counter: 21 out of 100
Updating learning rate to 5.80847778967295e-24
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.904238894836475e-24
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.4521194474182376e-24
EarlyStopping counter: 24 out of 100
Updating learning rate to 7.260597237091188e-25
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.630298618545594e-25
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.815149309272797e-25
EarlyStopping counter: 27 out of 100
Updating learning rate to 9.075746546363985e-26
EarlyStopping counter: 28 out of 100
Updating learning rate to 4.5378732731819924e-26
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.2689366365909962e-26
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.1344683182954981e-26
EarlyStopping counter: 31 out of 100
Updating learning rate to 5.6723415914774905e-27
EarlyStopping counter: 32 out of 100
Updating learning rate to 2.8361707957387453e-27
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.4180853978693726e-27
EarlyStopping counter: 34 out of 100
Updating learning rate to 7.090426989346863e-28
EarlyStopping counter: 35 out of 100
Updating learning rate to 3.5452134946734316e-28
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.7726067473367158e-28
EarlyStopping counter: 37 out of 100
Updating learning rate to 8.863033736683579e-29
EarlyStopping counter: 38 out of 100
Updating learning rate to 4.4315168683417895e-29
EarlyStopping counter: 39 out of 100
Updating learning rate to 2.2157584341708947e-29
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.1078792170854474e-29
EarlyStopping counter: 41 out of 100
Updating learning rate to 5.539396085427237e-30
EarlyStopping counter: 42 out of 100
Updating learning rate to 2.7696980427136184e-30
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.3848490213568092e-30
EarlyStopping counter: 44 out of 100
Updating learning rate to 6.924245106784046e-31
EarlyStopping counter: 45 out of 100
Updating learning rate to 3.462122553392023e-31
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.7310612766960115e-31
EarlyStopping counter: 47 out of 100
Updating learning rate to 8.655306383480058e-32
EarlyStopping counter: 48 out of 100
Updating learning rate to 4.327653191740029e-32
EarlyStopping counter: 49 out of 100
Updating learning rate to 2.1638265958700144e-32
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.0819132979350072e-32
EarlyStopping counter: 51 out of 100
Updating learning rate to 5.409566489675036e-33
EarlyStopping counter: 52 out of 100
Updating learning rate to 2.704783244837518e-33
EarlyStopping counter: 53 out of 100
Updating learning rate to 1.352391622418759e-33
EarlyStopping counter: 54 out of 100
Updating learning rate to 6.761958112093795e-34
>>>>>> Testing on validation set: trial_24 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.050899017602205276, mae:0.07848893105983734, dtw:Not calculated


                                                                                      [I 2025-10-17 06:53:43,597] Trial 24 finished with value: 0.07848893105983734 and parameters: {'seq_len': 96, 'pred_len': 1, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 1, 'batch_size': 64, 'learning_rate': 0.0004285900129756922, 'dropout': 0.08356670916470856}. Best is trial 23 with value: 0.07454614341259003.
Best trial: 23. Best value: 0.0745461:  48%|████▊     | 24/50 [49:52<30:06, 69.47s/it]Best trial: 23. Best value: 0.0745461:  48%|████▊     | 24/50 [49:52<30:06, 69.47s/it]Best trial: 23. Best value: 0.0745461:  50%|█████     | 25/50 [49:52<28:43, 68.95s/it]
============================================================
Trial 25
============================================================
seq_len: 96, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 1
batch_size: 64, lr: 0.000697
dropout: 0.1503932589812601
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_25 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 1
============================================================
train 4577
val 259
test 261
Validation loss decreased (inf --> 0.029361).  Saving model ...
Updating learning rate to 0.0006974838256406885
Validation loss decreased (0.029361 --> 0.024414).  Saving model ...
Updating learning rate to 0.00034874191282034423
Validation loss decreased (0.024414 --> 0.022743).  Saving model ...
Updating learning rate to 0.00017437095641017211
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.718547820508606e-05
Validation loss decreased (0.022743 --> 0.022234).  Saving model ...
Updating learning rate to 4.359273910254303e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.1796369551271514e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0898184775635757e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.4490923878178786e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7245461939089393e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3622730969544696e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.811365484772348e-07
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.405682742386174e-07
Validation loss decreased (0.022234 --> 0.021555).  Saving model ...
Updating learning rate to 1.702841371193087e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.514206855965435e-08
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.2571034279827176e-08
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.1285517139913588e-08
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0642758569956794e-08
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.321379284978397e-09
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.6606896424891985e-09
Validation loss decreased (0.021555 --> 0.021277).  Saving model ...
Updating learning rate to 1.3303448212445993e-09
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.651724106222996e-10
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.325862053111498e-10
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.662931026555749e-10
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.314655132778745e-11
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.157327566389373e-11
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0786637831946863e-11
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.0393318915973432e-11
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.196659457986716e-12
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.598329728993358e-12
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.299164864496679e-12
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.495824322483395e-13
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.2479121612416974e-13
Validation loss decreased (0.021277 --> 0.021091).  Saving model ...
Updating learning rate to 1.6239560806208487e-13
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.119780403104244e-14
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.059890201552122e-14
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.029945100776061e-14
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0149725503880304e-14
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.074862751940152e-15
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.537431375970076e-15
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.268715687985038e-15
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.34357843992519e-16
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.171789219962595e-16
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.5858946099812976e-16
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.929473049906488e-17
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.964736524953244e-17
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.982368262476622e-17
EarlyStopping counter: 14 out of 100
Updating learning rate to 9.91184131238311e-18
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.955920656191555e-18
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.4779603280957774e-18
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.2389801640478887e-18
EarlyStopping counter: 18 out of 100
Updating learning rate to 6.194900820239444e-19
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.097450410119722e-19
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.548725205059861e-19
EarlyStopping counter: 21 out of 100
Updating learning rate to 7.743626025299305e-20
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.871813012649652e-20
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.935906506324826e-20
EarlyStopping counter: 24 out of 100
Updating learning rate to 9.67953253162413e-21
EarlyStopping counter: 25 out of 100
Updating learning rate to 4.839766265812065e-21
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.4198831329060327e-21
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.2099415664530163e-21
EarlyStopping counter: 28 out of 100
Updating learning rate to 6.049707832265082e-22
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.024853916132541e-22
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.5124269580662704e-22
EarlyStopping counter: 31 out of 100
Updating learning rate to 7.562134790331352e-23
EarlyStopping counter: 32 out of 100
Updating learning rate to 3.781067395165676e-23
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.890533697582838e-23
EarlyStopping counter: 34 out of 100
Updating learning rate to 9.45266848791419e-24
EarlyStopping counter: 35 out of 100
Updating learning rate to 4.726334243957095e-24
EarlyStopping counter: 36 out of 100
Updating learning rate to 2.3631671219785475e-24
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.1815835609892738e-24
EarlyStopping counter: 38 out of 100
Updating learning rate to 5.907917804946369e-25
EarlyStopping counter: 39 out of 100
Updating learning rate to 2.9539589024731844e-25
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.4769794512365922e-25
EarlyStopping counter: 41 out of 100
Updating learning rate to 7.384897256182961e-26
EarlyStopping counter: 42 out of 100
Updating learning rate to 3.6924486280914805e-26
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.8462243140457403e-26
EarlyStopping counter: 44 out of 100
Updating learning rate to 9.231121570228701e-27
EarlyStopping counter: 45 out of 100
Updating learning rate to 4.6155607851143506e-27
EarlyStopping counter: 46 out of 100
Updating learning rate to 2.3077803925571753e-27
EarlyStopping counter: 47 out of 100
Updating learning rate to 1.1538901962785877e-27
EarlyStopping counter: 48 out of 100
Updating learning rate to 5.769450981392938e-28
EarlyStopping counter: 49 out of 100
Updating learning rate to 2.884725490696469e-28
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.4423627453482346e-28
EarlyStopping counter: 51 out of 100
Updating learning rate to 7.211813726741173e-29
EarlyStopping counter: 52 out of 100
Updating learning rate to 3.6059068633705864e-29
EarlyStopping counter: 53 out of 100
Updating learning rate to 1.8029534316852932e-29
EarlyStopping counter: 54 out of 100
Updating learning rate to 9.014767158426466e-30
EarlyStopping counter: 55 out of 100
Updating learning rate to 4.507383579213233e-30
EarlyStopping counter: 56 out of 100
Updating learning rate to 2.2536917896066165e-30
EarlyStopping counter: 57 out of 100
Updating learning rate to 1.1268458948033083e-30
EarlyStopping counter: 58 out of 100
Updating learning rate to 5.634229474016541e-31
EarlyStopping counter: 59 out of 100
Updating learning rate to 2.8171147370082706e-31
EarlyStopping counter: 60 out of 100
Updating learning rate to 1.4085573685041353e-31
EarlyStopping counter: 61 out of 100
Updating learning rate to 7.042786842520677e-32
EarlyStopping counter: 62 out of 100
Updating learning rate to 3.5213934212603383e-32
EarlyStopping counter: 63 out of 100
Updating learning rate to 1.7606967106301692e-32
EarlyStopping counter: 64 out of 100
Updating learning rate to 8.803483553150846e-33
EarlyStopping counter: 65 out of 100
Updating learning rate to 4.401741776575423e-33
EarlyStopping counter: 66 out of 100
Updating learning rate to 2.2008708882877114e-33
EarlyStopping counter: 67 out of 100
Updating learning rate to 1.1004354441438557e-33
>>>>>> Testing on validation set: trial_25 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.04909069463610649, mae:0.07399702072143555, dtw:Not calculated


                                                                                      [I 2025-10-17 06:54:51,516] Trial 25 finished with value: 0.07399702072143555 and parameters: {'seq_len': 96, 'pred_len': 1, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 1, 'batch_size': 64, 'learning_rate': 0.0006974838256406885, 'dropout': 0.1503932589812601}. Best is trial 25 with value: 0.07399702072143555.
Best trial: 23. Best value: 0.0745461:  50%|█████     | 25/50 [51:00<28:43, 68.95s/it]Best trial: 25. Best value: 0.073997:  50%|█████     | 25/50 [51:00<28:43, 68.95s/it] Best trial: 25. Best value: 0.073997:  52%|█████▏    | 26/50 [51:00<27:27, 68.64s/it]
============================================================
Trial 26
============================================================
seq_len: 96, pred_len: 30
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 1
batch_size: 64, lr: 0.000317
dropout: 0.14029998733136306
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_26 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 30
============================================================
train 4548
val 230
test 232
Validation loss decreased (inf --> 0.036733).  Saving model ...
Updating learning rate to 0.0003165550632130046
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0001582775316065023
Validation loss decreased (0.036733 --> 0.036491).  Saving model ...
Updating learning rate to 7.913876580325115e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.9569382901625574e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.9784691450812787e-05
Validation loss decreased (0.036491 --> 0.036448).  Saving model ...
Updating learning rate to 9.892345725406394e-06
Validation loss decreased (0.036448 --> 0.036446).  Saving model ...
Updating learning rate to 4.946172862703197e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.4730864313515984e-06
Validation loss decreased (0.036446 --> 0.035758).  Saving model ...
Updating learning rate to 1.2365432156757992e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.182716078378996e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.091358039189498e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.545679019594749e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.728395097973745e-08
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.8641975489868725e-08
Validation loss decreased (0.035758 --> 0.035718).  Saving model ...
Updating learning rate to 1.9320987744934362e-08
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.660493872467181e-09
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.830246936233591e-09
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.4151234681167953e-09
Validation loss decreased (0.035718 --> 0.035668).  Saving model ...
Updating learning rate to 1.2075617340583977e-09
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.037808670291988e-10
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.018904335145994e-10
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.509452167572997e-10
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.547260837864985e-11
Validation loss decreased (0.035668 --> 0.035431).  Saving model ...
Updating learning rate to 3.7736304189324927e-11
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8868152094662463e-11
Validation loss decreased (0.035431 --> 0.035423).  Saving model ...
Updating learning rate to 9.434076047331232e-12
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.717038023665616e-12
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.358519011832808e-12
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.179259505916404e-12
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.89629752958202e-13
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.94814876479101e-13
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.474074382395505e-13
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.370371911977525e-14
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.6851859559887624e-14
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.8425929779943812e-14
EarlyStopping counter: 10 out of 100
Updating learning rate to 9.212964889971906e-15
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.606482444985953e-15
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.3032412224929765e-15
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.1516206112464882e-15
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.758103056232441e-16
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.8790515281162206e-16
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.4395257640581103e-16
EarlyStopping counter: 17 out of 100
Updating learning rate to 7.197628820290552e-17
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.598814410145276e-17
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.799407205072638e-17
EarlyStopping counter: 20 out of 100
Updating learning rate to 8.99703602536319e-18
EarlyStopping counter: 21 out of 100
Updating learning rate to 4.498518012681595e-18
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.2492590063407973e-18
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.1246295031703987e-18
EarlyStopping counter: 24 out of 100
Updating learning rate to 5.623147515851993e-19
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.8115737579259967e-19
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.4057868789629983e-19
EarlyStopping counter: 27 out of 100
Updating learning rate to 7.028934394814992e-20
EarlyStopping counter: 28 out of 100
Updating learning rate to 3.514467197407496e-20
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.757233598703748e-20
EarlyStopping counter: 30 out of 100
Updating learning rate to 8.78616799351874e-21
EarlyStopping counter: 31 out of 100
Updating learning rate to 4.39308399675937e-21
EarlyStopping counter: 32 out of 100
Updating learning rate to 2.196541998379685e-21
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.0982709991898425e-21
EarlyStopping counter: 34 out of 100
Updating learning rate to 5.491354995949212e-22
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.745677497974606e-22
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.372838748987303e-22
EarlyStopping counter: 37 out of 100
Updating learning rate to 6.864193744936515e-23
EarlyStopping counter: 38 out of 100
Updating learning rate to 3.4320968724682577e-23
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.7160484362341288e-23
EarlyStopping counter: 40 out of 100
Updating learning rate to 8.580242181170644e-24
EarlyStopping counter: 41 out of 100
Updating learning rate to 4.290121090585322e-24
EarlyStopping counter: 42 out of 100
Updating learning rate to 2.145060545292661e-24
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.0725302726463305e-24
EarlyStopping counter: 44 out of 100
Updating learning rate to 5.362651363231653e-25
EarlyStopping counter: 45 out of 100
Updating learning rate to 2.6813256816158263e-25
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.3406628408079132e-25
EarlyStopping counter: 47 out of 100
Updating learning rate to 6.703314204039566e-26
EarlyStopping counter: 48 out of 100
Updating learning rate to 3.351657102019783e-26
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.6758285510098914e-26
EarlyStopping counter: 50 out of 100
Updating learning rate to 8.379142755049457e-27
EarlyStopping counter: 51 out of 100
Updating learning rate to 4.1895713775247286e-27
EarlyStopping counter: 52 out of 100
Updating learning rate to 2.0947856887623643e-27
EarlyStopping counter: 53 out of 100
Updating learning rate to 1.0473928443811822e-27
EarlyStopping counter: 54 out of 100
Updating learning rate to 5.236964221905911e-28
EarlyStopping counter: 55 out of 100
Updating learning rate to 2.6184821109529554e-28
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.3092410554764777e-28
EarlyStopping counter: 57 out of 100
Updating learning rate to 6.546205277382388e-29
EarlyStopping counter: 58 out of 100
Updating learning rate to 3.273102638691194e-29
EarlyStopping counter: 59 out of 100
Updating learning rate to 1.636551319345597e-29
EarlyStopping counter: 60 out of 100
Updating learning rate to 8.182756596727986e-30
EarlyStopping counter: 61 out of 100
Updating learning rate to 4.091378298363993e-30
EarlyStopping counter: 62 out of 100
Updating learning rate to 2.0456891491819964e-30
EarlyStopping counter: 63 out of 100
Updating learning rate to 1.0228445745909982e-30
EarlyStopping counter: 64 out of 100
Updating learning rate to 5.114222872954991e-31
EarlyStopping counter: 65 out of 100
Updating learning rate to 2.5571114364774955e-31
EarlyStopping counter: 66 out of 100
Updating learning rate to 1.2785557182387477e-31
EarlyStopping counter: 67 out of 100
Updating learning rate to 6.392778591193739e-32
EarlyStopping counter: 68 out of 100
Updating learning rate to 3.1963892955968694e-32
EarlyStopping counter: 69 out of 100
Updating learning rate to 1.5981946477984347e-32
EarlyStopping counter: 70 out of 100
Updating learning rate to 7.990973238992173e-33
EarlyStopping counter: 71 out of 100
Updating learning rate to 3.995486619496087e-33
EarlyStopping counter: 72 out of 100
Updating learning rate to 1.9977433097480433e-33
EarlyStopping counter: 73 out of 100
Updating learning rate to 9.988716548740217e-34
EarlyStopping counter: 74 out of 100
Updating learning rate to 4.994358274370108e-34
>>>>>> Testing on validation set: trial_26 >>>>>>
test 232
test shape: (232, 30, 5) (232, 30, 5)
test shape: (232, 30, 5) (232, 30, 5)


	mse:0.07210874557495117, mae:0.11379480361938477, dtw:Not calculated


                                                                                     [I 2025-10-17 06:55:58,825] Trial 26 finished with value: 0.11379480361938477 and parameters: {'seq_len': 96, 'pred_len': 30, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 1, 'batch_size': 64, 'learning_rate': 0.0003165550632130046, 'dropout': 0.14029998733136306}. Best is trial 25 with value: 0.07399702072143555.
Best trial: 25. Best value: 0.073997:  52%|█████▏    | 26/50 [52:08<27:27, 68.64s/it]Best trial: 25. Best value: 0.073997:  52%|█████▏    | 26/50 [52:08<27:27, 68.64s/it]Best trial: 25. Best value: 0.073997:  54%|█████▍    | 27/50 [52:08<26:09, 68.24s/it]
============================================================
Trial 27
============================================================
seq_len: 96, pred_len: 7
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 1
batch_size: 64, lr: 0.000626
dropout: 0.14219395120094855
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_27 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 7
============================================================
train 4571
val 253
test 255
Validation loss decreased (inf --> 0.040210).  Saving model ...
Updating learning rate to 0.000626394057066282
Validation loss decreased (0.040210 --> 0.038041).  Saving model ...
Updating learning rate to 0.000313197028533141
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0001565985142665705
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.829925713328525e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.9149628566642624e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.9574814283321312e-05
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.787407141660656e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.893703570830328e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.446851785415164e-06
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.223425892707582e-06
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.11712946353791e-07
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.058564731768955e-07
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.5292823658844775e-07
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.646411829422388e-08
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.823205914711194e-08
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.911602957355597e-08
EarlyStopping counter: 15 out of 100
Updating learning rate to 9.558014786777984e-09
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.779007393388992e-09
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.389503696694496e-09
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.194751848347248e-09
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.97375924173624e-10
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.98687962086812e-10
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.49343981043406e-10
EarlyStopping counter: 22 out of 100
Updating learning rate to 7.4671990521703e-11
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.73359952608515e-11
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.866799763042575e-11
EarlyStopping counter: 25 out of 100
Updating learning rate to 9.333998815212875e-12
EarlyStopping counter: 26 out of 100
Updating learning rate to 4.666999407606438e-12
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.333499703803219e-12
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.1667498519016094e-12
EarlyStopping counter: 29 out of 100
Updating learning rate to 5.833749259508047e-13
EarlyStopping counter: 30 out of 100
Updating learning rate to 2.9168746297540236e-13
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.4584373148770118e-13
EarlyStopping counter: 32 out of 100
Updating learning rate to 7.292186574385059e-14
EarlyStopping counter: 33 out of 100
Updating learning rate to 3.6460932871925295e-14
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.8230466435962647e-14
EarlyStopping counter: 35 out of 100
Updating learning rate to 9.115233217981324e-15
EarlyStopping counter: 36 out of 100
Updating learning rate to 4.557616608990662e-15
EarlyStopping counter: 37 out of 100
Updating learning rate to 2.278808304495331e-15
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.1394041522476655e-15
EarlyStopping counter: 39 out of 100
Updating learning rate to 5.697020761238327e-16
EarlyStopping counter: 40 out of 100
Updating learning rate to 2.8485103806191637e-16
EarlyStopping counter: 41 out of 100
Updating learning rate to 1.4242551903095818e-16
EarlyStopping counter: 42 out of 100
Updating learning rate to 7.121275951547909e-17
EarlyStopping counter: 43 out of 100
Updating learning rate to 3.5606379757739546e-17
EarlyStopping counter: 44 out of 100
Updating learning rate to 1.7803189878869773e-17
EarlyStopping counter: 45 out of 100
Updating learning rate to 8.901594939434886e-18
EarlyStopping counter: 46 out of 100
Updating learning rate to 4.450797469717443e-18
EarlyStopping counter: 47 out of 100
Updating learning rate to 2.2253987348587216e-18
EarlyStopping counter: 48 out of 100
Updating learning rate to 1.1126993674293608e-18
EarlyStopping counter: 49 out of 100
Updating learning rate to 5.563496837146804e-19
EarlyStopping counter: 50 out of 100
Updating learning rate to 2.781748418573402e-19
EarlyStopping counter: 51 out of 100
Updating learning rate to 1.390874209286701e-19
EarlyStopping counter: 52 out of 100
Updating learning rate to 6.954371046433505e-20
EarlyStopping counter: 53 out of 100
Updating learning rate to 3.4771855232167525e-20
EarlyStopping counter: 54 out of 100
Updating learning rate to 1.7385927616083763e-20
EarlyStopping counter: 55 out of 100
Updating learning rate to 8.692963808041881e-21
EarlyStopping counter: 56 out of 100
Updating learning rate to 4.346481904020941e-21
EarlyStopping counter: 57 out of 100
Updating learning rate to 2.1732409520104703e-21
EarlyStopping counter: 58 out of 100
Updating learning rate to 1.0866204760052352e-21
EarlyStopping counter: 59 out of 100
Updating learning rate to 5.433102380026176e-22
EarlyStopping counter: 60 out of 100
Updating learning rate to 2.716551190013088e-22
EarlyStopping counter: 61 out of 100
Updating learning rate to 1.358275595006544e-22
EarlyStopping counter: 62 out of 100
Updating learning rate to 6.79137797503272e-23
EarlyStopping counter: 63 out of 100
Updating learning rate to 3.39568898751636e-23
EarlyStopping counter: 64 out of 100
Updating learning rate to 1.69784449375818e-23
EarlyStopping counter: 65 out of 100
Updating learning rate to 8.4892224687909e-24
EarlyStopping counter: 66 out of 100
Updating learning rate to 4.24461123439545e-24
EarlyStopping counter: 67 out of 100
Updating learning rate to 2.122305617197725e-24
EarlyStopping counter: 68 out of 100
Updating learning rate to 1.0611528085988625e-24
EarlyStopping counter: 69 out of 100
Updating learning rate to 5.305764042994312e-25
EarlyStopping counter: 70 out of 100
Updating learning rate to 2.652882021497156e-25
EarlyStopping counter: 71 out of 100
Updating learning rate to 1.326441010748578e-25
EarlyStopping counter: 72 out of 100
Updating learning rate to 6.63220505374289e-26
EarlyStopping counter: 73 out of 100
Updating learning rate to 3.316102526871445e-26
EarlyStopping counter: 74 out of 100
Updating learning rate to 1.6580512634357226e-26
EarlyStopping counter: 75 out of 100
Updating learning rate to 8.290256317178613e-27
EarlyStopping counter: 76 out of 100
Updating learning rate to 4.1451281585893065e-27
EarlyStopping counter: 77 out of 100
Updating learning rate to 2.0725640792946532e-27
EarlyStopping counter: 78 out of 100
Updating learning rate to 1.0362820396473266e-27
EarlyStopping counter: 79 out of 100
Updating learning rate to 5.181410198236633e-28
EarlyStopping counter: 80 out of 100
Updating learning rate to 2.5907050991183166e-28
EarlyStopping counter: 81 out of 100
Updating learning rate to 1.2953525495591583e-28
EarlyStopping counter: 82 out of 100
Updating learning rate to 6.476762747795791e-29
EarlyStopping counter: 83 out of 100
Updating learning rate to 3.2383813738978957e-29
EarlyStopping counter: 84 out of 100
Updating learning rate to 1.6191906869489478e-29
EarlyStopping counter: 85 out of 100
Updating learning rate to 8.095953434744739e-30
EarlyStopping counter: 86 out of 100
Updating learning rate to 4.0479767173723696e-30
EarlyStopping counter: 87 out of 100
Updating learning rate to 2.0239883586861848e-30
EarlyStopping counter: 88 out of 100
Updating learning rate to 1.0119941793430924e-30
EarlyStopping counter: 89 out of 100
Updating learning rate to 5.059970896715462e-31
EarlyStopping counter: 90 out of 100
Updating learning rate to 2.529985448357731e-31
EarlyStopping counter: 91 out of 100
Updating learning rate to 1.2649927241788655e-31
EarlyStopping counter: 92 out of 100
Updating learning rate to 6.324963620894328e-32
EarlyStopping counter: 93 out of 100
Updating learning rate to 3.162481810447164e-32
EarlyStopping counter: 94 out of 100
Updating learning rate to 1.581240905223582e-32
EarlyStopping counter: 95 out of 100
Updating learning rate to 7.90620452611791e-33
EarlyStopping counter: 96 out of 100
Updating learning rate to 3.953102263058955e-33
EarlyStopping counter: 97 out of 100
Updating learning rate to 1.9765511315294774e-33
EarlyStopping counter: 98 out of 100
Updating learning rate to 9.882755657647387e-34
>>>>>> Testing on validation set: trial_27 >>>>>>
test 255
test shape: (255, 7, 5) (255, 7, 5)
test shape: (255, 7, 5) (255, 7, 5)


	mse:0.0683446153998375, mae:0.10367221385240555, dtw:Not calculated


                                                                                     [I 2025-10-17 06:57:06,223] Trial 27 finished with value: 0.10367221385240555 and parameters: {'seq_len': 96, 'pred_len': 7, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 1, 'batch_size': 64, 'learning_rate': 0.000626394057066282, 'dropout': 0.14219395120094855}. Best is trial 25 with value: 0.07399702072143555.
Best trial: 25. Best value: 0.073997:  54%|█████▍    | 27/50 [53:15<26:09, 68.24s/it]Best trial: 25. Best value: 0.073997:  54%|█████▍    | 27/50 [53:15<26:09, 68.24s/it]Best trial: 25. Best value: 0.073997:  56%|█████▌    | 28/50 [53:15<24:55, 67.99s/it]
============================================================
Trial 28
============================================================
seq_len: 96, pred_len: 14
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 1
batch_size: 64, lr: 0.000519
dropout: 0.17227433651816404
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_28 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 14
============================================================
train 4564
val 246
test 248
Validation loss decreased (inf --> 0.039194).  Saving model ...
Updating learning rate to 0.0005190539397079863
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00025952696985399317
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.00012976348492699659
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.488174246349829e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.2440871231749146e-05
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6220435615874573e-05
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.110217807937287e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.055108903968643e-06
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0275544519843217e-06
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.0137772259921608e-06
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.068886129960804e-07
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.534443064980402e-07
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.267221532490201e-07
EarlyStopping counter: 13 out of 100
Updating learning rate to 6.336107662451005e-08
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.1680538312255026e-08
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.5840269156127513e-08
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.920134578063756e-09
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.960067289031878e-09
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.980033644515939e-09
EarlyStopping counter: 19 out of 100
Updating learning rate to 9.900168222579696e-10
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.950084111289848e-10
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.475042055644924e-10
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.237521027822462e-10
EarlyStopping counter: 23 out of 100
Updating learning rate to 6.18760513911231e-11
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.093802569556155e-11
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.5469012847780774e-11
EarlyStopping counter: 26 out of 100
Updating learning rate to 7.734506423890387e-12
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.8672532119451936e-12
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.9336266059725968e-12
EarlyStopping counter: 29 out of 100
Updating learning rate to 9.668133029862984e-13
EarlyStopping counter: 30 out of 100
Updating learning rate to 4.834066514931492e-13
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.417033257465746e-13
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.208516628732873e-13
EarlyStopping counter: 33 out of 100
Updating learning rate to 6.042583143664365e-14
EarlyStopping counter: 34 out of 100
Updating learning rate to 3.0212915718321825e-14
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.5106457859160912e-14
EarlyStopping counter: 36 out of 100
Updating learning rate to 7.553228929580456e-15
EarlyStopping counter: 37 out of 100
Updating learning rate to 3.776614464790228e-15
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.888307232395114e-15
EarlyStopping counter: 39 out of 100
Updating learning rate to 9.44153616197557e-16
EarlyStopping counter: 40 out of 100
Updating learning rate to 4.720768080987785e-16
EarlyStopping counter: 41 out of 100
Updating learning rate to 2.3603840404938926e-16
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.1801920202469463e-16
EarlyStopping counter: 43 out of 100
Updating learning rate to 5.900960101234731e-17
EarlyStopping counter: 44 out of 100
Updating learning rate to 2.950480050617366e-17
EarlyStopping counter: 45 out of 100
Updating learning rate to 1.475240025308683e-17
EarlyStopping counter: 46 out of 100
Updating learning rate to 7.376200126543414e-18
EarlyStopping counter: 47 out of 100
Updating learning rate to 3.688100063271707e-18
EarlyStopping counter: 48 out of 100
Updating learning rate to 1.8440500316358536e-18
EarlyStopping counter: 49 out of 100
Updating learning rate to 9.220250158179268e-19
EarlyStopping counter: 50 out of 100
Updating learning rate to 4.610125079089634e-19
EarlyStopping counter: 51 out of 100
Updating learning rate to 2.305062539544817e-19
EarlyStopping counter: 52 out of 100
Updating learning rate to 1.1525312697724085e-19
EarlyStopping counter: 53 out of 100
Updating learning rate to 5.762656348862042e-20
EarlyStopping counter: 54 out of 100
Updating learning rate to 2.881328174431021e-20
EarlyStopping counter: 55 out of 100
Updating learning rate to 1.4406640872155106e-20
EarlyStopping counter: 56 out of 100
Updating learning rate to 7.203320436077553e-21
EarlyStopping counter: 57 out of 100
Updating learning rate to 3.6016602180387765e-21
EarlyStopping counter: 58 out of 100
Updating learning rate to 1.8008301090193883e-21
EarlyStopping counter: 59 out of 100
Updating learning rate to 9.004150545096941e-22
EarlyStopping counter: 60 out of 100
Updating learning rate to 4.502075272548471e-22
EarlyStopping counter: 61 out of 100
Updating learning rate to 2.2510376362742353e-22
EarlyStopping counter: 62 out of 100
Updating learning rate to 1.1255188181371177e-22
EarlyStopping counter: 63 out of 100
Updating learning rate to 5.627594090685588e-23
EarlyStopping counter: 64 out of 100
Updating learning rate to 2.813797045342794e-23
EarlyStopping counter: 65 out of 100
Updating learning rate to 1.406898522671397e-23
EarlyStopping counter: 66 out of 100
Updating learning rate to 7.034492613356985e-24
EarlyStopping counter: 67 out of 100
Updating learning rate to 3.517246306678493e-24
EarlyStopping counter: 68 out of 100
Updating learning rate to 1.7586231533392463e-24
EarlyStopping counter: 69 out of 100
Updating learning rate to 8.793115766696232e-25
EarlyStopping counter: 70 out of 100
Updating learning rate to 4.396557883348116e-25
EarlyStopping counter: 71 out of 100
Updating learning rate to 2.198278941674058e-25
EarlyStopping counter: 72 out of 100
Updating learning rate to 1.099139470837029e-25
EarlyStopping counter: 73 out of 100
Updating learning rate to 5.495697354185145e-26
EarlyStopping counter: 74 out of 100
Updating learning rate to 2.7478486770925724e-26
EarlyStopping counter: 75 out of 100
Updating learning rate to 1.3739243385462862e-26
EarlyStopping counter: 76 out of 100
Updating learning rate to 6.869621692731431e-27
EarlyStopping counter: 77 out of 100
Updating learning rate to 3.4348108463657155e-27
EarlyStopping counter: 78 out of 100
Updating learning rate to 1.7174054231828578e-27
EarlyStopping counter: 79 out of 100
Updating learning rate to 8.587027115914289e-28
EarlyStopping counter: 80 out of 100
Updating learning rate to 4.293513557957144e-28
EarlyStopping counter: 81 out of 100
Updating learning rate to 2.146756778978572e-28
EarlyStopping counter: 82 out of 100
Updating learning rate to 1.073378389489286e-28
EarlyStopping counter: 83 out of 100
Updating learning rate to 5.36689194744643e-29
EarlyStopping counter: 84 out of 100
Updating learning rate to 2.683445973723215e-29
EarlyStopping counter: 85 out of 100
Updating learning rate to 1.3417229868616076e-29
EarlyStopping counter: 86 out of 100
Updating learning rate to 6.708614934308038e-30
EarlyStopping counter: 87 out of 100
Updating learning rate to 3.354307467154019e-30
EarlyStopping counter: 88 out of 100
Updating learning rate to 1.6771537335770095e-30
EarlyStopping counter: 89 out of 100
Updating learning rate to 8.385768667885048e-31
EarlyStopping counter: 90 out of 100
Updating learning rate to 4.192884333942524e-31
EarlyStopping counter: 91 out of 100
Updating learning rate to 2.096442166971262e-31
EarlyStopping counter: 92 out of 100
Updating learning rate to 1.048221083485631e-31
EarlyStopping counter: 93 out of 100
Updating learning rate to 5.241105417428155e-32
EarlyStopping counter: 94 out of 100
Updating learning rate to 2.6205527087140774e-32
EarlyStopping counter: 95 out of 100
Updating learning rate to 1.3102763543570387e-32
EarlyStopping counter: 96 out of 100
Updating learning rate to 6.551381771785193e-33
EarlyStopping counter: 97 out of 100
Updating learning rate to 3.275690885892597e-33
EarlyStopping counter: 98 out of 100
Updating learning rate to 1.6378454429462984e-33
EarlyStopping counter: 99 out of 100
Updating learning rate to 8.189227214731492e-34
>>>>>> Testing on validation set: trial_28 >>>>>>
test 248
test shape: (248, 14, 5) (248, 14, 5)
test shape: (248, 14, 5) (248, 14, 5)


	mse:0.06808358430862427, mae:0.10704746097326279, dtw:Not calculated


                                                                                     [I 2025-10-17 06:58:13,443] Trial 28 finished with value: 0.10704746097326279 and parameters: {'seq_len': 96, 'pred_len': 14, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 1, 'batch_size': 64, 'learning_rate': 0.0005190539397079863, 'dropout': 0.17227433651816404}. Best is trial 25 with value: 0.07399702072143555.
Best trial: 25. Best value: 0.073997:  56%|█████▌    | 28/50 [54:22<24:55, 67.99s/it]Best trial: 25. Best value: 0.073997:  56%|█████▌    | 28/50 [54:22<24:55, 67.99s/it]Best trial: 25. Best value: 0.073997:  58%|█████▊    | 29/50 [54:22<23:42, 67.76s/it]
============================================================
Trial 29
============================================================
seq_len: 96, pred_len: 7
d_model: 32, n_heads: 8
e_layers: 2, d_layers: 1
batch_size: 64, lr: 0.000305
dropout: 0.07515849115354782
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 32, expand: 1
>>>>>> Start training: trial_29 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 7
============================================================
train 4571
val 253
test 255
Validation loss decreased (inf --> 0.040230).  Saving model ...
Updating learning rate to 0.0003051412235368727
Validation loss decreased (0.040230 --> 0.039830).  Saving model ...
Updating learning rate to 0.00015257061176843635
Validation loss decreased (0.039830 --> 0.038357).  Saving model ...
Updating learning rate to 7.628530588421817e-05
Validation loss decreased (0.038357 --> 0.038217).  Saving model ...
Updating learning rate to 3.814265294210909e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.9071326471054544e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.535663235527272e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.767831617763636e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.383915808881818e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.191957904440909e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.959789522204545e-07
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.9798947611022724e-07
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.4899473805511362e-07
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.449736902755681e-08
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.7248684513778406e-08
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.8624342256889203e-08
EarlyStopping counter: 12 out of 100
Updating learning rate to 9.312171128444601e-09
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.656085564222301e-09
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.3280427821111504e-09
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.1640213910555752e-09
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.820106955277876e-10
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.910053477638938e-10
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.455026738819469e-10
EarlyStopping counter: 19 out of 100
Updating learning rate to 7.275133694097345e-11
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.6375668470486724e-11
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.8187834235243362e-11
EarlyStopping counter: 22 out of 100
Updating learning rate to 9.093917117621681e-12
EarlyStopping counter: 23 out of 100
Updating learning rate to 4.5469585588108405e-12
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.2734792794054203e-12
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.1367396397027101e-12
EarlyStopping counter: 26 out of 100
Updating learning rate to 5.683698198513551e-13
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.8418490992567753e-13
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.4209245496283877e-13
EarlyStopping counter: 29 out of 100
Updating learning rate to 7.104622748141938e-14
EarlyStopping counter: 30 out of 100
Updating learning rate to 3.552311374070969e-14
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.7761556870354846e-14
EarlyStopping counter: 32 out of 100
Updating learning rate to 8.880778435177423e-15
EarlyStopping counter: 33 out of 100
Updating learning rate to 4.4403892175887115e-15
EarlyStopping counter: 34 out of 100
Updating learning rate to 2.2201946087943557e-15
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.1100973043971779e-15
EarlyStopping counter: 36 out of 100
Updating learning rate to 5.550486521985889e-16
EarlyStopping counter: 37 out of 100
Updating learning rate to 2.7752432609929447e-16
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.3876216304964723e-16
EarlyStopping counter: 39 out of 100
Updating learning rate to 6.938108152482362e-17
EarlyStopping counter: 40 out of 100
Updating learning rate to 3.469054076241181e-17
EarlyStopping counter: 41 out of 100
Updating learning rate to 1.7345270381205904e-17
EarlyStopping counter: 42 out of 100
Updating learning rate to 8.672635190602952e-18
EarlyStopping counter: 43 out of 100
Updating learning rate to 4.336317595301476e-18
EarlyStopping counter: 44 out of 100
Updating learning rate to 2.168158797650738e-18
EarlyStopping counter: 45 out of 100
Updating learning rate to 1.084079398825369e-18
EarlyStopping counter: 46 out of 100
Updating learning rate to 5.420396994126845e-19
EarlyStopping counter: 47 out of 100
Updating learning rate to 2.7101984970634225e-19
EarlyStopping counter: 48 out of 100
Updating learning rate to 1.3550992485317113e-19
EarlyStopping counter: 49 out of 100
Updating learning rate to 6.775496242658556e-20
EarlyStopping counter: 50 out of 100
Updating learning rate to 3.387748121329278e-20
EarlyStopping counter: 51 out of 100
Updating learning rate to 1.693874060664639e-20
EarlyStopping counter: 52 out of 100
Updating learning rate to 8.469370303323195e-21
EarlyStopping counter: 53 out of 100
Updating learning rate to 4.234685151661598e-21
EarlyStopping counter: 54 out of 100
Updating learning rate to 2.117342575830799e-21
EarlyStopping counter: 55 out of 100
Updating learning rate to 1.0586712879153994e-21
EarlyStopping counter: 56 out of 100
Updating learning rate to 5.293356439576997e-22
EarlyStopping counter: 57 out of 100
Updating learning rate to 2.6466782197884986e-22
EarlyStopping counter: 58 out of 100
Updating learning rate to 1.3233391098942493e-22
EarlyStopping counter: 59 out of 100
Updating learning rate to 6.616695549471246e-23
EarlyStopping counter: 60 out of 100
Updating learning rate to 3.308347774735623e-23
EarlyStopping counter: 61 out of 100
Updating learning rate to 1.6541738873678116e-23
EarlyStopping counter: 62 out of 100
Updating learning rate to 8.270869436839058e-24
EarlyStopping counter: 63 out of 100
Updating learning rate to 4.135434718419529e-24
EarlyStopping counter: 64 out of 100
Updating learning rate to 2.0677173592097645e-24
EarlyStopping counter: 65 out of 100
Updating learning rate to 1.0338586796048822e-24
EarlyStopping counter: 66 out of 100
Updating learning rate to 5.169293398024411e-25
EarlyStopping counter: 67 out of 100
Updating learning rate to 2.5846466990122056e-25
EarlyStopping counter: 68 out of 100
Updating learning rate to 1.2923233495061028e-25
EarlyStopping counter: 69 out of 100
Updating learning rate to 6.461616747530514e-26
EarlyStopping counter: 70 out of 100
Updating learning rate to 3.230808373765257e-26
EarlyStopping counter: 71 out of 100
Updating learning rate to 1.6154041868826285e-26
EarlyStopping counter: 72 out of 100
Updating learning rate to 8.077020934413143e-27
EarlyStopping counter: 73 out of 100
Updating learning rate to 4.038510467206571e-27
EarlyStopping counter: 74 out of 100
Updating learning rate to 2.0192552336032856e-27
EarlyStopping counter: 75 out of 100
Updating learning rate to 1.0096276168016428e-27
EarlyStopping counter: 76 out of 100
Updating learning rate to 5.048138084008214e-28
EarlyStopping counter: 77 out of 100
Updating learning rate to 2.524069042004107e-28
EarlyStopping counter: 78 out of 100
Updating learning rate to 1.2620345210020535e-28
EarlyStopping counter: 79 out of 100
Updating learning rate to 6.310172605010268e-29
EarlyStopping counter: 80 out of 100
Updating learning rate to 3.155086302505134e-29
EarlyStopping counter: 81 out of 100
Updating learning rate to 1.577543151252567e-29
EarlyStopping counter: 82 out of 100
Updating learning rate to 7.887715756262835e-30
EarlyStopping counter: 83 out of 100
Updating learning rate to 3.943857878131417e-30
EarlyStopping counter: 84 out of 100
Updating learning rate to 1.9719289390657086e-30
EarlyStopping counter: 85 out of 100
Updating learning rate to 9.859644695328543e-31
EarlyStopping counter: 86 out of 100
Updating learning rate to 4.929822347664272e-31
EarlyStopping counter: 87 out of 100
Updating learning rate to 2.464911173832136e-31
EarlyStopping counter: 88 out of 100
Updating learning rate to 1.232455586916068e-31
EarlyStopping counter: 89 out of 100
Updating learning rate to 6.16227793458034e-32
EarlyStopping counter: 90 out of 100
Updating learning rate to 3.08113896729017e-32
EarlyStopping counter: 91 out of 100
Updating learning rate to 1.540569483645085e-32
EarlyStopping counter: 92 out of 100
Updating learning rate to 7.702847418225424e-33
EarlyStopping counter: 93 out of 100
Updating learning rate to 3.851423709112712e-33
EarlyStopping counter: 94 out of 100
Updating learning rate to 1.925711854556356e-33
EarlyStopping counter: 95 out of 100
Updating learning rate to 9.62855927278178e-34
EarlyStopping counter: 96 out of 100
Updating learning rate to 4.81427963639089e-34
>>>>>> Testing on validation set: trial_29 >>>>>>
test 255
test shape: (255, 7, 5) (255, 7, 5)
test shape: (255, 7, 5) (255, 7, 5)


	mse:0.06813274323940277, mae:0.10477389395236969, dtw:Not calculated


                                                                                     [I 2025-10-17 06:59:20,308] Trial 29 finished with value: 0.10477389395236969 and parameters: {'seq_len': 96, 'pred_len': 7, 'expand': 1, 'd_model': 32, 'n_heads': 8, 'e_layers': 2, 'd_layers': 1, 'batch_size': 64, 'learning_rate': 0.0003051412235368727, 'dropout': 0.07515849115354782}. Best is trial 25 with value: 0.07399702072143555.
Best trial: 25. Best value: 0.073997:  58%|█████▊    | 29/50 [55:29<23:42, 67.76s/it]Best trial: 25. Best value: 0.073997:  58%|█████▊    | 29/50 [55:29<23:42, 67.76s/it]Best trial: 25. Best value: 0.073997:  60%|██████    | 30/50 [55:29<22:29, 67.49s/it]
============================================================
Trial 30
============================================================
seq_len: 96, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 1
batch_size: 64, lr: 0.000693
dropout: 0.12865130850756282
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_30 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 1
============================================================
train 4577
val 259
test 261
Validation loss decreased (inf --> 0.026023).  Saving model ...
Updating learning rate to 0.0006932552803660707
Validation loss decreased (0.026023 --> 0.023578).  Saving model ...
Updating learning rate to 0.00034662764018303534
Validation loss decreased (0.023578 --> 0.023443).  Saving model ...
Updating learning rate to 0.00017331382009151767
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.665691004575884e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.332845502287942e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.166422751143971e-05
Validation loss decreased (0.023443 --> 0.022143).  Saving model ...
Updating learning rate to 1.0832113755719854e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.416056877859927e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7080284389299636e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3540142194649818e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.770071097324909e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.3850355486624545e-07
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6925177743312272e-07
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.462588871656136e-08
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.231294435828068e-08
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.115647217914034e-08
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.057823608957017e-08
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.289118044785085e-09
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.6445590223925426e-09
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.3222795111962713e-09
Validation loss decreased (0.022143 --> 0.022085).  Saving model ...
Updating learning rate to 6.611397555981356e-10
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.305698777990678e-10
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.652849388995339e-10
Validation loss decreased (0.022085 --> 0.021531).  Saving model ...
Updating learning rate to 8.264246944976696e-11
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.132123472488348e-11
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.066061736244174e-11
Validation loss decreased (0.021531 --> 0.021183).  Saving model ...
Updating learning rate to 1.033030868122087e-11
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.165154340610435e-12
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.5825771703052174e-12
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2912885851526087e-12
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.456442925763043e-13
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.2282214628815217e-13
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6141107314407608e-13
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.070553657203804e-14
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.035276828601902e-14
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.017638414300951e-14
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.0088192071504755e-14
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.044096035752378e-15
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.522048017876189e-15
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.2610240089380944e-15
EarlyStopping counter: 14 out of 100
Updating learning rate to 6.305120044690472e-16
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.152560022345236e-16
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.576280011172618e-16
EarlyStopping counter: 17 out of 100
Updating learning rate to 7.88140005586309e-17
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.940700027931545e-17
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.9703500139657725e-17
EarlyStopping counter: 20 out of 100
Updating learning rate to 9.851750069828863e-18
EarlyStopping counter: 21 out of 100
Updating learning rate to 4.925875034914431e-18
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.4629375174572156e-18
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.2314687587286078e-18
EarlyStopping counter: 24 out of 100
Updating learning rate to 6.157343793643039e-19
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.0786718968215196e-19
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.5393359484107598e-19
EarlyStopping counter: 27 out of 100
Updating learning rate to 7.696679742053799e-20
EarlyStopping counter: 28 out of 100
Updating learning rate to 3.8483398710268995e-20
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.9241699355134497e-20
EarlyStopping counter: 30 out of 100
Updating learning rate to 9.620849677567249e-21
EarlyStopping counter: 31 out of 100
Updating learning rate to 4.810424838783624e-21
EarlyStopping counter: 32 out of 100
Updating learning rate to 2.405212419391812e-21
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.202606209695906e-21
EarlyStopping counter: 34 out of 100
Updating learning rate to 6.01303104847953e-22
EarlyStopping counter: 35 out of 100
Updating learning rate to 3.006515524239765e-22
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.5032577621198826e-22
EarlyStopping counter: 37 out of 100
Updating learning rate to 7.516288810599413e-23
EarlyStopping counter: 38 out of 100
Updating learning rate to 3.7581444052997065e-23
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.8790722026498532e-23
EarlyStopping counter: 40 out of 100
Updating learning rate to 9.395361013249266e-24
EarlyStopping counter: 41 out of 100
Updating learning rate to 4.697680506624633e-24
EarlyStopping counter: 42 out of 100
Updating learning rate to 2.3488402533123166e-24
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.1744201266561583e-24
EarlyStopping counter: 44 out of 100
Updating learning rate to 5.872100633280791e-25
EarlyStopping counter: 45 out of 100
Updating learning rate to 2.9360503166403957e-25
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.4680251583201979e-25
EarlyStopping counter: 47 out of 100
Updating learning rate to 7.340125791600989e-26
EarlyStopping counter: 48 out of 100
Updating learning rate to 3.6700628958004946e-26
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.8350314479002473e-26
EarlyStopping counter: 50 out of 100
Updating learning rate to 9.175157239501237e-27
EarlyStopping counter: 51 out of 100
Updating learning rate to 4.587578619750618e-27
EarlyStopping counter: 52 out of 100
Updating learning rate to 2.293789309875309e-27
EarlyStopping counter: 53 out of 100
Updating learning rate to 1.1468946549376546e-27
EarlyStopping counter: 54 out of 100
Updating learning rate to 5.734473274688273e-28
EarlyStopping counter: 55 out of 100
Updating learning rate to 2.8672366373441364e-28
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.4336183186720682e-28
EarlyStopping counter: 57 out of 100
Updating learning rate to 7.168091593360341e-29
EarlyStopping counter: 58 out of 100
Updating learning rate to 3.5840457966801705e-29
EarlyStopping counter: 59 out of 100
Updating learning rate to 1.7920228983400853e-29
EarlyStopping counter: 60 out of 100
Updating learning rate to 8.960114491700426e-30
EarlyStopping counter: 61 out of 100
Updating learning rate to 4.480057245850213e-30
EarlyStopping counter: 62 out of 100
Updating learning rate to 2.2400286229251066e-30
EarlyStopping counter: 63 out of 100
Updating learning rate to 1.1200143114625533e-30
EarlyStopping counter: 64 out of 100
Updating learning rate to 5.6000715573127665e-31
EarlyStopping counter: 65 out of 100
Updating learning rate to 2.8000357786563832e-31
EarlyStopping counter: 66 out of 100
Updating learning rate to 1.4000178893281916e-31
EarlyStopping counter: 67 out of 100
Updating learning rate to 7.000089446640958e-32
EarlyStopping counter: 68 out of 100
Updating learning rate to 3.500044723320479e-32
EarlyStopping counter: 69 out of 100
Updating learning rate to 1.7500223616602395e-32
EarlyStopping counter: 70 out of 100
Updating learning rate to 8.750111808301198e-33
EarlyStopping counter: 71 out of 100
Updating learning rate to 4.375055904150599e-33
EarlyStopping counter: 72 out of 100
Updating learning rate to 2.1875279520752994e-33
EarlyStopping counter: 73 out of 100
Updating learning rate to 1.0937639760376497e-33
>>>>>> Testing on validation set: trial_30 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.049005672335624695, mae:0.07595321536064148, dtw:Not calculated


                                                                                     [I 2025-10-17 07:00:28,075] Trial 30 finished with value: 0.07595321536064148 and parameters: {'seq_len': 96, 'pred_len': 1, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 1, 'batch_size': 64, 'learning_rate': 0.0006932552803660707, 'dropout': 0.12865130850756282}. Best is trial 25 with value: 0.07399702072143555.
Best trial: 25. Best value: 0.073997:  60%|██████    | 30/50 [56:37<22:29, 67.49s/it]Best trial: 25. Best value: 0.073997:  60%|██████    | 30/50 [56:37<22:29, 67.49s/it]Best trial: 25. Best value: 0.073997:  62%|██████▏   | 31/50 [56:37<21:23, 67.57s/it]
============================================================
Trial 31
============================================================
seq_len: 96, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 1
batch_size: 64, lr: 0.000881
dropout: 0.23473738241333225
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_31 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 1
============================================================
train 4577
val 259
test 261
Validation loss decreased (inf --> 0.022109).  Saving model ...
Updating learning rate to 0.0008805839947663963
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00044029199738319816
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.00022014599869159908
EarlyStopping counter: 3 out of 100
Updating learning rate to 0.00011007299934579954
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.503649967289977e-05
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7518249836449885e-05
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3759124918224942e-05
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.879562459112471e-06
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.4397812295562356e-06
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.7198906147781178e-06
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.599453073890589e-07
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.2997265369452945e-07
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.1498632684726472e-07
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.0749316342363236e-07
Validation loss decreased (0.022109 --> 0.021967).  Saving model ...
Updating learning rate to 5.374658171181618e-08
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.687329085590809e-08
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3436645427954045e-08
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.718322713977023e-09
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.3591613569885113e-09
Validation loss decreased (0.021967 --> 0.021744).  Saving model ...
Updating learning rate to 1.6795806784942557e-09
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.397903392471278e-10
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.198951696235639e-10
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0994758481178196e-10
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0497379240589098e-10
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.248689620294549e-11
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.6243448101472745e-11
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3121724050736372e-11
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.560862025368186e-12
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.280431012684093e-12
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.6402155063420465e-12
EarlyStopping counter: 11 out of 100
Updating learning rate to 8.201077531710233e-13
Validation loss decreased (0.021744 --> 0.021661).  Saving model ...
Updating learning rate to 4.1005387658551164e-13
Validation loss decreased (0.021661 --> 0.021549).  Saving model ...
Updating learning rate to 2.0502693829275582e-13
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0251346914637791e-13
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.1256734573188955e-14
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.5628367286594477e-14
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2814183643297239e-14
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.407091821648619e-15
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.2035459108243097e-15
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.6017729554121548e-15
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.008864777060774e-16
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.004432388530387e-16
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.0022161942651935e-16
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.0011080971325968e-16
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.005540485662984e-17
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.502770242831492e-17
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.251385121415746e-17
EarlyStopping counter: 15 out of 100
Updating learning rate to 6.25692560707873e-18
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.128462803539365e-18
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.5642314017696825e-18
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.821157008848412e-19
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.910578504424206e-19
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.955289252212103e-19
EarlyStopping counter: 21 out of 100
Updating learning rate to 9.776446261060515e-20
EarlyStopping counter: 22 out of 100
Updating learning rate to 4.8882231305302577e-20
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.4441115652651288e-20
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.2220557826325644e-20
EarlyStopping counter: 25 out of 100
Updating learning rate to 6.110278913162822e-21
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.055139456581411e-21
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.5275697282907055e-21
EarlyStopping counter: 28 out of 100
Updating learning rate to 7.637848641453528e-22
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.818924320726764e-22
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.909462160363382e-22
EarlyStopping counter: 31 out of 100
Updating learning rate to 9.54731080181691e-23
EarlyStopping counter: 32 out of 100
Updating learning rate to 4.773655400908455e-23
EarlyStopping counter: 33 out of 100
Updating learning rate to 2.3868277004542274e-23
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.1934138502271137e-23
EarlyStopping counter: 35 out of 100
Updating learning rate to 5.9670692511355684e-24
EarlyStopping counter: 36 out of 100
Updating learning rate to 2.9835346255677842e-24
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.4917673127838921e-24
EarlyStopping counter: 38 out of 100
Updating learning rate to 7.4588365639194605e-25
EarlyStopping counter: 39 out of 100
Updating learning rate to 3.7294182819597303e-25
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.8647091409798651e-25
EarlyStopping counter: 41 out of 100
Updating learning rate to 9.323545704899326e-26
EarlyStopping counter: 42 out of 100
Updating learning rate to 4.661772852449663e-26
EarlyStopping counter: 43 out of 100
Updating learning rate to 2.3308864262248314e-26
EarlyStopping counter: 44 out of 100
Updating learning rate to 1.1654432131124157e-26
EarlyStopping counter: 45 out of 100
Updating learning rate to 5.8272160655620785e-27
EarlyStopping counter: 46 out of 100
Updating learning rate to 2.9136080327810393e-27
EarlyStopping counter: 47 out of 100
Updating learning rate to 1.4568040163905196e-27
EarlyStopping counter: 48 out of 100
Updating learning rate to 7.284020081952598e-28
EarlyStopping counter: 49 out of 100
Updating learning rate to 3.642010040976299e-28
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.8210050204881495e-28
EarlyStopping counter: 51 out of 100
Updating learning rate to 9.105025102440748e-29
EarlyStopping counter: 52 out of 100
Updating learning rate to 4.552512551220374e-29
EarlyStopping counter: 53 out of 100
Updating learning rate to 2.276256275610187e-29
EarlyStopping counter: 54 out of 100
Updating learning rate to 1.1381281378050935e-29
EarlyStopping counter: 55 out of 100
Updating learning rate to 5.690640689025467e-30
EarlyStopping counter: 56 out of 100
Updating learning rate to 2.8453203445127337e-30
EarlyStopping counter: 57 out of 100
Updating learning rate to 1.4226601722563668e-30
EarlyStopping counter: 58 out of 100
Updating learning rate to 7.113300861281834e-31
EarlyStopping counter: 59 out of 100
Updating learning rate to 3.556650430640917e-31
EarlyStopping counter: 60 out of 100
Updating learning rate to 1.7783252153204585e-31
EarlyStopping counter: 61 out of 100
Updating learning rate to 8.891626076602293e-32
EarlyStopping counter: 62 out of 100
Updating learning rate to 4.4458130383011464e-32
EarlyStopping counter: 63 out of 100
Updating learning rate to 2.2229065191505732e-32
EarlyStopping counter: 64 out of 100
Updating learning rate to 1.1114532595752866e-32
Validation loss decreased (0.021549 --> 0.021524).  Saving model ...
Updating learning rate to 5.557266297876433e-33
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7786331489382165e-33
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3893165744691082e-33
>>>>>> Testing on validation set: trial_31 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.05087925121188164, mae:0.07537313550710678, dtw:Not calculated


                                                                                     [I 2025-10-17 07:01:35,784] Trial 31 finished with value: 0.07537313550710678 and parameters: {'seq_len': 96, 'pred_len': 1, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 1, 'batch_size': 64, 'learning_rate': 0.0008805839947663963, 'dropout': 0.23473738241333225}. Best is trial 25 with value: 0.07399702072143555.
Best trial: 25. Best value: 0.073997:  62%|██████▏   | 31/50 [57:45<21:23, 67.57s/it]Best trial: 25. Best value: 0.073997:  62%|██████▏   | 31/50 [57:45<21:23, 67.57s/it]Best trial: 25. Best value: 0.073997:  64%|██████▍   | 32/50 [57:45<20:17, 67.61s/it]
============================================================
Trial 32
============================================================
seq_len: 96, pred_len: 1
d_model: 64, n_heads: 4
e_layers: 1, d_layers: 1
batch_size: 64, lr: 0.000979
dropout: 0.09755387879752067
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_32 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 1
============================================================
train 4577
val 259
test 261
Validation loss decreased (inf --> 0.029966).  Saving model ...
Updating learning rate to 0.0009785935672723262
Validation loss decreased (0.029966 --> 0.029276).  Saving model ...
Updating learning rate to 0.0004892967836361631
Validation loss decreased (0.029276 --> 0.024603).  Saving model ...
Updating learning rate to 0.00024464839181808154
Validation loss decreased (0.024603 --> 0.023730).  Saving model ...
Updating learning rate to 0.00012232419590904077
Validation loss decreased (0.023730 --> 0.023470).  Saving model ...
Updating learning rate to 6.116209795452038e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.058104897726019e-05
Validation loss decreased (0.023470 --> 0.023125).  Saving model ...
Updating learning rate to 1.5290524488630096e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.645262244315048e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.822631122157524e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.911315561078762e-06
Validation loss decreased (0.023125 --> 0.022483).  Saving model ...
Updating learning rate to 9.55657780539381e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.778288902696905e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.3891444513484525e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1945722256742263e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.972861128371131e-08
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.986430564185566e-08
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.493215282092783e-08
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.466076410463914e-09
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.733038205231957e-09
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.8665191026159785e-09
EarlyStopping counter: 10 out of 100
Updating learning rate to 9.332595513079893e-10
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.666297756539946e-10
Validation loss decreased (0.022483 --> 0.021804).  Saving model ...
Updating learning rate to 2.333148878269973e-10
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1665744391349866e-10
Validation loss decreased (0.021804 --> 0.021475).  Saving model ...
Updating learning rate to 5.832872195674933e-11
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.9164360978374665e-11
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4582180489187332e-11
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.291090244593666e-12
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.645545122296833e-12
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8227725611484165e-12
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.113862805742083e-13
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.556931402871041e-13
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.2784657014355207e-13
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.1392328507177603e-13
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.696164253588802e-14
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.848082126794401e-14
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.4240410633972004e-14
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.120205316986002e-15
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.560102658493001e-15
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.7800513292465005e-15
EarlyStopping counter: 16 out of 100
Updating learning rate to 8.900256646232503e-16
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.450128323116251e-16
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.2250641615581257e-16
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.1125320807790628e-16
EarlyStopping counter: 20 out of 100
Updating learning rate to 5.562660403895314e-17
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.781330201947657e-17
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.3906651009738285e-17
EarlyStopping counter: 23 out of 100
Updating learning rate to 6.953325504869143e-18
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.476662752434571e-18
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.7383313762172857e-18
EarlyStopping counter: 26 out of 100
Updating learning rate to 8.691656881086428e-19
EarlyStopping counter: 27 out of 100
Updating learning rate to 4.345828440543214e-19
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.172914220271607e-19
Validation loss decreased (0.021475 --> 0.021459).  Saving model ...
Updating learning rate to 1.0864571101358035e-19
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.432285550679018e-20
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.716142775339509e-20
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3580713876697544e-20
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.790356938348772e-21
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.395178469174386e-21
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.697589234587193e-21
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.487946172935965e-22
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.243973086467983e-22
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.1219865432339913e-22
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.0609932716169957e-22
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.304966358084978e-23
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.652483179042489e-23
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.3262415895212446e-23
EarlyStopping counter: 14 out of 100
Updating learning rate to 6.631207947606223e-24
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.3156039738031114e-24
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.6578019869015557e-24
EarlyStopping counter: 17 out of 100
Updating learning rate to 8.289009934507779e-25
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.144504967253889e-25
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.0722524836269446e-25
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.0361262418134723e-25
EarlyStopping counter: 21 out of 100
Updating learning rate to 5.180631209067362e-26
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.590315604533681e-26
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.2951578022668404e-26
EarlyStopping counter: 24 out of 100
Updating learning rate to 6.475789011334202e-27
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.237894505667101e-27
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.6189472528335505e-27
EarlyStopping counter: 27 out of 100
Updating learning rate to 8.094736264167752e-28
EarlyStopping counter: 28 out of 100
Updating learning rate to 4.047368132083876e-28
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.023684066041938e-28
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.011842033020969e-28
Validation loss decreased (0.021459 --> 0.021436).  Saving model ...
Updating learning rate to 5.059210165104845e-29
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.5296050825524227e-29
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2648025412762113e-29
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.324012706381057e-30
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.162006353190528e-30
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.581003176595264e-30
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.90501588297632e-31
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.95250794148816e-31
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.97625397074408e-31
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.8812698537204e-32
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.9406349268602e-32
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.4703174634301e-32
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.23515873171505e-32
EarlyStopping counter: 13 out of 100
Updating learning rate to 6.17579365857525e-33
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.087896829287625e-33
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.5439484146438127e-33
>>>>>> Testing on validation set: trial_32 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.05152062326669693, mae:0.07468407601118088, dtw:Not calculated


                                                                                     [I 2025-10-17 07:02:43,614] Trial 32 finished with value: 0.07468407601118088 and parameters: {'seq_len': 96, 'pred_len': 1, 'expand': 1, 'd_model': 64, 'n_heads': 4, 'e_layers': 1, 'd_layers': 1, 'batch_size': 64, 'learning_rate': 0.0009785935672723262, 'dropout': 0.09755387879752067}. Best is trial 25 with value: 0.07399702072143555.
Best trial: 25. Best value: 0.073997:  64%|██████▍   | 32/50 [58:52<20:17, 67.61s/it]Best trial: 25. Best value: 0.073997:  64%|██████▍   | 32/50 [58:52<20:17, 67.61s/it]Best trial: 25. Best value: 0.073997:  66%|██████▌   | 33/50 [58:52<19:10, 67.68s/it]
============================================================
Trial 33
============================================================
seq_len: 96, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 1
batch_size: 64, lr: 0.000446
dropout: 0.09830944374284335
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_33 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 1
============================================================
train 4577
val 259
test 261
Validation loss decreased (inf --> 0.026546).  Saving model ...
Updating learning rate to 0.0004457512453958145
Validation loss decreased (0.026546 --> 0.023593).  Saving model ...
Updating learning rate to 0.00022287562269790725
Validation loss decreased (0.023593 --> 0.022851).  Saving model ...
Updating learning rate to 0.00011143781134895362
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.571890567447681e-05
Validation loss decreased (0.022851 --> 0.022333).  Saving model ...
Updating learning rate to 2.7859452837238406e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3929726418619203e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.964863209309601e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4824316046548007e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.7412158023274004e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.706079011637002e-07
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.353039505818501e-07
Validation loss decreased (0.022333 --> 0.021707).  Saving model ...
Updating learning rate to 2.1765197529092504e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0882598764546252e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.441299382273126e-08
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.720649691136563e-08
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3603248455682815e-08
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.801624227841408e-09
Validation loss decreased (0.021707 --> 0.021642).  Saving model ...
Updating learning rate to 3.400812113920704e-09
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.700406056960352e-09
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.50203028480176e-10
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.25101514240088e-10
Validation loss decreased (0.021642 --> 0.021501).  Saving model ...
Updating learning rate to 2.12550757120044e-10
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.06275378560022e-10
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.3137689280011e-11
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.65688446400055e-11
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.328442232000275e-11
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.642211160001375e-12
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.3211055800006873e-12
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.6605527900003437e-12
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.302763950001718e-13
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.151381975000859e-13
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.0756909875004296e-13
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.0378454937502148e-13
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.189227468751074e-14
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.594613734375537e-14
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.2973068671877685e-14
EarlyStopping counter: 15 out of 100
Updating learning rate to 6.4865343359388424e-15
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.2432671679694212e-15
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.6216335839847106e-15
EarlyStopping counter: 18 out of 100
Updating learning rate to 8.108167919923553e-16
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.0540839599617765e-16
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.0270419799808883e-16
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.0135209899904441e-16
EarlyStopping counter: 22 out of 100
Updating learning rate to 5.0676049499522206e-17
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.5338024749761103e-17
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.2669012374880552e-17
EarlyStopping counter: 25 out of 100
Updating learning rate to 6.334506187440276e-18
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.167253093720138e-18
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.583626546860069e-18
EarlyStopping counter: 28 out of 100
Updating learning rate to 7.918132734300345e-19
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.9590663671501724e-19
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.9795331835750862e-19
EarlyStopping counter: 31 out of 100
Updating learning rate to 9.897665917875431e-20
EarlyStopping counter: 32 out of 100
Updating learning rate to 4.9488329589377155e-20
EarlyStopping counter: 33 out of 100
Updating learning rate to 2.4744164794688577e-20
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.2372082397344289e-20
EarlyStopping counter: 35 out of 100
Updating learning rate to 6.186041198672144e-21
EarlyStopping counter: 36 out of 100
Updating learning rate to 3.093020599336072e-21
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.546510299668036e-21
EarlyStopping counter: 38 out of 100
Updating learning rate to 7.73255149834018e-22
EarlyStopping counter: 39 out of 100
Updating learning rate to 3.86627574917009e-22
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.933137874585045e-22
EarlyStopping counter: 41 out of 100
Updating learning rate to 9.665689372925226e-23
EarlyStopping counter: 42 out of 100
Updating learning rate to 4.832844686462613e-23
EarlyStopping counter: 43 out of 100
Updating learning rate to 2.4164223432313064e-23
EarlyStopping counter: 44 out of 100
Updating learning rate to 1.2082111716156532e-23
EarlyStopping counter: 45 out of 100
Updating learning rate to 6.041055858078266e-24
EarlyStopping counter: 46 out of 100
Updating learning rate to 3.020527929039133e-24
EarlyStopping counter: 47 out of 100
Updating learning rate to 1.5102639645195665e-24
EarlyStopping counter: 48 out of 100
Updating learning rate to 7.551319822597832e-25
EarlyStopping counter: 49 out of 100
Updating learning rate to 3.775659911298916e-25
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.887829955649458e-25
EarlyStopping counter: 51 out of 100
Updating learning rate to 9.43914977824729e-26
EarlyStopping counter: 52 out of 100
Updating learning rate to 4.719574889123645e-26
Validation loss decreased (0.021501 --> 0.021376).  Saving model ...
Updating learning rate to 2.3597874445618226e-26
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1798937222809113e-26
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8994686114045566e-27
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.9497343057022783e-27
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4748671528511391e-27
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.374335764255696e-28
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.687167882127848e-28
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.843583941063924e-28
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.21791970531962e-29
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.60895985265981e-29
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.304479926329905e-29
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.1522399631649525e-29
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.761199815824762e-30
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.880599907912381e-30
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.4402999539561906e-30
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.201499769780953e-31
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.6007498848904764e-31
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.8003749424452382e-31
EarlyStopping counter: 18 out of 100
Updating learning rate to 9.001874712226191e-32
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.5009373561130955e-32
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.2504686780565478e-32
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.1252343390282739e-32
EarlyStopping counter: 22 out of 100
Updating learning rate to 5.6261716951413694e-33
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.8130858475706847e-33
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.4065429237853424e-33
EarlyStopping counter: 25 out of 100
Updating learning rate to 7.032714618926712e-34
>>>>>> Testing on validation set: trial_33 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.051137253642082214, mae:0.07653209567070007, dtw:Not calculated


                                                                                     [I 2025-10-17 07:03:51,716] Trial 33 finished with value: 0.07653209567070007 and parameters: {'seq_len': 96, 'pred_len': 1, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 1, 'batch_size': 64, 'learning_rate': 0.0004457512453958145, 'dropout': 0.09830944374284335}. Best is trial 25 with value: 0.07399702072143555.
Best trial: 25. Best value: 0.073997:  66%|██████▌   | 33/50 [1:00:01<19:10, 67.68s/it]Best trial: 25. Best value: 0.073997:  66%|██████▌   | 33/50 [1:00:01<19:10, 67.68s/it]Best trial: 25. Best value: 0.073997:  68%|██████▊   | 34/50 [1:00:01<18:04, 67.81s/it]
============================================================
Trial 34
============================================================
seq_len: 96, pred_len: 1
d_model: 32, n_heads: 4
e_layers: 1, d_layers: 1
batch_size: 64, lr: 0.000698
dropout: 0.1765363044801051
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 32, expand: 1
>>>>>> Start training: trial_34 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 1
============================================================
train 4577
val 259
test 261
Validation loss decreased (inf --> 0.025779).  Saving model ...
Updating learning rate to 0.0006983550190730047
Validation loss decreased (0.025779 --> 0.023147).  Saving model ...
Updating learning rate to 0.00034917750953650234
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00017458875476825117
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.729437738412559e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.364718869206279e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.1823594346031396e-05
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0911797173015698e-05
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.455898586507849e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7279492932539245e-06
Validation loss decreased (0.023147 --> 0.022647).  Saving model ...
Updating learning rate to 1.3639746466269623e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.819873233134811e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4099366165674057e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.7049683082837028e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.524841541418514e-08
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.262420770709257e-08
Validation loss decreased (0.022647 --> 0.022051).  Saving model ...
Updating learning rate to 2.1312103853546285e-08
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0656051926773143e-08
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.328025963386571e-09
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.6640129816932857e-09
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3320064908466428e-09
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.660032454233214e-10
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.330016227116607e-10
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.6650081135583036e-10
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.325040567791518e-11
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.162520283895759e-11
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.0812601419478794e-11
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.0406300709739397e-11
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.203150354869699e-12
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.6015751774348493e-12
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.3007875887174246e-12
EarlyStopping counter: 15 out of 100
Updating learning rate to 6.503937943587123e-13
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.2519689717935616e-13
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.6259844858967808e-13
EarlyStopping counter: 18 out of 100
Updating learning rate to 8.129922429483904e-14
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.064961214741952e-14
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.032480607370976e-14
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.016240303685488e-14
EarlyStopping counter: 22 out of 100
Updating learning rate to 5.08120151842744e-15
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.54060075921372e-15
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.27030037960686e-15
EarlyStopping counter: 25 out of 100
Updating learning rate to 6.3515018980343e-16
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.17575094901715e-16
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.587875474508575e-16
Validation loss decreased (0.022051 --> 0.021811).  Saving model ...
Updating learning rate to 7.939377372542875e-17
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.9696886862714375e-17
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.9848443431357188e-17
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.924221715678594e-18
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.962110857839297e-18
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.4810554289196485e-18
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.2405277144598242e-18
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.202638572299121e-19
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.1013192861495606e-19
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.5506596430747803e-19
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.753298215373901e-20
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.876649107686951e-20
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.9383245538434754e-20
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.691622769217377e-21
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.8458113846086884e-21
Validation loss decreased (0.021811 --> 0.021674).  Saving model ...
Updating learning rate to 2.4229056923043442e-21
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2114528461521721e-21
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.0572642307608605e-22
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.0286321153804302e-22
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5143160576902151e-22
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.571580288451076e-23
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.785790144225538e-23
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.892895072112769e-23
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.464475360563845e-24
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.732237680281922e-24
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.366118840140961e-24
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.1830594200704806e-24
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.915297100352403e-25
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.9576485501762014e-25
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.4788242750881007e-25
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.394121375440504e-26
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.697060687720252e-26
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.848530343860126e-26
EarlyStopping counter: 18 out of 100
Updating learning rate to 9.24265171930063e-27
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.621325859650315e-27
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.3106629298251574e-27
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.1553314649125787e-27
EarlyStopping counter: 22 out of 100
Updating learning rate to 5.776657324562893e-28
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.8883286622814467e-28
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.4441643311407233e-28
EarlyStopping counter: 25 out of 100
Updating learning rate to 7.220821655703617e-29
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.6104108278518084e-29
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.8052054139259042e-29
EarlyStopping counter: 28 out of 100
Updating learning rate to 9.026027069629521e-30
EarlyStopping counter: 29 out of 100
Updating learning rate to 4.5130135348147605e-30
EarlyStopping counter: 30 out of 100
Updating learning rate to 2.2565067674073802e-30
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.1282533837036901e-30
EarlyStopping counter: 32 out of 100
Updating learning rate to 5.641266918518451e-31
EarlyStopping counter: 33 out of 100
Updating learning rate to 2.8206334592592253e-31
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.4103167296296126e-31
EarlyStopping counter: 35 out of 100
Updating learning rate to 7.051583648148063e-32
EarlyStopping counter: 36 out of 100
Updating learning rate to 3.5257918240740316e-32
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.7628959120370158e-32
EarlyStopping counter: 38 out of 100
Updating learning rate to 8.814479560185079e-33
EarlyStopping counter: 39 out of 100
Updating learning rate to 4.4072397800925395e-33
EarlyStopping counter: 40 out of 100
Updating learning rate to 2.2036198900462698e-33
EarlyStopping counter: 41 out of 100
Updating learning rate to 1.1018099450231349e-33
>>>>>> Testing on validation set: trial_34 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.05041281133890152, mae:0.07807508111000061, dtw:Not calculated


                                                                                       [I 2025-10-17 07:04:59,116] Trial 34 finished with value: 0.07807508111000061 and parameters: {'seq_len': 96, 'pred_len': 1, 'expand': 1, 'd_model': 32, 'n_heads': 4, 'e_layers': 1, 'd_layers': 1, 'batch_size': 64, 'learning_rate': 0.0006983550190730047, 'dropout': 0.1765363044801051}. Best is trial 25 with value: 0.07399702072143555.
Best trial: 25. Best value: 0.073997:  68%|██████▊   | 34/50 [1:01:08<18:04, 67.81s/it]Best trial: 25. Best value: 0.073997:  68%|██████▊   | 34/50 [1:01:08<18:04, 67.81s/it]Best trial: 25. Best value: 0.073997:  70%|███████   | 35/50 [1:01:08<16:55, 67.68s/it]
============================================================
Trial 35
============================================================
seq_len: 96, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 2, d_layers: 1
batch_size: 16, lr: 0.000946
dropout: 0.06299761759134764
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_35 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 1
============================================================
train 4577
val 259
test 261
Validation loss decreased (inf --> 0.025823).  Saving model ...
Updating learning rate to 0.0009460798179810813
Validation loss decreased (0.025823 --> 0.025120).  Saving model ...
Updating learning rate to 0.00047303990899054063
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00023651995449527031
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.00011825997724763516
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.912998862381758e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.956499431190879e-05
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4782497155954395e-05
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.391248577977197e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.6956242889885987e-06
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.8478121444942993e-06
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.239060722471497e-07
Validation loss decreased (0.025120 --> 0.025111).  Saving model ...
Updating learning rate to 4.6195303612357483e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.3097651806178742e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1548825903089371e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.7744129515446854e-08
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.8872064757723427e-08
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4436032378861714e-08
Validation loss decreased (0.025111 --> 0.024915).  Saving model ...
Updating learning rate to 7.218016189430857e-09
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.6090080947154284e-09
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8045040473577142e-09
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.022520236788571e-10
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.5112601183942855e-10
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2556300591971427e-10
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1278150295985714e-10
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.639075147992857e-11
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.8195375739964284e-11
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4097687869982142e-11
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.048843934991071e-12
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.5244219674955355e-12
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.7622109837477678e-12
EarlyStopping counter: 13 out of 100
Updating learning rate to 8.811054918738839e-13
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.4055274593694194e-13
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.2027637296847097e-13
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.1013818648423549e-13
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.506909324211774e-14
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.753454662105887e-14
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.3767273310529436e-14
EarlyStopping counter: 20 out of 100
Updating learning rate to 6.883636655264718e-15
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.441818327632359e-15
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.7209091638161795e-15
EarlyStopping counter: 23 out of 100
Updating learning rate to 8.604545819080897e-16
EarlyStopping counter: 24 out of 100
Updating learning rate to 4.3022729095404486e-16
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.1511364547702243e-16
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.0755682273851122e-16
EarlyStopping counter: 27 out of 100
Updating learning rate to 5.377841136925561e-17
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.6889205684627804e-17
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.3444602842313902e-17
EarlyStopping counter: 30 out of 100
Updating learning rate to 6.722301421156951e-18
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.3611507105784755e-18
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.6805753552892378e-18
EarlyStopping counter: 33 out of 100
Updating learning rate to 8.402876776446189e-19
EarlyStopping counter: 34 out of 100
Updating learning rate to 4.2014383882230944e-19
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.1007191941115472e-19
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.0503595970557736e-19
EarlyStopping counter: 37 out of 100
Updating learning rate to 5.251797985278868e-20
EarlyStopping counter: 38 out of 100
Updating learning rate to 2.625898992639434e-20
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.312949496319717e-20
EarlyStopping counter: 40 out of 100
Updating learning rate to 6.564747481598585e-21
EarlyStopping counter: 41 out of 100
Updating learning rate to 3.2823737407992925e-21
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.6411868703996462e-21
EarlyStopping counter: 43 out of 100
Updating learning rate to 8.205934351998231e-22
EarlyStopping counter: 44 out of 100
Updating learning rate to 4.1029671759991156e-22
EarlyStopping counter: 45 out of 100
Updating learning rate to 2.0514835879995578e-22
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.0257417939997789e-22
EarlyStopping counter: 47 out of 100
Updating learning rate to 5.1287089699988945e-23
EarlyStopping counter: 48 out of 100
Updating learning rate to 2.5643544849994473e-23
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.2821772424997236e-23
EarlyStopping counter: 50 out of 100
Updating learning rate to 6.410886212498618e-24
EarlyStopping counter: 51 out of 100
Updating learning rate to 3.205443106249309e-24
EarlyStopping counter: 52 out of 100
Updating learning rate to 1.6027215531246545e-24
EarlyStopping counter: 53 out of 100
Updating learning rate to 8.013607765623273e-25
Validation loss decreased (0.024915 --> 0.024900).  Saving model ...
Updating learning rate to 4.0068038828116363e-25
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0034019414058182e-25
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0017009707029091e-25
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.0085048535145454e-26
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.5042524267572727e-26
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2521262133786364e-26
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.260631066893182e-27
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.130315533446591e-27
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.5651577667232954e-27
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.825788833616477e-28
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.9128944168082386e-28
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.9564472084041193e-28
EarlyStopping counter: 12 out of 100
Updating learning rate to 9.782236042020597e-29
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.891118021010298e-29
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.445559010505149e-29
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.2227795052525746e-29
EarlyStopping counter: 16 out of 100
Updating learning rate to 6.113897526262873e-30
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.0569487631314364e-30
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.5284743815657182e-30
EarlyStopping counter: 19 out of 100
Updating learning rate to 7.642371907828591e-31
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.8211859539142955e-31
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.9105929769571478e-31
EarlyStopping counter: 22 out of 100
Updating learning rate to 9.552964884785739e-32
EarlyStopping counter: 23 out of 100
Updating learning rate to 4.7764824423928694e-32
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.3882412211964347e-32
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.1941206105982173e-32
EarlyStopping counter: 26 out of 100
Updating learning rate to 5.970603052991087e-33
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.9853015264955434e-33
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.4926507632477717e-33
>>>>>> Testing on validation set: trial_35 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.05182401463389397, mae:0.07532253861427307, dtw:Not calculated


                                                                                       [I 2025-10-17 07:09:19,742] Trial 35 finished with value: 0.07532253861427307 and parameters: {'seq_len': 96, 'pred_len': 1, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 2, 'd_layers': 1, 'batch_size': 16, 'learning_rate': 0.0009460798179810813, 'dropout': 0.06299761759134764}. Best is trial 25 with value: 0.07399702072143555.
Best trial: 25. Best value: 0.073997:  70%|███████   | 35/50 [1:05:29<16:55, 67.68s/it]Best trial: 25. Best value: 0.073997:  70%|███████   | 35/50 [1:05:29<16:55, 67.68s/it]Best trial: 25. Best value: 0.073997:  72%|███████▏  | 36/50 [1:05:29<29:17, 125.57s/it]
============================================================
Trial 36
============================================================
seq_len: 96, pred_len: 1
d_model: 32, n_heads: 8
e_layers: 1, d_layers: 2
batch_size: 64, lr: 0.000578
dropout: 0.0004265211351261733
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 32, expand: 1
>>>>>> Start training: trial_36 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 1
============================================================
train 4577
val 259
test 261
Validation loss decreased (inf --> 0.027674).  Saving model ...
Updating learning rate to 0.0005777317153237747
Validation loss decreased (0.027674 --> 0.023757).  Saving model ...
Updating learning rate to 0.00028886585766188733
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00014443292883094367
Validation loss decreased (0.023757 --> 0.022001).  Saving model ...
Updating learning rate to 7.221646441547183e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.6108232207735916e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8054116103867958e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.027058051933979e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.5135290259669895e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2567645129834948e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1283822564917474e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.641911282458737e-07
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.8209556412293685e-07
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4104778206146842e-07
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.052389103073421e-08
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.5261945515367106e-08
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.7630972757683553e-08
EarlyStopping counter: 13 out of 100
Updating learning rate to 8.815486378841776e-09
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.407743189420888e-09
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.203871594710444e-09
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.101935797355222e-09
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.50967898677611e-10
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.754839493388055e-10
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.3774197466940276e-10
Validation loss decreased (0.022001 --> 0.021617).  Saving model ...
Updating learning rate to 6.887098733470138e-11
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.443549366735069e-11
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.7217746833675345e-11
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.608873416837672e-12
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.304436708418836e-12
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.152218354209418e-12
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.076109177104709e-12
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.380545885523545e-13
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.6902729427617726e-13
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.3451364713808863e-13
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.725682356904432e-14
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.362841178452216e-14
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.681420589226108e-14
EarlyStopping counter: 13 out of 100
Updating learning rate to 8.40710294613054e-15
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.20355147306527e-15
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.101775736532635e-15
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.0508878682663174e-15
Validation loss decreased (0.021617 --> 0.021479).  Saving model ...
Updating learning rate to 5.254439341331587e-16
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.6272196706657936e-16
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3136098353328968e-16
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.568049176664484e-17
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.284024588332242e-17
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.642012294166121e-17
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.210061470830605e-18
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.1050307354153024e-18
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0525153677076512e-18
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.0262576838538256e-18
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.131288419269128e-19
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.565644209634564e-19
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.282822104817282e-19
EarlyStopping counter: 13 out of 100
Updating learning rate to 6.41411052408641e-20
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.207055262043205e-20
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.6035276310216025e-20
EarlyStopping counter: 16 out of 100
Updating learning rate to 8.017638155108013e-21
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.008819077554006e-21
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.004409538777003e-21
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.0022047693885016e-21
EarlyStopping counter: 20 out of 100
Updating learning rate to 5.011023846942508e-22
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.505511923471254e-22
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.252755961735627e-22
EarlyStopping counter: 23 out of 100
Updating learning rate to 6.263779808678135e-23
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.1318899043390674e-23
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.5659449521695337e-23
EarlyStopping counter: 26 out of 100
Updating learning rate to 7.829724760847669e-24
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.914862380423834e-24
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.957431190211917e-24
EarlyStopping counter: 29 out of 100
Updating learning rate to 9.787155951059586e-25
EarlyStopping counter: 30 out of 100
Updating learning rate to 4.893577975529793e-25
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.4467889877648964e-25
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.2233944938824482e-25
EarlyStopping counter: 33 out of 100
Updating learning rate to 6.116972469412241e-26
EarlyStopping counter: 34 out of 100
Updating learning rate to 3.0584862347061205e-26
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.5292431173530603e-26
EarlyStopping counter: 36 out of 100
Updating learning rate to 7.646215586765301e-27
EarlyStopping counter: 37 out of 100
Updating learning rate to 3.823107793382651e-27
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.9115538966913253e-27
EarlyStopping counter: 39 out of 100
Updating learning rate to 9.557769483456627e-28
EarlyStopping counter: 40 out of 100
Updating learning rate to 4.778884741728313e-28
EarlyStopping counter: 41 out of 100
Updating learning rate to 2.3894423708641567e-28
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.1947211854320783e-28
EarlyStopping counter: 43 out of 100
Updating learning rate to 5.973605927160392e-29
EarlyStopping counter: 44 out of 100
Updating learning rate to 2.986802963580196e-29
EarlyStopping counter: 45 out of 100
Updating learning rate to 1.493401481790098e-29
EarlyStopping counter: 46 out of 100
Updating learning rate to 7.46700740895049e-30
EarlyStopping counter: 47 out of 100
Updating learning rate to 3.733503704475245e-30
EarlyStopping counter: 48 out of 100
Updating learning rate to 1.8667518522376224e-30
EarlyStopping counter: 49 out of 100
Updating learning rate to 9.333759261188112e-31
EarlyStopping counter: 50 out of 100
Updating learning rate to 4.666879630594056e-31
EarlyStopping counter: 51 out of 100
Updating learning rate to 2.333439815297028e-31
EarlyStopping counter: 52 out of 100
Updating learning rate to 1.166719907648514e-31
EarlyStopping counter: 53 out of 100
Updating learning rate to 5.83359953824257e-32
EarlyStopping counter: 54 out of 100
Updating learning rate to 2.916799769121285e-32
EarlyStopping counter: 55 out of 100
Updating learning rate to 1.4583998845606425e-32
EarlyStopping counter: 56 out of 100
Updating learning rate to 7.291999422803212e-33
EarlyStopping counter: 57 out of 100
Updating learning rate to 3.645999711401606e-33
EarlyStopping counter: 58 out of 100
Updating learning rate to 1.822999855700803e-33
EarlyStopping counter: 59 out of 100
Updating learning rate to 9.114999278504016e-34
>>>>>> Testing on validation set: trial_36 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.052219562232494354, mae:0.08314407616853714, dtw:Not calculated


                                                                                        [I 2025-10-17 07:10:27,064] Trial 36 finished with value: 0.08314407616853714 and parameters: {'seq_len': 96, 'pred_len': 1, 'expand': 1, 'd_model': 32, 'n_heads': 8, 'e_layers': 1, 'd_layers': 2, 'batch_size': 64, 'learning_rate': 0.0005777317153237747, 'dropout': 0.0004265211351261733}. Best is trial 25 with value: 0.07399702072143555.
Best trial: 25. Best value: 0.073997:  72%|███████▏  | 36/50 [1:06:36<29:17, 125.57s/it]Best trial: 25. Best value: 0.073997:  72%|███████▏  | 36/50 [1:06:36<29:17, 125.57s/it]Best trial: 25. Best value: 0.073997:  74%|███████▍  | 37/50 [1:06:36<23:25, 108.09s/it]
============================================================
Trial 37
============================================================
seq_len: 96, pred_len: 30
d_model: 64, n_heads: 4
e_layers: 1, d_layers: 1
batch_size: 64, lr: 0.000755
dropout: 0.10079581602391194
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_37 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 30
============================================================
train 4548
val 230
test 232
Validation loss decreased (inf --> 0.038348).  Saving model ...
Updating learning rate to 0.0007548729034637013
Validation loss decreased (0.038348 --> 0.036227).  Saving model ...
Updating learning rate to 0.00037743645173185064
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00018871822586592532
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.435911293296266e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.717955646648133e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.3589778233240665e-05
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1794889116620332e-05
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.897444558310166e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.948722279155083e-06
Validation loss decreased (0.036227 --> 0.036185).  Saving model ...
Updating learning rate to 1.4743611395775416e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.371805697887708e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.685902848943854e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.842951424471927e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.214757122359635e-08
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.6073785611798174e-08
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.3036892805899087e-08
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1518446402949543e-08
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.759223201474772e-09
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.879611600737386e-09
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.439805800368693e-09
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.199029001843465e-10
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.5995145009217323e-10
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.7997572504608662e-10
EarlyStopping counter: 14 out of 100
Updating learning rate to 8.998786252304331e-11
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.4993931261521654e-11
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.2496965630760827e-11
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.1248482815380413e-11
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.624241407690207e-12
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.8121207038451034e-12
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.4060603519225517e-12
EarlyStopping counter: 21 out of 100
Updating learning rate to 7.030301759612758e-13
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.515150879806379e-13
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.7575754399031896e-13
EarlyStopping counter: 24 out of 100
Updating learning rate to 8.787877199515948e-14
EarlyStopping counter: 25 out of 100
Updating learning rate to 4.393938599757974e-14
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.196969299878987e-14
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.0984846499394935e-14
EarlyStopping counter: 28 out of 100
Updating learning rate to 5.4924232496974675e-15
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.7462116248487338e-15
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.3731058124243669e-15
EarlyStopping counter: 31 out of 100
Updating learning rate to 6.865529062121834e-16
EarlyStopping counter: 32 out of 100
Updating learning rate to 3.432764531060917e-16
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.7163822655304586e-16
EarlyStopping counter: 34 out of 100
Updating learning rate to 8.581911327652293e-17
EarlyStopping counter: 35 out of 100
Updating learning rate to 4.2909556638261465e-17
EarlyStopping counter: 36 out of 100
Updating learning rate to 2.1454778319130733e-17
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.0727389159565366e-17
EarlyStopping counter: 38 out of 100
Updating learning rate to 5.363694579782683e-18
EarlyStopping counter: 39 out of 100
Updating learning rate to 2.6818472898913416e-18
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.3409236449456708e-18
EarlyStopping counter: 41 out of 100
Updating learning rate to 6.704618224728354e-19
EarlyStopping counter: 42 out of 100
Updating learning rate to 3.352309112364177e-19
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.6761545561820885e-19
EarlyStopping counter: 44 out of 100
Updating learning rate to 8.380772780910442e-20
EarlyStopping counter: 45 out of 100
Updating learning rate to 4.190386390455221e-20
EarlyStopping counter: 46 out of 100
Updating learning rate to 2.0951931952276106e-20
EarlyStopping counter: 47 out of 100
Updating learning rate to 1.0475965976138053e-20
EarlyStopping counter: 48 out of 100
Updating learning rate to 5.2379829880690265e-21
EarlyStopping counter: 49 out of 100
Updating learning rate to 2.6189914940345132e-21
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.3094957470172566e-21
EarlyStopping counter: 51 out of 100
Updating learning rate to 6.547478735086283e-22
EarlyStopping counter: 52 out of 100
Updating learning rate to 3.2737393675431416e-22
EarlyStopping counter: 53 out of 100
Updating learning rate to 1.6368696837715708e-22
EarlyStopping counter: 54 out of 100
Updating learning rate to 8.184348418857854e-23
EarlyStopping counter: 55 out of 100
Updating learning rate to 4.092174209428927e-23
EarlyStopping counter: 56 out of 100
Updating learning rate to 2.0460871047144635e-23
EarlyStopping counter: 57 out of 100
Updating learning rate to 1.0230435523572317e-23
EarlyStopping counter: 58 out of 100
Updating learning rate to 5.115217761786159e-24
EarlyStopping counter: 59 out of 100
Updating learning rate to 2.5576088808930793e-24
EarlyStopping counter: 60 out of 100
Updating learning rate to 1.2788044404465397e-24
EarlyStopping counter: 61 out of 100
Updating learning rate to 6.394022202232698e-25
EarlyStopping counter: 62 out of 100
Updating learning rate to 3.197011101116349e-25
EarlyStopping counter: 63 out of 100
Updating learning rate to 1.5985055505581746e-25
EarlyStopping counter: 64 out of 100
Updating learning rate to 7.992527752790873e-26
EarlyStopping counter: 65 out of 100
Updating learning rate to 3.9962638763954365e-26
EarlyStopping counter: 66 out of 100
Updating learning rate to 1.9981319381977182e-26
EarlyStopping counter: 67 out of 100
Updating learning rate to 9.990659690988591e-27
EarlyStopping counter: 68 out of 100
Updating learning rate to 4.9953298454942956e-27
EarlyStopping counter: 69 out of 100
Updating learning rate to 2.4976649227471478e-27
EarlyStopping counter: 70 out of 100
Updating learning rate to 1.2488324613735739e-27
EarlyStopping counter: 71 out of 100
Updating learning rate to 6.2441623068678695e-28
EarlyStopping counter: 72 out of 100
Updating learning rate to 3.1220811534339347e-28
EarlyStopping counter: 73 out of 100
Updating learning rate to 1.5610405767169674e-28
EarlyStopping counter: 74 out of 100
Updating learning rate to 7.805202883584837e-29
EarlyStopping counter: 75 out of 100
Updating learning rate to 3.9026014417924184e-29
EarlyStopping counter: 76 out of 100
Updating learning rate to 1.9513007208962092e-29
EarlyStopping counter: 77 out of 100
Updating learning rate to 9.756503604481046e-30
EarlyStopping counter: 78 out of 100
Updating learning rate to 4.878251802240523e-30
EarlyStopping counter: 79 out of 100
Updating learning rate to 2.4391259011202615e-30
EarlyStopping counter: 80 out of 100
Updating learning rate to 1.2195629505601308e-30
EarlyStopping counter: 81 out of 100
Updating learning rate to 6.097814752800654e-31
EarlyStopping counter: 82 out of 100
Updating learning rate to 3.048907376400327e-31
EarlyStopping counter: 83 out of 100
Updating learning rate to 1.5244536882001635e-31
EarlyStopping counter: 84 out of 100
Updating learning rate to 7.622268441000817e-32
EarlyStopping counter: 85 out of 100
Updating learning rate to 3.8111342205004086e-32
EarlyStopping counter: 86 out of 100
Updating learning rate to 1.9055671102502043e-32
EarlyStopping counter: 87 out of 100
Updating learning rate to 9.527835551251022e-33
EarlyStopping counter: 88 out of 100
Updating learning rate to 4.763917775625511e-33
EarlyStopping counter: 89 out of 100
Updating learning rate to 2.3819588878127554e-33
EarlyStopping counter: 90 out of 100
Updating learning rate to 1.1909794439063777e-33
>>>>>> Testing on validation set: trial_37 >>>>>>
test 232
test shape: (232, 30, 5) (232, 30, 5)
test shape: (232, 30, 5) (232, 30, 5)


	mse:0.0712863877415657, mae:0.11394814401865005, dtw:Not calculated


                                                                                        [I 2025-10-17 07:11:34,193] Trial 37 finished with value: 0.11394814401865005 and parameters: {'seq_len': 96, 'pred_len': 30, 'expand': 1, 'd_model': 64, 'n_heads': 4, 'e_layers': 1, 'd_layers': 1, 'batch_size': 64, 'learning_rate': 0.0007548729034637013, 'dropout': 0.10079581602391194}. Best is trial 25 with value: 0.07399702072143555.
Best trial: 25. Best value: 0.073997:  74%|███████▍  | 37/50 [1:07:43<23:25, 108.09s/it]Best trial: 25. Best value: 0.073997:  74%|███████▍  | 37/50 [1:07:43<23:25, 108.09s/it]Best trial: 25. Best value: 0.073997:  76%|███████▌  | 38/50 [1:07:43<19:09, 95.80s/it] 
============================================================
Trial 38
============================================================
seq_len: 96, pred_len: 1
d_model: 64, n_heads: 8
e_layers: 2, d_layers: 1
batch_size: 16, lr: 0.000382
dropout: 0.13413002311355446
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_38 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 1
============================================================
train 4577
val 259
test 261
Validation loss decreased (inf --> 0.026222).  Saving model ...
Updating learning rate to 0.0003823343404648072
Validation loss decreased (0.026222 --> 0.026088).  Saving model ...
Updating learning rate to 0.0001911671702324036
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.55835851162018e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.77917925581009e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.389589627905045e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1947948139525225e-05
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.973974069762612e-06
Validation loss decreased (0.026088 --> 0.026036).  Saving model ...
Updating learning rate to 2.986987034881306e-06
Validation loss decreased (0.026036 --> 0.025527).  Saving model ...
Updating learning rate to 1.493493517440653e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.467467587203265e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.7337337936016327e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8668668968008163e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.334334484004082e-08
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.667167242002041e-08
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.3335836210010204e-08
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1667918105005102e-08
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.833959052502551e-09
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.9169795262512755e-09
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.4584897631256378e-09
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.292448815628189e-10
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.6462244078140944e-10
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.8231122039070472e-10
EarlyStopping counter: 14 out of 100
Updating learning rate to 9.115561019535236e-11
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.557780509767618e-11
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.278890254883809e-11
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.1394451274419045e-11
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.6972256372095225e-12
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.8486128186047613e-12
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.4243064093023806e-12
EarlyStopping counter: 21 out of 100
Updating learning rate to 7.121532046511903e-13
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.5607660232559516e-13
Validation loss decreased (0.025527 --> 0.025417).  Saving model ...
Updating learning rate to 1.7803830116279758e-13
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.901915058139879e-14
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.4509575290699395e-14
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2254787645349697e-14
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1127393822674849e-14
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.563696911337424e-15
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.781848455668712e-15
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.390924227834356e-15
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.95462113917178e-16
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.47731056958589e-16
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.738655284792945e-16
EarlyStopping counter: 11 out of 100
Updating learning rate to 8.693276423964726e-17
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.346638211982363e-17
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.1733191059911814e-17
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.0866595529955907e-17
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.4332977649779535e-18
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.7166488824889767e-18
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.3583244412444884e-18
EarlyStopping counter: 18 out of 100
Updating learning rate to 6.791622206222442e-19
Validation loss decreased (0.025417 --> 0.025416).  Saving model ...
Updating learning rate to 3.395811103111221e-19
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6979055515556105e-19
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.489527757778052e-20
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.244763878889026e-20
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.122381939444513e-20
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0611909697222565e-20
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.305954848611283e-21
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.6529774243056413e-21
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3264887121528207e-21
Validation loss decreased (0.025416 --> 0.025348).  Saving model ...
Updating learning rate to 6.632443560764103e-22
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.3162217803820517e-22
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6581108901910258e-22
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.290554450955129e-23
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.1452772254775646e-23
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0726386127387823e-23
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.0363193063693911e-23
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.181596531846956e-24
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.590798265923478e-24
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.295399132961739e-24
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.476995664808695e-25
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.2384978324043473e-25
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.6192489162021737e-25
EarlyStopping counter: 13 out of 100
Updating learning rate to 8.096244581010868e-26
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.048122290505434e-26
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.024061145252717e-26
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.0120305726263585e-26
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.060152863131793e-27
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.5300764315658964e-27
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.2650382157829482e-27
EarlyStopping counter: 20 out of 100
Updating learning rate to 6.325191078914741e-28
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.1625955394573705e-28
Validation loss decreased (0.025348 --> 0.025345).  Saving model ...
Updating learning rate to 1.5812977697286852e-28
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.906488848643426e-29
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.953244424321713e-29
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.9766222121608565e-29
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.883111060804283e-30
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.941555530402141e-30
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.4707777652010707e-30
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.2353888826005353e-30
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.176944413002677e-31
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.0884722065013383e-31
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.5442361032506692e-31
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.721180516253346e-32
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.860590258126673e-32
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.9302951290633365e-32
EarlyStopping counter: 14 out of 100
Updating learning rate to 9.651475645316682e-33
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.825737822658341e-33
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.4128689113291706e-33
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.2064344556645853e-33
EarlyStopping counter: 18 out of 100
Updating learning rate to 6.0321722783229264e-34
>>>>>> Testing on validation set: trial_38 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.05142064765095711, mae:0.07674195617437363, dtw:Not calculated


                                                                                       [I 2025-10-17 07:15:54,612] Trial 38 finished with value: 0.07674195617437363 and parameters: {'seq_len': 96, 'pred_len': 1, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 2, 'd_layers': 1, 'batch_size': 16, 'learning_rate': 0.0003823343404648072, 'dropout': 0.13413002311355446}. Best is trial 25 with value: 0.07399702072143555.
Best trial: 25. Best value: 0.073997:  76%|███████▌  | 38/50 [1:12:03<19:09, 95.80s/it]Best trial: 25. Best value: 0.073997:  76%|███████▌  | 38/50 [1:12:03<19:09, 95.80s/it]Best trial: 25. Best value: 0.073997:  78%|███████▊  | 39/50 [1:12:03<26:37, 145.19s/it]
============================================================
Trial 39
============================================================
seq_len: 48, pred_len: 1
d_model: 32, n_heads: 4
e_layers: 1, d_layers: 2
batch_size: 32, lr: 0.000277
dropout: 0.11410234892162807
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 32, expand: 1
>>>>>> Start training: trial_39 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.032165).  Saving model ...
Updating learning rate to 0.0002771399017124581
Validation loss decreased (0.032165 --> 0.027148).  Saving model ...
Updating learning rate to 0.00013856995085622905
Validation loss decreased (0.027148 --> 0.027116).  Saving model ...
Updating learning rate to 6.928497542811452e-05
Validation loss decreased (0.027116 --> 0.026811).  Saving model ...
Updating learning rate to 3.464248771405726e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.732124385702863e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.660621928514316e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.330310964257158e-06
Validation loss decreased (0.026811 --> 0.025760).  Saving model ...
Updating learning rate to 2.165155482128579e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0825777410642894e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.412888705321447e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7064443526607236e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3532221763303618e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.766110881651809e-08
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.3830554408259045e-08
Validation loss decreased (0.025760 --> 0.025697).  Saving model ...
Updating learning rate to 1.6915277204129522e-08
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.457638602064761e-09
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.228819301032381e-09
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.1144096505161903e-09
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0572048252580952e-09
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.286024126290476e-10
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.643012063145238e-10
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.321506031572619e-10
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.607530157863095e-11
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.3037650789315474e-11
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.6518825394657737e-11
EarlyStopping counter: 11 out of 100
Updating learning rate to 8.259412697328868e-12
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.129706348664434e-12
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.064853174332217e-12
Validation loss decreased (0.025697 --> 0.025639).  Saving model ...
Updating learning rate to 1.0324265871661085e-12
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.162132935830543e-13
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.5810664679152714e-13
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2905332339576357e-13
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.452666169788178e-14
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.226333084894089e-14
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6131665424470446e-14
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.065832712235223e-15
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.0329163561176115e-15
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.0164581780588058e-15
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.0082290890294029e-15
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.041145445147014e-16
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.520572722573507e-16
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.2602863612867536e-16
EarlyStopping counter: 14 out of 100
Updating learning rate to 6.301431806433768e-17
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.150715903216884e-17
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.575357951608442e-17
EarlyStopping counter: 17 out of 100
Updating learning rate to 7.87678975804221e-18
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.938394879021105e-18
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.9691974395105525e-18
EarlyStopping counter: 20 out of 100
Updating learning rate to 9.845987197552762e-19
EarlyStopping counter: 21 out of 100
Updating learning rate to 4.922993598776381e-19
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.4614967993881906e-19
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.2307483996940953e-19
EarlyStopping counter: 24 out of 100
Updating learning rate to 6.153741998470477e-20
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.076870999235238e-20
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.538435499617619e-20
EarlyStopping counter: 27 out of 100
Updating learning rate to 7.692177498088096e-21
EarlyStopping counter: 28 out of 100
Updating learning rate to 3.846088749044048e-21
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.923044374522024e-21
EarlyStopping counter: 30 out of 100
Updating learning rate to 9.61522187261012e-22
EarlyStopping counter: 31 out of 100
Updating learning rate to 4.80761093630506e-22
EarlyStopping counter: 32 out of 100
Updating learning rate to 2.40380546815253e-22
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.201902734076265e-22
EarlyStopping counter: 34 out of 100
Updating learning rate to 6.009513670381325e-23
EarlyStopping counter: 35 out of 100
Updating learning rate to 3.0047568351906624e-23
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.5023784175953312e-23
EarlyStopping counter: 37 out of 100
Updating learning rate to 7.511892087976656e-24
EarlyStopping counter: 38 out of 100
Updating learning rate to 3.755946043988328e-24
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.877973021994164e-24
EarlyStopping counter: 40 out of 100
Updating learning rate to 9.38986510997082e-25
EarlyStopping counter: 41 out of 100
Updating learning rate to 4.69493255498541e-25
EarlyStopping counter: 42 out of 100
Updating learning rate to 2.347466277492705e-25
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.1737331387463525e-25
EarlyStopping counter: 44 out of 100
Updating learning rate to 5.868665693731762e-26
EarlyStopping counter: 45 out of 100
Updating learning rate to 2.934332846865881e-26
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.4671664234329406e-26
EarlyStopping counter: 47 out of 100
Updating learning rate to 7.335832117164703e-27
EarlyStopping counter: 48 out of 100
Updating learning rate to 3.6679160585823515e-27
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.8339580292911758e-27
EarlyStopping counter: 50 out of 100
Updating learning rate to 9.169790146455879e-28
EarlyStopping counter: 51 out of 100
Updating learning rate to 4.584895073227939e-28
EarlyStopping counter: 52 out of 100
Updating learning rate to 2.2924475366139697e-28
EarlyStopping counter: 53 out of 100
Updating learning rate to 1.1462237683069849e-28
EarlyStopping counter: 54 out of 100
Updating learning rate to 5.731118841534924e-29
EarlyStopping counter: 55 out of 100
Updating learning rate to 2.865559420767462e-29
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.432779710383731e-29
EarlyStopping counter: 57 out of 100
Updating learning rate to 7.163898551918655e-30
EarlyStopping counter: 58 out of 100
Updating learning rate to 3.581949275959328e-30
EarlyStopping counter: 59 out of 100
Updating learning rate to 1.790974637979664e-30
EarlyStopping counter: 60 out of 100
Updating learning rate to 8.95487318989832e-31
EarlyStopping counter: 61 out of 100
Updating learning rate to 4.47743659494916e-31
EarlyStopping counter: 62 out of 100
Updating learning rate to 2.23871829747458e-31
EarlyStopping counter: 63 out of 100
Updating learning rate to 1.11935914873729e-31
EarlyStopping counter: 64 out of 100
Updating learning rate to 5.59679574368645e-32
EarlyStopping counter: 65 out of 100
Updating learning rate to 2.798397871843225e-32
EarlyStopping counter: 66 out of 100
Updating learning rate to 1.3991989359216124e-32
EarlyStopping counter: 67 out of 100
Updating learning rate to 6.995994679608062e-33
EarlyStopping counter: 68 out of 100
Updating learning rate to 3.497997339804031e-33
EarlyStopping counter: 69 out of 100
Updating learning rate to 1.7489986699020155e-33
Validation loss decreased (0.025639 --> 0.025618).  Saving model ...
Updating learning rate to 8.744993349510077e-34
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.372496674755039e-34
>>>>>> Testing on validation set: trial_39 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.052035920321941376, mae:0.08057215809822083, dtw:Not calculated


                                                                                        [I 2025-10-17 07:18:06,908] Trial 39 finished with value: 0.08057215809822083 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 1, 'd_model': 32, 'n_heads': 4, 'e_layers': 1, 'd_layers': 2, 'batch_size': 32, 'learning_rate': 0.0002771399017124581, 'dropout': 0.11410234892162807}. Best is trial 25 with value: 0.07399702072143555.
Best trial: 25. Best value: 0.073997:  78%|███████▊  | 39/50 [1:14:16<26:37, 145.19s/it]Best trial: 25. Best value: 0.073997:  78%|███████▊  | 39/50 [1:14:16<26:37, 145.19s/it]Best trial: 25. Best value: 0.073997:  80%|████████  | 40/50 [1:14:16<23:33, 141.32s/it]
============================================================
Trial 40
============================================================
seq_len: 48, pred_len: 7
d_model: 64, n_heads: 8
e_layers: 1, d_layers: 1
batch_size: 64, lr: 0.000137
dropout: 0.1521646899181277
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_40 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 7
============================================================
train 4619
val 253
test 255
Validation loss decreased (inf --> 0.037792).  Saving model ...
Updating learning rate to 0.00013675924434819854
Validation loss decreased (0.037792 --> 0.037344).  Saving model ...
Updating learning rate to 6.837962217409927e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4189811087049636e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.7094905543524818e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.547452771762409e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.2737263858812045e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.1368631929406023e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.0684315964703011e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.342157982351506e-07
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.671078991175753e-07
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.3355394955878764e-07
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.677697477939382e-08
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.338848738969691e-08
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.6694243694848455e-08
EarlyStopping counter: 13 out of 100
Updating learning rate to 8.347121847424228e-09
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.173560923712114e-09
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.086780461856057e-09
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.0433902309280284e-09
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.216951154640142e-10
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.608475577320071e-10
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.3042377886600356e-10
EarlyStopping counter: 20 out of 100
Updating learning rate to 6.521188943300178e-11
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.260594471650089e-11
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.6302972358250445e-11
EarlyStopping counter: 23 out of 100
Updating learning rate to 8.151486179125222e-12
EarlyStopping counter: 24 out of 100
Updating learning rate to 4.075743089562611e-12
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.0378715447813056e-12
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.0189357723906528e-12
EarlyStopping counter: 27 out of 100
Updating learning rate to 5.094678861953264e-13
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.547339430976632e-13
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.273669715488316e-13
EarlyStopping counter: 30 out of 100
Updating learning rate to 6.36834857744158e-14
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.18417428872079e-14
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.592087144360395e-14
EarlyStopping counter: 33 out of 100
Updating learning rate to 7.960435721801975e-15
EarlyStopping counter: 34 out of 100
Updating learning rate to 3.9802178609009874e-15
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.9901089304504937e-15
EarlyStopping counter: 36 out of 100
Updating learning rate to 9.950544652252469e-16
EarlyStopping counter: 37 out of 100
Updating learning rate to 4.975272326126234e-16
EarlyStopping counter: 38 out of 100
Updating learning rate to 2.487636163063117e-16
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.2438180815315586e-16
EarlyStopping counter: 40 out of 100
Updating learning rate to 6.219090407657793e-17
EarlyStopping counter: 41 out of 100
Updating learning rate to 3.1095452038288964e-17
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.5547726019144482e-17
EarlyStopping counter: 43 out of 100
Updating learning rate to 7.773863009572241e-18
EarlyStopping counter: 44 out of 100
Updating learning rate to 3.8869315047861205e-18
EarlyStopping counter: 45 out of 100
Updating learning rate to 1.9434657523930603e-18
EarlyStopping counter: 46 out of 100
Updating learning rate to 9.717328761965301e-19
EarlyStopping counter: 47 out of 100
Updating learning rate to 4.858664380982651e-19
EarlyStopping counter: 48 out of 100
Updating learning rate to 2.4293321904913253e-19
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.2146660952456627e-19
EarlyStopping counter: 50 out of 100
Updating learning rate to 6.073330476228313e-20
EarlyStopping counter: 51 out of 100
Updating learning rate to 3.0366652381141567e-20
EarlyStopping counter: 52 out of 100
Updating learning rate to 1.5183326190570783e-20
EarlyStopping counter: 53 out of 100
Updating learning rate to 7.591663095285392e-21
EarlyStopping counter: 54 out of 100
Updating learning rate to 3.795831547642696e-21
EarlyStopping counter: 55 out of 100
Updating learning rate to 1.897915773821348e-21
EarlyStopping counter: 56 out of 100
Updating learning rate to 9.48957886910674e-22
EarlyStopping counter: 57 out of 100
Updating learning rate to 4.74478943455337e-22
EarlyStopping counter: 58 out of 100
Updating learning rate to 2.372394717276685e-22
EarlyStopping counter: 59 out of 100
Updating learning rate to 1.1861973586383424e-22
EarlyStopping counter: 60 out of 100
Updating learning rate to 5.930986793191712e-23
EarlyStopping counter: 61 out of 100
Updating learning rate to 2.965493396595856e-23
EarlyStopping counter: 62 out of 100
Updating learning rate to 1.482746698297928e-23
EarlyStopping counter: 63 out of 100
Updating learning rate to 7.41373349148964e-24
EarlyStopping counter: 64 out of 100
Updating learning rate to 3.70686674574482e-24
EarlyStopping counter: 65 out of 100
Updating learning rate to 1.85343337287241e-24
EarlyStopping counter: 66 out of 100
Updating learning rate to 9.26716686436205e-25
EarlyStopping counter: 67 out of 100
Updating learning rate to 4.633583432181025e-25
EarlyStopping counter: 68 out of 100
Updating learning rate to 2.3167917160905126e-25
EarlyStopping counter: 69 out of 100
Updating learning rate to 1.1583958580452563e-25
EarlyStopping counter: 70 out of 100
Updating learning rate to 5.791979290226281e-26
EarlyStopping counter: 71 out of 100
Updating learning rate to 2.895989645113141e-26
EarlyStopping counter: 72 out of 100
Updating learning rate to 1.4479948225565704e-26
EarlyStopping counter: 73 out of 100
Updating learning rate to 7.239974112782852e-27
EarlyStopping counter: 74 out of 100
Updating learning rate to 3.619987056391426e-27
EarlyStopping counter: 75 out of 100
Updating learning rate to 1.809993528195713e-27
EarlyStopping counter: 76 out of 100
Updating learning rate to 9.049967640978565e-28
EarlyStopping counter: 77 out of 100
Updating learning rate to 4.524983820489282e-28
EarlyStopping counter: 78 out of 100
Updating learning rate to 2.262491910244641e-28
EarlyStopping counter: 79 out of 100
Updating learning rate to 1.1312459551223206e-28
EarlyStopping counter: 80 out of 100
Updating learning rate to 5.656229775611603e-29
EarlyStopping counter: 81 out of 100
Updating learning rate to 2.8281148878058015e-29
EarlyStopping counter: 82 out of 100
Updating learning rate to 1.4140574439029008e-29
EarlyStopping counter: 83 out of 100
Updating learning rate to 7.070287219514504e-30
EarlyStopping counter: 84 out of 100
Updating learning rate to 3.535143609757252e-30
EarlyStopping counter: 85 out of 100
Updating learning rate to 1.767571804878626e-30
EarlyStopping counter: 86 out of 100
Updating learning rate to 8.83785902439313e-31
EarlyStopping counter: 87 out of 100
Updating learning rate to 4.418929512196565e-31
EarlyStopping counter: 88 out of 100
Updating learning rate to 2.2094647560982824e-31
EarlyStopping counter: 89 out of 100
Updating learning rate to 1.1047323780491412e-31
EarlyStopping counter: 90 out of 100
Updating learning rate to 5.523661890245706e-32
EarlyStopping counter: 91 out of 100
Updating learning rate to 2.761830945122853e-32
EarlyStopping counter: 92 out of 100
Updating learning rate to 1.3809154725614265e-32
EarlyStopping counter: 93 out of 100
Updating learning rate to 6.904577362807133e-33
EarlyStopping counter: 94 out of 100
Updating learning rate to 3.452288681403566e-33
EarlyStopping counter: 95 out of 100
Updating learning rate to 1.726144340701783e-33
EarlyStopping counter: 96 out of 100
Updating learning rate to 8.630721703508916e-34
EarlyStopping counter: 97 out of 100
Updating learning rate to 4.315360851754458e-34
EarlyStopping counter: 98 out of 100
Updating learning rate to 2.157680425877229e-34
>>>>>> Testing on validation set: trial_40 >>>>>>
test 255
test shape: (255, 7, 5) (255, 7, 5)
test shape: (255, 7, 5) (255, 7, 5)


	mse:0.06497153639793396, mae:0.09779759496450424, dtw:Not calculated


                                                                                        [I 2025-10-17 07:19:15,040] Trial 40 finished with value: 0.09779759496450424 and parameters: {'seq_len': 48, 'pred_len': 7, 'expand': 1, 'd_model': 64, 'n_heads': 8, 'e_layers': 1, 'd_layers': 1, 'batch_size': 64, 'learning_rate': 0.00013675924434819854, 'dropout': 0.1521646899181277}. Best is trial 25 with value: 0.07399702072143555.
Best trial: 25. Best value: 0.073997:  80%|████████  | 40/50 [1:15:24<23:33, 141.32s/it]Best trial: 25. Best value: 0.073997:  80%|████████  | 40/50 [1:15:24<23:33, 141.32s/it]Best trial: 25. Best value: 0.073997:  82%|████████▏ | 41/50 [1:15:24<17:54, 119.36s/it]
============================================================
Trial 41
============================================================
seq_len: 96, pred_len: 1
d_model: 64, n_heads: 4
e_layers: 1, d_layers: 1
batch_size: 64, lr: 0.000750
dropout: 0.196941765489703
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_41 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 1
============================================================
train 4577
val 259
test 261
Validation loss decreased (inf --> 0.022975).  Saving model ...
Updating learning rate to 0.0007502909273893535
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00037514546369467675
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.00018757273184733837
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.378636592366919e-05
Validation loss decreased (0.022975 --> 0.021453).  Saving model ...
Updating learning rate to 4.689318296183459e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.3446591480917297e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1723295740458648e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.861647870229324e-06
Validation loss decreased (0.021453 --> 0.021159).  Saving model ...
Updating learning rate to 2.930823935114662e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.465411967557331e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.327059837786655e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.6635299188933276e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8317649594466638e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.158824797233319e-08
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.5794123986166595e-08
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2897061993083297e-08
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.1448530996541649e-08
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.724265498270824e-09
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.862132749135412e-09
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.431066374567706e-09
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.15533187283853e-10
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.577665936419265e-10
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.7888329682096326e-10
EarlyStopping counter: 15 out of 100
Updating learning rate to 8.944164841048163e-11
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.4720824205240815e-11
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.2360412102620408e-11
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.1180206051310204e-11
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.590103025655102e-12
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.795051512827551e-12
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.3975257564137755e-12
EarlyStopping counter: 22 out of 100
Updating learning rate to 6.987628782068877e-13
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.4938143910344387e-13
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.7469071955172193e-13
EarlyStopping counter: 25 out of 100
Updating learning rate to 8.734535977586097e-14
EarlyStopping counter: 26 out of 100
Updating learning rate to 4.3672679887930484e-14
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.1836339943965242e-14
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.0918169971982621e-14
EarlyStopping counter: 29 out of 100
Updating learning rate to 5.4590849859913105e-15
EarlyStopping counter: 30 out of 100
Updating learning rate to 2.7295424929956552e-15
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.3647712464978276e-15
EarlyStopping counter: 32 out of 100
Updating learning rate to 6.823856232489138e-16
EarlyStopping counter: 33 out of 100
Updating learning rate to 3.411928116244569e-16
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.7059640581222845e-16
EarlyStopping counter: 35 out of 100
Updating learning rate to 8.529820290611423e-17
EarlyStopping counter: 36 out of 100
Updating learning rate to 4.264910145305711e-17
Validation loss decreased (0.021159 --> 0.021116).  Saving model ...
Updating learning rate to 2.1324550726528556e-17
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0662275363264278e-17
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.331137681632139e-18
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.6655688408160696e-18
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3327844204080348e-18
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.663922102040174e-19
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.331961051020087e-19
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.6659805255100435e-19
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.329902627550217e-20
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.1649513137751087e-20
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.0824756568875543e-20
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.0412378284437772e-20
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.206189142218886e-21
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.603094571109443e-21
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.3015472855547215e-21
EarlyStopping counter: 15 out of 100
Updating learning rate to 6.507736427773607e-22
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.2538682138868037e-22
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.6269341069434018e-22
EarlyStopping counter: 18 out of 100
Updating learning rate to 8.134670534717009e-23
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.0673352673585046e-23
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.0336676336792523e-23
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.0168338168396261e-23
EarlyStopping counter: 22 out of 100
Updating learning rate to 5.084169084198131e-24
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.5420845420990654e-24
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.2710422710495327e-24
EarlyStopping counter: 25 out of 100
Updating learning rate to 6.355211355247663e-25
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.1776056776238317e-25
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.5888028388119159e-25
EarlyStopping counter: 28 out of 100
Updating learning rate to 7.944014194059579e-26
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.9720070970297896e-26
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.9860035485148948e-26
EarlyStopping counter: 31 out of 100
Updating learning rate to 9.930017742574474e-27
EarlyStopping counter: 32 out of 100
Updating learning rate to 4.965008871287237e-27
EarlyStopping counter: 33 out of 100
Updating learning rate to 2.4825044356436185e-27
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.2412522178218093e-27
EarlyStopping counter: 35 out of 100
Updating learning rate to 6.206261089109046e-28
EarlyStopping counter: 36 out of 100
Updating learning rate to 3.103130544554523e-28
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.5515652722772616e-28
EarlyStopping counter: 38 out of 100
Updating learning rate to 7.757826361386308e-29
EarlyStopping counter: 39 out of 100
Updating learning rate to 3.878913180693154e-29
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.939456590346577e-29
EarlyStopping counter: 41 out of 100
Updating learning rate to 9.697282951732885e-30
EarlyStopping counter: 42 out of 100
Updating learning rate to 4.8486414758664424e-30
Validation loss decreased (0.021116 --> 0.021015).  Saving model ...
Updating learning rate to 2.4243207379332212e-30
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2121603689666106e-30
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.060801844833053e-31
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.0304009224165265e-31
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5152004612082633e-31
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.576002306041316e-32
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.788001153020658e-32
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.894000576510329e-32
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.470002882551645e-33
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.735001441275823e-33
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.3675007206379113e-33
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.1837503603189557e-33
>>>>>> Testing on validation set: trial_41 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.04996485263109207, mae:0.07671826332807541, dtw:Not calculated


                                                                                        [I 2025-10-17 07:20:22,646] Trial 41 finished with value: 0.07671826332807541 and parameters: {'seq_len': 96, 'pred_len': 1, 'expand': 1, 'd_model': 64, 'n_heads': 4, 'e_layers': 1, 'd_layers': 1, 'batch_size': 64, 'learning_rate': 0.0007502909273893535, 'dropout': 0.196941765489703}. Best is trial 25 with value: 0.07399702072143555.
Best trial: 25. Best value: 0.073997:  82%|████████▏ | 41/50 [1:16:31<17:54, 119.36s/it]Best trial: 25. Best value: 0.073997:  82%|████████▏ | 41/50 [1:16:31<17:54, 119.36s/it]Best trial: 25. Best value: 0.073997:  84%|████████▍ | 42/50 [1:16:31<13:50, 103.84s/it]
============================================================
Trial 42
============================================================
seq_len: 96, pred_len: 1
d_model: 64, n_heads: 4
e_layers: 1, d_layers: 1
batch_size: 64, lr: 0.000485
dropout: 0.09726816301522531
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_42 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 1
============================================================
train 4577
val 259
test 261
Validation loss decreased (inf --> 0.030632).  Saving model ...
Updating learning rate to 0.00048530184776301825
Validation loss decreased (0.030632 --> 0.022162).  Saving model ...
Updating learning rate to 0.00024265092388150913
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00012132546194075456
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.066273097037728e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.033136548518864e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.516568274259432e-05
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.58284137129716e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.79142068564858e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.89571034282429e-06
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.47855171412145e-07
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.739275857060725e-07
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.3696379285303626e-07
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.1848189642651813e-07
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.9240948213259064e-08
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.9620474106629532e-08
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.4810237053314766e-08
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.405118526657383e-09
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.7025592633286915e-09
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.8512796316643458e-09
EarlyStopping counter: 18 out of 100
Updating learning rate to 9.256398158321729e-10
Validation loss decreased (0.022162 --> 0.022059).  Saving model ...
Updating learning rate to 4.6281990791608644e-10
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.3140995395804322e-10
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1570497697902161e-10
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.7852488489510805e-11
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.8926244244755402e-11
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4463122122377701e-11
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.231561061188851e-12
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.6157805305944253e-12
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.8078902652972127e-12
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.039451326486063e-13
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.5197256632430316e-13
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.2598628316215158e-13
Validation loss decreased (0.022059 --> 0.021465).  Saving model ...
Updating learning rate to 1.1299314158107579e-13
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.6496570790537895e-14
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.8248285395268948e-14
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4124142697634474e-14
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.062071348817237e-15
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.5310356744086185e-15
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.7655178372043092e-15
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.827589186021546e-16
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.413794593010773e-16
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.2068972965053865e-16
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.1034486482526933e-16
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.5172432412634664e-17
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.7586216206317332e-17
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.3793108103158666e-17
EarlyStopping counter: 14 out of 100
Updating learning rate to 6.896554051579333e-18
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.4482770257896665e-18
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.7241385128948332e-18
EarlyStopping counter: 17 out of 100
Updating learning rate to 8.620692564474166e-19
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.310346282237083e-19
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.1551731411185415e-19
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.0775865705592708e-19
EarlyStopping counter: 21 out of 100
Updating learning rate to 5.387932852796354e-20
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.693966426398177e-20
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.3469832131990885e-20
EarlyStopping counter: 24 out of 100
Updating learning rate to 6.734916065995442e-21
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.367458032997721e-21
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.6837290164988606e-21
EarlyStopping counter: 27 out of 100
Updating learning rate to 8.418645082494303e-22
EarlyStopping counter: 28 out of 100
Updating learning rate to 4.2093225412471515e-22
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.1046612706235757e-22
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.0523306353117879e-22
EarlyStopping counter: 31 out of 100
Updating learning rate to 5.2616531765589393e-23
EarlyStopping counter: 32 out of 100
Updating learning rate to 2.6308265882794697e-23
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.3154132941397348e-23
EarlyStopping counter: 34 out of 100
Updating learning rate to 6.577066470698674e-24
EarlyStopping counter: 35 out of 100
Updating learning rate to 3.288533235349337e-24
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.6442666176746685e-24
EarlyStopping counter: 37 out of 100
Updating learning rate to 8.221333088373343e-25
EarlyStopping counter: 38 out of 100
Updating learning rate to 4.1106665441866713e-25
EarlyStopping counter: 39 out of 100
Updating learning rate to 2.0553332720933357e-25
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.0276666360466678e-25
EarlyStopping counter: 41 out of 100
Updating learning rate to 5.138333180233339e-26
EarlyStopping counter: 42 out of 100
Updating learning rate to 2.5691665901166696e-26
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.2845832950583348e-26
EarlyStopping counter: 44 out of 100
Updating learning rate to 6.422916475291674e-27
EarlyStopping counter: 45 out of 100
Updating learning rate to 3.211458237645837e-27
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.6057291188229185e-27
EarlyStopping counter: 47 out of 100
Updating learning rate to 8.0286455941145925e-28
EarlyStopping counter: 48 out of 100
Updating learning rate to 4.0143227970572962e-28
EarlyStopping counter: 49 out of 100
Updating learning rate to 2.0071613985286481e-28
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.0035806992643241e-28
EarlyStopping counter: 51 out of 100
Updating learning rate to 5.0179034963216203e-29
EarlyStopping counter: 52 out of 100
Updating learning rate to 2.5089517481608101e-29
EarlyStopping counter: 53 out of 100
Updating learning rate to 1.2544758740804051e-29
EarlyStopping counter: 54 out of 100
Updating learning rate to 6.2723793704020254e-30
EarlyStopping counter: 55 out of 100
Updating learning rate to 3.1361896852010127e-30
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.5680948426005063e-30
EarlyStopping counter: 57 out of 100
Updating learning rate to 7.840474213002532e-31
EarlyStopping counter: 58 out of 100
Updating learning rate to 3.920237106501266e-31
EarlyStopping counter: 59 out of 100
Updating learning rate to 1.960118553250633e-31
EarlyStopping counter: 60 out of 100
Updating learning rate to 9.800592766253165e-32
Validation loss decreased (0.021465 --> 0.021344).  Saving model ...
Updating learning rate to 4.9002963831265823e-32
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.4501481915632912e-32
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2250740957816456e-32
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.125370478908228e-33
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.062685239454114e-33
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.531342619727057e-33
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.656713098635285e-34
>>>>>> Testing on validation set: trial_42 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.049451373517513275, mae:0.07614598423242569, dtw:Not calculated


                                                                                        [I 2025-10-17 07:21:30,610] Trial 42 finished with value: 0.07614598423242569 and parameters: {'seq_len': 96, 'pred_len': 1, 'expand': 1, 'd_model': 64, 'n_heads': 4, 'e_layers': 1, 'd_layers': 1, 'batch_size': 64, 'learning_rate': 0.00048530184776301825, 'dropout': 0.09726816301522531}. Best is trial 25 with value: 0.07399702072143555.
Best trial: 25. Best value: 0.073997:  84%|████████▍ | 42/50 [1:17:39<13:50, 103.84s/it]Best trial: 25. Best value: 0.073997:  84%|████████▍ | 42/50 [1:17:39<13:50, 103.84s/it]Best trial: 25. Best value: 0.073997:  86%|████████▌ | 43/50 [1:17:39<10:51, 93.08s/it] 
============================================================
Trial 43
============================================================
seq_len: 96, pred_len: 1
d_model: 64, n_heads: 4
e_layers: 1, d_layers: 1
batch_size: 64, lr: 0.000960
dropout: 0.048492164835469226
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_43 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 1
============================================================
train 4577
val 259
test 261
Validation loss decreased (inf --> 0.024105).  Saving model ...
Updating learning rate to 0.0009603042935620075
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00048015214678100377
Validation loss decreased (0.024105 --> 0.023126).  Saving model ...
Updating learning rate to 0.00024007607339050188
Validation loss decreased (0.023126 --> 0.022766).  Saving model ...
Updating learning rate to 0.00012003803669525094
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.001901834762547e-05
Validation loss decreased (0.022766 --> 0.022351).  Saving model ...
Updating learning rate to 3.0009509173812735e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5004754586906368e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.502377293453184e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.751188646726592e-06
Validation loss decreased (0.022351 --> 0.021809).  Saving model ...
Updating learning rate to 1.875594323363296e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.37797161681648e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.68898580840824e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.34449290420412e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.17224645210206e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8612322605103e-08
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.93061613025515e-08
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.465308065127575e-08
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.326540325637875e-09
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.6632701628189374e-09
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.8316350814094687e-09
EarlyStopping counter: 11 out of 100
Updating learning rate to 9.158175407047344e-10
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.579087703523672e-10
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.289543851761836e-10
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.144771925880918e-10
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.72385962940459e-11
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.861929814702295e-11
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.4309649073511474e-11
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.154824536755737e-12
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.5774122683778686e-12
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.7887061341889343e-12
EarlyStopping counter: 21 out of 100
Updating learning rate to 8.943530670944671e-13
EarlyStopping counter: 22 out of 100
Updating learning rate to 4.4717653354723357e-13
Validation loss decreased (0.021809 --> 0.021702).  Saving model ...
Updating learning rate to 2.2358826677361679e-13
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1179413338680839e-13
Validation loss decreased (0.021702 --> 0.021597).  Saving model ...
Updating learning rate to 5.5897066693404197e-14
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7948533346702098e-14
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3974266673351049e-14
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.9871333366755246e-15
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4935666683377623e-15
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.7467833341688811e-15
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.733916670844406e-16
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.366958335422203e-16
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.1834791677111014e-16
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.0917395838555507e-16
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.4586979192777536e-17
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7293489596388768e-17
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.3646744798194384e-17
EarlyStopping counter: 13 out of 100
Updating learning rate to 6.823372399097192e-18
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.411686199548596e-18
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.705843099774298e-18
EarlyStopping counter: 16 out of 100
Updating learning rate to 8.52921549887149e-19
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.264607749435745e-19
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.1323038747178725e-19
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.0661519373589362e-19
Validation loss decreased (0.021597 --> 0.021521).  Saving model ...
Updating learning rate to 5.330759686794681e-20
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.6653798433973406e-20
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3326899216986703e-20
Validation loss decreased (0.021521 --> 0.021461).  Saving model ...
Updating learning rate to 6.6634496084933515e-21
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.3317248042466758e-21
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6658624021233379e-21
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.329312010616689e-22
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.1646560053083447e-22
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0823280026541724e-22
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.0411640013270862e-22
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.205820006635431e-23
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.6029100033177154e-23
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.3014550016588577e-23
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.5072750082942886e-24
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.2536375041471443e-24
Validation loss decreased (0.021461 --> 0.021325).  Saving model ...
Updating learning rate to 1.6268187520735722e-24
Validation loss decreased (0.021325 --> 0.021259).  Saving model ...
Updating learning rate to 8.134093760367861e-25
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.0670468801839304e-25
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0335234400919652e-25
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0167617200459826e-25
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.083808600229913e-26
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.5419043001149565e-26
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.2709521500574782e-26
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.354760750287391e-27
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.1773803751436956e-27
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.5886901875718478e-27
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.943450937859239e-28
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.9717254689296195e-28
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.9858627344648098e-28
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.929313672324049e-29
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.9646568361620244e-29
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.4823284180810122e-29
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.2411642090405061e-29
EarlyStopping counter: 17 out of 100
Updating learning rate to 6.2058210452025305e-30
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.1029105226012652e-30
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.5514552613006326e-30
EarlyStopping counter: 20 out of 100
Updating learning rate to 7.757276306503163e-31
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.8786381532515816e-31
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.9393190766257908e-31
EarlyStopping counter: 23 out of 100
Updating learning rate to 9.696595383128954e-32
EarlyStopping counter: 24 out of 100
Updating learning rate to 4.848297691564477e-32
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.4241488457822385e-32
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.2120744228911192e-32
EarlyStopping counter: 27 out of 100
Updating learning rate to 6.060372114455596e-33
EarlyStopping counter: 28 out of 100
Updating learning rate to 3.030186057227798e-33
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.515093028613899e-33
>>>>>> Testing on validation set: trial_43 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.05064905807375908, mae:0.07572697103023529, dtw:Not calculated


                                                                                       [I 2025-10-17 07:22:38,430] Trial 43 finished with value: 0.07572697103023529 and parameters: {'seq_len': 96, 'pred_len': 1, 'expand': 1, 'd_model': 64, 'n_heads': 4, 'e_layers': 1, 'd_layers': 1, 'batch_size': 64, 'learning_rate': 0.0009603042935620075, 'dropout': 0.048492164835469226}. Best is trial 25 with value: 0.07399702072143555.
Best trial: 25. Best value: 0.073997:  86%|████████▌ | 43/50 [1:18:47<10:51, 93.08s/it]Best trial: 25. Best value: 0.073997:  86%|████████▌ | 43/50 [1:18:47<10:51, 93.08s/it]Best trial: 25. Best value: 0.073997:  88%|████████▊ | 44/50 [1:18:47<08:32, 85.50s/it]
============================================================
Trial 44
============================================================
seq_len: 96, pred_len: 1
d_model: 64, n_heads: 4
e_layers: 1, d_layers: 1
batch_size: 16, lr: 0.000730
dropout: 0.17516767536248093
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_44 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 1
============================================================
train 4577
val 259
test 261
Validation loss decreased (inf --> 0.026056).  Saving model ...
Updating learning rate to 0.0007297186309209869
Validation loss decreased (0.026056 --> 0.025434).  Saving model ...
Updating learning rate to 0.00036485931546049343
Validation loss decreased (0.025434 --> 0.024791).  Saving model ...
Updating learning rate to 0.00018242965773024672
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.121482886512336e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.560741443256168e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.280370721628084e-05
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.140185360814042e-05
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.70092680407021e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.850463402035105e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4252317010175525e-06
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.126158505087762e-07
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.563079252543881e-07
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.7815396262719406e-07
EarlyStopping counter: 11 out of 100
Updating learning rate to 8.907698131359703e-08
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.4538490656798515e-08
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.2269245328399257e-08
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.1134622664199629e-08
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.567311332099814e-09
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.783655666049907e-09
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.3918278330249536e-09
EarlyStopping counter: 18 out of 100
Updating learning rate to 6.959139165124768e-10
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.479569582562384e-10
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.739784791281192e-10
EarlyStopping counter: 21 out of 100
Updating learning rate to 8.69892395640596e-11
EarlyStopping counter: 22 out of 100
Updating learning rate to 4.34946197820298e-11
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.17473098910149e-11
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.087365494550745e-11
EarlyStopping counter: 25 out of 100
Updating learning rate to 5.436827472753725e-12
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.7184137363768625e-12
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.3592068681884312e-12
EarlyStopping counter: 28 out of 100
Updating learning rate to 6.796034340942156e-13
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.398017170471078e-13
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.699008585235539e-13
EarlyStopping counter: 31 out of 100
Updating learning rate to 8.495042926177695e-14
EarlyStopping counter: 32 out of 100
Updating learning rate to 4.2475214630888476e-14
Validation loss decreased (0.024791 --> 0.024760).  Saving model ...
Updating learning rate to 2.1237607315444238e-14
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0618803657722119e-14
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.3094018288610595e-15
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.6547009144305298e-15
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3273504572152649e-15
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.636752286076324e-16
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.318376143038162e-16
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.659188071519081e-16
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.295940357595405e-17
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.147970178797703e-17
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.0739850893988514e-17
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.0369925446994257e-17
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.1849627234971284e-18
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.5924813617485642e-18
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.2962406808742821e-18
EarlyStopping counter: 15 out of 100
Updating learning rate to 6.481203404371411e-19
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.2406017021857053e-19
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.6203008510928526e-19
EarlyStopping counter: 18 out of 100
Updating learning rate to 8.101504255464263e-20
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.0507521277321316e-20
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.0253760638660658e-20
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.0126880319330329e-20
EarlyStopping counter: 22 out of 100
Updating learning rate to 5.0634401596651645e-21
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.5317200798325822e-21
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.2658600399162911e-21
EarlyStopping counter: 25 out of 100
Updating learning rate to 6.329300199581456e-22
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.164650099790728e-22
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.582325049895364e-22
EarlyStopping counter: 28 out of 100
Updating learning rate to 7.91162524947682e-23
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.95581262473841e-23
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.977906312369205e-23
EarlyStopping counter: 31 out of 100
Updating learning rate to 9.889531561846024e-24
EarlyStopping counter: 32 out of 100
Updating learning rate to 4.944765780923012e-24
EarlyStopping counter: 33 out of 100
Updating learning rate to 2.472382890461506e-24
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.236191445230753e-24
EarlyStopping counter: 35 out of 100
Updating learning rate to 6.180957226153765e-25
EarlyStopping counter: 36 out of 100
Updating learning rate to 3.0904786130768826e-25
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.5452393065384413e-25
EarlyStopping counter: 38 out of 100
Updating learning rate to 7.726196532692207e-26
EarlyStopping counter: 39 out of 100
Updating learning rate to 3.863098266346103e-26
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.9315491331730516e-26
EarlyStopping counter: 41 out of 100
Updating learning rate to 9.657745665865258e-27
EarlyStopping counter: 42 out of 100
Updating learning rate to 4.828872832932629e-27
EarlyStopping counter: 43 out of 100
Updating learning rate to 2.4144364164663145e-27
EarlyStopping counter: 44 out of 100
Updating learning rate to 1.2072182082331573e-27
EarlyStopping counter: 45 out of 100
Updating learning rate to 6.036091041165786e-28
EarlyStopping counter: 46 out of 100
Updating learning rate to 3.018045520582893e-28
EarlyStopping counter: 47 out of 100
Updating learning rate to 1.5090227602914466e-28
EarlyStopping counter: 48 out of 100
Updating learning rate to 7.545113801457233e-29
EarlyStopping counter: 49 out of 100
Updating learning rate to 3.7725569007286165e-29
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.8862784503643082e-29
EarlyStopping counter: 51 out of 100
Updating learning rate to 9.431392251821541e-30
EarlyStopping counter: 52 out of 100
Updating learning rate to 4.7156961259107706e-30
EarlyStopping counter: 53 out of 100
Updating learning rate to 2.3578480629553853e-30
EarlyStopping counter: 54 out of 100
Updating learning rate to 1.1789240314776926e-30
EarlyStopping counter: 55 out of 100
Updating learning rate to 5.894620157388463e-31
EarlyStopping counter: 56 out of 100
Updating learning rate to 2.9473100786942316e-31
EarlyStopping counter: 57 out of 100
Updating learning rate to 1.4736550393471158e-31
EarlyStopping counter: 58 out of 100
Updating learning rate to 7.368275196735579e-32
EarlyStopping counter: 59 out of 100
Updating learning rate to 3.6841375983677895e-32
EarlyStopping counter: 60 out of 100
Updating learning rate to 1.8420687991838948e-32
EarlyStopping counter: 61 out of 100
Updating learning rate to 9.210343995919474e-33
EarlyStopping counter: 62 out of 100
Updating learning rate to 4.605171997959737e-33
EarlyStopping counter: 63 out of 100
Updating learning rate to 2.3025859989798685e-33
EarlyStopping counter: 64 out of 100
Updating learning rate to 1.1512929994899342e-33
>>>>>> Testing on validation set: trial_44 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.04997881129384041, mae:0.07358504831790924, dtw:Not calculated


                                                                                       [I 2025-10-17 07:26:59,018] Trial 44 finished with value: 0.07358504831790924 and parameters: {'seq_len': 96, 'pred_len': 1, 'expand': 1, 'd_model': 64, 'n_heads': 4, 'e_layers': 1, 'd_layers': 1, 'batch_size': 16, 'learning_rate': 0.0007297186309209869, 'dropout': 0.17516767536248093}. Best is trial 44 with value: 0.07358504831790924.
Best trial: 25. Best value: 0.073997:  88%|████████▊ | 44/50 [1:23:08<08:32, 85.50s/it]Best trial: 44. Best value: 0.073585:  88%|████████▊ | 44/50 [1:23:08<08:32, 85.50s/it]Best trial: 44. Best value: 0.073585:  90%|█████████ | 45/50 [1:23:08<11:30, 138.02s/it]
============================================================
Trial 45
============================================================
seq_len: 96, pred_len: 1
d_model: 64, n_heads: 4
e_layers: 1, d_layers: 1
batch_size: 16, lr: 0.000599
dropout: 0.18083359034266835
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_45 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 1
============================================================
train 4577
val 259
test 261
Validation loss decreased (inf --> 0.026270).  Saving model ...
Updating learning rate to 0.0005987807478130086
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0002993903739065043
Validation loss decreased (0.026270 --> 0.025734).  Saving model ...
Updating learning rate to 0.00014969518695325215
Validation loss decreased (0.025734 --> 0.024824).  Saving model ...
Updating learning rate to 7.484759347662608e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.742379673831304e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.871189836915652e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.35594918457826e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.67797459228913e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.338987296144565e-06
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1694936480722824e-06
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.847468240361412e-07
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.923734120180706e-07
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.461867060090353e-07
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.309335300451765e-08
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.6546676502258826e-08
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.8273338251129413e-08
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.136669125564706e-09
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.568334562782353e-09
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.2841672813911766e-09
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.1420836406955883e-09
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.710418203477942e-10
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.855209101738971e-10
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.4276045508694854e-10
EarlyStopping counter: 20 out of 100
Updating learning rate to 7.138022754347427e-11
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.5690113771737135e-11
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.7845056885868567e-11
EarlyStopping counter: 23 out of 100
Updating learning rate to 8.922528442934284e-12
EarlyStopping counter: 24 out of 100
Updating learning rate to 4.461264221467142e-12
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.230632110733571e-12
Validation loss decreased (0.024824 --> 0.024751).  Saving model ...
Updating learning rate to 1.1153160553667855e-12
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.576580276833927e-13
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7882901384169636e-13
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3941450692084818e-13
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.970725346042409e-14
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4853626730212046e-14
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.7426813365106023e-14
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.713406682553011e-15
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.356703341276506e-15
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.178351670638253e-15
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.0891758353191264e-15
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.445879176595632e-16
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.722939588297816e-16
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.361469794148908e-16
EarlyStopping counter: 14 out of 100
Updating learning rate to 6.80734897074454e-17
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.40367448537227e-17
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.701837242686135e-17
EarlyStopping counter: 17 out of 100
Updating learning rate to 8.509186213430675e-18
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.2545931067153376e-18
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.1272965533576688e-18
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.0636482766788344e-18
EarlyStopping counter: 21 out of 100
Updating learning rate to 5.318241383394172e-19
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.659120691697086e-19
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.329560345848543e-19
EarlyStopping counter: 24 out of 100
Updating learning rate to 6.647801729242715e-20
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.3239008646213575e-20
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.6619504323106787e-20
EarlyStopping counter: 27 out of 100
Updating learning rate to 8.309752161553394e-21
EarlyStopping counter: 28 out of 100
Updating learning rate to 4.154876080776697e-21
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.0774380403883484e-21
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.0387190201941742e-21
EarlyStopping counter: 31 out of 100
Updating learning rate to 5.193595100970871e-22
EarlyStopping counter: 32 out of 100
Updating learning rate to 2.5967975504854355e-22
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.2983987752427178e-22
EarlyStopping counter: 34 out of 100
Updating learning rate to 6.491993876213589e-23
EarlyStopping counter: 35 out of 100
Updating learning rate to 3.2459969381067944e-23
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.6229984690533972e-23
EarlyStopping counter: 37 out of 100
Updating learning rate to 8.114992345266986e-24
EarlyStopping counter: 38 out of 100
Updating learning rate to 4.057496172633493e-24
EarlyStopping counter: 39 out of 100
Updating learning rate to 2.0287480863167465e-24
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.0143740431583733e-24
EarlyStopping counter: 41 out of 100
Updating learning rate to 5.071870215791866e-25
EarlyStopping counter: 42 out of 100
Updating learning rate to 2.535935107895933e-25
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.2679675539479666e-25
EarlyStopping counter: 44 out of 100
Updating learning rate to 6.339837769739833e-26
EarlyStopping counter: 45 out of 100
Updating learning rate to 3.1699188848699164e-26
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.5849594424349582e-26
EarlyStopping counter: 47 out of 100
Updating learning rate to 7.924797212174791e-27
EarlyStopping counter: 48 out of 100
Updating learning rate to 3.9623986060873955e-27
EarlyStopping counter: 49 out of 100
Updating learning rate to 1.9811993030436978e-27
EarlyStopping counter: 50 out of 100
Updating learning rate to 9.905996515218489e-28
EarlyStopping counter: 51 out of 100
Updating learning rate to 4.952998257609244e-28
EarlyStopping counter: 52 out of 100
Updating learning rate to 2.476499128804622e-28
EarlyStopping counter: 53 out of 100
Updating learning rate to 1.238249564402311e-28
EarlyStopping counter: 54 out of 100
Updating learning rate to 6.191247822011556e-29
EarlyStopping counter: 55 out of 100
Updating learning rate to 3.095623911005778e-29
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.547811955502889e-29
EarlyStopping counter: 57 out of 100
Updating learning rate to 7.739059777514444e-30
EarlyStopping counter: 58 out of 100
Updating learning rate to 3.869529888757222e-30
EarlyStopping counter: 59 out of 100
Updating learning rate to 1.934764944378611e-30
EarlyStopping counter: 60 out of 100
Updating learning rate to 9.673824721893056e-31
EarlyStopping counter: 61 out of 100
Updating learning rate to 4.836912360946528e-31
EarlyStopping counter: 62 out of 100
Updating learning rate to 2.418456180473264e-31
EarlyStopping counter: 63 out of 100
Updating learning rate to 1.209228090236632e-31
EarlyStopping counter: 64 out of 100
Updating learning rate to 6.04614045118316e-32
EarlyStopping counter: 65 out of 100
Updating learning rate to 3.02307022559158e-32
EarlyStopping counter: 66 out of 100
Updating learning rate to 1.51153511279579e-32
EarlyStopping counter: 67 out of 100
Updating learning rate to 7.55767556397895e-33
EarlyStopping counter: 68 out of 100
Updating learning rate to 3.778837781989475e-33
EarlyStopping counter: 69 out of 100
Updating learning rate to 1.8894188909947374e-33
EarlyStopping counter: 70 out of 100
Updating learning rate to 9.447094454973687e-34
>>>>>> Testing on validation set: trial_45 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.04993635043501854, mae:0.0737231969833374, dtw:Not calculated


                                                                                        [I 2025-10-17 07:31:19,338] Trial 45 finished with value: 0.0737231969833374 and parameters: {'seq_len': 96, 'pred_len': 1, 'expand': 1, 'd_model': 64, 'n_heads': 4, 'e_layers': 1, 'd_layers': 1, 'batch_size': 16, 'learning_rate': 0.0005987807478130086, 'dropout': 0.18083359034266835}. Best is trial 44 with value: 0.07358504831790924.
Best trial: 44. Best value: 0.073585:  90%|█████████ | 45/50 [1:27:28<11:30, 138.02s/it]Best trial: 44. Best value: 0.073585:  90%|█████████ | 45/50 [1:27:28<11:30, 138.02s/it]Best trial: 44. Best value: 0.073585:  92%|█████████▏| 46/50 [1:27:28<11:38, 174.71s/it]
============================================================
Trial 46
============================================================
seq_len: 48, pred_len: 14
d_model: 64, n_heads: 4
e_layers: 1, d_layers: 2
batch_size: 16, lr: 0.000042
dropout: 0.18081256463131168
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_46 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 14
============================================================
train 4612
val 246
test 248
Validation loss decreased (inf --> 0.038837).  Saving model ...
Updating learning rate to 4.2125357186817525e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.1062678593408763e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0531339296704381e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.265669648352191e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.6328348241760953e-06
Validation loss decreased (0.038837 --> 0.038531).  Saving model ...
Updating learning rate to 1.3164174120880477e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.582087060440238e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.291043530220119e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6455217651100596e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.227608825550298e-08
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.113804412775149e-08
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0569022063875745e-08
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.0284511031937872e-08
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.142255515968936e-09
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.571127757984468e-09
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.285563878992234e-09
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.42781939496117e-10
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.213909697480585e-10
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.6069548487402926e-10
EarlyStopping counter: 14 out of 100
Updating learning rate to 8.034774243701463e-11
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.0173871218507314e-11
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.0086935609253657e-11
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.0043467804626828e-11
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.021733902313414e-12
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.510866951156707e-12
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.2554334755783536e-12
EarlyStopping counter: 21 out of 100
Updating learning rate to 6.277167377891768e-13
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.138583688945884e-13
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.569291844472942e-13
EarlyStopping counter: 24 out of 100
Updating learning rate to 7.84645922236471e-14
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.923229611182355e-14
EarlyStopping counter: 26 out of 100
Updating learning rate to 1.9616148055911774e-14
EarlyStopping counter: 27 out of 100
Updating learning rate to 9.808074027955887e-15
EarlyStopping counter: 28 out of 100
Updating learning rate to 4.9040370139779436e-15
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.4520185069889718e-15
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.2260092534944859e-15
EarlyStopping counter: 31 out of 100
Updating learning rate to 6.130046267472429e-16
EarlyStopping counter: 32 out of 100
Updating learning rate to 3.0650231337362147e-16
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.5325115668681074e-16
EarlyStopping counter: 34 out of 100
Updating learning rate to 7.662557834340537e-17
EarlyStopping counter: 35 out of 100
Updating learning rate to 3.8312789171702684e-17
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.9156394585851342e-17
EarlyStopping counter: 37 out of 100
Updating learning rate to 9.578197292925671e-18
EarlyStopping counter: 38 out of 100
Updating learning rate to 4.7890986464628355e-18
EarlyStopping counter: 39 out of 100
Updating learning rate to 2.3945493232314178e-18
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.1972746616157089e-18
EarlyStopping counter: 41 out of 100
Updating learning rate to 5.986373308078544e-19
EarlyStopping counter: 42 out of 100
Updating learning rate to 2.993186654039272e-19
EarlyStopping counter: 43 out of 100
Updating learning rate to 1.496593327019636e-19
EarlyStopping counter: 44 out of 100
Updating learning rate to 7.48296663509818e-20
EarlyStopping counter: 45 out of 100
Updating learning rate to 3.74148331754909e-20
EarlyStopping counter: 46 out of 100
Updating learning rate to 1.870741658774545e-20
EarlyStopping counter: 47 out of 100
Updating learning rate to 9.353708293872726e-21
EarlyStopping counter: 48 out of 100
Updating learning rate to 4.676854146936363e-21
EarlyStopping counter: 49 out of 100
Updating learning rate to 2.3384270734681814e-21
EarlyStopping counter: 50 out of 100
Updating learning rate to 1.1692135367340907e-21
EarlyStopping counter: 51 out of 100
Updating learning rate to 5.8460676836704535e-22
EarlyStopping counter: 52 out of 100
Updating learning rate to 2.9230338418352268e-22
EarlyStopping counter: 53 out of 100
Updating learning rate to 1.4615169209176134e-22
EarlyStopping counter: 54 out of 100
Updating learning rate to 7.307584604588067e-23
EarlyStopping counter: 55 out of 100
Updating learning rate to 3.6537923022940335e-23
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.8268961511470167e-23
EarlyStopping counter: 57 out of 100
Updating learning rate to 9.134480755735084e-24
EarlyStopping counter: 58 out of 100
Updating learning rate to 4.567240377867542e-24
EarlyStopping counter: 59 out of 100
Updating learning rate to 2.283620188933771e-24
EarlyStopping counter: 60 out of 100
Updating learning rate to 1.1418100944668855e-24
EarlyStopping counter: 61 out of 100
Updating learning rate to 5.709050472334427e-25
EarlyStopping counter: 62 out of 100
Updating learning rate to 2.8545252361672136e-25
EarlyStopping counter: 63 out of 100
Updating learning rate to 1.4272626180836068e-25
EarlyStopping counter: 64 out of 100
Updating learning rate to 7.136313090418034e-26
EarlyStopping counter: 65 out of 100
Updating learning rate to 3.568156545209017e-26
EarlyStopping counter: 66 out of 100
Updating learning rate to 1.7840782726045085e-26
EarlyStopping counter: 67 out of 100
Updating learning rate to 8.920391363022543e-27
EarlyStopping counter: 68 out of 100
Updating learning rate to 4.460195681511271e-27
EarlyStopping counter: 69 out of 100
Updating learning rate to 2.2300978407556357e-27
EarlyStopping counter: 70 out of 100
Updating learning rate to 1.1150489203778178e-27
EarlyStopping counter: 71 out of 100
Updating learning rate to 5.575244601889089e-28
EarlyStopping counter: 72 out of 100
Updating learning rate to 2.7876223009445446e-28
EarlyStopping counter: 73 out of 100
Updating learning rate to 1.3938111504722723e-28
EarlyStopping counter: 74 out of 100
Updating learning rate to 6.969055752361361e-29
EarlyStopping counter: 75 out of 100
Updating learning rate to 3.4845278761806807e-29
EarlyStopping counter: 76 out of 100
Updating learning rate to 1.7422639380903404e-29
EarlyStopping counter: 77 out of 100
Updating learning rate to 8.711319690451702e-30
EarlyStopping counter: 78 out of 100
Updating learning rate to 4.355659845225851e-30
EarlyStopping counter: 79 out of 100
Updating learning rate to 2.1778299226129254e-30
EarlyStopping counter: 80 out of 100
Updating learning rate to 1.0889149613064627e-30
EarlyStopping counter: 81 out of 100
Updating learning rate to 5.444574806532314e-31
EarlyStopping counter: 82 out of 100
Updating learning rate to 2.722287403266157e-31
EarlyStopping counter: 83 out of 100
Updating learning rate to 1.3611437016330784e-31
EarlyStopping counter: 84 out of 100
Updating learning rate to 6.805718508165392e-32
EarlyStopping counter: 85 out of 100
Updating learning rate to 3.402859254082696e-32
EarlyStopping counter: 86 out of 100
Updating learning rate to 1.701429627041348e-32
EarlyStopping counter: 87 out of 100
Updating learning rate to 8.50714813520674e-33
EarlyStopping counter: 88 out of 100
Updating learning rate to 4.25357406760337e-33
EarlyStopping counter: 89 out of 100
Updating learning rate to 2.126787033801685e-33
EarlyStopping counter: 90 out of 100
Updating learning rate to 1.0633935169008425e-33
EarlyStopping counter: 91 out of 100
Updating learning rate to 5.3169675845042125e-34
EarlyStopping counter: 92 out of 100
Updating learning rate to 2.6584837922521063e-34
EarlyStopping counter: 93 out of 100
Updating learning rate to 1.3292418961260531e-34
EarlyStopping counter: 94 out of 100
Updating learning rate to 6.646209480630266e-35
>>>>>> Testing on validation set: trial_46 >>>>>>
test 248
test shape: (248, 14, 5) (248, 14, 5)
test shape: (248, 14, 5) (248, 14, 5)


	mse:0.06485734134912491, mae:0.0984705239534378, dtw:Not calculated


                                                                                        [I 2025-10-17 07:35:40,610] Trial 46 finished with value: 0.0984705239534378 and parameters: {'seq_len': 48, 'pred_len': 14, 'expand': 1, 'd_model': 64, 'n_heads': 4, 'e_layers': 1, 'd_layers': 2, 'batch_size': 16, 'learning_rate': 4.2125357186817525e-05, 'dropout': 0.18081256463131168}. Best is trial 44 with value: 0.07358504831790924.
Best trial: 44. Best value: 0.073585:  92%|█████████▏| 46/50 [1:31:49<11:38, 174.71s/it]Best trial: 44. Best value: 0.073585:  92%|█████████▏| 46/50 [1:31:49<11:38, 174.71s/it]Best trial: 44. Best value: 0.073585:  94%|█████████▍| 47/50 [1:31:49<10:02, 200.68s/it]
============================================================
Trial 47
============================================================
seq_len: 96, pred_len: 1
d_model: 32, n_heads: 4
e_layers: 1, d_layers: 1
batch_size: 16, lr: 0.000633
dropout: 0.2154206453119898
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 32, d_state: 16, d_inner: 32, expand: 1
>>>>>> Start training: trial_47 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 1
============================================================
train 4577
val 259
test 261
Validation loss decreased (inf --> 0.027900).  Saving model ...
Updating learning rate to 0.0006332535430252966
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0003166267715126483
EarlyStopping counter: 2 out of 100
Updating learning rate to 0.00015831338575632414
Validation loss decreased (0.027900 --> 0.025817).  Saving model ...
Updating learning rate to 7.915669287816207e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.9578346439081035e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.9789173219540518e-05
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.894586609770259e-06
Validation loss decreased (0.025817 --> 0.025408).  Saving model ...
Updating learning rate to 4.9472933048851294e-06
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.4736466524425647e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2368233262212824e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.184116631106412e-07
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.092058315553206e-07
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.546029157776603e-07
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.730145788883015e-08
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.8650728944415074e-08
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.9325364472207537e-08
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.662682236103768e-09
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.831341118051884e-09
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.415670559025942e-09
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.207835279512971e-09
EarlyStopping counter: 13 out of 100
Updating learning rate to 6.039176397564855e-10
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.0195881987824276e-10
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.5097940993912138e-10
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.548970496956069e-11
Validation loss decreased (0.025408 --> 0.025403).  Saving model ...
Updating learning rate to 3.7744852484780345e-11
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8872426242390173e-11
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.436213121195086e-12
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.718106560597543e-12
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.3590532802987716e-12
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1795266401493858e-12
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.897633200746929e-13
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.9488166003734645e-13
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.4744083001867322e-13
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.372041500933661e-14
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.6860207504668306e-14
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.8430103752334153e-14
EarlyStopping counter: 12 out of 100
Updating learning rate to 9.215051876167077e-15
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.607525938083538e-15
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.303762969041769e-15
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.1518814845208846e-15
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.759407422604423e-16
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.8797037113022114e-16
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.4398518556511057e-16
EarlyStopping counter: 19 out of 100
Updating learning rate to 7.199259278255529e-17
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.599629639127764e-17
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.799814819563882e-17
EarlyStopping counter: 22 out of 100
Updating learning rate to 8.99907409781941e-18
EarlyStopping counter: 23 out of 100
Updating learning rate to 4.499537048909705e-18
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.2497685244548527e-18
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.1248842622274263e-18
EarlyStopping counter: 26 out of 100
Updating learning rate to 5.624421311137132e-19
Validation loss decreased (0.025403 --> 0.025395).  Saving model ...
Updating learning rate to 2.812210655568566e-19
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.406105327784283e-19
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.030526638921415e-20
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.515263319460707e-20
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.7576316597303536e-20
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.788158298651768e-21
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.394079149325884e-21
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.197039574662942e-21
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.098519787331471e-21
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.492598936657355e-22
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7462994683286776e-22
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.3731497341643388e-22
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.865748670821694e-23
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.432874335410847e-23
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.7164371677054235e-23
EarlyStopping counter: 15 out of 100
Updating learning rate to 8.582185838527117e-24
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.291092919263559e-24
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.1455464596317793e-24
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.0727732298158897e-24
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.363866149079448e-25
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.681933074539724e-25
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.340966537269862e-25
EarlyStopping counter: 22 out of 100
Updating learning rate to 6.70483268634931e-26
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.352416343174655e-26
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.6762081715873276e-26
EarlyStopping counter: 25 out of 100
Updating learning rate to 8.381040857936638e-27
EarlyStopping counter: 26 out of 100
Updating learning rate to 4.190520428968319e-27
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.0952602144841595e-27
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.0476301072420798e-27
EarlyStopping counter: 29 out of 100
Updating learning rate to 5.238150536210399e-28
EarlyStopping counter: 30 out of 100
Updating learning rate to 2.6190752681051994e-28
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.3095376340525997e-28
EarlyStopping counter: 32 out of 100
Updating learning rate to 6.547688170262998e-29
EarlyStopping counter: 33 out of 100
Updating learning rate to 3.273844085131499e-29
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.6369220425657496e-29
EarlyStopping counter: 35 out of 100
Updating learning rate to 8.184610212828748e-30
EarlyStopping counter: 36 out of 100
Updating learning rate to 4.092305106414374e-30
EarlyStopping counter: 37 out of 100
Updating learning rate to 2.046152553207187e-30
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.0230762766035935e-30
EarlyStopping counter: 39 out of 100
Updating learning rate to 5.115381383017968e-31
EarlyStopping counter: 40 out of 100
Updating learning rate to 2.557690691508984e-31
EarlyStopping counter: 41 out of 100
Updating learning rate to 1.278845345754492e-31
EarlyStopping counter: 42 out of 100
Updating learning rate to 6.39422672877246e-32
Validation loss decreased (0.025395 --> 0.025325).  Saving model ...
Updating learning rate to 3.19711336438623e-32
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.598556682193115e-32
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.992783410965574e-33
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.996391705482787e-33
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.9981958527413936e-33
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.990979263706968e-34
>>>>>> Testing on validation set: trial_47 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.04962512478232384, mae:0.07789675891399384, dtw:Not calculated


                                                                                        [I 2025-10-17 07:39:59,964] Trial 47 finished with value: 0.07789675891399384 and parameters: {'seq_len': 96, 'pred_len': 1, 'expand': 1, 'd_model': 32, 'n_heads': 4, 'e_layers': 1, 'd_layers': 1, 'batch_size': 16, 'learning_rate': 0.0006332535430252966, 'dropout': 0.2154206453119898}. Best is trial 44 with value: 0.07358504831790924.
Best trial: 44. Best value: 0.073585:  94%|█████████▍| 47/50 [1:36:09<10:02, 200.68s/it]Best trial: 44. Best value: 0.073585:  94%|█████████▍| 47/50 [1:36:09<10:02, 200.68s/it]Best trial: 44. Best value: 0.073585:  96%|█████████▌| 48/50 [1:36:09<07:16, 218.28s/it]
============================================================
Trial 48
============================================================
seq_len: 96, pred_len: 1
d_model: 64, n_heads: 4
e_layers: 1, d_layers: 1
batch_size: 16, lr: 0.000560
dropout: 0.19336141128875692
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_48 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 96, Prediction length: 1
============================================================
train 4577
val 259
test 261
Validation loss decreased (inf --> 0.026387).  Saving model ...
Updating learning rate to 0.000560098998499317
Validation loss decreased (0.026387 --> 0.025921).  Saving model ...
Updating learning rate to 0.0002800494992496585
Validation loss decreased (0.025921 --> 0.024955).  Saving model ...
Updating learning rate to 0.00014002474962482924
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.001237481241462e-05
Validation loss decreased (0.024955 --> 0.024804).  Saving model ...
Updating learning rate to 3.500618740620731e-05
Validation loss decreased (0.024804 --> 0.024592).  Saving model ...
Updating learning rate to 1.7503093703103655e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.751546851551827e-06
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.375773425775914e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.187886712887957e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0939433564439784e-06
Validation loss decreased (0.024592 --> 0.024525).  Saving model ...
Updating learning rate to 5.469716782219892e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.734858391109946e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.367429195554973e-07
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.837145977774865e-08
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4185729888874326e-08
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.7092864944437163e-08
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.546432472218581e-09
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.273216236109291e-09
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.1366081180546453e-09
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.0683040590273227e-09
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.341520295136613e-10
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.6707601475683067e-10
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.3353800737841533e-10
EarlyStopping counter: 13 out of 100
Updating learning rate to 6.676900368920767e-11
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.3384501844603834e-11
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.6692250922301917e-11
EarlyStopping counter: 16 out of 100
Updating learning rate to 8.346125461150958e-12
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.173062730575479e-12
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.0865313652877396e-12
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.0432656826438698e-12
EarlyStopping counter: 20 out of 100
Updating learning rate to 5.216328413219349e-13
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.6081642066096745e-13
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.3040821033048372e-13
EarlyStopping counter: 23 out of 100
Updating learning rate to 6.520410516524186e-14
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.260205258262093e-14
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.6301026291310466e-14
EarlyStopping counter: 26 out of 100
Updating learning rate to 8.150513145655233e-15
EarlyStopping counter: 27 out of 100
Updating learning rate to 4.0752565728276164e-15
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.0376282864138082e-15
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.0188141432069041e-15
EarlyStopping counter: 30 out of 100
Updating learning rate to 5.0940707160345205e-16
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.5470353580172603e-16
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.2735176790086301e-16
EarlyStopping counter: 33 out of 100
Updating learning rate to 6.367588395043151e-17
EarlyStopping counter: 34 out of 100
Updating learning rate to 3.1837941975215753e-17
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.5918970987607877e-17
EarlyStopping counter: 36 out of 100
Updating learning rate to 7.959485493803938e-18
EarlyStopping counter: 37 out of 100
Updating learning rate to 3.979742746901969e-18
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.9898713734509846e-18
EarlyStopping counter: 39 out of 100
Updating learning rate to 9.949356867254923e-19
EarlyStopping counter: 40 out of 100
Updating learning rate to 4.974678433627461e-19
EarlyStopping counter: 41 out of 100
Updating learning rate to 2.4873392168137307e-19
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.2436696084068654e-19
EarlyStopping counter: 43 out of 100
Updating learning rate to 6.218348042034327e-20
EarlyStopping counter: 44 out of 100
Updating learning rate to 3.1091740210171634e-20
EarlyStopping counter: 45 out of 100
Updating learning rate to 1.5545870105085817e-20
EarlyStopping counter: 46 out of 100
Updating learning rate to 7.772935052542908e-21
EarlyStopping counter: 47 out of 100
Updating learning rate to 3.886467526271454e-21
EarlyStopping counter: 48 out of 100
Updating learning rate to 1.943233763135727e-21
EarlyStopping counter: 49 out of 100
Updating learning rate to 9.716168815678636e-22
EarlyStopping counter: 50 out of 100
Updating learning rate to 4.858084407839318e-22
EarlyStopping counter: 51 out of 100
Updating learning rate to 2.429042203919659e-22
EarlyStopping counter: 52 out of 100
Updating learning rate to 1.2145211019598295e-22
EarlyStopping counter: 53 out of 100
Updating learning rate to 6.072605509799147e-23
EarlyStopping counter: 54 out of 100
Updating learning rate to 3.0363027548995736e-23
EarlyStopping counter: 55 out of 100
Updating learning rate to 1.5181513774497868e-23
EarlyStopping counter: 56 out of 100
Updating learning rate to 7.590756887248934e-24
EarlyStopping counter: 57 out of 100
Updating learning rate to 3.795378443624467e-24
EarlyStopping counter: 58 out of 100
Updating learning rate to 1.8976892218122335e-24
EarlyStopping counter: 59 out of 100
Updating learning rate to 9.488446109061168e-25
EarlyStopping counter: 60 out of 100
Updating learning rate to 4.744223054530584e-25
EarlyStopping counter: 61 out of 100
Updating learning rate to 2.372111527265292e-25
EarlyStopping counter: 62 out of 100
Updating learning rate to 1.186055763632646e-25
EarlyStopping counter: 63 out of 100
Updating learning rate to 5.93027881816323e-26
EarlyStopping counter: 64 out of 100
Updating learning rate to 2.965139409081615e-26
EarlyStopping counter: 65 out of 100
Updating learning rate to 1.4825697045408074e-26
EarlyStopping counter: 66 out of 100
Updating learning rate to 7.412848522704037e-27
EarlyStopping counter: 67 out of 100
Updating learning rate to 3.7064242613520186e-27
EarlyStopping counter: 68 out of 100
Updating learning rate to 1.8532121306760093e-27
EarlyStopping counter: 69 out of 100
Updating learning rate to 9.266060653380046e-28
EarlyStopping counter: 70 out of 100
Updating learning rate to 4.633030326690023e-28
EarlyStopping counter: 71 out of 100
Updating learning rate to 2.3165151633450116e-28
EarlyStopping counter: 72 out of 100
Updating learning rate to 1.1582575816725058e-28
EarlyStopping counter: 73 out of 100
Updating learning rate to 5.791287908362529e-29
EarlyStopping counter: 74 out of 100
Updating learning rate to 2.8956439541812645e-29
EarlyStopping counter: 75 out of 100
Updating learning rate to 1.4478219770906323e-29
EarlyStopping counter: 76 out of 100
Updating learning rate to 7.239109885453161e-30
EarlyStopping counter: 77 out of 100
Updating learning rate to 3.619554942726581e-30
EarlyStopping counter: 78 out of 100
Updating learning rate to 1.8097774713632903e-30
EarlyStopping counter: 79 out of 100
Updating learning rate to 9.048887356816452e-31
EarlyStopping counter: 80 out of 100
Updating learning rate to 4.524443678408226e-31
EarlyStopping counter: 81 out of 100
Updating learning rate to 2.262221839204113e-31
EarlyStopping counter: 82 out of 100
Updating learning rate to 1.1311109196020565e-31
EarlyStopping counter: 83 out of 100
Updating learning rate to 5.655554598010282e-32
EarlyStopping counter: 84 out of 100
Updating learning rate to 2.827777299005141e-32
EarlyStopping counter: 85 out of 100
Updating learning rate to 1.4138886495025706e-32
EarlyStopping counter: 86 out of 100
Updating learning rate to 7.069443247512853e-33
EarlyStopping counter: 87 out of 100
Updating learning rate to 3.5347216237564264e-33
Validation loss decreased (0.024525 --> 0.024509).  Saving model ...
Updating learning rate to 1.7673608118782132e-33
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.836804059391066e-34
>>>>>> Testing on validation set: trial_48 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.049106162041425705, mae:0.07247909903526306, dtw:Not calculated


                                                                                        [I 2025-10-17 07:44:20,658] Trial 48 finished with value: 0.07247909903526306 and parameters: {'seq_len': 96, 'pred_len': 1, 'expand': 1, 'd_model': 64, 'n_heads': 4, 'e_layers': 1, 'd_layers': 1, 'batch_size': 16, 'learning_rate': 0.000560098998499317, 'dropout': 0.19336141128875692}. Best is trial 48 with value: 0.07247909903526306.
Best trial: 44. Best value: 0.073585:  96%|█████████▌| 48/50 [1:40:29<07:16, 218.28s/it]Best trial: 48. Best value: 0.0724791:  96%|█████████▌| 48/50 [1:40:29<07:16, 218.28s/it]Best trial: 48. Best value: 0.0724791:  98%|█████████▊| 49/50 [1:40:29<03:51, 231.01s/it]
============================================================
Trial 49
============================================================
seq_len: 48, pred_len: 1
d_model: 64, n_heads: 4
e_layers: 2, d_layers: 1
batch_size: 16, lr: 0.000380
dropout: 0.19867025558229714
============================================================

Please make sure you have successfully installed mamba_ssm
Use GPU: cuda:0
DEBUG Mamba Init - d_model: 64, d_state: 16, d_inner: 64, expand: 1
>>>>>> Start training: trial_49 >>>>>>
============================================================
DATASET SPLIT INFO (90/5/5):
============================================================
Total samples: 5193
Train: 4673 samples (90%) - rows 0 to 4672
Val: 259 samples (5%) - rows 4673 to 4931
Test: 261 samples (5%) - rows 4932 to 5192
Sequence length: 48, Prediction length: 1
============================================================
train 4625
val 259
test 261
Validation loss decreased (inf --> 0.030241).  Saving model ...
Updating learning rate to 0.00038018488790440765
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.00019009244395220382
Validation loss decreased (0.030241 --> 0.026547).  Saving model ...
Updating learning rate to 9.504622197610191e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.7523110988050956e-05
Validation loss decreased (0.026547 --> 0.025592).  Saving model ...
Updating learning rate to 2.3761555494025478e-05
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1880777747012739e-05
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.9403888735063695e-06
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.9701944367531848e-06
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4850972183765924e-06
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.425486091882962e-07
Validation loss decreased (0.025592 --> 0.025592).  Saving model ...
Updating learning rate to 3.712743045941481e-07
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8563715229707405e-07
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.281857614853702e-08
Validation loss decreased (0.025592 --> 0.025425).  Saving model ...
Updating learning rate to 4.640928807426851e-08
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.3204644037134256e-08
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1602322018567128e-08
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.801161009283564e-09
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.900580504641782e-09
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.450290252320891e-09
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.251451261604455e-10
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.6257256308022275e-10
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.8128628154011137e-10
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.064314077005569e-11
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.5321570385027844e-11
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.2660785192513922e-11
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.1330392596256961e-11
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.6651962981284805e-12
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.8325981490642402e-12
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.4162990745321201e-12
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.081495372660601e-13
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.5407476863303003e-13
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.7703738431651501e-13
EarlyStopping counter: 19 out of 100
Updating learning rate to 8.851869215825751e-14
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.4259346079128754e-14
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.2129673039564377e-14
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.1064836519782188e-14
EarlyStopping counter: 23 out of 100
Updating learning rate to 5.532418259891094e-15
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.766209129945547e-15
EarlyStopping counter: 25 out of 100
Updating learning rate to 1.3831045649727735e-15
EarlyStopping counter: 26 out of 100
Updating learning rate to 6.915522824863868e-16
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.457761412431934e-16
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.728880706215967e-16
EarlyStopping counter: 29 out of 100
Updating learning rate to 8.644403531079835e-17
EarlyStopping counter: 30 out of 100
Updating learning rate to 4.3222017655399173e-17
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.1611008827699587e-17
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.0805504413849793e-17
EarlyStopping counter: 33 out of 100
Updating learning rate to 5.402752206924897e-18
EarlyStopping counter: 34 out of 100
Updating learning rate to 2.7013761034624483e-18
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.3506880517312242e-18
EarlyStopping counter: 36 out of 100
Updating learning rate to 6.753440258656121e-19
EarlyStopping counter: 37 out of 100
Updating learning rate to 3.3767201293280604e-19
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.6883600646640302e-19
EarlyStopping counter: 39 out of 100
Updating learning rate to 8.441800323320151e-20
EarlyStopping counter: 40 out of 100
Updating learning rate to 4.2209001616600755e-20
EarlyStopping counter: 41 out of 100
Updating learning rate to 2.1104500808300378e-20
EarlyStopping counter: 42 out of 100
Updating learning rate to 1.0552250404150189e-20
EarlyStopping counter: 43 out of 100
Updating learning rate to 5.2761252020750944e-21
EarlyStopping counter: 44 out of 100
Updating learning rate to 2.6380626010375472e-21
EarlyStopping counter: 45 out of 100
Updating learning rate to 1.3190313005187736e-21
EarlyStopping counter: 46 out of 100
Updating learning rate to 6.595156502593868e-22
Validation loss decreased (0.025425 --> 0.025415).  Saving model ...
Updating learning rate to 3.297578251296934e-22
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.648789125648467e-22
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.243945628242335e-23
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.1219728141211675e-23
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0609864070605838e-23
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0304932035302919e-23
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.1524660176514594e-24
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.5762330088257297e-24
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.2881165044128648e-24
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.440582522064324e-25
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.220291261032162e-25
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.610145630516081e-25
EarlyStopping counter: 12 out of 100
Updating learning rate to 8.050728152580405e-26
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.0253640762902026e-26
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.0126820381451013e-26
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.0063410190725507e-26
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.031705095362753e-27
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.5158525476813767e-27
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.2579262738406883e-27
EarlyStopping counter: 19 out of 100
Updating learning rate to 6.289631369203442e-28
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.144815684601721e-28
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.5724078423008604e-28
EarlyStopping counter: 22 out of 100
Updating learning rate to 7.862039211504302e-29
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.931019605752151e-29
EarlyStopping counter: 24 out of 100
Updating learning rate to 1.9655098028760755e-29
EarlyStopping counter: 25 out of 100
Updating learning rate to 9.827549014380378e-30
EarlyStopping counter: 26 out of 100
Updating learning rate to 4.913774507190189e-30
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.4568872535950944e-30
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.2284436267975472e-30
EarlyStopping counter: 29 out of 100
Updating learning rate to 6.142218133987736e-31
EarlyStopping counter: 30 out of 100
Updating learning rate to 3.071109066993868e-31
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.535554533496934e-31
EarlyStopping counter: 32 out of 100
Updating learning rate to 7.67777266748467e-32
EarlyStopping counter: 33 out of 100
Updating learning rate to 3.838886333742335e-32
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.9194431668711675e-32
EarlyStopping counter: 35 out of 100
Updating learning rate to 9.597215834355837e-33
EarlyStopping counter: 36 out of 100
Updating learning rate to 4.798607917177919e-33
EarlyStopping counter: 37 out of 100
Updating learning rate to 2.3993039585889594e-33
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.1996519792944797e-33
EarlyStopping counter: 39 out of 100
Updating learning rate to 5.998259896472398e-34
>>>>>> Testing on validation set: trial_49 >>>>>>
test 261
test shape: (261, 1, 5) (261, 1, 5)
test shape: (261, 1, 5) (261, 1, 5)


	mse:0.04986661672592163, mae:0.07512588798999786, dtw:Not calculated


                                                                                         [I 2025-10-17 07:48:42,467] Trial 49 finished with value: 0.07512588798999786 and parameters: {'seq_len': 48, 'pred_len': 1, 'expand': 1, 'd_model': 64, 'n_heads': 4, 'e_layers': 2, 'd_layers': 1, 'batch_size': 16, 'learning_rate': 0.00038018488790440765, 'dropout': 0.19867025558229714}. Best is trial 48 with value: 0.07247909903526306.
Best trial: 48. Best value: 0.0724791:  98%|█████████▊| 49/50 [1:44:51<03:51, 231.01s/it]Best trial: 48. Best value: 0.0724791:  98%|█████████▊| 49/50 [1:44:51<03:51, 231.01s/it]Best trial: 48. Best value: 0.0724791: 100%|██████████| 50/50 [1:44:51<00:00, 240.25s/it]Best trial: 48. Best value: 0.0724791: 100%|██████████| 50/50 [1:44:51<00:00, 125.84s/it]

======================================================================
Optimization Complete!
======================================================================
Number of finished trials: 50

Best trial:
  Value (MSE): 0.072479

Best hyperparameters:
  seq_len: 96
  pred_len: 1
  expand: 1
  d_model: 64
  n_heads: 4
  e_layers: 1
  d_layers: 1
  batch_size: 16
  learning_rate: 0.000560098998499317
  dropout: 0.19336141128875692
======================================================================

✅ Best parameters saved to: ./optuna_results/Mamba_Exchange_30_best_params.json
✅ Visualizations saved to ./optuna_results/

======================================================================
✅ Hyperparameter tuning complete!
✅ Best parameters saved to: ./optuna_results/Mamba_Exchange_30_best_params.json
======================================================================

Next steps:
  1. Review visualizations in optuna_results/ folder
  2. Train final model:
     python train_best_model.py --model Mamba --train_epochs 100
======================================================================
